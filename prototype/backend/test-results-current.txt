
> armoured-souls-backend@0.1.0 test
> jest

FAIL tests/tagTeamValidation.property.test.ts
  ● Console

    console.log
      [TagTeamMatchmaking] Current cycle: 0, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 64, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 1, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 3, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 47, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 93, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 3, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 94, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 2, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 91, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 3, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 55, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 36, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 38, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 80, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 5, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 38, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 5, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 66, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 75, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 41, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 42, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 4, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 5, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 47, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 48, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 2, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 3, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 0, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 1, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 63, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 64, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 3, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 4, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 58, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 59, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 15, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 16, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 6, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 7, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 0, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 1, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 56, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 57, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 83, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 84, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 55, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 56, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 31, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 32, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 24, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 25, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 57, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 58, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 48, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 49, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 2, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 3, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 34, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 35, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 63, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 64, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 16, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 17, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 66, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 67, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 78, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 79, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 14, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 15, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 50, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 51, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 48, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 49, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 5, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 6, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 6, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 7, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 24, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 25, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 15, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 16, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 53, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 54, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 3, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 4, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 0, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 1, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 76, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 50, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 0, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 1, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 38, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 39, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 57, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 58, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 67, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 68, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 72, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 73, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 74, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 75, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 75, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 76, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 1, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 3, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 5, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 7, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 9, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 11, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 13, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 15, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 17, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 19, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 21, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 23, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 25, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 27, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 29, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 31, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 33, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 35, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 37, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 39, should run: true

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 0, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 2, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 4, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 6, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 8, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 10, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 12, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 14, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 16, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 18, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 20, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 22, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 24, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 26, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 28, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 30, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 32, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 34, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 36, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 38, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

    console.log
      [TagTeamMatchmaking] Current cycle: 40, should run: false

      at shouldRunTagTeamMatchmaking (src/services/tagTeamMatchmakingService.ts:35:11)

  ● Tag Team Validation Property Tests › should only validate teams where both robots are from same stable and battle ready

    TypeError: Cannot read properties of null (reading 'id')

      43 |     // Get a weapon for testing
      44 |     const weapon = await prisma.weapon.findFirst();
    > 45 |     weaponId = weapon!.id;
         |                        ^
      46 |   });
      47 |
      48 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:45:24)

  ● Tag Team Validation Property Tests › should reject teams with robots from different stables

    TypeError: Cannot read properties of null (reading 'id')

      43 |     // Get a weapon for testing
      44 |     const weapon = await prisma.weapon.findFirst();
    > 45 |     weaponId = weapon!.id;
         |                        ^
      46 |   });
      47 |
      48 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:45:24)

  ● Tag Team Validation Property Tests › should reject teams with unready robots

    TypeError: Cannot read properties of null (reading 'id')

      43 |     // Get a weapon for testing
      44 |     const weapon = await prisma.weapon.findFirst();
    > 45 |     weaponId = weapon!.id;
         |                        ^
      46 |   });
      47 |
      48 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:45:24)

  ● Tag Team Validation Property Tests › should preserve team configuration through create and retrieve cycle

    TypeError: Cannot read properties of null (reading 'id')

      43 |     // Get a weapon for testing
      44 |     const weapon = await prisma.weapon.findFirst();
    > 45 |     weaponId = weapon!.id;
         |                        ^
      46 |   });
      47 |
      48 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:45:24)

  ● Tag Team Validation Property Tests › should place all new teams in Bronze league with initial values

    TypeError: Cannot read properties of null (reading 'id')

      43 |     // Get a weapon for testing
      44 |     const weapon = await prisma.weapon.findFirst();
    > 45 |     weaponId = weapon!.id;
         |                        ^
      46 |   });
      47 |
      48 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:45:24)

  ● Tag Team Validation Property Tests › should enforce team creation limit based on roster size

    TypeError: Cannot read properties of null (reading 'id')

      43 |     // Get a weapon for testing
      44 |     const weapon = await prisma.weapon.findFirst();
    > 45 |     weaponId = weapon!.id;
         |                        ^
      46 |   });
      47 |
      48 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:45:24)

  ● Tag Team Validation Property Tests › should remove team from database and free robots for new teams

    TypeError: Cannot read properties of null (reading 'id')

      43 |     // Get a weapon for testing
      44 |     const weapon = await prisma.weapon.findFirst();
    > 45 |     weaponId = weapon!.id;
         |                        ^
      46 |   });
      47 |
      48 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:45:24)

  ● Tag Team Validation Property Tests › should validate team readiness based on both robots meeting all requirements

    TypeError: Cannot read properties of null (reading 'id')

      43 |     // Get a weapon for testing
      44 |     const weapon = await prisma.weapon.findFirst();
    > 45 |     weaponId = weapon!.id;
         |                        ^
      46 |   });
      47 |
      48 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:45:24)

  ● Tag Team Validation Property Tests › should calculate combined ELO as sum of both robots ELOs

    TypeError: Cannot read properties of null (reading 'id')

      43 |     // Get a weapon for testing
      44 |     const weapon = await prisma.weapon.findFirst();
    > 45 |     weaponId = weapon!.id;
         |                        ^
      46 |   });
      47 |
      48 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:45:24)

  ● Tag Team Matchmaking Cycle Scheduling Property Tests › should alternate matchmaking between consecutive cycles

    Property failed after 35 tests
    { seed: -421635051, path: "34", endOnFailure: true }
    Counterexample: [76]
    Shrunk 0 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).not.toBe(expected) // Object.is equality

    Expected: not false

      1121 |
      1122 |           // Property: Consecutive cycles should have opposite values
    > 1123 |           expect(shouldRunCurrent).not.toBe(shouldRunNext);
           |                                        ^
      1124 |
      1125 |           // Property: If current cycle runs, next should not
      1126 |           if (shouldRunCurrent) {

      at tests/tagTeamValidation.property.test.ts:1123:40
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:1103:5)

  ● Tag Team Matchmaking Eligible Teams Property Tests › should exclude teams with unready robots from eligible teams

    TypeError: Cannot read properties of null (reading 'id')

      1207 |     // Get a weapon for testing
      1208 |     const weapon = await prisma.weapon.findFirst();
    > 1209 |     weaponId = weapon!.id;
           |                        ^
      1210 |   });
      1211 |
      1212 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:1209:24)

  ● Tag Team Matchmaking Eligible Teams Property Tests › should exclude teams where any robot has HP below 75%

    TypeError: Cannot read properties of null (reading 'id')

      1207 |     // Get a weapon for testing
      1208 |     const weapon = await prisma.weapon.findFirst();
    > 1209 |     weaponId = weapon!.id;
           |                        ^
      1210 |   });
      1211 |
      1212 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:1209:24)

  ● Tag Team Matchmaking ELO Matching Property Tests › should prefer matching teams with smaller ELO differences

    TypeError: Cannot read properties of null (reading 'id')

      1498 |     // Get a weapon for testing
      1499 |     const weapon = await prisma.weapon.findFirst();
    > 1500 |     weaponId = weapon!.id;
           |                        ^
      1501 |   });
      1502 |
      1503 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:1500:24)

  ● Tag Team Matchmaking Same-Stable Exclusion Property Tests › should strongly deprioritize same-stable matches

    TypeError: Cannot read properties of null (reading 'id')

      1684 |     // Get a weapon for testing
      1685 |     const weapon = await prisma.weapon.findFirst();
    > 1686 |     weaponId = weapon!.id;
           |                        ^
      1687 |   });
      1688 |
      1689 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:1686:24)

  ● Tag Team Matchmaking Recent Opponent Deprioritization Property Tests › should deprioritize recent opponents when multiple options exist

    TypeError: Cannot read properties of null (reading 'id')

      1934 |     // Get a weapon for testing
      1935 |     const weapon = await prisma.weapon.findFirst();
    > 1936 |     weaponId = weapon!.id;
           |                        ^
      1937 |   });
      1938 |
      1939 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:1936:24)

PASS tests/cycleSummaryStreamingRevenue.property.test.ts
  ● Console

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:20.282Z

      at executeScheduledBattles (src/services/battleOrchestrator.ts:841:11)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at executeScheduledBattles (src/services/battleOrchestrator.ts:860:11)

    console.log
      [Streaming] TestRobot1_1771858880192_0.09258731745866144 earned ₡12,013 from Battle #60688

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858880192_0.09235203722576901 earned ₡21,506 from Battle #60688

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.error
      [BattleOrchestrator] Failed to process match 40536: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:722:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSummaryStreamingRevenue.property.test.ts:251:27
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSummaryStreamingRevenue.property.test.ts:177:5) {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/cycleSummaryStreamingRevenue.property.test.ts:251:27
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/cycleSummaryStreamingRevenue.property.test.ts:177:5)

    console.log
      [Streaming] TestRobot1_1771858880263_0.7222971984361943 earned ₡2,999 from Battle #60689

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858880271_0.8175161413064398 earned ₡2,554 from Battle #60689

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858880263_0.7222971984361943 (User 38462) vs TestRobot2_1771858880271_0.8175161413064398 (User 38463) | Winner: TestRobot2_1771858880271_0.8175161413064398 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 1 failed, 0 bye-matches

      at executeScheduledBattles (src/services/battleOrchestrator.ts:938:11)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at executeScheduledBattles (src/services/battleOrchestrator.ts:939:11)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:20.558Z

      at executeScheduledBattles (src/services/battleOrchestrator.ts:841:11)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at executeScheduledBattles (src/services/battleOrchestrator.ts:860:11)

    console.log
      [Streaming] TestRobot1_1771858880440_0.602182634730807 earned ₡2,007 from Battle #60692

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858880440_0.9193466933876333 earned ₡21,509 from Battle #60692

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858880440_0.602182634730807 (User 38460) vs TestRobot2_1771858880440_0.9193466933876333 (User 38461) | Winner: TestRobot2_1771858880440_0.9193466933876333 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +3

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858880550_0.7331328909169752 earned ₡11,960 from Battle #60695

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858880552_0.23911333252508837 earned ₡14,826 from Battle #60695

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858880550_0.7331328909169752 (User 38462) vs TestRobot2_1771858880552_0.23911333252508837 (User 38463) | Winner: TestRobot1_1771858880550_0.7331328909169752 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 0 failed, 0 bye-matches

      at executeScheduledBattles (src/services/battleOrchestrator.ts:938:11)

    console.log
      [BattleOrchestrator] Reputation: 10 prestige, 5 fame awarded

      at executeScheduledBattles (src/services/battleOrchestrator.ts:939:11)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:20.770Z

      at executeScheduledBattles (src/services/battleOrchestrator.ts:841:11)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at executeScheduledBattles (src/services/battleOrchestrator.ts:860:11)

    console.log
      [Streaming] TestRobot1_1771858880672_0.2395032711865187 earned ₡2,001 from Battle #60699

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858880672_0.2880802867574742 earned ₡21,513 from Battle #60699

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858880672_0.2395032711865187 (User 38460) vs TestRobot2_1771858880672_0.2880802867574742 (User 38461) | Winner: TestRobot2_1771858880672_0.2880802867574742 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858880756_0.48329929983168907 earned ₡1,894 from Battle #60701

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858880760_0.129578070217363 earned ₡2,391 from Battle #60701

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858880756_0.48329929983168907 (User 38462) vs TestRobot2_1771858880760_0.129578070217363 (User 38463) | Winner: TestRobot1_1771858880756_0.48329929983168907 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 0 failed, 0 bye-matches

      at executeScheduledBattles (src/services/battleOrchestrator.ts:938:11)

    console.log
      [BattleOrchestrator] Reputation: 10 prestige, 4 fame awarded

      at executeScheduledBattles (src/services/battleOrchestrator.ts:939:11)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:21.000Z

      at executeScheduledBattles (src/services/battleOrchestrator.ts:841:11)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at executeScheduledBattles (src/services/battleOrchestrator.ts:860:11)

    console.log
      [Streaming] TestRobot1_1771858880874_0.7969556892285852 earned ₡2,004 from Battle #60703

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858880874_0.9050349615869661 earned ₡11,399 from Battle #60703

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858880874_0.7969556892285852 (User 38460) vs TestRobot2_1771858880874_0.9050349615869661 (User 38461) | Winner: TestRobot2_1771858880874_0.9050349615869661 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858880991_0.3815794846376095 earned ₡16,567 from Battle #60705

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858880993_0.12574180703754545 earned ₡17,890 from Battle #60705

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858880991_0.3815794846376095 (User 38462) vs TestRobot2_1771858880993_0.12574180703754545 (User 38463) | Winner: TestRobot2_1771858880993_0.12574180703754545 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2 | Kill: TestRobot2_1771858880993_0.12574180703754545

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 0 failed, 0 bye-matches

      at executeScheduledBattles (src/services/battleOrchestrator.ts:938:11)

    console.log
      [BattleOrchestrator] Reputation: 10 prestige, 4 fame awarded

      at executeScheduledBattles (src/services/battleOrchestrator.ts:939:11)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:21.194Z

      at executeScheduledBattles (src/services/battleOrchestrator.ts:841:11)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at executeScheduledBattles (src/services/battleOrchestrator.ts:860:11)

    console.log
      [Streaming] TestRobot1_1771858881044_0.17627262520634135 earned ₡2,004 from Battle #60709

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858881044_0.7459075297126387 earned ₡9,025 from Battle #60709

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.error
      [BattleOrchestrator] Failed to process match 40544: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:722:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSummaryStreamingRevenue.property.test.ts:251:27
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSummaryStreamingRevenue.property.test.ts:177:5) {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/cycleSummaryStreamingRevenue.property.test.ts:251:27
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/cycleSummaryStreamingRevenue.property.test.ts:177:5)

    console.log
      [Streaming] TestRobot1_1771858881185_0.9029383247340351 earned ₡2,995 from Battle #60711

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858881188_0.9960772427675278 earned ₡5,529 from Battle #60711

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858881185_0.9029383247340351 (User 38462) vs TestRobot2_1771858881188_0.9960772427675278 (User 38463) | Winner: TestRobot2_1771858881188_0.9960772427675278 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 1 failed, 0 bye-matches

      at executeScheduledBattles (src/services/battleOrchestrator.ts:938:11)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at executeScheduledBattles (src/services/battleOrchestrator.ts:939:11)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:21.383Z

      at executeScheduledBattles (src/services/battleOrchestrator.ts:841:11)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at executeScheduledBattles (src/services/battleOrchestrator.ts:860:11)

    console.log
      [Streaming] TestRobot1_1771858881237_0.35725691522718384 earned ₡2,004 from Battle #60713

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858881237_0.8472287016253194 earned ₡9,021 from Battle #60713

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858881237_0.35725691522718384 (User 38460) vs TestRobot2_1771858881237_0.8472287016253194 (User 38461) | Winner: TestRobot1_1771858881237_0.35725691522718384 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2 | Kill: TestRobot1_1771858881237_0.35725691522718384

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858881372_0.8780283056361814 earned ₡15,831 from Battle #60715

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858881376_0.3052811274414826 earned ₡16,524 from Battle #60715

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858881372_0.8780283056361814 (User 38462) vs TestRobot2_1771858881376_0.3052811274414826 (User 38463) | Winner: TestRobot2_1771858881376_0.3052811274414826 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2 | Kill: TestRobot2_1771858881376_0.3052811274414826

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 0 failed, 0 bye-matches

      at executeScheduledBattles (src/services/battleOrchestrator.ts:938:11)

    console.log
      [BattleOrchestrator] Reputation: 10 prestige, 4 fame awarded

      at executeScheduledBattles (src/services/battleOrchestrator.ts:939:11)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:21.589Z

      at executeScheduledBattles (src/services/battleOrchestrator.ts:841:11)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at executeScheduledBattles (src/services/battleOrchestrator.ts:860:11)

    console.error
      [BattleOrchestrator] Failed to process match 40548: PrismaClientKnownRequestError: 
      Invalid `prisma.battle.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:397:38
      
        394 }
        395 
        396 // Create battle record
      → 397 const battle = await prisma.battle.create(
      Foreign key constraint violated: `battles_robot1_id_fkey (index)`
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at createBattleRecord (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:397:18)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:641:18)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSummaryStreamingRevenue.property.test.ts:251:27
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSummaryStreamingRevenue.property.test.ts:177:5) {
        code: 'P2003',
        clientVersion: '5.22.0',
        meta: { modelName: 'Battle', field_name: 'battles_robot1_id_fkey (index)' }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/cycleSummaryStreamingRevenue.property.test.ts:251:27
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/cycleSummaryStreamingRevenue.property.test.ts:177:5)

    console.log
      [Streaming] TestRobot1_1771858881580_0.4143941780078221 earned ₡4,487 from Battle #60718

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858881583_0.007280012205443609 earned ₡10,019 from Battle #60718

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858881580_0.4143941780078221 (User 38462) vs TestRobot2_1771858881583_0.007280012205443609 (User 38463) | Winner: TestRobot2_1771858881583_0.007280012205443609 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 1 failed, 0 bye-matches

      at executeScheduledBattles (src/services/battleOrchestrator.ts:938:11)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at executeScheduledBattles (src/services/battleOrchestrator.ts:939:11)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:21.749Z

      at executeScheduledBattles (src/services/battleOrchestrator.ts:841:11)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at executeScheduledBattles (src/services/battleOrchestrator.ts:860:11)

    console.log
      [Streaming] TestRobot1_1771858881623_0.7166025449737565 earned ₡2,001 from Battle #60721

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858881623_0.797770478475584 earned ₡5,007 from Battle #60721

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858881623_0.7166025449737565 (User 38460) vs TestRobot2_1771858881623_0.797770478475584 (User 38461) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858881741_0.6118555875634609 earned ₡18,912 from Battle #60723

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858881743_0.7756091257482438 earned ₡7,268 from Battle #60723

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.error
      [BattleOrchestrator] Failed to process match 40551: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:761:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSummaryStreamingRevenue.property.test.ts:251:27
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSummaryStreamingRevenue.property.test.ts:177:5) {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/cycleSummaryStreamingRevenue.property.test.ts:251:27
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/cycleSummaryStreamingRevenue.property.test.ts:177:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 1 failed, 0 bye-matches

      at executeScheduledBattles (src/services/battleOrchestrator.ts:938:11)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at executeScheduledBattles (src/services/battleOrchestrator.ts:939:11)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:21.913Z

      at executeScheduledBattles (src/services/battleOrchestrator.ts:841:11)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at executeScheduledBattles (src/services/battleOrchestrator.ts:860:11)

    console.log
      [Streaming] TestRobot1_1771858881809_0.013776551290393568 earned ₡2,001 from Battle #60725

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858881809_0.6025669508677448 earned ₡2,001 from Battle #60725

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858881809_0.013776551290393568 (User 38460) vs TestRobot2_1771858881809_0.6025669508677448 (User 38461) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858881904_0.779341608761073 earned ₡10,155 from Battle #60727

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858881907_0.3240468445048026 earned ₡8,025 from Battle #60727

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858881904_0.779341608761073 (User 38462) vs TestRobot2_1771858881907_0.3240468445048026 (User 38463) | Winner: TestRobot2_1771858881907_0.3240468445048026 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 0 failed, 0 bye-matches

      at executeScheduledBattles (src/services/battleOrchestrator.ts:938:11)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at executeScheduledBattles (src/services/battleOrchestrator.ts:939:11)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:22.084Z

      at executeScheduledBattles (src/services/battleOrchestrator.ts:841:11)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at executeScheduledBattles (src/services/battleOrchestrator.ts:860:11)

    console.log
      [Streaming] TestRobot1_1771858881959_0.7013411440723439 earned ₡2,006 from Battle #60729

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858881959_0.48605881673145834 earned ₡2,004 from Battle #60729

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858881959_0.7013411440723439 (User 38460) vs TestRobot2_1771858881959_0.48605881673145834 (User 38461) | Winner: TestRobot1_1771858881959_0.7013411440723439 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +3 | Kill: TestRobot1_1771858881959_0.7013411440723439

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858882075_0.574517479190503 earned ₡6,180 from Battle #60731

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858882078_0.14434901913717635 earned ₡21,637 from Battle #60731

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858882075_0.574517479190503 (User 38462) vs TestRobot2_1771858882078_0.14434901913717635 (User 38463) | Winner: TestRobot1_1771858882075_0.574517479190503 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 0 failed, 0 bye-matches

      at executeScheduledBattles (src/services/battleOrchestrator.ts:938:11)

    console.log
      [BattleOrchestrator] Reputation: 10 prestige, 5 fame awarded

      at executeScheduledBattles (src/services/battleOrchestrator.ts:939:11)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:32.262Z

      at executeScheduledBattles (src/services/battleOrchestrator.ts:841:11)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at executeScheduledBattles (src/services/battleOrchestrator.ts:860:11)

    console.error
      [BattleOrchestrator] Failed to process match 40556: Error: BattleParticipant not found for battle 60733, robot 550361
          at updateRobotStats (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:490:11)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:646:18)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSummaryStreamingRevenue.property.test.ts:285:21)

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at Object.<anonymous> (tests/cycleSummaryStreamingRevenue.property.test.ts:285:21)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 1 failed, 0 bye-matches

      at executeScheduledBattles (src/services/battleOrchestrator.ts:938:11)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at executeScheduledBattles (src/services/battleOrchestrator.ts:939:11)

FAIL tests/creditChangeAuditTrail.property.test.ts (5.273 s)
  ● Property 3: Credit Change Audit Trail › balance progression is continuous

    Property failed after 3 tests
    { seed: -885100289, path: "2", endOnFailure: true }
    Counterexample: [9,84,77398,[-269,1000]]
    Shrunk 0 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCreditChange (src/services/eventLogger.ts:401:5)
      at tests/creditChangeAuditTrail.property.test.ts:167:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/creditChangeAuditTrail.property.test.ts:148:5)

  ● Property 3: Credit Change Audit Trail › multiple users tracked independently

    Property failed after 1 tests
    { seed: 661200367, path: "0:0:1:0:0:0:0:0:0:0:0:1:0:0:0:0:0:0:0:0:0:0:2:6:3:3:1", endOnFailure: true }
    Counterexample: [1,[{"userId":1,"startingBalance":0,"changes":[0]},{"userId":1,"startingBalance":4,"changes":[-777]}]]
    Shrunk 26 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: -777
    Received: -553

      263 |             }, 0);
      264 |
    > 265 |             expect(sumOfChanges).toBe(expectedDelta);
          |                                  ^
      266 |           }
      267 |         }
      268 |       ),

      at tests/creditChangeAuditTrail.property.test.ts:265:34
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/creditChangeAuditTrail.property.test.ts:206:5)

  ● Property 3: Credit Change Audit Trail › credit changes across multiple cycles

    Property failed after 2 tests
    { seed: -261052029, path: "1:0:0:0:1:2:0:0:7:1:0:0:2:1:4:1:2:6:4:1:2:1:1:1:3:0:1:6:4:1:2:2:2:2:1:0:0:0:0:0:0:3:0", endOnFailure: true }
    Counterexample: [1,[{"cycleNumber":1,"startingBalance":0,"changes":[513]},{"cycleNumber":1,"startingBalance":11721,"changes":[0,13]}]]
    Shrunk 42 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 526
    Received: 13

      337 |             }, 0);
      338 |
    > 339 |             expect(sumOfChanges).toBe(expectedDelta);
          |                                  ^
      340 |           }
      341 |         }
      342 |       ),

      at tests/creditChangeAuditTrail.property.test.ts:339:34
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/creditChangeAuditTrail.property.test.ts:280:5)

  ● Property 3: Credit Change Audit Trail › credit source is preserved

    Property failed after 2 tests
    { seed: -1998131617, path: "1:4:1:4:0:0:0:0:3:1:1:1:3:3:2:2", endOnFailure: true }
    Counterexample: [1,1,0,[{"amount":0,"source":"battle"},{"amount":-2900,"source":"facility_purchase"}]]
    Shrunk 15 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 1

      399 |           });
      400 |
    > 401 |           expect(events.length).toBe(changes.length);
          |                                 ^
      402 |
      403 |           for (let i = 0; i < events.length; i++) {
      404 |             const payload = events[i].payload as any;

      at tests/creditChangeAuditTrail.property.test.ts:401:33
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/creditChangeAuditTrail.property.test.ts:353:5)

FAIL tests/financialReportStreamingRevenue.property.test.ts
  ● Property 17: Financial Report Includes Streaming Revenue › Property 17: Financial report includes streaming revenue line item

    Property failed after 1 tests
    { seed: -836021373, path: "0:0:0:0:1:0:0:0:0", endOnFailure: true }
    Counterexample: [{__proto__:null,"numBattles":1,"robotBattles":0,"robotFame":0,"studioLevel":0,"streamingRevenuePerBattle":[1000]}]
    Shrunk 8 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 1000
    Received: 0

      205 |
      206 |           // Property 3: Streaming revenue should equal sum of all battle streaming revenues
    > 207 |           expect(report.revenue.streaming).toBe(expectedTotalStreamingRevenue);
          |                                            ^
      208 |
      209 |           // Property 4: Streaming battle count should equal number of battles
      210 |           expect(report.revenue.streamingBattleCount).toBe(numBattles);

      at tests/financialReportStreamingRevenue.property.test.ts:207:44
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/financialReportStreamingRevenue.property.test.ts:127:5)

  ● Property 17: Financial Report Includes Streaming Revenue › Property 17.2: Only counts streaming revenue from user's robots

    Property failed after 1 tests
    { seed: 920757807, path: "0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [{"userBattles":1,"opponentBattles":1,"userStreamingRevenue":[1000],"opponentStreamingRevenue":[1000]}]
    Shrunk 5 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 2000
    Received:    0

      383 |             // Note: The report aggregates from last 7 days, so it may include more than just our test data
      384 |             // We verify that it includes AT LEAST the expected amount from our test
    > 385 |             expect(report.revenue.streaming).toBeGreaterThanOrEqual(expectedUserStreamingRevenue);
          |                                              ^
      386 |
      387 |             // Property: Should count at least the battles where user's robot participated
      388 |             expect(report.revenue.streamingBattleCount).toBeGreaterThanOrEqual(userBattles + opponentBattles);

      at tests/financialReportStreamingRevenue.property.test.ts:385:46
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/financialReportStreamingRevenue.property.test.ts:282:5)

  ● Property 17: Financial Report Includes Streaming Revenue › Property 17.3: Streaming revenue contributes to total revenue

    Property failed after 1 tests
    { seed: 1943544140, path: "0:1:0:0:0:0", endOnFailure: true }
    Counterexample: [{"numBattles":1,"streamingRevenuePerBattle":1000,"battleWinnings":0}]
    Shrunk 5 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 1000
    Received: 0

      454 |             expectedStreamingRevenue;
      455 |
    > 456 |           expect(report.revenue.total).toBe(expectedTotalRevenue);
          |                                        ^
      457 |
      458 |           // Property: Total revenue should be at least streaming revenue
      459 |           expect(report.revenue.total).toBeGreaterThanOrEqual(expectedStreamingRevenue);

      at tests/financialReportStreamingRevenue.property.test.ts:456:40
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/financialReportStreamingRevenue.property.test.ts:408:5)

  ● Property 17: Financial Report Includes Streaming Revenue › Property 17.4: Aggregates streaming revenue across multiple robots

    Property failed after 1 tests
    { seed: 1716770196, path: "0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [{"numRobots":2,"battlesPerRobot":[1,1],"revenuePerBattle":[1000,1000]}]
    Shrunk 5 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 2000
    Received: 0

      539 |
      540 |           // Property: Should aggregate streaming revenue from all robots
    > 541 |           expect(report.revenue.streaming).toBe(expectedTotalStreamingRevenue);
          |                                            ^
      542 |
      543 |           // Property: Should count all battles from all robots
      544 |           expect(report.revenue.streamingBattleCount).toBe(expectedTotalBattleCount);

      at tests/financialReportStreamingRevenue.property.test.ts:541:44
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/financialReportStreamingRevenue.property.test.ts:473:5)

FAIL tests/statsUpdatedBeforeStreamingRevenue.property.test.ts
  ● Console

    console.log
      [Streaming] TestRobot1_1771858884223_0.3998145265637485 earned ₡1,671 from Battle #60754

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858884227_0.035538474698961986 earned ₡4,087 from Battle #60754

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858884223_0.3998145265637485 (User 38507) vs TestRobot2_1771858884227_0.035538474698961986 (User 38508) | Winner: TestRobot1_1771858884223_0.3998145265637485 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858884374_0.34305294060837543 earned ₡1,008 from Battle #60757

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858884377_0.06757752829223629 earned ₡4,088 from Battle #60757

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858884374_0.34305294060837543 (User 38507) vs TestRobot2_1771858884377_0.06757752829223629 (User 38508) | Winner: TestRobot2_1771858884377_0.06757752829223629 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858884466_0.41941401880065476 earned ₡1,000 from Battle #60759

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858884469_0.6164645118929425 earned ₡4,087 from Battle #60759

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Streaming] TestRobot1_1771858884571_0.9206582319108751 earned ₡1,000 from Battle #60762

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858884574_0.21689052351342086 earned ₡2,609 from Battle #60762

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858884571_0.9206582319108751 (User 38507) vs TestRobot2_1771858884574_0.21689052351342086 (User 38508) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858884680_0.4150619395484886 earned ₡1,001 from Battle #60765

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858884684_0.5677860777347072 earned ₡2,001 from Battle #60765

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858884680_0.4150619395484886 (User 38507) vs TestRobot2_1771858884684_0.5677860777347072 (User 38508) | Winner: TestRobot1_1771858884680_0.4150619395484886 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858884782_0.6127311516853856 earned ₡1,001 from Battle #60767

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858884785_0.2564772736930574 earned ₡1,000 from Battle #60767

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858884782_0.6127311516853856 (User 38507) vs TestRobot2_1771858884785_0.2564772736930574 (User 38508) | Winner: TestRobot1_1771858884782_0.6127311516853856 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858884897_0.47071855819677966 earned ₡1,014 from Battle #60769

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858884900_0.43909763780791156 earned ₡1,001 from Battle #60769

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858884897_0.47071855819677966 (User 38507) vs TestRobot2_1771858884900_0.43909763780791156 (User 38508) | Winner: TestRobot2_1771858884900_0.43909763780791156 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858885004_0.4475869337313423 earned ₡2,233 from Battle #60771

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858885006_0.7816327174028374 earned ₡1,000 from Battle #60771

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858885004_0.4475869337313423 (User 38507) vs TestRobot2_1771858885006_0.7816327174028374 (User 38508) | Winner: TestRobot1_1771858885004_0.4475869337313423 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2 | Kill: TestRobot1_1771858885004_0.4475869337313423

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858885101_0.08941588802269618 earned ₡1,011 from Battle #60773

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858885105_0.07249023796590104 earned ₡1,001 from Battle #60773

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858885101_0.08941588802269618 (User 38507) vs TestRobot2_1771858885105_0.07249023796590104 (User 38508) | Winner: TestRobot2_1771858885105_0.07249023796590104 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858885205_0.2564559824695246 earned ₡6,010 from Battle #60774

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858885208_0.8240173140033156 earned ₡1,000 from Battle #60774

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858885205_0.2564559824695246 (User 38507) vs TestRobot2_1771858885208_0.8240173140033156 (User 38508) | Winner: TestRobot1_1771858885205_0.2564559824695246 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +3

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858885300_0.6861969785311147 earned ₡5,921 from Battle #60777

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858885302_0.16368526177352938 earned ₡1,000 from Battle #60777

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858885300_0.6861969785311147 (User 38507) vs TestRobot2_1771858885302_0.16368526177352938 (User 38508) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858885388_0.39171134685392994 earned ₡6,063 from Battle #60779

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858885391_0.9449241094843517 earned ₡1,000 from Battle #60779

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858885388_0.39171134685392994 (User 38507) vs TestRobot2_1771858885391_0.9449241094843517 (User 38508) | Winner: TestRobot1_1771858885388_0.39171134685392994 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +3

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858885482_0.43616065125353354 earned ₡3,890 from Battle #60780

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858885484_0.268285136837772 earned ₡1,000 from Battle #60780

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858885482_0.43616065125353354 (User 38507) vs TestRobot2_1771858885484_0.268285136837772 (User 38508) | Winner: TestRobot1_1771858885482_0.43616065125353354 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2 | Kill: TestRobot1_1771858885482_0.43616065125353354

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858885574_0.7772852685170919 earned ₡15,311 from Battle #60783

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858885577_0.027757725095200025 earned ₡1,000 from Battle #60783

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858885574_0.7772852685170919 (User 38507) vs TestRobot2_1771858885577_0.027757725095200025 (User 38508) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858885671_0.2658101017076724 earned ₡2,900 from Battle #60784

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858885675_0.37437817583124544 earned ₡1,000 from Battle #60784

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858885671_0.2658101017076724 (User 38507) vs TestRobot2_1771858885675_0.37437817583124544 (User 38508) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858885786_0.5928158871888417 earned ₡34,294 from Battle #60787

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858885790_0.9926860951549431 earned ₡1,000 from Battle #60787

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858885786_0.5928158871888417 (User 38507) vs TestRobot2_1771858885790_0.9926860951549431 (User 38508) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858885895_0.6270817095922678 earned ₡4,338 from Battle #60789

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858885897_0.9186250466422471 earned ₡1,001 from Battle #60789

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858885895_0.6270817095922678 (User 38507) vs TestRobot2_1771858885897_0.9186250466422471 (User 38508) | Winner: TestRobot2_1771858885897_0.9186250466422471 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +3

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858885988_0.7201501745584803 earned ₡29,945 from Battle #60790

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858885991_0.9184921626859041 earned ₡1,001 from Battle #60790

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858885988_0.7201501745584803 (User 38507) vs TestRobot2_1771858885991_0.9184921626859041 (User 38508) | Winner: TestRobot2_1771858885991_0.9184921626859041 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858886083_0.5158938065945594 earned ₡3,450 from Battle #60793

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858886086_0.12970037173932725 earned ₡1,001 from Battle #60793

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Streaming] TestRobot1_1771858886173_0.47345243821584493 earned ₡2,584 from Battle #60794

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858886176_0.6261762129554868 earned ₡1,001 from Battle #60794

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858886173_0.47345243821584493 (User 38507) vs TestRobot2_1771858886176_0.6261762129554868 (User 38508) | Winner: TestRobot2_1771858886176_0.6261762129554868 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2 | Kill: TestRobot2_1771858886176_0.6261762129554868

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858886275_0.2688854407740848 earned ₡3,018 from Battle #60796

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858886278_0.43825225117339284 earned ₡1,000 from Battle #60796

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858886275_0.2688854407740848 (User 38507) vs TestRobot2_1771858886278_0.43825225117339284 (User 38508) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858886362_0.38374780647703477 earned ₡3,236 from Battle #60798

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858886366_0.4056536810367052 earned ₡1,000 from Battle #60798

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858886362_0.38374780647703477 (User 38507) vs TestRobot2_1771858886366_0.4056536810367052 (User 38508) | Winner: TestRobot1_1771858886362_0.38374780647703477 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858886454_0.8014787935974518 earned ₡3,344 from Battle #60803

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858886457_0.8637170017089737 earned ₡1,000 from Battle #60803

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Streaming] TestRobot1_1771858886534_0.2321912349551366 earned ₡3,289 from Battle #60804

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858886537_0.24545279250026686 earned ₡1,001 from Battle #60804

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858886534_0.2321912349551366 (User 38507) vs TestRobot2_1771858886537_0.24545279250026686 (User 38508) | Winner: TestRobot2_1771858886537_0.24545279250026686 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2 | Kill: TestRobot2_1771858886537_0.24545279250026686

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858886626_0.9267471822723145 earned ₡3,318 from Battle #60807

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858886629_0.6966059369859575 earned ₡1,000 from Battle #60807

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Streaming] TestRobot1_1771858886710_0.5410185898832818 earned ₡3,305 from Battle #60808

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858886713_0.2686158515950007 earned ₡1,001 from Battle #60808

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858886710_0.5410185898832818 (User 38507) vs TestRobot2_1771858886713_0.2686158515950007 (User 38508) | Winner: TestRobot2_1771858886713_0.2686158515950007 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +3

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858886803_0.27707056638767114 earned ₡3,313 from Battle #60810

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858886807_0.4895543051977098 earned ₡1,000 from Battle #60810

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Streaming] TestRobot1_1771858886893_0.07249574311184837 earned ₡3,311 from Battle #60812

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858886895_0.12078300890993521 earned ₡1,000 from Battle #60812

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858886893_0.07249574311184837 (User 38507) vs TestRobot2_1771858886895_0.12078300890993521 (User 38508) | Winner: TestRobot1_1771858886893_0.07249574311184837 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858886983_0.8410551394081086 earned ₡1,283 from Battle #60814

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858886985_0.17505804713382622 earned ₡1,001 from Battle #60814

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858886983_0.8410551394081086 (User 38507) vs TestRobot2_1771858886985_0.17505804713382622 (User 38508) | Winner: TestRobot2_1771858886985_0.17505804713382622 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858887070_0.12552869696773905 earned ₡2,298 from Battle #60816

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858887072_0.0673918423642107 earned ₡1,001 from Battle #60816

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858887070_0.12552869696773905 (User 38507) vs TestRobot2_1771858887072_0.0673918423642107 (User 38508) | Winner: TestRobot2_1771858887072_0.0673918423642107 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858887166_0.9028588570618461 earned ₡2,806 from Battle #60819

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858887167_0.301559992332477 earned ₡1,000 from Battle #60819

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Streaming] TestRobot1_1771858887241_0.5487694287849767 earned ₡2,803 from Battle #60820

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858887243_0.10261867050818907 earned ₡1,000 from Battle #60820

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858887241_0.5487694287849767 (User 38507) vs TestRobot2_1771858887243_0.10261867050818907 (User 38508) | Winner: TestRobot1_1771858887241_0.5487694287849767 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858887330_0.23399928767128397 earned ₡2,551 from Battle #60823

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858887333_0.7399414955688853 earned ₡1,000 from Battle #60823

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858887330_0.23399928767128397 (User 38507) vs TestRobot2_1771858887333_0.7399414955688853 (User 38508) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858887424_0.2800028098123093 earned ₡2,678 from Battle #60824

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858887427_0.9084124822469284 earned ₡1,001 from Battle #60824

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858887424_0.2800028098123093 (User 38507) vs TestRobot2_1771858887427_0.9084124822469284 (User 38508) | Winner: TestRobot2_1771858887427_0.9084124822469284 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858887515_0.34900552989745215 earned ₡2,742 from Battle #60827

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858887517_0.9460913393601912 earned ₡1,000 from Battle #60827

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858887515_0.34900552989745215 (User 38507) vs TestRobot2_1771858887517_0.9460913393601912 (User 38508) | Winner: TestRobot1_1771858887515_0.34900552989745215 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858887611_0.7148812067393187 earned ₡2,774 from Battle #60829

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858887614_0.7070037196565494 earned ₡1,001 from Battle #60829

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858887611_0.7148812067393187 (User 38507) vs TestRobot2_1771858887614_0.7070037196565494 (User 38508) | Winner: TestRobot2_1771858887614_0.7070037196565494 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858887700_0.8316506990476105 earned ₡2,790 from Battle #60832

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858887703_0.5880016975636649 earned ₡1,001 from Battle #60832

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858887700_0.8316506990476105 (User 38507) vs TestRobot2_1771858887703_0.5880016975636649 (User 38508) | Winner: TestRobot2_1771858887703_0.5880016975636649 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858887785_0.4124017691253665 earned ₡2,797 from Battle #60834

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858887787_0.15163250288196106 earned ₡1,001 from Battle #60834

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858887785_0.4124017691253665 (User 38507) vs TestRobot2_1771858887787_0.15163250288196106 (User 38508) | Winner: TestRobot2_1771858887787_0.15163250288196106 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858887877_0.20688885905033338 earned ₡2,801 from Battle #60837

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858887880_0.6195960670375037 earned ₡1,001 from Battle #60837

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Streaming] TestRobot1_1771858887950_0.46147100483933035 earned ₡2,800 from Battle #60838

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858887953_0.4649435499303316 earned ₡1,000 from Battle #60838

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858887950_0.46147100483933035 (User 38507) vs TestRobot2_1771858887953_0.4649435499303316 (User 38508) | Winner: TestRobot1_1771858887950_0.46147100483933035 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858888040_0.8672558851819582 earned ₡2,800 from Battle #60840

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858888043_0.7987115567350762 earned ₡1,000 from Battle #60840

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858888040_0.8672558851819582 (User 38507) vs TestRobot2_1771858888043_0.7987115567350762 (User 38508) | Winner: TestRobot1_1771858888040_0.8672558851819582 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +3

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858888130_0.15903917268989232 earned ₡2,801 from Battle #60845

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858888135_0.8010970915963157 earned ₡1,000 from Battle #60845

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858888130_0.15903917268989232 (User 38507) vs TestRobot2_1771858888135_0.8010970915963157 (User 38508) | Winner: TestRobot1_1771858888130_0.15903917268989232 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858888273_0.39888072056671353 earned ₡2,802 from Battle #60849

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858888278_0.6014599066682466 earned ₡1,000 from Battle #60849

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858888273_0.39888072056671353 (User 38507) vs TestRobot2_1771858888278_0.6014599066682466 (User 38508) | Winner: TestRobot1_1771858888273_0.39888072056671353 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858888403_0.8541941132663584 earned ₡2,002 from Battle #60853

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858888410_0.03622984979192323 earned ₡1,000 from Battle #60853

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: silver | TestRobot1_1771858888403_0.8541941132663584 (User 38507) vs TestRobot2_1771858888410_0.03622984979192323 (User 38508) | Winner: TestRobot1_1771858888403_0.8541941132663584 | Rewards: ₡18,000 / ₡3,000 | Prestige: +10 | Fame: +5

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858888491_0.4201576123434091 earned ₡1,002 from Battle #60855

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858888496_0.8683437529301109 earned ₡1,000 from Battle #60855

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: silver | TestRobot1_1771858888491_0.4201576123434091 (User 38507) vs TestRobot2_1771858888496_0.8683437529301109 (User 38508) | Winner: TestRobot1_1771858888491_0.4201576123434091 | Rewards: ₡18,000 / ₡3,000 | Prestige: +10 | Fame: +8

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858888576_0.6210473497951602 earned ₡1,001 from Battle #60857

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858888581_0.6406100661080436 earned ₡1,000 from Battle #60857

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858888576_0.6210473497951602 (User 38507) vs TestRobot2_1771858888581_0.6406100661080436 (User 38508) | Winner: TestRobot1_1771858888576_0.6210473497951602 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858888671_0.935815319053835 earned ₡2,999 from Battle #60860

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858888674_0.5151346426241084 earned ₡1,000 from Battle #60860

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858888671_0.935815319053835 (User 38507) vs TestRobot2_1771858888674_0.5151346426241084 (User 38508) | Winner: TestRobot1_1771858888671_0.935815319053835 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] TestRobot1_1771858888764_0.9864447657510275 earned ₡1,002 from Battle #60861

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestRobot2_1771858888766_0.8940781324448689 earned ₡1,000 from Battle #60861

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | TestRobot1_1771858888764_0.9864447657510275 (User 38507) vs TestRobot2_1771858888766_0.8940781324448689 (User 38508) | Winner: TestRobot1_1771858888764_0.9864447657510275 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +3

      at processBattle (src/services/battleOrchestrator.ts:821:11)

  ● Property 5: Stats Updated Before Streaming Revenue Calculation › Property 5: Stats updated before streaming revenue calculation

    Property failed after 1 tests
    { seed: -1324507898, path: "0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0,0,0,0,"bronze"]
    Shrunk 5 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).not.toBeNull()

    Received: null

      267 |           });
      268 |
    > 269 |           expect(battleCompleteEvent).not.toBeNull();
          |                                           ^
      270 |           const payload = battleCompleteEvent!.payload as any;
      271 |
      272 |           // Get updated robot stats from database

      at tests/statsUpdatedBeforeStreamingRevenue.property.test.ts:269:43
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/statsUpdatedBeforeStreamingRevenue.property.test.ts:189:5)

  ● Property 5: Stats Updated Before Streaming Revenue Calculation › Property 5.1: Battle count increments by exactly 1 per battle

    Property failed after 13 tests
    { seed: 1996253306, path: "12:3:1:1:3:7", endOnFailure: true }
    Counterexample: [282,5919]
    Shrunk 5 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at processBattle (src/services/battleOrchestrator.ts:722:3)
      at tests/statsUpdatedBeforeStreamingRevenue.property.test.ts:408:11
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/statsUpdatedBeforeStreamingRevenue.property.test.ts:385:5)

  ● Property 5: Stats Updated Before Streaming Revenue Calculation › Property 5.2: Winner fame increases after battle

    Property failed after 1 tests
    { seed: 1494241162, path: "0:0:0", endOnFailure: true }
    Counterexample: [0,"bronze"]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    TypeError: Cannot read properties of null (reading 'payload')

      485 |           });
      486 |
    > 487 |           const payload = battleCompleteEvent!.payload as any;
          |                                                ^
      488 |
      489 |           // Get updated robot stats
      490 |           const updatedRobot1 = await prisma.robot.findUnique({

      at tests/statsUpdatedBeforeStreamingRevenue.property.test.ts:487:48
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/statsUpdatedBeforeStreamingRevenue.property.test.ts:438:5)

  ● Property 5: Stats Updated Before Streaming Revenue Calculation › Property 5.3: Stats are always updated before streaming revenue calculation

    Property failed after 1 tests
    { seed: 1925643995, path: "0:0", endOnFailure: true }
    Counterexample: [0,0]
    Shrunk 1 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    TypeError: Cannot read properties of null (reading 'payload')

      561 |           });
      562 |
    > 563 |           const payload = battleCompleteEvent!.payload as any;
          |                                                ^
      564 |
      565 |           // Property: The battle count used in streaming revenue should be 
      566 |           // the initial count + 1 (proving stats were updated first)

      at tests/statsUpdatedBeforeStreamingRevenue.property.test.ts:563:48
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/statsUpdatedBeforeStreamingRevenue.property.test.ts:526:5)

FAIL tests/tagTeamLeagueRebalancing.test.ts
  ● Console

    console.log
      ════════════════════════════════════════════════════════════

      at rebalanceTagTeamLeagues (src/services/tagTeamLeagueRebalancingService.ts:374:11)

    console.log
      [TagTeamRebalancing] Starting tag team league rebalancing...

      at rebalanceTagTeamLeagues (src/services/tagTeamLeagueRebalancingService.ts:375:11)

    console.log
      ════════════════════════════════════════════════════════════

      at rebalanceTagTeamLeagues (src/services/tagTeamLeagueRebalancingService.ts:376:11)

    console.log
      [TagTeamRebalancing] Total teams in system: 0

      at rebalanceTagTeamLeagues (src/services/tagTeamLeagueRebalancingService.ts:389:11)

    console.log
      
      [TagTeamRebalancing] Processing BRONZE league...

      at rebalanceTier (src/services/tagTeamLeagueRebalancingService.ts:282:11)

    console.log
      [TagTeamRebalancing] bronze: 0 total teams across 0 instances

      at rebalanceTier (src/services/tagTeamLeagueRebalancingService.ts:308:11)

    console.log
      [TagTeamRebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at rebalanceTier (src/services/tagTeamLeagueRebalancingService.ts:362:11)

    console.log
      
      [TagTeamRebalancing] Processing SILVER league...

      at rebalanceTier (src/services/tagTeamLeagueRebalancingService.ts:282:11)

    console.log
      [TagTeamRebalancing] silver: 0 total teams across 0 instances

      at rebalanceTier (src/services/tagTeamLeagueRebalancingService.ts:308:11)

    console.log
      [TagTeamRebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at rebalanceTier (src/services/tagTeamLeagueRebalancingService.ts:362:11)

    console.log
      
      [TagTeamRebalancing] Processing GOLD league...

      at rebalanceTier (src/services/tagTeamLeagueRebalancingService.ts:282:11)

    console.log
      [TagTeamRebalancing] gold: 0 total teams across 0 instances

      at rebalanceTier (src/services/tagTeamLeagueRebalancingService.ts:308:11)

    console.log
      [TagTeamRebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at rebalanceTier (src/services/tagTeamLeagueRebalancingService.ts:362:11)

    console.log
      
      [TagTeamRebalancing] Processing PLATINUM league...

      at rebalanceTier (src/services/tagTeamLeagueRebalancingService.ts:282:11)

    console.log
      [TagTeamRebalancing] platinum: 0 total teams across 0 instances

      at rebalanceTier (src/services/tagTeamLeagueRebalancingService.ts:308:11)

    console.log
      [TagTeamRebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at rebalanceTier (src/services/tagTeamLeagueRebalancingService.ts:362:11)

    console.log
      
      [TagTeamRebalancing] Processing DIAMOND league...

      at rebalanceTier (src/services/tagTeamLeagueRebalancingService.ts:282:11)

    console.log
      [TagTeamRebalancing] diamond: 0 total teams across 0 instances

      at rebalanceTier (src/services/tagTeamLeagueRebalancingService.ts:308:11)

    console.log
      [TagTeamRebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at rebalanceTier (src/services/tagTeamLeagueRebalancingService.ts:362:11)

    console.log
      
      [TagTeamRebalancing] Processing CHAMPION league...

      at rebalanceTier (src/services/tagTeamLeagueRebalancingService.ts:282:11)

    console.log
      [TagTeamRebalancing] champion: 0 total teams across 0 instances

      at rebalanceTier (src/services/tagTeamLeagueRebalancingService.ts:308:11)

    console.log
      [TagTeamRebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at rebalanceTier (src/services/tagTeamLeagueRebalancingService.ts:362:11)

    console.log
      
      ════════════════════════════════════════════════════════════

      at rebalanceTagTeamLeagues (src/services/tagTeamLeagueRebalancingService.ts:408:11)

    console.log
      [TagTeamRebalancing] Tag team league rebalancing complete!

      at rebalanceTagTeamLeagues (src/services/tagTeamLeagueRebalancingService.ts:409:11)

    console.log
        Total promoted: 0

      at rebalanceTagTeamLeagues (src/services/tagTeamLeagueRebalancingService.ts:410:11)

    console.log
        Total demoted: 0

      at rebalanceTagTeamLeagues (src/services/tagTeamLeagueRebalancingService.ts:411:11)

    console.log
        Errors: 0

      at rebalanceTagTeamLeagues (src/services/tagTeamLeagueRebalancingService.ts:412:11)

    console.log
      ════════════════════════════════════════════════════════════

      at rebalanceTagTeamLeagues (src/services/tagTeamLeagueRebalancingService.ts:413:11)

    console.log
      [TagTeamRebalancing] Rebalancing instances across all tiers...

      at rebalanceTagTeamLeagues (src/services/tagTeamLeagueRebalancingService.ts:416:11)

    console.log
      [TagTeamLeagueInstance] bronze instances balanced, no action needed

      at rebalanceTagTeamInstances (src/services/tagTeamLeagueInstanceService.ts:252:13)

    console.log
      [TagTeamLeagueInstance] silver instances balanced, no action needed

      at rebalanceTagTeamInstances (src/services/tagTeamLeagueInstanceService.ts:252:13)

    console.log
      [TagTeamLeagueInstance] gold instances balanced, no action needed

      at rebalanceTagTeamInstances (src/services/tagTeamLeagueInstanceService.ts:252:13)

    console.log
      [TagTeamLeagueInstance] platinum instances balanced, no action needed

      at rebalanceTagTeamInstances (src/services/tagTeamLeagueInstanceService.ts:252:13)

    console.log
      [TagTeamLeagueInstance] diamond instances balanced, no action needed

      at rebalanceTagTeamInstances (src/services/tagTeamLeagueInstanceService.ts:252:13)

    console.log
      [TagTeamLeagueInstance] champion instances balanced, no action needed

      at rebalanceTagTeamInstances (src/services/tagTeamLeagueInstanceService.ts:252:13)

  ● Tag Team League Rebalancing › determinePromotions › should return empty array when fewer than 10 teams

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:137:9)

  ● Tag Team League Rebalancing › determinePromotions › should return empty array when no teams have 5+ cycles

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:152:9)

  ● Tag Team League Rebalancing › determinePromotions › should promote top 10% of eligible teams with ≥25 league points

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:167:9)

  ● Tag Team League Rebalancing › determinePromotions › should return empty array when no teams have ≥25 league points

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:191:9)

  ● Tag Team League Rebalancing › determinePromotions › should exclude teams in excludeTeamIds set

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:207:22)

  ● Tag Team League Rebalancing › determineDemotions › should return empty array when fewer than 10 teams

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:237:9)

  ● Tag Team League Rebalancing › determineDemotions › should return empty array when no teams have 5+ cycles

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:252:9)

  ● Tag Team League Rebalancing › determineDemotions › should demote bottom 10% of eligible teams

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:267:9)

  ● Tag Team League Rebalancing › determineDemotions › should exclude teams in excludeTeamIds set

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:289:22)

  ● Tag Team League Rebalancing › promoteTeam › should promote team from bronze to silver

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:305:20)

  ● Tag Team League Rebalancing › promoteTeam › should promote team from silver to gold

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:320:20)

  ● Tag Team League Rebalancing › promoteTeam › should throw error when promoting from champion tier

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:334:20)

  ● Tag Team League Rebalancing › demoteTeam › should demote team from silver to bronze

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:344:20)

  ● Tag Team League Rebalancing › demoteTeam › should demote team from gold to silver

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:359:20)

  ● Tag Team League Rebalancing › demoteTeam › should throw error when demoting from bronze tier

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:373:20)

  ● Tag Team League Rebalancing › rebalanceTagTeamLeagues › should promote and demote teams across multiple tiers

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:399:9)

  ● Tag Team League Rebalancing › rebalanceTagTeamLeagues › should skip tiers with insufficient teams

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:427:9)

  ● Tag Team League Rebalancing › rebalanceTagTeamLeagues › should skip teams without 5+ cycles

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:443:9)

  ● Tag Team League Rebalancing › Edge Cases › should handle exactly 10 teams (minimum for rebalancing)

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:464:9)

  ● Tag Team League Rebalancing › Edge Cases › should handle 11 teams (10% rounds down to 1)

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:479:9)

  ● Tag Team League Rebalancing › Edge Cases › should handle teams with same league points (tiebreaker)

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:493:9)

FAIL tests/cycleStepDuration.property.test.ts (6.818 s)
  ● Property 15: Cycle Step Duration Recording › Property 15.1: Each cycle step has a step completion event with duration

    Property failed after 1 tests
    { seed: -1194949916, path: "0:0:1:0:0:4:2:5:6:2:2:3:4:11:2:3:3", endOnFailure: true }
    Counterexample: [1,3,[2337,4982]]
    Shrunk 16 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 2337
    Received: 472

      93 |           for (let i = 0; i < numberOfSteps; i++) {
      94 |             const payload = stepEvents[i].payload as any;
    > 95 |             expect(payload.duration).toBe(stepDurations[i]);
         |                                      ^
      96 |           }
      97 |         }
      98 |       ),

      at tests/cycleStepDuration.property.test.ts:95:38
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/cycleStepDuration.property.test.ts:43:5)

  ● Property 15: Cycle Step Duration Recording › Property 15.2: Sum of step durations approximately equals total cycle duration (within 5% tolerance)

    Property failed after 2 tests
    { seed: 1836175004, path: "1:0:2:0:2:1:0:1:1:4:1:1:2:1:2:1:5:2:1:1:0:2:2:0:0:0:1:0:2:1:1:1", endOnFailure: true }
    Counterexample: [1,[100,100,839],3]
    Shrunk 31 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 1039
    Received: 839

      157 |
      158 |           // Property: Sum of steps equals what we logged
    > 159 |           expect(recordedSumOfSteps).toBe(sumOfSteps);
          |                                      ^
      160 |
      161 |           // Property: Total duration equals sum of steps + overhead
      162 |           expect(recordedTotalDuration).toBe(totalDuration);

      at tests/cycleStepDuration.property.test.ts:159:38
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/cycleStepDuration.property.test.ts:107:5)

  ● Property 15: Cycle Step Duration Recording › Property 15.3: Step durations are recorded in sequence order

    Property failed after 1 tests
    { seed: -505901614, path: "0:0:0:1:1:2:3:1:7:1:1:0:0:2:0:1:1:0:0:0:0", endOnFailure: true }
    Counterexample: [1,[295,50,96,155,50]]
    Shrunk 20 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 3

      215 |           for (let i = 0; i < stepEvents.length; i++) {
      216 |             const payload = stepEvents[i].payload as any;
    > 217 |             expect(payload.stepNumber).toBe(i + 1);
          |                                        ^
      218 |           }
      219 |         }
      220 |       ),

      at tests/cycleStepDuration.property.test.ts:217:40
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/cycleStepDuration.property.test.ts:177:5)

  ● Property 15: Cycle Step Duration Recording › Property 15.5: Step completion events include step name and number

    Property failed after 2 tests
    { seed: -342129570, path: "1:3:0:0:0:0:0:0:1:0:0:2:1:1:1:3:1:4:1:0:3:1:0:8:1:6:10:0:0:2:3:6:3:1:4:1:14:6:5:6:8:4:4:4:2:4:0:7:9:4:4:1:3:11:1:1:1:6:3:0:4:1:6:1:6:5:0:1:1", endOnFailure: true }
    Counterexample: [1,[{__proto__:null,"name":"  J {","duration":1742},{__proto__:null,"name":"D/ n7","duration":1005},{__proto__:null,"name":"/ E',","duration":2532}]]
    Shrunk 68 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: "  J {"
    Received: "/ E',"

      310 |           for (let i = 0; i < steps.length; i++) {
      311 |             const payload = stepEvents[i].payload as any;
    > 312 |             expect(payload.stepName).toBe(steps[i].name as string);
          |                                      ^
      313 |             expect(payload.stepNumber).toBe(i + 1);
      314 |             expect(payload.duration).toBe(steps[i].duration as number);
      315 |           }

      at tests/cycleStepDuration.property.test.ts:312:38
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/cycleStepDuration.property.test.ts:273:5)

  ● Property 15: Cycle Step Duration Recording › Property 15.6: Multiple cycles can be logged independently with correct durations

    Property failed after 1 tests
    { seed: -610533521, path: "0:0:0:0:0:0:0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [[{"cycleNumber":1,"stepDurations":[100,100,100]},{"cycleNumber":1,"stepDurations":[100,100,100]}]]
    Shrunk 11 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toHaveLength(expected)

    Expected length: 3
    Received length: 1
    Received array:  [{"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:29.121Z, "eventType": "cycle_step_complete", "id": 2113140n, "metadata": null, "payload": {"duration": 100, "stepName": "step_3", "stepNumber": 3, "summary": {}}, "robotId": null, "sequenceNumber": 4, "userId": null}]

      378 |
      379 |             // Property: Correct number of steps per cycle
    > 380 |             expect(stepEvents).toHaveLength(cycle.stepDurations.length);
          |                                ^
      381 |
      382 |             // Property: Durations match for each cycle
      383 |             for (let i = 0; i < cycle.stepDurations.length; i++) {

      at tests/cycleStepDuration.property.test.ts:380:32
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/cycleStepDuration.property.test.ts:326:5)

FAIL tests/facilityRecommendation.property.test.ts (12.317 s)
  ● Property 22: Investment Recommendation Ranking › Property 22.2: Only facilities with positive projected ROI are recommended

    Property failed after 1 tests
    { seed: -152303241, path: "0:0:0:0", endOnFailure: true }
    Counterexample: [5,500000,2000]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

      177 |           // Property: All recommendations should have positive ROI
      178 |           for (const recommendation of result.recommendations) {
    > 179 |             expect(recommendation.projectedROI).toBeGreaterThan(0);
          |                                                 ^
      180 |           }
      181 |         }
      182 |       ),

      at tests/facilityRecommendation.property.test.ts:179:49
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/facilityRecommendation.property.test.ts:129:5)

  ● Property 22: Investment Recommendation Ranking › Property 22.4: High activity users get more discount facility recommendations

    Property failed after 1 tests
    { seed: -1282724766, path: "0:0:0:0", endOnFailure: true }
    Counterexample: [50000,30000,20]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

      307 |           // Discount facilities should have positive ROI
      308 |           for (const facility of discountFacilities) {
    > 309 |             expect(facility.projectedROI).toBeGreaterThan(0);
          |                                           ^
      310 |           }
      311 |         }
      312 |       ),

      at tests/facilityRecommendation.property.test.ts:309:43
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/facilityRecommendation.property.test.ts:235:5)

  ● Property 22: Investment Recommendation Ranking › Property 22.5: Recommendations include upgrade cost and payoff cycles

    Property failed after 1 tests
    { seed: 1869750377, path: "0:0:0", endOnFailure: true }
    Counterexample: [10,2000000]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBeTruthy()

    Received: ""

      371 |             
      372 |             // Should have a reason
    > 373 |             expect(recommendation.reason).toBeTruthy();
          |                                           ^
      374 |             expect(recommendation.reason.length).toBeGreaterThan(0);
      375 |             
      376 |             // Should have a priority

      at tests/facilityRecommendation.property.test.ts:373:43
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/facilityRecommendation.property.test.ts:318:5)

FAIL tests/roiCalculatorService.test.ts
  ● ROICalculatorService › calculateFacilityROI › should calculate ROI for income generator facility

    expect(received).not.toBeNull()

    Received: null

      117 |       );
      118 |
    > 119 |       expect(roi).not.toBeNull();
          |                       ^
      120 |       expect(roi!.facilityType).toBe('merchandising_hub');
      121 |       expect(roi!.currentLevel).toBe(1);
      122 |       expect(roi!.totalInvestment).toBe(150000); // Level 1 cost

      at Object.<anonymous> (tests/roiCalculatorService.test.ts:119:23)

  ● ROICalculatorService › calculateFacilityROI › should calculate ROI for repair bay facility with discounts

    expect(received).not.toBeNull()

    Received: null

      199 |       );
      200 |
    > 201 |       expect(roi).not.toBeNull();
          |                       ^
      202 |       expect(roi!.facilityType).toBe('repair_bay');
      203 |       expect(roi!.currentLevel).toBe(2);
      204 |       expect(roi!.totalInvestment).toBe(300000);

      at Object.<anonymous> (tests/roiCalculatorService.test.ts:201:23)

  ● ROICalculatorService › calculateFacilityROI › should calculate ROI for training facility with discounts

    expect(received).not.toBeNull()

    Received: null

      272 |       );
      273 |
    > 274 |       expect(roi).not.toBeNull();
          |                       ^
      275 |       expect(roi!.facilityType).toBe('training_facility');
      276 |       expect(roi!.currentLevel).toBe(1);
      277 |       expect(roi!.totalInvestment).toBe(150000);

      at Object.<anonymous> (tests/roiCalculatorService.test.ts:274:23)

  ● ROICalculatorService › calculateFacilityROI › should calculate breakeven cycle when facility becomes profitable

    expect(received).not.toBeNull()

    Received: null

      338 |       );
      339 |
    > 340 |       expect(roi).not.toBeNull();
          |                       ^
      341 |       expect(roi!.totalInvestment).toBe(900000); // 150k + 300k + 450k
      342 |       expect(roi!.totalReturns).toBe(1500000); // (12000 + 3000) * 100 cycles
      343 |       expect(roi!.totalOperatingCosts).toBe(800000); // 8000 * 100 cycles

      at Object.<anonymous> (tests/roiCalculatorService.test.ts:340:23)

  ● ROICalculatorService › calculateAllFacilityROIs › should calculate ROI for all purchased facilities

    expect(received).toHaveLength(expected)

    Expected length: 3
    Received length: 1
    Received array:  [{"breakevenCycle": null, "currentLevel": 1, "cyclesSincePurchase": 1, "facilityType": "merchandising_hub", "isProfitable": false, "netROI": -1, "totalInvestment": 150000, "totalOperatingCosts": 0, "totalReturns": 0}]

      392 |       const rois = await roiCalculatorService.calculateAllFacilityROIs(testUserId);
      393 |
    > 394 |       expect(rois).toHaveLength(3); // Only purchased facilities (level > 0)
          |                    ^
      395 |       expect(rois.map(r => r.facilityType).sort()).toEqual([
      396 |         'merchandising_hub',
      397 |         'repair_bay',

      at Object.<anonymous> (tests/roiCalculatorService.test.ts:394:20)

FAIL tests/facilityAdvisorStreamingStudioROI.property.test.ts
  ● Property 21: Facility Advisor Provides Streaming Studio ROI › Property 21: Facility Advisor provides Streaming Studio ROI metrics

    Property failed after 1 tests
    { seed: -1691627479, path: "0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,1,0,0,5]
    Shrunk 5 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toContain(expected) // indexOf

    Expected substring: "operating cost"
    Received string:    "Increases streaming revenue by 10% per battle (no battle history to estimate ROI)"

      310 |
      311 |                 // Property 17.5: Reason should mention operating cost
    > 312 |                 expect(studioRec.reason).toContain('operating cost');
          |                                          ^
      313 |
      314 |                 // Property 17.6: Should calculate payback period (battles needed)
      315 |                 // The payback period should be based on net benefit

      at tests/facilityAdvisorStreamingStudioROI.property.test.ts:312:42
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/facilityAdvisorStreamingStudioROI.property.test.ts:196:5)

  ● Property 21: Facility Advisor Provides Streaming Studio ROI › Property 21.2: Revenue increase per battle is calculated correctly

    Property failed after 1 tests
    { seed: 1208635561, path: "0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,100,1000,10]
    Shrunk 4 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBeCloseTo(expected, precision)

    Expected: 2.93
    Received: 0.2

    Expected precision:    5
    Expected difference: < 0.000005
    Received difference:   2.73

      492 |             // Property: ROI should be calculated correctly
      493 |             const expectedROI = (expectedNetBenefitPerCycle * 30 - studioRec.upgradeCost) / studioRec.upgradeCost;
    > 494 |             expect(studioRec.projectedROI).toBeCloseTo(expectedROI, 5);
          |                                            ^
      495 |           }
      496 |         }
      497 |       ),

      at tests/facilityAdvisorStreamingStudioROI.property.test.ts:494:44
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/facilityAdvisorStreamingStudioROI.property.test.ts:423:5)

  ● Property 21: Facility Advisor Provides Streaming Studio ROI › Property 21.4: Operating cost increase reduces net benefit

    Property failed after 1 tests
    { seed: 821040174, path: "0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,100,1000,5]
    Shrunk 4 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toContain(expected) // indexOf

    Expected substring: "operating cost"
    Received string:    "Increases streaming revenue by 10% per battle (no battle history to estimate ROI)"

      596 |
      597 |             // Property: Reason should mention operating cost
    > 598 |             expect(studioRec.reason).toContain('operating cost');
          |                                      ^
      599 |             expect(studioRec.reason).toContain(`₡${operatingCostIncrease}`);
      600 |
      601 |             // Property: Operating cost should reduce the net benefit

      at tests/facilityAdvisorStreamingStudioROI.property.test.ts:598:38
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/facilityAdvisorStreamingStudioROI.property.test.ts:549:5)

PASS tests/tagTeamLeagueInstanceService.test.ts
  ● Console

    console.log
      [TagTeamLeagueInstance] platinum instances balanced, no action needed

      at rebalanceTagTeamInstances (src/services/tagTeamLeagueInstanceService.ts:252:13)

    console.log
      [TagTeamLeagueInstance] champion instances balanced, no action needed

      at rebalanceTagTeamInstances (src/services/tagTeamLeagueInstanceService.ts:252:13)

FAIL tests/streamingStudioPrestigeRequirements.property.test.ts (10.188 s)
  ● Console

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 9 | Cost: ₡900,000 | Balance: ₡6,400,000 → ₡5,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 9 | Cost: ₡900,000 | Balance: ₡6,400,000 → ₡5,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 9 | Cost: ₡900,000 | Balance: ₡6,400,000 → ₡5,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 10 | Cost: ₡1,000,000 | Balance: ₡5,500,000 → ₡4,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,499,600 → ₡7,899,600

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 9 | Cost: ₡900,000 | Balance: ₡6,400,000 → ₡5,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 9 | Cost: ₡900,000 | Balance: ₡6,400,000 → ₡5,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38480 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡9,999,900 → ₡9,899,900

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,899,900 → ₡9,699,900

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,699,900 → ₡9,399,900

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38512 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 9 | Cost: ₡900,000 | Balance: ₡6,400,000 → ₡5,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡8,999,700 → ₡8,499,700

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,499,700 → ₡7,899,700

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,899,700 → ₡7,199,700

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,199,700 → ₡6,399,700

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 9 | Cost: ₡900,000 | Balance: ₡6,399,700 → ₡5,499,700

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 10 | Cost: ₡1,000,000 | Balance: ₡5,499,700 → ₡4,499,700

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 9 | Cost: ₡900,000 | Balance: ₡6,400,000 → ₡5,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 10 | Cost: ₡1,000,000 | Balance: ₡5,500,000 → ₡4,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 9 | Cost: ₡900,000 | Balance: ₡6,400,000 → ₡5,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 9 | Cost: ₡900,000 | Balance: ₡6,400,000 → ₡5,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 10 | Cost: ₡1,000,000 | Balance: ₡5,500,000 → ₡4,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 9 | Cost: ₡900,000 | Balance: ₡6,400,000 → ₡5,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 10 | Cost: ₡1,000,000 | Balance: ₡5,500,000 → ₡4,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 9 | Cost: ₡900,000 | Balance: ₡6,400,000 → ₡5,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38519 | Upgraded: Streaming Studio | Level: 10 | Cost: ₡1,000,000 | Balance: ₡5,500,000 → ₡4,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,399,800 → ₡8,999,800

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡8,999,800 → ₡8,499,800

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,499,800 → ₡7,899,800

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 9 | Cost: ₡900,000 | Balance: ₡6,400,000 → ₡5,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 9 | Cost: ₡900,000 | Balance: ₡6,400,000 → ₡5,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 9 | Cost: ₡900,000 | Balance: ₡6,400,000 → ₡5,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 9 | Cost: ₡900,000 | Balance: ₡6,400,000 → ₡5,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 9 | Cost: ₡900,000 | Balance: ₡6,400,000 → ₡5,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.error
      Failed to log facility transaction event: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logFacilityTransaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:325:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:198:7 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      212 |       console.log(`[Facility] User ${userId} | ${action}: ${config.name} | Level: ${targetLevel} | Cost: ₡${upgradeCost.toLocaleString()} | Balance: ₡${user.currency.toLocaleString()} → ₡${result.user.currency.toLocaleString()}`);
      213 |     } catch (logError) {
    > 214 |       console.error('Failed to log facility transaction event:', logError);
          |               ^
      215 |       // Don't fail the request if logging fails
      216 |     }
      217 |

      at src/routes/facility.ts:214:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38554 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 9 | Cost: ₡900,000 | Balance: ₡6,400,000 → ₡5,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38606 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

  ● Property 9: Streaming Studio Prestige Requirements › Property 9.5: Prestige validation occurs regardless of currency

    Property failed after 5 tests
    { seed: 698438025, path: "4:0", endOnFailure: true }
    Counterexample: [4,0]
    Shrunk 1 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.user.update()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingStudioPrestigeRequirements.property.test.ts:415:29

      412 const maxPrestigeNeeded = Math.max(
      413   ...PRESTIGE_REQUIREMENTS.slice(0, targetLevel - 1)
      414 );
    → 415 await prisma.user.update(
    An operation failed because it depends on one or more records that were required but not found. Record to update not found.

      413 |             ...PRESTIGE_REQUIREMENTS.slice(0, targetLevel - 1)
      414 |           );
    > 415 |           await prisma.user.update({
          |           ^
      416 |             where: { id: testUser.id },
      417 |             data: { prestige: maxPrestigeNeeded, currency: 10000000 },
      418 |           });

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at tests/streamingStudioPrestigeRequirements.property.test.ts:415:11
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingStudioPrestigeRequirements.property.test.ts:396:5)

FAIL tests/terminalLogStreamingRevenue.property.test.ts (13.652 s)
  ● Console

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:20.209Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858880192_0.09258731745866144 earned ₡12,013 from Battle #60687

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858880192_0.09235203722576901 earned ₡21,499 from Battle #60687

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40536: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:722:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:280:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:199:5) {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:280:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:199:5)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 1 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:20.449Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 3 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858880192_0.09258731745866144 earned ₡12,015 from Battle #60690

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858880192_0.09235203722576901 earned ₡21,517 from Battle #60690

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858880192_0.09258731745866144 (User 38460) vs TestRobot2_1771858880192_0.09235203722576901 (User 38461) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40537: PrismaClientKnownRequestError: 
      Invalid `prisma.battle.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:397:38
      
        394 }
        395 
        396 // Create battle record
      → 397 const battle = await prisma.battle.create(
      Foreign key constraint violated: `battles_robot1_id_fkey (index)`
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at createBattleRecord (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:397:18)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:641:18)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:280:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:199:5) {
        code: 'P2003',
        clientVersion: '5.22.0',
        meta: { modelName: 'Battle', field_name: 'battles_robot1_id_fkey (index)' }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:280:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:199:5)

    console.log
      [Streaming] TestRobot1_1771858880440_0.602182634730807 earned ₡2,007 from Battle #60693

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858880440_0.9193466933876333 earned ₡21,509 from Battle #60693

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858880440_0.602182634730807 (User 38460) vs TestRobot2_1771858880440_0.9193466933876333 (User 38461) | Winner: TestRobot1_1771858880440_0.602182634730807 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 1 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:20.682Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858880550_0.7331328909169752 earned ₡11,980 from Battle #60696

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858880552_0.23911333252508837 earned ₡14,826 from Battle #60696

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40539: PrismaClientKnownRequestError: 
      Invalid `prisma.battleParticipant.update()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:672:34
      
        669 }
        670 
        671 // Update BattleParticipant records with prestige, fame, and streaming revenue
      → 672 await prisma.battleParticipant.update(
      An operation failed because it depends on one or more records that were required but not found. Record to update not found.
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:672:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:280:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:199:5) {
        code: 'P2025',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'BattleParticipant',
          cause: 'Record to update not found.'
        }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:280:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:199:5)

    console.log
      [Streaming] TestRobot1_1771858880672_0.2395032711865187 earned ₡2,001 from Battle #60698

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858880672_0.2880802867574742 earned ₡21,506 from Battle #60698

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858880672_0.2395032711865187 (User 38460) vs TestRobot2_1771858880672_0.2880802867574742 (User 38461) | Winner: TestRobot2_1771858880672_0.2880802867574742 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 1 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:20.885Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858880756_0.48329929983168907 earned ₡1,894 from Battle #60700

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858880760_0.129578070217363 earned ₡2,391 from Battle #60700

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858880756_0.48329929983168907 (User 38462) vs TestRobot2_1771858880760_0.129578070217363 (User 38463) | Winner: TestRobot1_1771858880756_0.48329929983168907 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +3

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858880874_0.7969556892285852 earned ₡2,001 from Battle #60702

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858880874_0.9050349615869661 earned ₡11,396 from Battle #60702

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858880874_0.7969556892285852 (User 38460) vs TestRobot2_1771858880874_0.9050349615869661 (User 38461) | Winner: TestRobot2_1771858880874_0.9050349615869661 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 10 prestige, 5 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:21.053Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858880991_0.3815794846376095 earned ₡16,567 from Battle #60704

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858880993_0.12574180703754545 earned ₡17,887 from Battle #60704

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858880991_0.3815794846376095 (User 38462) vs TestRobot2_1771858880993_0.12574180703754545 (User 38463) | Winner: TestRobot2_1771858880993_0.12574180703754545 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858881044_0.17627262520634135 earned ₡2,001 from Battle #60707

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858881044_0.7459075297126387 earned ₡9,012 from Battle #60707

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858881044_0.17627262520634135 (User 38460) vs TestRobot2_1771858881044_0.7459075297126387 (User 38461) | Winner: TestRobot2_1771858881044_0.7459075297126387 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 10 prestige, 4 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:21.245Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858881185_0.9029383247340351 earned ₡2,995 from Battle #60710

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858881188_0.9960772427675278 earned ₡5,528 from Battle #60710

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858881185_0.9029383247340351 (User 38462) vs TestRobot2_1771858881188_0.9960772427675278 (User 38463) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858881237_0.35725691522718384 earned ₡2,001 from Battle #60712

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858881237_0.8472287016253194 earned ₡9,012 from Battle #60712

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858881237_0.35725691522718384 (User 38460) vs TestRobot2_1771858881237_0.8472287016253194 (User 38461) | Winner: TestRobot2_1771858881237_0.8472287016253194 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:21.421Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858881372_0.8780283056361814 earned ₡15,820 from Battle #60714

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858881376_0.3052811274414826 earned ₡16,517 from Battle #60714

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40547: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:722:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:280:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:199:5) {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:280:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:199:5)

    console.log
      [Streaming] TestRobot1_1771858881417_0.30891069640449564 earned ₡2,001 from Battle #60716

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858881417_0.2711970052672589 earned ₡9,012 from Battle #60716

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858881417_0.30891069640449564 (User 38460) vs TestRobot2_1771858881417_0.2711970052672589 (User 38461) | Winner: TestRobot2_1771858881417_0.2711970052672589 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 1 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:21.630Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858881580_0.4143941780078221 earned ₡4,487 from Battle #60719

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858881583_0.007280012205443609 earned ₡10,019 from Battle #60719

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858881580_0.4143941780078221 (User 38462) vs TestRobot2_1771858881583_0.007280012205443609 (User 38463) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858881623_0.7166025449737565 earned ₡2,001 from Battle #60720

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858881623_0.797770478475584 earned ₡5,007 from Battle #60720

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858881623_0.7166025449737565 (User 38460) vs TestRobot2_1771858881623_0.797770478475584 (User 38461) | Winner: TestRobot2_1771858881623_0.797770478475584 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:21.816Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858881741_0.6118555875634609 earned ₡18,912 from Battle #60722

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858881743_0.7756091257482438 earned ₡7,268 from Battle #60722

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858881741_0.6118555875634609 (User 38462) vs TestRobot2_1771858881743_0.7756091257482438 (User 38463) | Winner: TestRobot1_1771858881741_0.6118555875634609 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858881809_0.013776551290393568 earned ₡2,001 from Battle #60724

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858881809_0.6025669508677448 earned ₡3,002 from Battle #60724

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858881809_0.013776551290393568 (User 38460) vs TestRobot2_1771858881809_0.6025669508677448 (User 38461) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:21.966Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858881904_0.779341608761073 earned ₡10,155 from Battle #60726

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858881907_0.3240468445048026 earned ₡8,022 from Battle #60726

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858881904_0.779341608761073 (User 38462) vs TestRobot2_1771858881907_0.3240468445048026 (User 38463) | Winner: TestRobot1_1771858881904_0.779341608761073 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858881959_0.7013411440723439 earned ₡2,003 from Battle #60728

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858881959_0.48605881673145834 earned ₡2,001 from Battle #60728

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858881959_0.7013411440723439 (User 38460) vs TestRobot2_1771858881959_0.48605881673145834 (User 38461) | Winner: TestRobot1_1771858881959_0.7013411440723439 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +3 | Kill: TestRobot1_1771858881959_0.7013411440723439

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 10 prestige, 5 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:22.127Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858882075_0.574517479190503 earned ₡6,178 from Battle #60730

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858882078_0.14434901913717635 earned ₡21,637 from Battle #60730

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858882075_0.574517479190503 (User 38462) vs TestRobot2_1771858882078_0.14434901913717635 (User 38463) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858882122_0.5356542952842668 earned ₡2,002 from Battle #60732

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858882122_0.9453066935995946 earned ₡2,001 from Battle #60732

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858882122_0.5356542952842668 (User 38460) vs TestRobot2_1771858882122_0.9453066935995946 (User 38461) | Winner: TestRobot1_1771858882122_0.5356542952842668 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:22.319Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858882310_0.6706157140974025 earned ₡13,152 from Battle #60734

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858882310_0.19418194089149443 earned ₡13,205 from Battle #60734

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858882310_0.6706157140974025 (User 38460) vs Robot2_1771858882310_0.19418194089149443 (User 38461) | Winner: Robot2_1771858882310_0.19418194089149443 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:22.457Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858882448_0.8882612342361029 earned ₡11,672 from Battle #60735

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858882448_0.5245815033773884 earned ₡13,199 from Battle #60735

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858882448_0.8882612342361029 (User 38460) vs Robot2_1771858882448_0.5245815033773884 (User 38461) | Winner: Robot2_1771858882448_0.5245815033773884 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:22.561Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858882552_0.8042261774979576 earned ₡8,839 from Battle #60736

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858882552_0.5233467134402444 earned ₡23,487 from Battle #60736

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858882552_0.8042261774979576 (User 38460) vs Robot2_1771858882552_0.5233467134402444 (User 38461) | Winner: Robot2_1771858882552_0.5233467134402444 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:22.663Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858882655_0.48766060353878293 earned ₡10,549 from Battle #60737

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858882655_0.10719492692104493 earned ₡11,025 from Battle #60737

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858882655_0.48766060353878293 (User 38460) vs Robot2_1771858882655_0.10719492692104493 (User 38461) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:22.772Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858882764_0.364383727608678 earned ₡8,996 from Battle #60738

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858882764_0.014134021896164639 earned ₡8,903 from Battle #60738

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858882764_0.364383727608678 (User 38460) vs Robot2_1771858882764_0.014134021896164639 (User 38461) | Winner: Robot1_1771858882764_0.364383727608678 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:22.867Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858882858_0.20273554370081692 earned ₡8,939 from Battle #60740

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858882858_0.7556997578929281 earned ₡8,903 from Battle #60740

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858882858_0.20273554370081692 (User 38460) vs Robot2_1771858882858_0.7556997578929281 (User 38461) | Winner: Robot1_1771858882858_0.20273554370081692 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:22.980Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858882968_0.6330351648712672 earned ₡8,971 from Battle #60741

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858882968_0.039381171962983075 earned ₡8,903 from Battle #60741

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858882968_0.6330351648712672 (User 38460) vs Robot2_1771858882968_0.039381171962983075 (User 38461) | Winner: Robot1_1771858882968_0.6330351648712672 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:23.092Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858883084_0.8332239636124672 earned ₡8,986 from Battle #60742

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858883084_0.9103164787244429 earned ₡8,903 from Battle #60742

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858883084_0.8332239636124672 (User 38460) vs Robot2_1771858883084_0.9103164787244429 (User 38461) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:23.203Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858883194_0.3717153088975368 earned ₡3,656 from Battle #60743

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858883194_0.17406017258215933 earned ₡8,904 from Battle #60743

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858883194_0.3717153088975368 (User 38460) vs Robot2_1771858883194_0.17406017258215933 (User 38461) | Winner: Robot2_1771858883194_0.17406017258215933 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:23.305Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858883296_0.3281091620722292 earned ₡6,327 from Battle #60744

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858883296_0.23417618704673127 earned ₡8,903 from Battle #60744

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858883296_0.3281091620722292 (User 38460) vs Robot2_1771858883296_0.23417618704673127 (User 38461) | Winner: Robot1_1771858883296_0.3281091620722292 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +3 | Kill: Robot1_1771858883296_0.3281091620722292

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 3 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:23.402Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858883394_0.5754514350994068 earned ₡7,660 from Battle #60745

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858883394_0.8167004837063683 earned ₡8,904 from Battle #60745

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858883394_0.5754514350994068 (User 38460) vs Robot2_1771858883394_0.8167004837063683 (User 38461) | Winner: Robot2_1771858883394_0.8167004837063683 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:23.494Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858883486_0.47255195183171517 earned ₡8,329 from Battle #60746

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858883486_0.8270421529133309 earned ₡8,903 from Battle #60746

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858883486_0.47255195183171517 (User 38460) vs Robot2_1771858883486_0.8270421529133309 (User 38461) | Winner: Robot1_1771858883486_0.47255195183171517 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:23.595Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858883587_0.26029658532044 earned ₡8,661 from Battle #60747

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858883587_0.7256364200960277 earned ₡8,904 from Battle #60747

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858883587_0.26029658532044 (User 38460) vs Robot2_1771858883587_0.7256364200960277 (User 38461) | Winner: Robot2_1771858883587_0.7256364200960277 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:23.693Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858883685_0.4621776508852854 earned ₡8,829 from Battle #60748

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858883685_0.37042077427720466 earned ₡8,903 from Battle #60748

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858883685_0.4621776508852854 (User 38460) vs Robot2_1771858883685_0.37042077427720466 (User 38461) | Winner: Robot1_1771858883685_0.4621776508852854 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:23.793Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858883785_0.4266076110242897 earned ₡8,911 from Battle #60749

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858883785_0.3447338753356841 earned ₡8,904 from Battle #60749

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858883785_0.4266076110242897 (User 38460) vs Robot2_1771858883785_0.3447338753356841 (User 38461) | Winner: Robot2_1771858883785_0.3447338753356841 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:23.886Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858883878_0.13054382816438648 earned ₡8,953 from Battle #60750

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858883878_0.9429505056524704 earned ₡8,904 from Battle #60750

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858883878_0.13054382816438648 (User 38460) vs Robot2_1771858883878_0.9429505056524704 (User 38461) | Winner: Robot2_1771858883878_0.9429505056524704 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:23.990Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858883979_0.7792027988979595 earned ₡8,974 from Battle #60751

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858883979_0.49824599220802634 earned ₡8,904 from Battle #60751

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858883979_0.7792027988979595 (User 38460) vs Robot2_1771858883979_0.49824599220802634 (User 38461) | Winner: Robot2_1771858883979_0.49824599220802634 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:24.083Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858884075_0.41518118994960007 earned ₡8,986 from Battle #60752

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858884075_0.6680464375220951 earned ₡8,903 from Battle #60752

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858884075_0.41518118994960007 (User 38460) vs Robot2_1771858884075_0.6680464375220951 (User 38461) | Winner: Robot1_1771858884075_0.41518118994960007 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:24.177Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858884168_0.8501713174218071 earned ₡8,990 from Battle #60753

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858884168_0.7901941102712025 earned ₡8,905 from Battle #60753

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858884168_0.8501713174218071 (User 38460) vs Robot2_1771858884168_0.7901941102712025 (User 38461) | Winner: Robot2_1771858884168_0.7901941102712025 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +3 | Kill: Robot2_1771858884168_0.7901941102712025

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 3 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:24.282Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858884223_0.3998145265637485 earned ₡1,671 from Battle #60755

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858884227_0.035538474698961986 earned ₡4,089 from Battle #60755

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858884223_0.3998145265637485 (User 38507) vs TestRobot2_1771858884227_0.035538474698961986 (User 38508) | Winner: TestRobot2_1771858884227_0.035538474698961986 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +3

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858884274_0.6255981378058656 earned ₡8,992 from Battle #60756

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858884274_0.3533191840827077 earned ₡8,904 from Battle #60756

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858884274_0.6255981378058656 (User 38460) vs Robot2_1771858884274_0.3533191840827077 (User 38461) | Winner: Robot2_1771858884274_0.3533191840827077 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 10 prestige, 5 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:24.468Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858884459_0.4454343011126173 earned ₡8,995 from Battle #60758

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858884459_0.7218597843494668 earned ₡8,903 from Battle #60758

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858884459_0.4454343011126173 (User 38460) vs Robot2_1771858884459_0.7218597843494668 (User 38461) | Winner: Robot1_1771858884459_0.4454343011126173 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2 | Kill: Robot1_1771858884459_0.4454343011126173

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:24.567Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858884466_0.41941401880065476 earned ₡1,002 from Battle #60761

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858884469_0.6164645118929425 earned ₡4,091 from Battle #60761

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858884466_0.41941401880065476 (User 38507) vs TestRobot2_1771858884469_0.6164645118929425 (User 38508) | Winner: TestRobot2_1771858884469_0.6164645118929425 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858884557_0.3752971127516711 earned ₡8,937 from Battle #60764

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858884557_0.3184549614326333 earned ₡8,903 from Battle #60764

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858884557_0.3752971127516711 (User 38460) vs Robot2_1771858884557_0.3184549614326333 (User 38461) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:24.779Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858884770_0.4548255529836198 earned ₡8,971 from Battle #60766

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858884770_0.6030572502153486 earned ₡8,903 from Battle #60766

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858884770_0.4548255529836198 (User 38460) vs Robot2_1771858884770_0.6030572502153486 (User 38461) | Winner: Robot1_1771858884770_0.4548255529836198 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:24.881Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858884872_0.9106269967925759 earned ₡8,985 from Battle #60768

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858884872_0.40776491897023215 earned ₡8,904 from Battle #60768

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858884872_0.9106269967925759 (User 38460) vs Robot2_1771858884872_0.40776491897023215 (User 38461) | Winner: Robot2_1771858884872_0.40776491897023215 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:24.992Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858884983_0.8048092608365705 earned ₡8,994 from Battle #60770

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858884983_0.7096277249361371 earned ₡8,903 from Battle #60770

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858884983_0.8048092608365705 (User 38460) vs Robot2_1771858884983_0.7096277249361371 (User 38461) | Winner: Robot1_1771858884983_0.8048092608365705 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:25.104Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858885093_0.1547283703528255 earned ₡8,994 from Battle #60772

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858885093_0.3817659275134998 earned ₡8,840 from Battle #60772

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858885093_0.1547283703528255 (User 38460) vs Robot2_1771858885093_0.3817659275134998 (User 38461) | Winner: Robot2_1771858885093_0.3817659275134998 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:25.215Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858885205_0.2564559824695246 earned ₡6,010 from Battle #60775

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858885208_0.8240173140033156 earned ₡1,000 from Battle #60775

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858885205_0.2564559824695246 (User 38507) vs TestRobot2_1771858885208_0.8240173140033156 (User 38508) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858885206_0.5455432856063502 earned ₡8,994 from Battle #60776

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858885206_0.061482424388809354 earned ₡8,872 from Battle #60776

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858885206_0.5455432856063502 (User 38460) vs Robot2_1771858885206_0.061482424388809354 (User 38461) | Winner: Robot2_1771858885206_0.061482424388809354 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:25.390Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858885382_0.49172203382045543 earned ₡8,994 from Battle #60778

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858885382_0.7683305908939504 earned ₡8,888 from Battle #60778

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858885382_0.49172203382045543 (User 38460) vs Robot2_1771858885382_0.7683305908939504 (User 38461) | Winner: Robot2_1771858885382_0.7683305908939504 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +3

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 3 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:25.497Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858885482_0.43616065125353354 earned ₡3,890 from Battle #60781

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858885484_0.268285136837772 earned ₡1,001 from Battle #60781

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40597: Error: BattleParticipant records not found for battle 60781
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:709:11)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5)

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [Streaming] Robot1_1771858885488_0.48730933043894065 earned ₡8,994 from Battle #60782

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858885488_0.5292111977529194 earned ₡8,896 from Battle #60782

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858885488_0.48730933043894065 (User 38460) vs Robot2_1771858885488_0.5292111977529194 (User 38461) | Winner: Robot2_1771858885488_0.5292111977529194 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 1 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:25.712Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40600: Error: BattleParticipant not found for battle 60785, robot 550856
          at updateRobotStats (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:490:11)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:646:18)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5)

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [Streaming] Robot1_1771858885700_0.114638576894735 earned ₡8,994 from Battle #60786

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858885700_0.0012176262828599294 earned ₡3,659 from Battle #60786

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858885700_0.114638576894735 (User 38460) vs Robot2_1771858885700_0.0012176262828599294 (User 38461) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 1 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:25.900Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858885891_0.5070979062293877 earned ₡8,995 from Battle #60788

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858885891_0.5190263005836006 earned ₡6,281 from Battle #60788

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858885891_0.5070979062293877 (User 38460) vs Robot2_1771858885891_0.5190263005836006 (User 38461) | Winner: Robot1_1771858885891_0.5070979062293877 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:26.007Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858885988_0.7201501745584803 earned ₡29,945 from Battle #60791

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858885991_0.9184921626859041 earned ₡1,002 from Battle #60791

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40605: Error: BattleParticipant records not found for battle 60791
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:709:11)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5)

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [Streaming] Robot1_1771858885997_0.9481955704615869 earned ₡8,994 from Battle #60792

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858885997_0.45012015147894746 earned ₡7,593 from Battle #60792

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858885997_0.9481955704615869 (User 38460) vs Robot2_1771858885997_0.45012015147894746 (User 38461) | Winner: Robot2_1771858885997_0.45012015147894746 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 1 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:26.206Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 3 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858886083_0.5158938065945594 earned ₡3,453 from Battle #60795

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858886086_0.12970037173932725 earned ₡1,002 from Battle #60795

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858886083_0.5158938065945594 (User 38507) vs TestRobot2_1771858886086_0.12970037173932725 (User 38508) | Winner: TestRobot1_1771858886083_0.5158938065945594 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40608: Error: Robots not found for match 40608
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:606:11)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5)

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [Streaming] Robot1_1771858886196_0.41555434804310865 earned ₡8,994 from Battle #60797

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858886196_0.6057385038654745 earned ₡8,248 from Battle #60797

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40609: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:722:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5) {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 2 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:26.386Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858886362_0.38374780647703477 earned ₡3,236 from Battle #60800

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858886366_0.4056536810367052 earned ₡1,002 from Battle #60800

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40611: PrismaClientKnownRequestError: 
      Invalid `prisma.battleParticipant.update()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:672:34
      
        669 }
        670 
        671 // Update BattleParticipant records with prestige, fame, and streaming revenue
      → 672 await prisma.battleParticipant.update(
      An operation failed because it depends on one or more records that were required but not found. Record to update not found.
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:672:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5) {
        code: 'P2025',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'BattleParticipant',
          cause: 'Record to update not found.'
        }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [Streaming] Robot1_1771858886377_0.9348543202848533 earned ₡8,996 from Battle #60801

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858886377_0.8928731190315927 earned ₡8,575 from Battle #60801

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40612: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:722:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5) {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 2 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:26.545Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 3 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858886454_0.8014787935974518 earned ₡3,347 from Battle #60805

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858886457_0.8637170017089737 earned ₡1,002 from Battle #60805

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858886454_0.8014787935974518 (User 38507) vs TestRobot2_1771858886457_0.8637170017089737 (User 38508) | Winner: TestRobot2_1771858886457_0.8637170017089737 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40614: Error: Robots not found for match 40614
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:606:11)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5)

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [Streaming] Robot1_1771858886536_0.3510183970404769 earned ₡8,937 from Battle #60806

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858886536_0.29841243819889685 earned ₡8,577 from Battle #60806

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858886536_0.3510183970404769 (User 38460) vs Robot2_1771858886536_0.29841243819889685 (User 38461) | Winner: Robot2_1771858886536_0.29841243819889685 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 1 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 10 prestige, 4 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:26.735Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 3 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858886626_0.9267471822723145 earned ₡3,321 from Battle #60809

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858886629_0.6966059369859575 earned ₡1,002 from Battle #60809

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858886626_0.9267471822723145 (User 38507) vs TestRobot2_1771858886629_0.6966059369859575 (User 38508) | Winner: TestRobot1_1771858886626_0.9267471822723145 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40617: Error: Robots not found for match 40617
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:606:11)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5)

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [Streaming] Robot1_1771858886726_0.7708544489955923 earned ₡8,969 from Battle #60811

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858886726_0.5884593916492185 earned ₡8,577 from Battle #60811

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858886726_0.7708544489955923 (User 38460) vs Robot2_1771858886726_0.5884593916492185 (User 38461) | Winner: Robot2_1771858886726_0.5884593916492185 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 1 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 10 prestige, 4 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:26.924Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 3 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858886803_0.27707056638767114 earned ₡3,316 from Battle #60813

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858886807_0.4895543051977098 earned ₡1,002 from Battle #60813

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858886803_0.27707056638767114 (User 38507) vs TestRobot2_1771858886807_0.4895543051977098 (User 38508) | Winner: TestRobot1_1771858886803_0.27707056638767114 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40620: Error: Robots not found for match 40620
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:606:11)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5)

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [Streaming] Robot1_1771858886915_0.7206255292006368 earned ₡8,985 from Battle #60815

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858886915_0.45571578189210604 earned ₡8,577 from Battle #60815

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858886915_0.7206255292006368 (User 38460) vs Robot2_1771858886915_0.45571578189210604 (User 38461) | Winner: Robot2_1771858886915_0.45571578189210604 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +3

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 1 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 10 prestige, 5 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:27.101Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858887070_0.12552869696773905 earned ₡2,298 from Battle #60817

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858887072_0.0673918423642107 earned ₡1,001 from Battle #60817

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40623: PrismaClientKnownRequestError: 
      Invalid `prisma.battleParticipant.update()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:672:34
      
        669 }
        670 
        671 // Update BattleParticipant records with prestige, fame, and streaming revenue
      → 672 await prisma.battleParticipant.update(
      An operation failed because it depends on one or more records that were required but not found. Record to update not found.
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:672:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5) {
        code: 'P2025',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'BattleParticipant',
          cause: 'Record to update not found.'
        }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [Streaming] Robot1_1771858887092_0.16956490774489552 earned ₡8,994 from Battle #60818

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858887092_0.7401900840408033 earned ₡8,575 from Battle #60818

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858887092_0.16956490774489552 (User 38460) vs Robot2_1771858887092_0.7401900840408033 (User 38461) | Winner: Robot1_1771858887092_0.16956490774489552 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 1 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:27.261Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 3 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858887166_0.9028588570618461 earned ₡2,809 from Battle #60821

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858887167_0.301559992332477 earned ₡1,002 from Battle #60821

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40625: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:722:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5) {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.error
      [BattleOrchestrator] Failed to process match 40626: Error: Robots not found for match 40626
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:606:11)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5)

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [Streaming] Robot1_1771858887251_0.7216506851237676 earned ₡8,994 from Battle #60822

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858887251_0.23008525171865235 earned ₡8,515 from Battle #60822

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40627: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:761:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5) {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 3 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:27.436Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 3 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858887166_0.9028588570618461 earned ₡2,811 from Battle #60825

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858887167_0.301559992332477 earned ₡1,002 from Battle #60825

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40625: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:761:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5) {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.error
      [BattleOrchestrator] Failed to process match 40629: PrismaClientKnownRequestError: 
      Invalid `prisma.battle.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:397:38
      
        394 }
        395 
        396 // Create battle record
      → 397 const battle = await prisma.battle.create(
      Foreign key constraint violated: `battles_robot1_id_fkey (index)`
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at createBattleRecord (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:397:18)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:641:18)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5) {
        code: 'P2003',
        clientVersion: '5.22.0',
        meta: { modelName: 'Battle', field_name: 'battles_robot1_id_fkey (index)' }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [Streaming] Robot1_1771858887428_0.14673411558857385 earned ₡8,994 from Battle #60828

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858887428_0.8029722732606546 earned ₡8,546 from Battle #60828

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40630: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:761:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5) {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 3 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:27.619Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 3 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858887166_0.9028588570618461 earned ₡2,814 from Battle #60830

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858887167_0.301559992332477 earned ₡1,004 from Battle #60830

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40625: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:761:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5) {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.error
      [BattleOrchestrator] Failed to process match 40632: PrismaClientKnownRequestError: 
      Invalid `prisma.battle.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:397:38
      
        394 }
        395 
        396 // Create battle record
      → 397 const battle = await prisma.battle.create(
      Foreign key constraint violated: `battles_robot1_id_fkey (index)`
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at createBattleRecord (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:397:18)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:641:18)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5) {
        code: 'P2003',
        clientVersion: '5.22.0',
        meta: { modelName: 'Battle', field_name: 'battles_robot1_id_fkey (index)' }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [Streaming] Robot1_1771858887612_0.7396601048229663 earned ₡8,994 from Battle #60833

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858887612_0.7879886175005207 earned ₡8,560 from Battle #60833

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40633: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:761:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5) {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 3 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:27.801Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 3 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858887166_0.9028588570618461 earned ₡2,816 from Battle #60835

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858887167_0.301559992332477 earned ₡1,005 from Battle #60835

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40625: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:761:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5) {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.error
      [BattleOrchestrator] Failed to process match 40635: Error: Robots not found for match 40635
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:606:11)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5)

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [Streaming] Robot1_1771858887792_0.9303629539211042 earned ₡8,995 from Battle #60836

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858887792_0.29056716277800865 earned ₡8,567 from Battle #60836

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858887792_0.9303629539211042 (User 38460) vs Robot2_1771858887792_0.29056716277800865 (User 38461) | Winner: Robot1_1771858887792_0.9303629539211042 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 2 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:27.974Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 4 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858887166_0.9028588570618461 earned ₡2,818 from Battle #60839

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858887167_0.301559992332477 earned ₡1,006 from Battle #60839

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858887166_0.9028588570618461 (User 38507) vs TestRobot2_1771858887167_0.301559992332477 (User 38508) | Winner: TestRobot2_1771858887167_0.301559992332477 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858887877_0.20688885905033338 earned ₡2,804 from Battle #60842

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858887880_0.6195960670375037 earned ₡1,002 from Battle #60842

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40637: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:722:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5) {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.error
      [BattleOrchestrator] Failed to process match 40638: Error: Robots not found for match 40638
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:606:11)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5)

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [Streaming] Robot1_1771858887966_0.6649351879865428 earned ₡8,995 from Battle #60843

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858887966_0.8025436554030833 earned ₡8,411 from Battle #60843

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858887966_0.6649351879865428 (User 38460) vs Robot2_1771858887966_0.8025436554030833 (User 38461) | Winner: Robot1_1771858887966_0.6649351879865428 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 2 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 10 prestige, 4 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:28.242Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40641: PrismaClientKnownRequestError: 
      Invalid `prisma.battle.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:397:38
      
        394 }
        395 
        396 // Create battle record
      → 397 const battle = await prisma.battle.create(
      Foreign key constraint violated: `battles_robot1_id_fkey (index)`
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at createBattleRecord (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:397:18)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:641:18)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5) {
        code: 'P2003',
        clientVersion: '5.22.0',
        meta: { modelName: 'Battle', field_name: 'battles_robot1_id_fkey (index)' }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [Streaming] Robot1_1771858888233_0.6126568771251876 earned ₡8,994 from Battle #60847

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858888233_0.3595921647592526 earned ₡8,495 from Battle #60847

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858888233_0.6126568771251876 (User 38460) vs Robot2_1771858888233_0.3595921647592526 (User 38461) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 1 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:28.359Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40643: PrismaClientKnownRequestError: 
      Invalid `prisma.battle.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:397:38
      
        394 }
        395 
        396 // Create battle record
      → 397 const battle = await prisma.battle.create(
      Foreign key constraint violated: `battles_robot1_id_fkey (index)`
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at createBattleRecord (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:397:18)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:641:18)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5) {
        code: 'P2003',
        clientVersion: '5.22.0',
        meta: { modelName: 'Battle', field_name: 'battles_robot1_id_fkey (index)' }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [Streaming] Robot1_1771858888352_0.2240864243221754 earned ₡8,940 from Battle #60851

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858888352_0.4130381603939325 earned ₡8,493 from Battle #60851

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858888352_0.2240864243221754 (User 38460) vs Robot2_1771858888352_0.4130381603939325 (User 38461) | Winner: Robot1_1771858888352_0.2240864243221754 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 1 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:28.482Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858888403_0.8541941132663584 earned ₡2,005 from Battle #60854

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858888410_0.03622984979192323 earned ₡1,002 from Battle #60854

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: silver | TestRobot1_1771858888403_0.8541941132663584 (User 38507) vs TestRobot2_1771858888410_0.03622984979192323 (User 38508) | Winner: TestRobot1_1771858888403_0.8541941132663584 | Rewards: ₡18,000 / ₡3,000 | Prestige: +10 | Fame: +5

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858888472_0.1278087393062982 earned ₡8,936 from Battle #60856

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858888472_0.3326937898614636 earned ₡8,495 from Battle #60856

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858888472_0.1278087393062982 (User 38460) vs Robot2_1771858888472_0.3326937898614636 (User 38461) | Winner: Robot2_1771858888472_0.3326937898614636 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 15 prestige, 7 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:28.651Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40648: PrismaClientKnownRequestError: 
      Invalid `prisma.battle.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:397:38
      
        394 }
        395 
        396 // Create battle record
      → 397 const battle = await prisma.battle.create(
      Foreign key constraint violated: `battles_robot1_id_fkey (index)`
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at createBattleRecord (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:397:18)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:641:18)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5) {
        code: 'P2003',
        clientVersion: '5.22.0',
        meta: { modelName: 'Battle', field_name: 'battles_robot1_id_fkey (index)' }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [Streaming] Robot1_1771858888642_0.27446398042853937 earned ₡8,937 from Battle #60859

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858888642_0.7462889221672334 earned ₡8,432 from Battle #60859

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40649: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:722:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5) {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 2 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:28.777Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot1_1771858888764_0.9864447657510275 earned ₡1,002 from Battle #60862

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] TestRobot2_1771858888766_0.8940781324448689 earned ₡1,000 from Battle #60862

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | TestRobot1_1771858888764_0.9864447657510275 (User 38507) vs TestRobot2_1771858888766_0.8940781324448689 (User 38508) | Winner: TestRobot1_1771858888764_0.9864447657510275 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858888768_0.47417297870042685 earned ₡8,938 from Battle #60863

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858888768_0.3406877787237462 earned ₡8,463 from Battle #60863

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858888768_0.47417297870042685 (User 38460) vs Robot2_1771858888768_0.3406877787237462 (User 38461) | Winner: Robot1_1771858888768_0.47417297870042685 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 10 prestige, 4 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:28.958Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858888949_0.6450369916383635 earned ₡8,938 from Battle #60864

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858888949_0.8912766362272628 earned ₡8,478 from Battle #60864

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858888949_0.6450369916383635 (User 38460) vs Robot2_1771858888949_0.8912766362272628 (User 38461) | Winner: Robot1_1771858888949_0.6450369916383635 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:29.058Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858889049_0.23364125496160637 earned ₡8,937 from Battle #60865

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858889049_0.43639029347190506 earned ₡8,487 from Battle #60865

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858889049_0.23364125496160637 (User 38460) vs Robot2_1771858889049_0.43639029347190506 (User 38461) | Winner: Robot2_1771858889049_0.43639029347190506 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:29.153Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858889144_0.046720187078380326 earned ₡8,937 from Battle #60866

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858889144_0.46454168118176387 earned ₡8,453 from Battle #60866

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858889144_0.046720187078380326 (User 38460) vs Robot2_1771858889144_0.46454168118176387 (User 38461) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:29.259Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858889250_0.8774058416332278 earned ₡8,938 from Battle #60867

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858889250_0.8785563626442565 earned ₡8,473 from Battle #60867

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40656: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:722:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:431:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:364:5) {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:431:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 1 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:29.358Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858889348_0.05199366358477453 earned ₡8,937 from Battle #60868

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858889348_0.5725262101182044 earned ₡8,485 from Battle #60868

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858889348_0.05199366358477453 (User 38460) vs Robot2_1771858889348_0.5725262101182044 (User 38461) | Winner: Robot2_1771858889348_0.5725262101182044 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:29.453Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858889445_0.7384187580803887 earned ₡8,938 from Battle #60869

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858889445_0.97835608289044 earned ₡8,489 from Battle #60869

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858889445_0.7384187580803887 (User 38460) vs Robot2_1771858889445_0.97835608289044 (User 38461) | Winner: Robot1_1771858889445_0.7384187580803887 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:29.555Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858889547_0.30472198889157887 earned ₡8,937 from Battle #60870

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858889547_0.7951667219365339 earned ₡8,493 from Battle #60870

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858889547_0.30472198889157887 (User 38460) vs Robot2_1771858889547_0.7951667219365339 (User 38461) | Winner: Robot2_1771858889547_0.7951667219365339 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:29.653Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858889645_0.9220739036828396 earned ₡8,938 from Battle #60871

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858889645_0.843625268000096 earned ₡8,493 from Battle #60871

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858889645_0.9220739036828396 (User 38460) vs Robot2_1771858889645_0.843625268000096 (User 38461) | Winner: Robot1_1771858889645_0.9220739036828396 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:29.748Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot1_1771858889740_0.824359395115725 earned ₡5,958 from Battle #60872

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Streaming] Robot2_1771858889740_0.7906786683803811 earned ₡5,663 from Battle #60872

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | Robot1_1771858889740_0.824359395115725 (User 38460) vs Robot2_1771858889740_0.7906786683803811 (User 38461) | Winner: Robot2_1771858889740_0.7906786683803811 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +3 | Kill: Robot2_1771858889740_0.7906786683803811

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 3 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:29.864Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | RealRobot_1771858889854_0.3828291772714957 (User 38460) vs Bye Robot (User 38461) | Winner: RealRobot_1771858889854_0.3828291772714957 | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0 | Kill: RealRobot_1771858889854_0.3828291772714957

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 1 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:29.934Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | RealRobot_1771858889925_0.31062297646991044 (User 38460) vs Bye Robot (User 38461) | Winner: RealRobot_1771858889925_0.31062297646991044 | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0 | Kill: RealRobot_1771858889925_0.31062297646991044

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 1 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:30.004Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | RealRobot_1771858889996_0.5660072691607818 (User 38460) vs Bye Robot (User 38461) | Winner: RealRobot_1771858889996_0.5660072691607818 | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0 | Kill: RealRobot_1771858889996_0.5660072691607818

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 1 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:30.086Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | RealRobot_1771858890075_0.5517148676308363 (User 38460) vs Bye Robot (User 38461) | Winner: RealRobot_1771858890075_0.5517148676308363 | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0 | Kill: RealRobot_1771858890075_0.5517148676308363

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 1 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:30.204Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | RealRobot_1771858890196_0.7235425359022982 (User 38460) vs Bye Robot (User 38461) | Winner: RealRobot_1771858890196_0.7235425359022982 | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0 | Kill: RealRobot_1771858890196_0.7235425359022982

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 1 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:30.278Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | RealRobot_1771858890270_0.9153223682111233 (User 38460) vs Bye Robot (User 38461) | Winner: RealRobot_1771858890270_0.9153223682111233 | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0 | Kill: RealRobot_1771858890270_0.9153223682111233

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 1 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:30.440Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | RealRobot_1771858890406_0.6708639599177758 (User 38460) vs Bye Robot (User 38461) | Winner: RealRobot_1771858890406_0.6708639599177758 | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0 | Kill: RealRobot_1771858890406_0.6708639599177758

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 1 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:30.510Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | RealRobot_1771858890501_0.6832772890349568 (User 38460) vs Bye Robot (User 38461) | Winner: RealRobot_1771858890501_0.6832772890349568 | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0 | Kill: RealRobot_1771858890501_0.6832772890349568

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 1 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:30.576Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | RealRobot_1771858890568_0.3253729755418091 (User 38460) vs Bye Robot (User 38461) | Winner: RealRobot_1771858890568_0.3253729755418091 | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0 | Kill: RealRobot_1771858890568_0.3253729755418091

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 1 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:30.644Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | RealRobot_1771858890636_0.63804977778995 (User 38460) vs Bye Robot (User 38461) | Winner: RealRobot_1771858890636_0.63804977778995 | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0 | Kill: RealRobot_1771858890636_0.63804977778995

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 1 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:30.736Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | RealRobot_1771858890728_0.3257464559871698 (User 38460) vs Bye Robot (User 38461) | Winner: RealRobot_1771858890728_0.3257464559871698 | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0 | Kill: RealRobot_1771858890728_0.3257464559871698

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 1 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:30.846Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | RealRobot_1771858890836_0.9341143677871359 (User 38460) vs Bye Robot (User 38461) | Winner: RealRobot_1771858890836_0.9341143677871359 | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0 | Kill: RealRobot_1771858890836_0.9341143677871359

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 1 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:30.912Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | RealRobot_1771858890904_0.7417362839764665 (User 38460) vs Bye Robot (User 38461) | Winner: RealRobot_1771858890904_0.7417362839764665 | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0 | Kill: RealRobot_1771858890904_0.7417362839764665

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 1 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:30.978Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | RealRobot_1771858890971_0.6391983980188487 (User 38460) vs Bye Robot (User 38461) | Winner: RealRobot_1771858890971_0.6391983980188487 | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0 | Kill: RealRobot_1771858890971_0.6391983980188487

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 1 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:31.048Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | RealRobot_1771858891039_0.32805481896766286 (User 38460) vs Bye Robot (User 38461) | Winner: RealRobot_1771858891039_0.32805481896766286 | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0 | Kill: RealRobot_1771858891039_0.32805481896766286

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 1 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:31.118Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [Battle] League: bronze | RealRobot_1771858891110_0.03324024948003301 (User 38460) vs Bye Robot (User 38461) | Winner: RealRobot_1771858891110_0.03324024948003301 | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0 | Kill: RealRobot_1771858891110_0.03324024948003301

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 1 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:31.187Z

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.error
      [BattleOrchestrator] Failed to process match 40678: PrismaClientKnownRequestError: 
      Invalid `prisma.scheduledMatch.update()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:803:31
      
        800 // No need to update Battle table
        801 
        802 // Update scheduled match
      → 803 await prisma.scheduledMatch.update(
      An operation failed because it depends on one or more records that were required but not found. Record to update not found.
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:803:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:563:13
          at AsyncProperty.run (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
          at asyncRunIt (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
          at Object.<anonymous> (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:503:5) {
        code: 'P2025',
        clientVersion: '5.22.0',
        meta: { modelName: 'ScheduledMatch', cause: 'Record to update not found.' }
      }

      932 |       const errorMsg = error instanceof Error ? error.message : String(error);
      933 |       summary.errors.push(`Match ${match.id}: ${errorMsg}`);
    > 934 |       console.error(`[BattleOrchestrator] Failed to process match ${match.id}:`, error);
          |               ^
      935 |     }
      936 |   }
      937 |   

      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at tests/terminalLogStreamingRevenue.property.test.ts:563:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:503:5)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 1 failed, 0 bye-matches

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (tests/terminalLogStreamingRevenue.property.test.ts:94:5)

  ● Property 14: Terminal Log Contains Streaming Revenue › Property 14: Terminal log contains streaming revenue for all battles

    Property failed after 1 tests
    { seed: -2099379571, path: "0:0:0:0:0:0:1:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0,0,0,0]
    Shrunk 9 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.delete()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:348:38

      345 // Cleanup - delete in correct order
      346 await prisma.battle.delete({ where: { id: battle!.id } });
      347 await prisma.scheduledMatch.delete({ where: { id: match.id } });
    → 348 await prisma.robot.delete(
    Foreign key constraint violated: `battles_robot1_id_fkey (index)`

      346 |             await prisma.battle.delete({ where: { id: battle!.id } });
      347 |             await prisma.scheduledMatch.delete({ where: { id: match.id } });
    > 348 |             await prisma.robot.delete({ where: { id: robot1.id } });
          |             ^
      349 |             await prisma.robot.delete({ where: { id: robot2.id } });
      350 |           } finally {
      351 |             capture.restore();

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at tests/terminalLogStreamingRevenue.property.test.ts:348:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:199:5)

  ● Property 14: Terminal Log Contains Streaming Revenue › Property 14.1: Streaming revenue logged immediately after battle completion

    Property failed after 5 tests
    { seed: 1070684108, path: "4:15:12:9:0", endOnFailure: true }
    Counterexample: [100,8529,108,7765,2]
    Shrunk 4 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 2
    Received:    0

      448 |             );
      449 |
    > 450 |             expect(streamingLogs.length).toBeGreaterThanOrEqual(2);
          |                                          ^
      451 |
      452 |             // Property: Both robots should have streaming revenue logged
      453 |             const robot1Logged = streamingLogs.some(log => log.includes(robotName1));

      at tests/terminalLogStreamingRevenue.property.test.ts:450:42
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

  ● Property 14: Terminal Log Contains Streaming Revenue › Property 14.2: No streaming revenue logged for bye matches

    Property failed after 17 tests
    { seed: -598911723, path: "16:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:20:29

      17 
      18 // Helper function to create a minimal test robot
      19 async function createTestRobot(userId: number, battles: number, fame: number, name: string) {
    → 20   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      18 | // Helper function to create a minimal test robot
      19 | async function createTestRobot(userId: number, battles: number, fame: number, name: string) {
    > 20 |   return await prisma.robot.create({
         |          ^
      21 |     data: {
      22 |       userId,
      23 |       name,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/terminalLogStreamingRevenue.property.test.ts:20:10)
      at tests/terminalLogStreamingRevenue.property.test.ts:511:25
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:503:5)

  ● Property 14: Terminal Log Contains Streaming Revenue › Property 14.3: Terminal log format is consistent

    Property failed after 1 tests
    { seed: -1970777393, path: "0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [[{"battles":0,"fame":0},{"battles":0,"fame":0}],0]
    Shrunk 5 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:20:29

      17 
      18 // Helper function to create a minimal test robot
      19 async function createTestRobot(userId: number, battles: number, fame: number, name: string) {
    → 20   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      18 | // Helper function to create a minimal test robot
      19 | async function createTestRobot(userId: number, battles: number, fame: number, name: string) {
    > 20 |   return await prisma.robot.create({
         |          ^
      21 |     data: {
      22 |       userId,
      23 |       name,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/terminalLogStreamingRevenue.property.test.ts:20:10)
      at tests/terminalLogStreamingRevenue.property.test.ts:631:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:616:5)

FAIL tests/cyclePerformanceMonitoring.test.ts
  ● Cycle Performance Monitoring Service › detectStepDegradation › should detect performance degradation when recent average exceeds 150% of baseline

    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStart (src/services/eventLogger.ts:271:5)
      at Object.<anonymous> (tests/cyclePerformanceMonitoring.test.ts:42:9)

  ● Cycle Performance Monitoring Service › detectStepDegradation › should not detect degradation when recent average is within threshold

    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStart (src/services/eventLogger.ts:271:5)
      at Object.<anonymous> (tests/cyclePerformanceMonitoring.test.ts:69:9)

  ● Cycle Performance Monitoring Service › detectStepDegradation › should return null when there is no baseline data

    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStart (src/services/eventLogger.ts:271:5)
      at Object.<anonymous> (tests/cyclePerformanceMonitoring.test.ts:91:9)

  ● Cycle Performance Monitoring Service › detectStepDegradation › should classify degradation severity correctly

    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStepComplete (src/services/eventLogger.ts:287:5)
      at Object.<anonymous> (tests/cyclePerformanceMonitoring.test.ts:107:9)

  ● Cycle Performance Monitoring Service › detectAllStepDegradations › should detect degradation across multiple steps

    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStepComplete (src/services/eventLogger.ts:287:5)
      at Object.<anonymous> (tests/cyclePerformanceMonitoring.test.ts:137:11)

  ● Cycle Performance Monitoring Service › getCyclePerformanceMetrics › should calculate performance metrics for a cycle range

    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStepComplete (src/services/eventLogger.ts:287:5)
      at Object.<anonymous> (tests/cyclePerformanceMonitoring.test.ts:169:9)

  ● Cycle Performance Monitoring Service › getCycleExecutionTrend › should detect improving trend when recent cycles are faster

    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStart (src/services/eventLogger.ts:271:5)
      at Object.<anonymous> (tests/cyclePerformanceMonitoring.test.ts:240:9)

  ● Cycle Performance Monitoring Service › getCycleExecutionTrend › should detect degrading trend when recent cycles are slower

    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStart (src/services/eventLogger.ts:271:5)
      at Object.<anonymous> (tests/cyclePerformanceMonitoring.test.ts:261:9)

  ● Cycle Performance Monitoring Service › getCycleExecutionTrend › should detect stable trend when durations are consistent

    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleComplete (src/services/eventLogger.ts:302:5)
      at Object.<anonymous> (tests/cyclePerformanceMonitoring.test.ts:283:9)

FAIL tests/leagueRebalancingService.test.ts
  ● Console

    console.log
      [Rebalancing] bronze: No robots with ≥25 league points, skipping promotions

      at determinePromotions (src/services/leagueRebalancingService.ts:72:13)

  ● League Rebalancing Service › determinePromotions › should return top 10% of robots with ≥5 cycles AND ≥25 league points

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 0

       99 |       // Should get top 10% of 20 = 2 robots, but only from those with ≥25 points
      100 |       // Robots 5-19 have ≥25 points (15 robots), top 2 are robots 19 and 18
    > 101 |       expect(toPromote.length).toBe(2);
          |                                ^
      102 |       expect(toPromote[0].name).toBe('Bronze Robot 19'); // 95 points
      103 |       expect(toPromote[1].name).toBe('Bronze Robot 18'); // 90 points
      104 |       expect(toPromote[0].leaguePoints).toBeGreaterThanOrEqual(25);

      at Object.<anonymous> (tests/leagueRebalancingService.test.ts:101:32)

  ● League Rebalancing Service › determinePromotions › should skip robots with <5 cycles in current league

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/leagueRebalancingService.test.ts:117:56

      114 it('should skip robots with <5 cycles in current league', async () => {
      115   const robots = [];
      116   for (let i = 0; i < 20; i++) {
    → 117     const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      115 |       const robots = [];
      116 |       for (let i = 0; i < 20; i++) {
    > 117 |         const weaponInv = await prisma.weaponInventory.create({
          |                           ^
      118 |           data: { userId: testUser.id, weaponId: practiceSword.id },
      119 |         });
      120 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/leagueRebalancingService.test.ts:117:27)

  ● League Rebalancing Service › determinePromotions › should return empty array when no robots have ≥25 league points

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/leagueRebalancingService.test.ts:168:56

      165 // Create 20 robots but none with ≥25 league points
      166 const robots = [];
      167 for (let i = 0; i < 20; i++) {
    → 168   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      166 |       const robots = [];
      167 |       for (let i = 0; i < 20; i++) {
    > 168 |         const weaponInv = await prisma.weaponInventory.create({
          |                           ^
      169 |           data: { userId: testUser.id, weaponId: practiceSword.id },
      170 |         });
      171 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/leagueRebalancingService.test.ts:168:27)

  ● League Rebalancing Service › determinePromotions › should return empty array when too few robots

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/leagueRebalancingService.test.ts:207:56

      204 // Create only 5 robots (< 10 minimum)
      205 const robots = [];
      206 for (let i = 0; i < 5; i++) {
    → 207   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      205 |       const robots = [];
      206 |       for (let i = 0; i < 5; i++) {
    > 207 |         const weaponInv = await prisma.weaponInventory.create({
          |                           ^
      208 |           data: { userId: testUser.id, weaponId: practiceSword.id },
      209 |         });
      210 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/leagueRebalancingService.test.ts:207:27)

  ● League Rebalancing Service › determineDemotions › should return bottom 10% of robots with ≥5 cycles in current league

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/leagueRebalancingService.test.ts:247:56

      244 it('should return bottom 10% of robots with ≥5 cycles in current league', async () => {
      245   const robots = [];
      246   for (let i = 0; i < 20; i++) {
    → 247     const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      245 |       const robots = [];
      246 |       for (let i = 0; i < 20; i++) {
    > 247 |         const weaponInv = await prisma.weaponInventory.create({
          |                           ^
      248 |           data: { userId: testUser.id, weaponId: practiceSword.id },
      249 |         });
      250 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/leagueRebalancingService.test.ts:247:27)

  ● League Rebalancing Service › promoteRobot › should move robot to next tier and reset league points and cycles

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/leagueRebalancingService.test.ts:294:54

      291 
      292 describe('promoteRobot', () => {
      293   it('should move robot to next tier and reset league points and cycles', async () => {
    → 294     const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      292 |   describe('promoteRobot', () => {
      293 |     it('should move robot to next tier and reset league points and cycles', async () => {
    > 294 |       const weaponInv = await prisma.weaponInventory.create({
          |                         ^
      295 |         data: { userId: testUser.id, weaponId: practiceSword.id },
      296 |       });
      297 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/leagueRebalancingService.test.ts:294:25)

  ● League Rebalancing Service › promoteRobot › should throw error when trying to promote from champion

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/leagueRebalancingService.test.ts:331:54

      328 });
      329 
      330 it('should throw error when trying to promote from champion', async () => {
    → 331   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      329 |
      330 |     it('should throw error when trying to promote from champion', async () => {
    > 331 |       const weaponInv = await prisma.weaponInventory.create({
          |                         ^
      332 |         data: { userId: testUser.id, weaponId: practiceSword.id },
      333 |       });
      334 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/leagueRebalancingService.test.ts:331:25)

  ● League Rebalancing Service › demoteRobot › should move robot to previous tier and reset league points

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/leagueRebalancingService.test.ts:362:54

      359 
      360 describe('demoteRobot', () => {
      361   it('should move robot to previous tier and reset league points', async () => {
    → 362     const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      360 |   describe('demoteRobot', () => {
      361 |     it('should move robot to previous tier and reset league points', async () => {
    > 362 |       const weaponInv = await prisma.weaponInventory.create({
          |                         ^
      363 |         data: { userId: testUser.id, weaponId: practiceSword.id },
      364 |       });
      365 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/leagueRebalancingService.test.ts:362:25)

  ● League Rebalancing Service › demoteRobot › should throw error when trying to demote from bronze

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/leagueRebalancingService.test.ts:397:54

      394 });
      395 
      396 it('should throw error when trying to demote from bronze', async () => {
    → 397   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      395 |
      396 |     it('should throw error when trying to demote from bronze', async () => {
    > 397 |       const weaponInv = await prisma.weaponInventory.create({
          |                         ^
      398 |         data: { userId: testUser.id, weaponId: practiceSword.id },
      399 |       });
      400 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/leagueRebalancingService.test.ts:397:25)

  ● League Rebalancing Service › rebalanceLeagues › should process all tiers and return summary

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/leagueRebalancingService.test.ts:433:56

      430 
      431 // 20 bronze robots
      432 for (let i = 0; i < 20; i++) {
    → 433   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      431 |       // 20 bronze robots
      432 |       for (let i = 0; i < 20; i++) {
    > 433 |         const weaponInv = await prisma.weaponInventory.create({
          |                           ^
      434 |           data: { userId: testUser.id, weaponId: practiceSword.id },
      435 |         });
      436 |         const robot = await prisma.robot.create({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/leagueRebalancingService.test.ts:433:27)

  ● League Rebalancing Service › rebalanceLeagues › should not promote or demote robots multiple times in same cycle

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/leagueRebalancingService.test.ts:478:56

      475 
      476 // Create 100 bronze robots (to trigger promotion)
      477 for (let i = 0; i < 100; i++) {
    → 478   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      476 |       // Create 100 bronze robots (to trigger promotion)
      477 |       for (let i = 0; i < 100; i++) {
    > 478 |         const weaponInv = await prisma.weaponInventory.create({
          |                           ^
      479 |           data: { userId: testUser.id, weaponId: practiceSword.id },
      480 |         });
      481 |         const robot = await prisma.robot.create({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/leagueRebalancingService.test.ts:478:27)

FAIL tests/trainingAcademyCaps.test.ts
  ● Training Academy Cap Enforcement › Test 1: Base cap of 10 without any academy › should allow upgrading combatPower to level 10

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 404

      83 |           });
      84 |
    > 85 |         expect(response.status).toBe(200);
         |                                 ^
      86 |       }
      87 |
      88 |       // Verify the robot is at level 10

      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:85:33)

  ● Training Academy Cap Enforcement › Test 1: Base cap of 10 without any academy › should block upgrading combatPower from level 10 to level 11 without academy

    expect(received).toBe(expected) // Object.is equality

    Expected: 400
    Received: 404

      106 |         .send({ attribute: 'combatPower' });
      107 |
    > 108 |       expect(response.status).toBe(400);
          |                               ^
      109 |       expect(response.body.error).toContain('Attribute cap of 10 reached');
      110 |       expect(response.body.error).toContain('Combat Training Academy');
      111 |     });

      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:108:31)

  ● Training Academy Cap Enforcement › Test 2: Academy Level 1 cap (15) › should allow upgrading combatPower to level 15 with academy level 1

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.update()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/trainingAcademyCaps.test.ts:128:26

      125 
      126 it('should allow upgrading combatPower to level 15 with academy level 1', async () => {
      127   // Update robot to level 14
    → 128   await prisma.robot.update(
    An operation failed because it depends on one or more records that were required but not found. Record to update not found.

      126 |     it('should allow upgrading combatPower to level 15 with academy level 1', async () => {
      127 |       // Update robot to level 14
    > 128 |       await prisma.robot.update({
          |       ^
      129 |         where: { id: testRobot.id },
      130 |         data: { combatPower: new Prisma.Decimal(14) },
      131 |       });

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:128:7)

  ● Training Academy Cap Enforcement › Test 2: Academy Level 1 cap (15) › should block upgrading combatPower from level 15 to level 16

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.update()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/trainingAcademyCaps.test.ts:150:26

      147 
      148 it('should block upgrading combatPower from level 15 to level 16', async () => {
      149   // Update robot to level 15
    → 150   await prisma.robot.update(
    An operation failed because it depends on one or more records that were required but not found. Record to update not found.

      148 |     it('should block upgrading combatPower from level 15 to level 16', async () => {
      149 |       // Update robot to level 15
    > 150 |       await prisma.robot.update({
          |       ^
      151 |         where: { id: testRobot.id },
      152 |         data: { combatPower: new Prisma.Decimal(15) },
      153 |       });

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:150:7)

  ● Training Academy Cap Enforcement › Test 3: All 4 academies control their respective attributes › should enforce Combat Training Academy for Combat Systems attributes

    expect(received).toBe(expected) // Object.is equality

    Expected: 400
    Received: 404

      189 |           .send({ attribute });
      190 |
    > 191 |         expect(response.status).toBe(400);
          |                                 ^
      192 |         expect(response.body.error).toContain('Attribute cap of 10 reached');
      193 |         expect(response.body.error).toContain('Combat Training Academy');
      194 |       }

      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:191:33)

  ● Training Academy Cap Enforcement › Test 3: All 4 academies control their respective attributes › should enforce Defense Training Academy for Defensive Systems attributes

    expect(received).toBe(expected) // Object.is equality

    Expected: 400
    Received: 404

      217 |           .send({ attribute });
      218 |
    > 219 |         expect(response.status).toBe(400);
          |                                 ^
      220 |         expect(response.body.error).toContain('Attribute cap of 10 reached');
      221 |         expect(response.body.error).toContain('Defense Training Academy');
      222 |       }

      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:219:33)

  ● Training Academy Cap Enforcement › Test 3: All 4 academies control their respective attributes › should enforce Mobility Training Academy for Chassis & Mobility attributes

    expect(received).toBe(expected) // Object.is equality

    Expected: 400
    Received: 404

      245 |           .send({ attribute });
      246 |
    > 247 |         expect(response.status).toBe(400);
          |                                 ^
      248 |         expect(response.body.error).toContain('Attribute cap of 10 reached');
      249 |         expect(response.body.error).toContain('Mobility Training Academy');
      250 |       }

      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:247:33)

  ● Training Academy Cap Enforcement › Test 3: All 4 academies control their respective attributes › should enforce AI Training Academy for AI Processing + Team attributes

    expect(received).toBe(expected) // Object.is equality

    Expected: 400
    Received: 404

      275 |           .send({ attribute });
      276 |
    > 277 |         expect(response.status).toBe(400);
          |                                 ^
      278 |         expect(response.body.error).toContain('Attribute cap of 10 reached');
      279 |         expect(response.body.error).toContain('AI Training Academy');
      280 |       }

      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:277:33)

  ● Training Academy Cap Enforcement › Test 4: Maximum cap of 50 at academy level 10 › should allow upgrading combatPower to level 50 with academy level 10

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 404

      307 |         .send({ attribute: 'combatPower' });
      308 |
    > 309 |       expect(response.status).toBe(200);
          |                               ^
      310 |
      311 |       // Verify the robot is at level 50
      312 |       const robot = await prisma.robot.findUnique({

      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:309:31)

  ● Training Academy Cap Enforcement › Test 4: Maximum cap of 50 at academy level 10 › should block upgrading combatPower from level 50 to level 51

    expect(received).toBe(expected) // Object.is equality

    Expected: 400
    Received: 404

      329 |         .send({ attribute: 'combatPower' });
      330 |
    > 331 |       expect(response.status).toBe(400);
          |                               ^
      332 |       expect(response.body.error).toContain('maximum level');
      333 |     });
      334 |   });

      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:331:31)

  ● Training Academy Cap Enforcement › Test 5: Verify cap progression mapping › should enforce cap of 35 for academy level 5

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.update()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/trainingAcademyCaps.test.ts:374:28

      371 }
      372 
      373 // Set robot attribute to the cap level
    → 374 await prisma.robot.update(
    An operation failed because it depends on one or more records that were required but not found. Record to update not found.

      372 |
      373 |         // Set robot attribute to the cap level
    > 374 |         await prisma.robot.update({
          |         ^
      375 |           where: { id: testRobot.id },
      376 |           data: { combatPower: cap },
      377 |         });

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:374:9)

  ● Training Academy Cap Enforcement › Test 5: Verify cap progression mapping › should enforce cap of 40 for academy level 6

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.update()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/trainingAcademyCaps.test.ts:374:28

      371 }
      372 
      373 // Set robot attribute to the cap level
    → 374 await prisma.robot.update(
    An operation failed because it depends on one or more records that were required but not found. Record to update not found.

      372 |
      373 |         // Set robot attribute to the cap level
    > 374 |         await prisma.robot.update({
          |         ^
      375 |           where: { id: testRobot.id },
      376 |           data: { combatPower: cap },
      377 |         });

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:374:9)

FAIL tests/tagTeamLeagueRebalancing.property.test.ts
  ● Tag Team League Rebalancing - Property Tests › Property 20: Tier Change Resets › promotion resets league points and cycles to 0

    Property failed after 1 tests
    { seed: -1591895252, path: "0:0:0", endOnFailure: true }
    Counterexample: ["bronze",1,1]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    TypeError: Cannot read properties of null (reading 'id')

      74 |     const weapon = await prisma.weapon.findFirst();
      75 |     const weaponInv = await prisma.weaponInventory.create({
    > 76 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      77 |     });
      78 |
      79 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.property.test.ts:76:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.property.test.ts:106:20)
      at tests/tagTeamLeagueRebalancing.property.test.ts:142:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.property.test.ts:132:7)

  ● Tag Team League Rebalancing - Property Tests › Property 20: Tier Change Resets › demotion resets league points and cycles to 0

    Property failed after 1 tests
    { seed: 1277371852, path: "0:0:0:0", endOnFailure: true }
    Counterexample: ["silver",1,1]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    TypeError: Cannot read properties of null (reading 'id')

      74 |     const weapon = await prisma.weapon.findFirst();
      75 |     const weaponInv = await prisma.weaponInventory.create({
    > 76 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      77 |     });
      78 |
      79 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.property.test.ts:76:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.property.test.ts:106:20)
      at tests/tagTeamLeagueRebalancing.property.test.ts:183:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.property.test.ts:173:7)

  ● Tag Team League Rebalancing - Property Tests › Property 20: Tier Change Resets › tier change resets work across all valid tier transitions

    Property failed after 1 tests
    { seed: 1404879569, path: "0:0:0:0:0", endOnFailure: true }
    Counterexample: [{"action":"demote","tier":"silver"},0,0]
    Shrunk 4 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    TypeError: Cannot read properties of null (reading 'id')

      74 |     const weapon = await prisma.weapon.findFirst();
      75 |     const weaponInv = await prisma.weaponInventory.create({
    > 76 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      77 |     });
      78 |
      79 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.property.test.ts:76:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.property.test.ts:106:20)
      at tests/tagTeamLeagueRebalancing.property.test.ts:234:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.property.test.ts:214:7)

  ● Tag Team League Rebalancing - Property Tests › Property 20: Tier Change Resets › reset applies regardless of initial values magnitude

    Property failed after 1 tests
    { seed: 11423722, path: "0:0:0:0", endOnFailure: true }
    Counterexample: ["bronze",0,0]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    TypeError: Cannot read properties of null (reading 'id')

      74 |     const weapon = await prisma.weapon.findFirst();
      75 |     const weaponInv = await prisma.weaponInventory.create({
    > 76 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      77 |     });
      78 |
      79 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.property.test.ts:76:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.property.test.ts:106:20)
      at tests/tagTeamLeagueRebalancing.property.test.ts:269:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.property.test.ts:261:7)

  ● Tag Team League Rebalancing - Property Tests › Property 20: Tier Change Resets › reset applies even when initial values are already 0

    Property failed after 1 tests
    { seed: -72446833, path: "0:0", endOnFailure: true }
    Counterexample: ["bronze"]
    Shrunk 1 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    TypeError: Cannot read properties of null (reading 'id')

      74 |     const weapon = await prisma.weapon.findFirst();
      75 |     const weaponInv = await prisma.weaponInventory.create({
    > 76 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      77 |     });
      78 |
      79 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.property.test.ts:76:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.property.test.ts:106:20)
      at tests/tagTeamLeagueRebalancing.property.test.ts:294:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.property.test.ts:289:7)


  ● Test suite failed to run

    PrismaClientKnownRequestError: 
    Invalid `prisma.user.delete()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeamLeagueRebalancing.property.test.ts:45:31

      42   });
      43 }
      44 if (testStableId) {
    → 45   await prisma.user.delete(
    An operation failed because it depends on one or more records that were required but not found. Record to delete does not exist.

      43 |     }
      44 |     if (testStableId) {
    > 45 |       await prisma.user.delete({
         |       ^
      46 |         where: { id: testStableId },
      47 |       });
      48 |     }

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.property.test.ts:45:7)

FAIL tests/facilityAdvisorStreamingStudio.test.ts
  ● Facility Advisor - Streaming Studio › should recommend Streaming Studio with positive ROI when user has battle history

    PrismaClientKnownRequestError: 
    Invalid `prisma.facility.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/facilityAdvisorStreamingStudio.test.ts:97:27

      94 });
      95 
      96 // Create Streaming Studio facility at level 0
    → 97 await prisma.facility.create(
    Foreign key constraint violated: `facilities_user_id_fkey (index)`

       95 |
       96 |     // Create Streaming Studio facility at level 0
    >  97 |     await prisma.facility.create({
          |     ^
       98 |       data: {
       99 |         userId: user.id,
      100 |         facilityType: 'streaming_studio',

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/facilityAdvisorStreamingStudio.test.ts:97:5)

  ● Facility Advisor - Streaming Studio › should calculate correct ROI for Streaming Studio upgrade from level 1 to 2

    PrismaClientKnownRequestError: 
    Invalid `prisma.facility.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/facilityAdvisorStreamingStudio.test.ts:231:27

      228 });
      229 
      230 // Create Streaming Studio facility at level 1
    → 231 await prisma.facility.create(
    Foreign key constraint violated: `facilities_user_id_fkey (index)`

      229 |
      230 |     // Create Streaming Studio facility at level 1
    > 231 |     await prisma.facility.create({
          |     ^
      232 |       data: {
      233 |         userId: user.id,
      234 |         facilityType: 'streaming_studio',

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/facilityAdvisorStreamingStudio.test.ts:231:5)

  ● Facility Advisor - Streaming Studio › should not recommend Streaming Studio when battle frequency is too low

    PrismaClientKnownRequestError: 
    Invalid `prisma.facility.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/facilityAdvisorStreamingStudio.test.ts:316:27

      313 });
      314 
      315 // Create Streaming Studio facility at level 0
    → 316 await prisma.facility.create(
    Foreign key constraint violated: `facilities_user_id_fkey (index)`

      314 |
      315 |     // Create Streaming Studio facility at level 0
    > 316 |     await prisma.facility.create({
          |     ^
      317 |       data: {
      318 |         userId: user.id,
      319 |         facilityType: 'streaming_studio',

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/facilityAdvisorStreamingStudio.test.ts:316:5)

FAIL tests/leagueInstanceService.test.ts
  ● Console

    console.log
      [LeagueInstance] platinum instances balanced, no action needed

      at rebalanceInstances (src/services/leagueInstanceService.ts:123:13)

    console.log
      [LeagueInstance] champion instances balanced, no action needed

      at rebalanceInstances (src/services/leagueInstanceService.ts:123:13)

  ● League Instance Service › getLeagueInstanceStats › should calculate correct statistics

    expect(received).toBe(expected) // Object.is equality

    Expected: 150
    Received: 151

      136 |       const stats = await getLeagueInstanceStats('bronze');
      137 |       
    > 138 |       expect(stats.totalRobots).toBe(150);
          |                                 ^
      139 |       expect(stats.instances).toHaveLength(3);
      140 |       expect(stats.averagePerInstance).toBe(50);
      141 |       expect(stats.needsRebalancing).toBe(false); // All instances have exactly 50 robots

      at Object.<anonymous> (tests/leagueInstanceService.test.ts:138:33)

  ● League Instance Service › getLeagueInstanceStats › should detect when rebalancing is needed

    expect(received).toBe(expected) // Object.is equality

    Expected: 100
    Received: 101

      173 |       const stats = await getLeagueInstanceStats('bronze');
      174 |       
    > 175 |       expect(stats.totalRobots).toBe(100);
          |                                 ^
      176 |       expect(stats.averagePerInstance).toBe(50);
      177 |       expect(stats.needsRebalancing).toBe(true); // Deviation of 30 > threshold of 20
      178 |

      at Object.<anonymous> (tests/leagueInstanceService.test.ts:175:33)

  ● League Instance Service › getLeagueInstanceStats › should detect rebalancing needed when single instance exceeds MAX_ROBOTS_PER_INSTANCE

    expect(received).toBe(expected) // Object.is equality

    Expected: 331
    Received: 332

      208 |       const stats = await getLeagueInstanceStats('bronze');
      209 |       
    > 210 |       expect(stats.totalRobots).toBe(331);
          |                                 ^
      211 |       expect(stats.instances).toHaveLength(1);
      212 |       expect(stats.instances[0].currentRobots).toBe(331);
      213 |       expect(stats.averagePerInstance).toBe(331);

      at Object.<anonymous> (tests/leagueInstanceService.test.ts:210:33)

  ● League Instance Service › rebalanceInstances › should rebalance when imbalance exceeds threshold

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 2
    Received array:  [{"currentRobots": 80, "instanceNumber": 1, "isFull": false, "leagueId": "champion_1", "maxRobots": 100, "tier": "champion"}, {"currentRobots": 20, "instanceNumber": 2, "isFull": false, "leagueId": "champion_2", "maxRobots": 100, "tier": "champion"}]

      370 |       
      371 |       // With 100 robots and MAX_ROBOTS_PER_INSTANCE=100, should have exactly 1 instance
    > 372 |       expect(instances).toHaveLength(1);
          |                         ^
      373 |       expect(instances[0].currentRobots).toBe(100);
      374 |       
      375 |       // Verify no instance exceeds the limit

      at Object.<anonymous> (tests/leagueInstanceService.test.ts:372:25)

  ● League Instance Service › getRobotsInInstance › should return robots in correct order

    expect(received).toHaveLength(expected)

    Expected length: 3
    Received length: 4
    Received array:  [{"adaptiveAI": "1", "armorPlating": "1", "attackSpeed": "1", "battleReadiness": 100, "combatAlgorithms": "1", "combatPower": "1", "counterProtocols": "1", "createdAt": 2026-02-23T15:01:32.012Z, "criticalSystems": "1", "currentHP": 10, "currentLeague": "bronze", "currentShield": 2, "cyclesInCurrentLeague": 0, "damageDampeners": "1", "damageDealtLifetime": 0, "damageTaken": 0, "damageTakenLifetime": 0, "draws": 0, "elo": 1300, "evasionThrusters": "1", "fame": 0, "formationTactics": "1", "frameId": 1, "gyroStabilizers": "1", "hullIntegrity": "1", "hydraulicSystems": "1", "id": 553332, "imageUrl": null, "kills": 0, "leagueId": "bronze_1", "leaguePoints": 20, "loadoutType": "single", "logicCores": "1", "losses": 0, "mainWeaponId": null, "maxHP": 10, "maxShield": 2, "name": "Robot C", "offhandWeaponId": null, "paintJob": null, "penetration": "1", "powerCore": "1", "repairCost": 0, "servoMotors": "1", "shieldCapacity": "1", "stance": "balanced", "supportSystems": "1", "syncProtocols": "1", "targetingSystems": "1", "threatAnalysis": "1", "timesTaggedIn": 0, "timesTaggedOut": 0, "titles": null, "totalBattles": 0, "totalRepairsPaid": 0, "totalTagTeamBattles": 0, "totalTagTeamDraws": 0, "totalTagTeamLosses": 0, "totalTagTeamWins": 0, "updatedAt": 2026-02-23T15:01:32.012Z, "user": {"id": 38678, "username": "test_order_user"}, "userId": 38678, "weaponControl": "1", "wins": 0, "yieldThreshold": 10}, {"adaptiveAI": "1", "armorPlating": "1", "attackSpeed": "1", "battleReadiness": 100, "combatAlgorithms": "1", "combatPower": "1", "counterProtocols": "1", "createdAt": 2026-02-23T15:01:32.012Z, "criticalSystems": "1", "currentHP": 10, "currentLeague": "bronze", "currentShield": 2, "cyclesInCurrentLeague": 0, "damageDampeners": "1", "damageDealtLifetime": 0, "damageTaken": 0, "damageTakenLifetime": 0, "draws": 0, "elo": 1100, "evasionThrusters": "1", "fame": 0, "formationTactics": "1", "frameId": 1, "gyroStabilizers": "1", "hullIntegrity": "1", "hydraulicSystems": "1", "id": 553331, "imageUrl": null, "kills": 0, "leagueId": "bronze_1", "leaguePoints": 20, "loadoutType": "single", "logicCores": "1", "losses": 0, "mainWeaponId": null, "maxHP": 10, "maxShield": 2, "name": "Robot B", "offhandWeaponId": null, "paintJob": null, "penetration": "1", "powerCore": "1", "repairCost": 0, "servoMotors": "1", "shieldCapacity": "1", "stance": "balanced", "supportSystems": "1", "syncProtocols": "1", "targetingSystems": "1", "threatAnalysis": "1", "timesTaggedIn": 0, "timesTaggedOut": 0, "titles": null, "totalBattles": 0, "totalRepairsPaid": 0, "totalTagTeamBattles": 0, "totalTagTeamDraws": 0, "totalTagTeamLosses": 0, "totalTagTeamWins": 0, "updatedAt": 2026-02-23T15:01:32.012Z, "user": {"id": 38678, "username": "test_order_user"}, "userId": 38678, "weaponControl": "1", "wins": 0, "yieldThreshold": 10}, {"adaptiveAI": "1", "armorPlating": "1", "attackSpeed": "1", "battleReadiness": 100, "combatAlgorithms": "1", "combatPower": "1", "counterProtocols": "1", "createdAt": 2026-02-23T15:01:32.012Z, "criticalSystems": "1", "currentHP": 10, "currentLeague": "bronze", "currentShield": 2, "cyclesInCurrentLeague": 0, "damageDampeners": "1", "damageDealtLifetime": 0, "damageTaken": 0, "damageTakenLifetime": 0, "draws": 0, "elo": 1200, "evasionThrusters": "1", "fame": 0, "formationTactics": "1", "frameId": 1, "gyroStabilizers": "1", "hullIntegrity": "1", "hydraulicSystems": "1", "id": 553330, "imageUrl": null, "kills": 0, "leagueId": "bronze_1", "leaguePoints": 10, "loadoutType": "single", "logicCores": "1", "losses": 0, "mainWeaponId": null, "maxHP": 10, "maxShield": 2, "name": "Robot A", "offhandWeaponId": null, "paintJob": null, "penetration": "1", "powerCore": "1", "repairCost": 0, "servoMotors": "1", "shieldCapacity": "1", "stance": "balanced", "supportSystems": "1", "syncProtocols": "1", "targetingSystems": "1", "threatAnalysis": "1", "timesTaggedIn": 0, "timesTaggedOut": 0, "titles": null, "totalBattles": 0, "totalRepairsPaid": 0, "totalTagTeamBattles": 0, "totalTagTeamDraws": 0, "totalTagTeamLosses": 0, "totalTagTeamWins": 0, "updatedAt": 2026-02-23T15:01:32.012Z, "user": {"id": 38678, "username": "test_order_user"}, "userId": 38678, "weaponControl": "1", "wins": 0, "yieldThreshold": 10}, {"adaptiveAI": "1", "armorPlating": "1", "attackSpeed": "1", "battleReadiness": 100, "combatAlgorithms": "1", "combatPower": "1", "counterProtocols": "1", "createdAt": 2026-02-23T15:01:32.012Z, "criticalSystems": "1", "currentHP": 100, "currentLeague": "bronze", "currentShield": 20, "cyclesInCurrentLeague": 0, "damageDampeners": "1", "damageDealtLifetime": 0, "damageTaken": 0, "damageTakenLifetime": 0, "draws": 0, "elo": 1200, "evasionThrusters": "1", "fame": 0, "formationTactics": "1", "frameId": 1, "gyroStabilizers": "1", "hullIntegrity": "1", "hydraulicSystems": "1", "id": 553328, "imageUrl": null, "kills": 0, "leagueId": "bronze_1", "leaguePoints": 0, "loadoutType": "single", "logicCores": "1", "losses": 0, "mainWeaponId": null, "maxHP": 100, "maxShield": 20, "name": "Test Robot 1771858892011", "offhandWeaponId": null, "paintJob": null, "penetration": "1", "powerCore": "1", "repairCost": 0, "servoMotors": "1", "shieldCapacity": "1", "stance": "balanced", "supportSystems": "1", "syncProtocols": "1", "targetingSystems": "1", "threatAnalysis": "1", "timesTaggedIn": 0, "timesTaggedOut": 0, "titles": null, "totalBattles": 0, "totalRepairsPaid": 0, "totalTagTeamBattles": 0, "totalTagTeamDraws": 0, "totalTagTeamLosses": 0, "totalTagTeamWins": 0, "updatedAt": 2026-02-23T15:01:32.012Z, "user": {"id": 38677, "username": "testuser_1771858892009_uke42d"}, "userId": 38677, "weaponControl": "1", "wins": 0, "yieldThreshold": 10}]

      404 |       const robots = await getRobotsInInstance('bronze_1');
      405 |       
    > 406 |       expect(robots).toHaveLength(3);
          |                      ^
      407 |       // Should be ordered by league points DESC, then ELO DESC
      408 |       expect(robots[0].name).toBe('Robot C'); // 20 points, 1300 ELO
      409 |       expect(robots[1].name).toBe('Robot B'); // 20 points, 1100 ELO

      at Object.<anonymous> (tests/leagueInstanceService.test.ts:406:22)

FAIL tests/facilityRecommendationService.test.ts
  ● FacilityRecommendationService › generateRecommendations › should recommend repair bay for user with high repair costs

    User 38621 not found

      43 |
      44 |     if (!user) {
    > 45 |       throw new Error(`User ${userId} not found`);
         |             ^
      46 |     }
      47 |
      48 |     // Get current cycle number

      at FacilityRecommendationService.generateRecommendations (src/services/facilityRecommendationService.ts:45:13)
      at Object.<anonymous> (tests/facilityRecommendationService.test.ts:139:22)

  ● FacilityRecommendationService › generateRecommendations › should rank recommendations by projected ROI

    User 38633 not found

      43 |
      44 |     if (!user) {
    > 45 |       throw new Error(`User ${userId} not found`);
         |             ^
      46 |     }
      47 |
      48 |     // Get current cycle number

      at FacilityRecommendationService.generateRecommendations (src/services/facilityRecommendationService.ts:45:13)
      at Object.<anonymous> (tests/facilityRecommendationService.test.ts:212:22)

  ● FacilityRecommendationService › generateRecommendations › should recommend roster expansion when user is at capacity

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/testHelpers.ts:24:29

      21  * Creates a test robot for a given user
      22  */
      23 export async function createTestRobot(userId: number, name?: string) {
    → 24   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      22 |  */
      23 | export async function createTestRobot(userId: number, name?: string) {
    > 24 |   return await prisma.robot.create({
         |          ^
      25 |     data: {
      26 |       name: name || `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      27 |       userId,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/testHelpers.ts:24:10)
      at Object.<anonymous> (tests/facilityRecommendationService.test.ts:344:7)

FAIL tests/stanceAndYieldAPI.test.ts
  ● Console

    console.error
      Yield threshold update error: PrismaClientKnownRequestError: 
      Invalid `prisma.robot.update()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/robots.ts:850:45
      
        847 }
        848 
        849 // Update yield threshold
      → 850 const updatedRobot = await prisma.robot.update(
      An operation failed because it depends on one or more records that were required but not found. Record to update not found.
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/robots.ts:850:26 {
        code: 'P2025',
        clientVersion: '5.22.0',
        meta: { modelName: 'Robot', cause: 'Record to update not found.' }
      }

      862 |     });
      863 |   } catch (error) {
    > 864 |     console.error('Yield threshold update error:', error);
          |             ^
      865 |     res.status(500).json({ error: 'Internal server error' });
      866 |   }
      867 | });

      at src/routes/robots.ts:864:13

    console.error
      Yield threshold update error: PrismaClientKnownRequestError: 
      Invalid `prisma.robot.update()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/robots.ts:850:45
      
        847 }
        848 
        849 // Update yield threshold
      → 850 const updatedRobot = await prisma.robot.update(
      An operation failed because it depends on one or more records that were required but not found. Record to update not found.
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/robots.ts:850:26 {
        code: 'P2025',
        clientVersion: '5.22.0',
        meta: { modelName: 'Robot', cause: 'Record to update not found.' }
      }

      862 |     });
      863 |   } catch (error) {
    > 864 |     console.error('Yield threshold update error:', error);
          |             ^
      865 |     res.status(500).json({ error: 'Internal server error' });
      866 |   }
      867 | });

      at src/routes/robots.ts:864:13

  ● Stance and Yield Threshold API Endpoints › PATCH /api/robots/:id/stance › should update robot stance to offensive

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 404

       99 |         .send({ stance: 'offensive' });
      100 |
    > 101 |       expect(response.status).toBe(200);
          |                               ^
      102 |       expect(response.body.stance).toBe('offensive');
      103 |       expect(response.body.message).toContain('offensive');
      104 |     });

      at Object.<anonymous> (tests/stanceAndYieldAPI.test.ts:101:31)

  ● Stance and Yield Threshold API Endpoints › PATCH /api/robots/:id/stance › should reject invalid stance value

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/stanceAndYieldAPI.test.ts:73:36

      70 );
      71 
      72 // Create a test robot
    → 73 testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      71 |
      72 |     // Create a test robot
    > 73 |     testRobot = await prisma.robot.create({
         |                 ^
      74 |       data: {
      75 |         userId: testUser.id,
      76 |         name: `Test Robot ${Date.now()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/stanceAndYieldAPI.test.ts:73:17)

  ● Stance and Yield Threshold API Endpoints › PATCH /api/robots/:id/yield-threshold › should update yield threshold to 25

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      206 |         .send({ yieldThreshold: 25 });
      207 |
    > 208 |       expect(response.status).toBe(200);
          |                               ^
      209 |       expect(response.body.yieldThreshold).toBe(25);
      210 |       expect(response.body.message).toContain('25');
      211 |     });

      at Object.<anonymous> (tests/stanceAndYieldAPI.test.ts:208:31)

  ● Stance and Yield Threshold API Endpoints › PATCH /api/robots/:id/yield-threshold › should accept 0% yield threshold

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      217 |         .send({ yieldThreshold: 0 });
      218 |
    > 219 |       expect(response.status).toBe(200);
          |                               ^
      220 |       expect(response.body.yieldThreshold).toBe(0);
      221 |     });
      222 |

      at Object.<anonymous> (tests/stanceAndYieldAPI.test.ts:219:31)

  ● Stance and Yield Threshold API Endpoints › PATCH /api/robots/:id/yield-threshold › should handle decimal yield threshold by rounding

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 404

      238 |         .send({ yieldThreshold: 12.5 });
      239 |
    > 240 |       expect(response.status).toBe(200);
          |                               ^
      241 |       // Expect integer value (database will round/truncate)
      242 |       expect(response.body.yieldThreshold).toBe(12);
      243 |     });

      at Object.<anonymous> (tests/stanceAndYieldAPI.test.ts:240:31)

  ● Stance and Yield Threshold API Endpoints › PATCH /api/robots/:id/yield-threshold › should return 404 for non-existent robot

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/stanceAndYieldAPI.test.ts:73:36

      70 );
      71 
      72 // Create a test robot
    → 73 testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      71 |
      72 |     // Create a test robot
    > 73 |     testRobot = await prisma.robot.create({
         |                 ^
      74 |       data: {
      75 |         userId: testUser.id,
      76 |         name: `Test Robot ${Date.now()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/stanceAndYieldAPI.test.ts:73:17)

FAIL tests/tagTeamLeagueInstance.property.test.ts
  ● Tag Team League Instance - Property Tests › Property 21: League Instance Capacity › no instance ever exceeds maximum capacity of 50 teams

    Property failed after 1 tests
    { seed: -1253227198, path: "0:0", endOnFailure: true }
    Counterexample: [1,"bronze"]
    Shrunk 1 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    TypeError: Cannot read properties of null (reading 'id')

      82 |     const weapon = await prisma.weapon.findFirst();
      83 |     const weaponInv = await prisma.weaponInventory.create({
    > 84 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      85 |     });
      86 |
      87 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueInstance.property.test.ts:84:55)
      at createTestTeam (tests/tagTeamLeagueInstance.property.test.ts:113:20)
      at tests/tagTeamLeagueInstance.property.test.ts:171:28
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueInstance.property.test.ts:156:7)

  ● Tag Team League Instance - Property Tests › Property 21: League Instance Capacity › new instance is created when 51st team would be added

    Property failed after 1 tests
    { seed: 154800718, path: "0:0", endOnFailure: true }
    Counterexample: ["bronze"]
    Shrunk 1 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    TypeError: Cannot read properties of null (reading 'id')

      82 |     const weapon = await prisma.weapon.findFirst();
      83 |     const weaponInv = await prisma.weaponInventory.create({
    > 84 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      85 |     });
      86 |
      87 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueInstance.property.test.ts:84:55)
      at createTestTeam (tests/tagTeamLeagueInstance.property.test.ts:113:20)
      at tests/tagTeamLeagueInstance.property.test.ts:205:15
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueInstance.property.test.ts:193:7)

  ● Tag Team League Instance - Property Tests › Property 21: League Instance Capacity › instance assignment distributes teams correctly

    Property failed after 1 tests
    { seed: -1892823521, path: "0:0:0", endOnFailure: true }
    Counterexample: [51,"bronze"]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeamLeagueInstance.property.test.ts:83:52

      80 async function createTestRobot(elo: number = 1000) {
      81   // Get a weapon for the robot
      82   const weapon = await prisma.weapon.findFirst();
    → 83   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      81 |     // Get a weapon for the robot
      82 |     const weapon = await prisma.weapon.findFirst();
    > 83 |     const weaponInv = await prisma.weaponInventory.create({
         |                       ^
      84 |       data: { userId: testStableId, weaponId: weapon!.id },
      85 |     });
      86 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/tagTeamLeagueInstance.property.test.ts:83:23)
      at createTestTeam (tests/tagTeamLeagueInstance.property.test.ts:113:20)
      at tests/tagTeamLeagueInstance.property.test.ts:251:15
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueInstance.property.test.ts:238:7)

  ● Tag Team League Instance - Property Tests › Property 21: League Instance Capacity › instance capacity is enforced across all league tiers

    Property failed after 1 tests
    { seed: -1857637709, path: "0:0", endOnFailure: true }
    Counterexample: [[{"tier":"bronze","numTeams":1}]]
    Shrunk 1 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeamLeagueInstance.property.test.ts:83:52

      80 async function createTestRobot(elo: number = 1000) {
      81   // Get a weapon for the robot
      82   const weapon = await prisma.weapon.findFirst();
    → 83   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      81 |     // Get a weapon for the robot
      82 |     const weapon = await prisma.weapon.findFirst();
    > 83 |     const weaponInv = await prisma.weaponInventory.create({
         |                       ^
      84 |       data: { userId: testStableId, weaponId: weapon!.id },
      85 |     });
      86 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/tagTeamLeagueInstance.property.test.ts:83:23)
      at createTestTeam (tests/tagTeamLeagueInstance.property.test.ts:113:20)
      at tests/tagTeamLeagueInstance.property.test.ts:299:17
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueInstance.property.test.ts:282:7)

  ● Tag Team League Instance - Property Tests › Property 21: League Instance Capacity › assignTagTeamLeagueInstance never returns a full instance

    Property failed after 1 tests
    { seed: -168130077, path: "0:0:1:0:0:0:0:0:0", endOnFailure: true }
    Counterexample: ["bronze",1]
    Shrunk 8 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeamLeagueInstance.property.test.ts:83:52

      80 async function createTestRobot(elo: number = 1000) {
      81   // Get a weapon for the robot
      82   const weapon = await prisma.weapon.findFirst();
    → 83   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      81 |     // Get a weapon for the robot
      82 |     const weapon = await prisma.weapon.findFirst();
    > 83 |     const weaponInv = await prisma.weaponInventory.create({
         |                       ^
      84 |       data: { userId: testStableId, weaponId: weapon!.id },
      85 |     });
      86 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/tagTeamLeagueInstance.property.test.ts:83:23)
      at createTestTeam (tests/tagTeamLeagueInstance.property.test.ts:113:20)
      at tests/tagTeamLeagueInstance.property.test.ts:330:15
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueInstance.property.test.ts:323:7)

  ● Tag Team League Instance - Property Tests › Property 21: League Instance Capacity › instance numbers are sequential and start at 1

    Property failed after 1 tests
    { seed: 124590087, path: "0:0:0", endOnFailure: true }
    Counterexample: ["bronze",1]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeamLeagueInstance.property.test.ts:83:52

      80 async function createTestRobot(elo: number = 1000) {
      81   // Get a weapon for the robot
      82   const weapon = await prisma.weapon.findFirst();
    → 83   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      81 |     // Get a weapon for the robot
      82 |     const weapon = await prisma.weapon.findFirst();
    > 83 |     const weaponInv = await prisma.weaponInventory.create({
         |                       ^
      84 |       data: { userId: testStableId, weaponId: weapon!.id },
      85 |     });
      86 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/tagTeamLeagueInstance.property.test.ts:83:23)
      at createTestTeam (tests/tagTeamLeagueInstance.property.test.ts:113:20)
      at tests/tagTeamLeagueInstance.property.test.ts:360:15
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueInstance.property.test.ts:353:7)

  ● Tag Team League Instance - Property Tests › Property 21: League Instance Capacity › capacity enforcement works with concurrent team creation

    Property failed after 1 tests
    { seed: -1638561238, path: "0:0:0", endOnFailure: true }
    Counterexample: ["bronze",45]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeamLeagueInstance.property.test.ts:83:52

      80 async function createTestRobot(elo: number = 1000) {
      81   // Get a weapon for the robot
      82   const weapon = await prisma.weapon.findFirst();
    → 83   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      81 |     // Get a weapon for the robot
      82 |     const weapon = await prisma.weapon.findFirst();
    > 83 |     const weaponInv = await prisma.weaponInventory.create({
         |                       ^
      84 |       data: { userId: testStableId, weaponId: weapon!.id },
      85 |     });
      86 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/tagTeamLeagueInstance.property.test.ts:83:23)
      at createTestTeam (tests/tagTeamLeagueInstance.property.test.ts:113:20)
          at async Promise.all (index 13)
      at tests/tagTeamLeagueInstance.property.test.ts:400:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueInstance.property.test.ts:385:7)


  ● Test suite failed to run

    PrismaClientKnownRequestError: 
    Invalid `prisma.user.delete()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeamLeagueInstance.property.test.ts:47:31

      44   });
      45 }
      46 if (testStableId) {
    → 47   await prisma.user.delete(
    An operation failed because it depends on one or more records that were required but not found. Record to delete does not exist.

      45 |     }
      46 |     if (testStableId) {
    > 47 |       await prisma.user.delete({
         |       ^
      48 |         where: { id: testStableId },
      49 |       });
      50 |     }

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/tagTeamLeagueInstance.property.test.ts:47:7)

FAIL tests/eventLogger.test.ts
  ● EventLogger Service › Single Event Logging › should log a single event with correct sequence number

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 0
    Received array:  []

      42 |       });
      43 |
    > 44 |       expect(events).toHaveLength(1);
         |                      ^
      45 |       expect(events[0].eventType).toBe(EventType.CYCLE_START);
      46 |       expect(events[0].sequenceNumber).toBe(1);
      47 |       expect(events[0].payload).toEqual(payload);

      at Object.<anonymous> (tests/eventLogger.test.ts:44:22)

  ● EventLogger Service › Sequence Number Management › should maintain separate sequence numbers per cycle

    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at Object.<anonymous> (tests/eventLogger.test.ts:468:7)

FAIL tests/adminRobotStats.test.ts
  ● Admin Robot Statistics Endpoint › GET /api/admin/stats/robots › should require authentication

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/adminRobotStats.test.ts:102:40

       99 ];
      100 
      101 for (const data of robotData) {
    → 102   const robot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      100 |
      101 |     for (const data of robotData) {
    > 102 |       const robot = await prisma.robot.create({
          |                     ^
      103 |         data: {
      104 |           userId: adminUser.id,
      105 |           name: data.name,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/adminRobotStats.test.ts:102:21)

  ● Admin Robot Statistics Endpoint › GET /api/admin/stats/robots › should require admin role

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/adminRobotStats.test.ts:102:40

       99 ];
      100 
      101 for (const data of robotData) {
    → 102   const robot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      100 |
      101 |     for (const data of robotData) {
    > 102 |       const robot = await prisma.robot.create({
          |                     ^
      103 |         data: {
      104 |           userId: adminUser.id,
      105 |           name: data.name,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/adminRobotStats.test.ts:102:21)

  ● Admin Robot Statistics Endpoint › GET /api/admin/stats/robots › should return comprehensive robot statistics

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/adminRobotStats.test.ts:102:40

       99 ];
      100 
      101 for (const data of robotData) {
    → 102   const robot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      100 |
      101 |     for (const data of robotData) {
    > 102 |       const robot = await prisma.robot.create({
          |                     ^
      103 |         data: {
      104 |           userId: adminUser.id,
      105 |           name: data.name,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/adminRobotStats.test.ts:102:21)

  ● Admin Robot Statistics Endpoint › GET /api/admin/stats/robots › should include summary statistics

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/adminRobotStats.test.ts:102:40

       99 ];
      100 
      101 for (const data of robotData) {
    → 102   const robot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      100 |
      101 |     for (const data of robotData) {
    > 102 |       const robot = await prisma.robot.create({
          |                     ^
      103 |         data: {
      104 |           userId: adminUser.id,
      105 |           name: data.name,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/adminRobotStats.test.ts:102:21)

  ● Admin Robot Statistics Endpoint › GET /api/admin/stats/robots › should calculate attribute statistics correctly

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/adminRobotStats.test.ts:102:40

       99 ];
      100 
      101 for (const data of robotData) {
    → 102   const robot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      100 |
      101 |     for (const data of robotData) {
    > 102 |       const robot = await prisma.robot.create({
          |                     ^
      103 |         data: {
      104 |           userId: adminUser.id,
      105 |           name: data.name,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/adminRobotStats.test.ts:102:21)

  ● Admin Robot Statistics Endpoint › GET /api/admin/stats/robots › should detect outliers correctly

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/adminRobotStats.test.ts:102:40

       99 ];
      100 
      101 for (const data of robotData) {
    → 102   const robot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      100 |
      101 |     for (const data of robotData) {
    > 102 |       const robot = await prisma.robot.create({
          |                     ^
      103 |         data: {
      104 |           userId: adminUser.id,
      105 |           name: data.name,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/adminRobotStats.test.ts:102:21)

  ● Admin Robot Statistics Endpoint › GET /api/admin/stats/robots › should provide statistics by league tier

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/adminRobotStats.test.ts:102:40

       99 ];
      100 
      101 for (const data of robotData) {
    → 102   const robot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      100 |
      101 |     for (const data of robotData) {
    > 102 |       const robot = await prisma.robot.create({
          |                     ^
      103 |         data: {
      104 |           userId: adminUser.id,
      105 |           name: data.name,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/adminRobotStats.test.ts:102:21)

  ● Admin Robot Statistics Endpoint › GET /api/admin/stats/robots › should include top and bottom performers

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/adminRobotStats.test.ts:102:40

       99 ];
      100 
      101 for (const data of robotData) {
    → 102   const robot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      100 |
      101 |     for (const data of robotData) {
    > 102 |       const robot = await prisma.robot.create({
          |                     ^
      103 |         data: {
      104 |           userId: adminUser.id,
      105 |           name: data.name,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/adminRobotStats.test.ts:102:21)

  ● Admin Robot Statistics Endpoint › GET /api/admin/stats/robots › should include win rate analysis

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/adminRobotStats.test.ts:102:40

       99 ];
      100 
      101 for (const data of robotData) {
    → 102   const robot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      100 |
      101 |     for (const data of robotData) {
    > 102 |       const robot = await prisma.robot.create({
          |                     ^
      103 |         data: {
      104 |           userId: adminUser.id,
      105 |           name: data.name,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/adminRobotStats.test.ts:102:21)

FAIL tests/streamingRevenueFormula.property.test.ts (14.878 s)
  ● Property 6: Studio Multiplier Applies Stable-Wide › Property 6.2: Studio upgrade affects all robots in stable

    Property failed after 44 tests
    { seed: -1052348510, path: "43:0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,1,0,0,0,0]
    Shrunk 5 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:802:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:776:5)

  ● Property 6: Studio Multiplier Applies Stable-Wide › Property 6.3: All robots in stable use same studio multiplier

    Property failed after 1 tests
    { seed: -642930646, path: "0:0:0", endOnFailure: true }
    Counterexample: [0,3]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:899:27
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:881:5)

  ● Property 2: Streaming Revenue Awarded to All Battle Participants › Property 2: Both participants receive streaming revenue in non-bye battles

    Property failed after 3 tests
    { seed: 998785496, path: "2:1:0:0:0:0:0:0:0:0:0:0:0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0,0,0,0]
    Shrunk 17 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1029:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1005:5)

  ● Property 2: Streaming Revenue Awarded to All Battle Participants › Property 2.1: Both winner and loser receive streaming revenue

    Property failed after 1 tests
    { seed: -289407348, path: "0:0:0", endOnFailure: true }
    Counterexample: [0,0,0]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1117:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1096:5)

  ● Property 2: Streaming Revenue Awarded to All Battle Participants › Property 2.2: Streaming revenue is independent of battle outcome

    Property failed after 1 tests
    { seed: -157739632, path: "0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0,0]
    Shrunk 4 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1176:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1168:5)

  ● Property 2: Streaming Revenue Awarded to All Battle Participants › Property 2.3: New robots with no stats still receive base streaming revenue

    Property failed after 1 tests
    { seed: -2144628441, path: "0", endOnFailure: true }
    Counterexample: [null]
    Shrunk 0 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1228:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1223:5)

  ● Property 2: Streaming Revenue Awarded to All Battle Participants › Property 2.4: Both participants receive revenue even with different studio levels

    Property failed after 1 tests
    { seed: 522538163, path: "0:0:1:0:1:1", endOnFailure: true }
    Counterexample: [0,1,0,0]
    Shrunk 5 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1292:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1265:5)

  ● Property 3: No Streaming Revenue for Bye Matches › Property 3: No streaming revenue for bye matches

    Property failed after 1 tests
    { seed: 2016728100, path: "0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1405:25
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1390:5)

  ● Property 3: No Streaming Revenue for Bye Matches › Property 3.1: Veteran robots get no revenue from bye matches

    Property failed after 1 tests
    { seed: -1717141400, path: "0:0:0:0", endOnFailure: true }
    Counterexample: [1000,5000,5]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1451:25
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1436:5)

  ● Property 3: No Streaming Revenue for Bye Matches › Property 3.2: Bye match flag always results in null revenue

    Property failed after 1 tests
    { seed: 834500299, path: "0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1500:25
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1485:5)

  ● Property 3: No Streaming Revenue for Bye Matches › Property 3.3: New robots get null revenue from bye matches

    Property failed after 1 tests
    { seed: 1253555510, path: "0", endOnFailure: true }
    Counterexample: [null]
    Shrunk 0 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1543:25
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1538:5)

  ● Property 3: No Streaming Revenue for Bye Matches › Property 3.4: Max studio level does not override bye match rule

    Property failed after 1 tests
    { seed: -668734267, path: "0:0", endOnFailure: true }
    Counterexample: [0,0]
    Shrunk 1 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1577:25
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1563:5)

  ● Property 12: Tag Team Single Payment Per Team › Property 12: Each stable receives exactly one payment per Tag Team battle

    Property failed after 1 tests
    { seed: 404937345, path: "0:0:0:0:0:0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0,0,0,0,0,0,0,0]
    Shrunk 10 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1695:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1659:5)

  ● Property 12: Tag Team Single Payment Per Team › Property 12.1: Single payment even with identical robot stats

    Property failed after 1 tests
    { seed: 1629920805, path: "0:0:0", endOnFailure: true }
    Counterexample: [0,0,0]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1822:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1807:5)

  ● Property 12: Tag Team Single Payment Per Team › Property 12.2: Payment uses team max values, not sum of robots

    Property failed after 1 tests
    { seed: -1113572953, path: "0:0:0:0", endOnFailure: true }
    Counterexample: [100,100,100,100,0]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1906:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1889:5)

  ● Property 10: Tag Team Uses Maximum Values › Property 10: Tag Team uses maximum battles and fame from each team

    Property failed after 1 tests
    { seed: 1608382944, path: "0:0:0:0:0:0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0,0,0,0,0,0,0,0]
    Shrunk 10 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:2080:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2045:5)

  ● Property 10: Tag Team Uses Maximum Values › Property 10.1: Tag Team uses max battles from one robot and max fame from another

    Property failed after 1 tests
    { seed: 112835302, path: "0:0:0:0", endOnFailure: true }
    Counterexample: [100,1000,0]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:2202:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2187:5)

  ● Property 10: Tag Team Uses Maximum Values › Property 10.2: Tag Team with equal robot stats uses either robot

    Property failed after 1 tests
    { seed: 1919770136, path: "0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:2281:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2266:5)

  ● Property 10: Tag Team Uses Maximum Values › Property 10.3: Each team independently selects max values

    Property failed after 1 tests
    { seed: -1025627617, path: "0:0:0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0,0,0,0,0,0]
    Shrunk 7 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:2356:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2339:5)

  ● Property 10: Tag Team Uses Maximum Values › Property 10.4: Tag Team revenue benefits from max value selection

    Property failed after 1 tests
    { seed: -126478909, path: "0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,1,1,0]
    Shrunk 4 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:2434:29
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2414:5)

  ● Property 10: Tag Team Uses Maximum Values › Property 10.5: Tag Team with new robots uses base multipliers

    Property failed after 1 tests
    { seed: -1988319284, path: "0:0", endOnFailure: true }
    Counterexample: [0]
    Shrunk 1 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:2507:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2494:5)

  ● Property 11: Tag Team Separate Calculations › Property 11: Tag Team separate calculations use own team values

    Property failed after 2 tests
    { seed: 2006659310, path: "1:0:0:0:0:0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0,0,0,0,0,0,0,0]
    Shrunk 10 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:2653:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2620:5)

  ● Property 11: Tag Team Separate Calculations › Property 11.1: Higher stat team gets more revenue independently

    Property failed after 1 tests
    { seed: -1432056810, path: "0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,100,1000,0]
    Shrunk 5 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:2791:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2768:5)

  ● Property 11: Tag Team Separate Calculations › Property 11.2: Each team uses their own studio multiplier

    Property failed after 1 tests
    { seed: 887631697, path: "0:0:0:0:1:0:0", endOnFailure: true }
    Counterexample: [0,0,0,1]
    Shrunk 6 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:2881:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2854:5)

  ● Property 11: Tag Team Separate Calculations › Property 11.3: Team calculations are independent of opponent composition

    Property failed after 1 tests
    { seed: -206066021, path: "0:0:0:0:0:0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0,0,0,0,0,0,0,0]
    Shrunk 10 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:2982:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2949:5)

  ● Property 11: Tag Team Separate Calculations › Property 11.4: Both teams receive positive revenue independently

    Property failed after 1 tests
    { seed: 1478003478, path: "0:0:0:0:0:0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0,0,0,0,0,0,0,0]
    Shrunk 10 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:3087:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:3054:5)


  ● Test suite failed to run

    PrismaClientKnownRequestError: 
    Invalid `prisma.user.delete()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:620:29

      617 // Clean up test data
      618 await prisma.robot.deleteMany({ where: { userId: testUserId } });
      619 await prisma.facility.deleteMany({ where: { userId: testUserId } });
    → 620 await prisma.user.delete(
    An operation failed because it depends on one or more records that were required but not found. Record to delete does not exist.

      618 |     await prisma.robot.deleteMany({ where: { userId: testUserId } });
      619 |     await prisma.facility.deleteMany({ where: { userId: testUserId } });
    > 620 |     await prisma.user.delete({ where: { id: testUserId } });
          |     ^
      621 |     await prisma.$disconnect();
      622 |   });
      623 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:620:5)

  ● Test suite failed to run

    PrismaClientKnownRequestError: 
    Invalid `prisma.user.delete()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:988:29

      985 await prisma.robot.deleteMany({ where: { userId: testUserId2 } });
      986 await prisma.facility.deleteMany({ where: { userId: testUserId1 } });
      987 await prisma.facility.deleteMany({ where: { userId: testUserId2 } });
    → 988 await prisma.user.delete(
    An operation failed because it depends on one or more records that were required but not found. Record to delete does not exist.

      986 |     await prisma.facility.deleteMany({ where: { userId: testUserId1 } });
      987 |     await prisma.facility.deleteMany({ where: { userId: testUserId2 } });
    > 988 |     await prisma.user.delete({ where: { id: testUserId1 } });
          |     ^
      989 |     await prisma.user.delete({ where: { id: testUserId2 } });
      990 |     await prisma.$disconnect();
      991 |   });

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:988:5)

  ● Test suite failed to run

    PrismaClientKnownRequestError: 
    Invalid `prisma.user.delete()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:1375:29

      1372 // Clean up test data
      1373 await prisma.robot.deleteMany({ where: { userId: testUserId } });
      1374 await prisma.facility.deleteMany({ where: { userId: testUserId } });
    → 1375 await prisma.user.delete(
    An operation failed because it depends on one or more records that were required but not found. Record to delete does not exist.

      1373 |     await prisma.robot.deleteMany({ where: { userId: testUserId } });
      1374 |     await prisma.facility.deleteMany({ where: { userId: testUserId } });
    > 1375 |     await prisma.user.delete({ where: { id: testUserId } });
           |     ^
      1376 |     await prisma.$disconnect();
      1377 |   });
      1378 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1375:5)

  ● Test suite failed to run

    PrismaClientKnownRequestError: 
    Invalid `prisma.user.delete()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:1641:29

      1638 await prisma.robot.deleteMany({ where: { userId: testUser2Id } });
      1639 await prisma.facility.deleteMany({ where: { userId: testUser1Id } });
      1640 await prisma.facility.deleteMany({ where: { userId: testUser2Id } });
    → 1641 await prisma.user.delete(
    An operation failed because it depends on one or more records that were required but not found. Record to delete does not exist.

      1639 |     await prisma.facility.deleteMany({ where: { userId: testUser1Id } });
      1640 |     await prisma.facility.deleteMany({ where: { userId: testUser2Id } });
    > 1641 |     await prisma.user.delete({ where: { id: testUser1Id } });
           |     ^
      1642 |     await prisma.user.delete({ where: { id: testUser2Id } });
      1643 |     await prisma.$disconnect();
      1644 |   });

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1641:5)

  ● Test suite failed to run

    PrismaClientKnownRequestError: 
    Invalid `prisma.user.delete()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:2027:29

      2024 await prisma.robot.deleteMany({ where: { userId: testUserId2 } });
      2025 await prisma.facility.deleteMany({ where: { userId: testUserId1 } });
      2026 await prisma.facility.deleteMany({ where: { userId: testUserId2 } });
    → 2027 await prisma.user.delete(
    An operation failed because it depends on one or more records that were required but not found. Record to delete does not exist.

      2025 |     await prisma.facility.deleteMany({ where: { userId: testUserId1 } });
      2026 |     await prisma.facility.deleteMany({ where: { userId: testUserId2 } });
    > 2027 |     await prisma.user.delete({ where: { id: testUserId1 } });
           |     ^
      2028 |     await prisma.user.delete({ where: { id: testUserId2 } });
      2029 |     await prisma.$disconnect();
      2030 |   });

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2027:5)

  ● Test suite failed to run

    PrismaClientKnownRequestError: 
    Invalid `prisma.user.delete()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:2602:29

      2599 await prisma.robot.deleteMany({ where: { userId: testUserId2 } });
      2600 await prisma.facility.deleteMany({ where: { userId: testUserId1 } });
      2601 await prisma.facility.deleteMany({ where: { userId: testUserId2 } });
    → 2602 await prisma.user.delete(
    An operation failed because it depends on one or more records that were required but not found. Record to delete does not exist.

      2600 |     await prisma.facility.deleteMany({ where: { userId: testUserId1 } });
      2601 |     await prisma.facility.deleteMany({ where: { userId: testUserId2 } });
    > 2602 |     await prisma.user.delete({ where: { id: testUserId1 } });
           |     ^
      2603 |     await prisma.user.delete({ where: { id: testUserId2 } });
      2604 |     await prisma.$disconnect();
      2605 |   });

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2602:5)

FAIL tests/queryService.test.ts
  ● QueryService › queryEvents › should query events by cycle number

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 0
    Received array:  []

      39 |       const result = await queryService.queryEvents({ cycleNumber: 2 });
      40 |
    > 41 |       expect(result.events).toHaveLength(1);
         |                             ^
      42 |       expect(result.events[0].cycleNumber).toBe(2);
      43 |       expect(result.total).toBe(1);
      44 |       expect(result.hasMore).toBe(false);

      at Object.<anonymous> (tests/queryService.test.ts:41:29)

  ● QueryService › queryEvents › should query events by cycle range

    expect(received).toHaveLength(expected)

    Expected length: 3
    Received length: 7
    Received array:  [{"cycleNumber": 2, "eventTimestamp": 2026-02-23T15:01:32.107Z, "eventType": "cycle_start", "id": 2116845n, "metadata": null, "payload": {"timestamp": "2026-02-23T15:01:32.107Z", "triggerType": "manual"}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"cycleNumber": 3, "eventTimestamp": 2026-02-23T15:01:32.110Z, "eventType": "cycle_start", "id": 2116847n, "metadata": null, "payload": {"timestamp": "2026-02-23T15:01:32.110Z", "triggerType": "manual"}, "robotId": null, "sequenceNumber": 289, "userId": null}, {"cycleNumber": 3, "eventTimestamp": 2026-02-23T15:01:32.111Z, "eventType": "credit_change", "id": 2116849n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 291, "userId": 7}, {"cycleNumber": 3, "eventTimestamp": 2026-02-23T15:01:32.115Z, "eventType": "credit_change", "id": 2116853n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 292, "userId": 1}, {"cycleNumber": 3, "eventTimestamp": 2026-02-23T15:01:32.119Z, "eventType": "credit_change", "id": 2116858n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 293, "userId": 5}, {"cycleNumber": 4, "eventTimestamp": 2026-02-23T15:01:32.113Z, "eventType": "cycle_start", "id": 2116851n, "metadata": null, "payload": {"timestamp": "2026-02-23T15:01:32.112Z", "triggerType": "manual"}, "robotId": null, "sequenceNumber": 1, "userId": null}, {"cycleNumber": 4, "eventTimestamp": 2026-02-23T15:01:32.116Z, "eventType": "credit_change", "id": 2116854n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 644, "userId": 6}]

      57 |       const result = await queryService.queryEvents({ cycleRange: [2, 4] });
      58 |
    > 59 |       expect(result.events).toHaveLength(3);
         |                             ^
      60 |       expect(result.events[0].cycleNumber).toBe(2);
      61 |       expect(result.events[2].cycleNumber).toBe(4);
      62 |       expect(result.total).toBe(3);

      at Object.<anonymous> (tests/queryService.test.ts:59:29)

  ● QueryService › queryEvents › should query events by event type

    expect(received).toHaveLength(expected)

    Expected length: 2
    Received length: 1
    Received array:  [{"cycleNumber": 173049, "eventTimestamp": 2026-02-23T15:01:32.152Z, "eventType": "cycle_start", "id": 2116897n, "metadata": null, "payload": {"test": "data", "value": 123}, "robotId": null, "sequenceNumber": 1, "userId": null}]

      116 |       });
      117 |
    > 118 |       expect(result.events).toHaveLength(2);
          |                             ^
      119 |       expect(result.events.every(e => e.eventType === 'cycle_start')).toBe(true);
      120 |     });
      121 |

      at Object.<anonymous> (tests/queryService.test.ts:118:29)

  ● QueryService › queryEvents › should query events by multiple event types

    expect(received).toHaveLength(expected)

    Expected length: 2
    Received length: 0
    Received array:  []

      134 |       });
      135 |
    > 136 |       expect(result.events).toHaveLength(2);
          |                             ^
      137 |       expect(result.events.some(e => e.eventType === 'cycle_start')).toBe(true);
      138 |       expect(result.events.some(e => e.eventType === 'cycle_complete')).toBe(true);
      139 |     });

      at Object.<anonymous> (tests/queryService.test.ts:136:29)

  ● QueryService › queryEvents › should support pagination with limit and offset

    expect(received).toBe(expected) // Object.is equality

    Expected: 10
    Received: 14

      151 |       const page1 = await queryService.queryEvents({ limit: 5, offset: 0 });
      152 |       expect(page1.events).toHaveLength(5);
    > 153 |       expect(page1.total).toBe(10);
          |                           ^
      154 |       expect(page1.hasMore).toBe(true);
      155 |
      156 |       // Get second page (5 events)

      at Object.<anonymous> (tests/queryService.test.ts:153:27)

  ● QueryService › queryEvents › should support sorting by timestamp

    expect(received).toHaveLength(expected)

    Expected length: 3
    Received length: 7
    Received array:  [{"cycleNumber": 6, "eventTimestamp": 2026-02-23T15:01:32.238Z, "eventType": "cycle_step_complete", "id": 2116992n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 211, "userId": null}, {"cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.237Z, "eventType": "credit_change", "id": 2116991n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 595, "userId": 6}, {"cycleNumber": 5, "eventTimestamp": 2026-02-23T15:01:32.236Z, "eventType": "cycle_step_complete", "id": 2116990n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"cycleNumber": 4, "eventTimestamp": 2026-02-23T15:01:32.235Z, "eventType": "cycle_step_complete", "id": 2116987n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"cycleNumber": 3, "eventTimestamp": 2026-02-23T15:01:32.235Z, "eventType": "cycle_start", "id": 2116988n, "metadata": null, "payload": {"timestamp": "2026-02-23T15:01:32.235Z", "triggerType": "manual"}, "robotId": null, "sequenceNumber": 291, "userId": null}, {"cycleNumber": 6, "eventTimestamp": 2026-02-23T15:01:32.235Z, "eventType": "credit_change", "id": 2116989n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 225, "userId": 5}, {"cycleNumber": 3, "eventTimestamp": 2026-02-23T15:01:32.233Z, "eventType": "cycle_step_complete", "id": 2116985n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}]

      179 |       });
      180 |
    > 181 |       expect(result.events).toHaveLength(3);
          |                             ^
      182 |       expect(result.events[0].cycleNumber).toBe(3);
      183 |       expect(result.events[2].cycleNumber).toBe(1);
      184 |     });

      at Object.<anonymous> (tests/queryService.test.ts:181:29)

  ● QueryService › getEventsByCycle › should get all events for a specific cycle

    expect(received).toHaveLength(expected)

    Expected length: 3
    Received length: 4
    Received array:  [{"cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.262Z, "eventType": "cycle_start", "id": 2117024n, "metadata": null, "payload": {"timestamp": "2026-02-23T15:01:32.262Z", "triggerType": "manual"}, "robotId": null, "sequenceNumber": 4, "userId": null}, {"cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.266Z, "eventType": "cycle_step_complete", "id": 2117028n, "metadata": null, "payload": {"duration": 100, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 5, "userId": null}, {"cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.271Z, "eventType": "cycle_complete", "id": 2117032n, "metadata": null, "payload": {"timestamp": "2026-02-23T15:01:32.271Z", "totalDuration": 100}, "robotId": null, "sequenceNumber": 6, "userId": null}, {"cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.263Z, "eventType": "credit_change", "id": 2117023n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 598, "userId": 6}]

      221 |       const events = await queryService.getEventsByCycle(1);
      222 |
    > 223 |       expect(events).toHaveLength(3);
          |                      ^
      224 |       expect(events.every(e => e.cycleNumber === 1)).toBe(true);
      225 |     });
      226 |   });

      at Object.<anonymous> (tests/queryService.test.ts:223:22)

  ● QueryService › getEventsByUser › should get all events for a specific user

    expect(received).toHaveLength(expected)

    Expected length: 3
    Received length: 4
    Received array:  [{"cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.301Z, "eventType": "credit_change", "id": 2117041n, "metadata": null, "payload": {"amount": 100, "newBalance": 1100, "source": "battle"}, "robotId": null, "sequenceNumber": 1, "userId": 5}, {"cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.316Z, "eventType": "prestige_change", "id": 2117047n, "metadata": null, "payload": {"amount": 10, "newTotal": 110, "source": "battle"}, "robotId": null, "sequenceNumber": 2, "userId": 5}, {"cycleNumber": 2, "eventTimestamp": 2026-02-23T15:01:32.307Z, "eventType": "credit_change", "id": 2117044n, "metadata": null, "payload": {"amount": 200, "newBalance": 1300, "source": "battle"}, "robotId": null, "sequenceNumber": 8, "userId": 5}, {"cycleNumber": 3, "eventTimestamp": 2026-02-23T15:01:32.303Z, "eventType": "credit_change", "id": 2117042n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 317, "userId": 5}]

      239 |       const events = await queryService.getEventsByUser(userId);
      240 |
    > 241 |       expect(events).toHaveLength(3);
          |                      ^
      242 |       expect(events.every(e => e.userId === userId)).toBe(true);
      243 |     });
      244 |

      at Object.<anonymous> (tests/queryService.test.ts:241:22)

  ● QueryService › getPaginatedEvents › should paginate events correctly

    expect(received).toHaveLength(expected)

    Expected length: 10
    Received length: 9
    Received array:  [{"cycleNumber": 25, "eventTimestamp": 2026-02-23T15:01:32.447Z, "eventType": "cycle_start", "id": 2117192n, "metadata": null, "payload": {"timestamp": "2026-02-23T15:01:32.445Z", "triggerType": "manual"}, "robotId": null, "sequenceNumber": 1, "userId": null}, {"cycleNumber": 78, "eventTimestamp": 2026-02-23T15:01:32.438Z, "eventType": "cycle_step_complete", "id": 2117179n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"cycleNumber": 79, "eventTimestamp": 2026-02-23T15:01:32.440Z, "eventType": "cycle_step_complete", "id": 2117182n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"cycleNumber": 80, "eventTimestamp": 2026-02-23T15:01:32.441Z, "eventType": "cycle_step_complete", "id": 2117184n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"cycleNumber": 81, "eventTimestamp": 2026-02-23T15:01:32.443Z, "eventType": "cycle_step_complete", "id": 2117187n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"cycleNumber": 82, "eventTimestamp": 2026-02-23T15:01:32.444Z, "eventType": "cycle_step_complete", "id": 2117189n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"cycleNumber": 83, "eventTimestamp": 2026-02-23T15:01:32.447Z, "eventType": "cycle_step_complete", "id": 2117193n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"cycleNumber": 84, "eventTimestamp": 2026-02-23T15:01:32.450Z, "eventType": "cycle_step_complete", "id": 2117195n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"cycleNumber": 85, "eventTimestamp": 2026-02-23T15:01:32.454Z, "eventType": "cycle_step_complete", "id": 2117197n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}]

      310 |       // Get page 2
      311 |       const page2 = await queryService.getPaginatedEvents({}, 2, 10);
    > 312 |       expect(page2.events).toHaveLength(10);
          |                            ^
      313 |       expect(page2.hasMore).toBe(true);
      314 |
      315 |       // Get page 3

      at Object.<anonymous> (tests/queryService.test.ts:312:28)

  ● QueryService › getEventStatistics › should calculate event statistics

    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: 4

      338 |       const stats = await queryService.getEventStatistics([1, 2]);
      339 |
    > 340 |       expect(stats.totalEvents).toBe(5);
          |                                 ^
      341 |       expect(stats.eventsByType['cycle_start']).toBe(2);
      342 |       expect(stats.eventsByType['credit_change']).toBe(2);
      343 |       expect(stats.eventsByType['attribute_upgrade']).toBe(1);

      at Object.<anonymous> (tests/queryService.test.ts:340:33)

  ● QueryService › getRecentEvents › should get most recent events

    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: 101

      362 |
      363 |       expect(recent).toHaveLength(3);
    > 364 |       expect(recent[0].cycleNumber).toBe(5); // Most recent first
          |                                     ^
      365 |       expect(recent[2].cycleNumber).toBe(3);
      366 |     });
      367 |   });

      at Object.<anonymous> (tests/queryService.test.ts:364:37)

FAIL tests/cycleExecutionTiming.test.ts
  ● Cycle Execution Timing › Complete cycle timing flow › should log complete cycle with start, steps, and complete events

    expect(received).toHaveLength(expected)

    Expected length: 5
    Received length: 9
    Received array:  [{"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.612Z, "eventType": "cycle_start", "id": 2117344n, "metadata": null, "payload": {"timestamp": "2026-02-23T15:01:32.611Z", "triggerType": "manual"}, "robotId": null, "sequenceNumber": 1, "userId": null}, {"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.613Z, "eventType": "cycle_step_complete", "id": 2117347n, "metadata": null, "payload": {"duration": 1000, "stepName": "execute_battles", "stepNumber": 1, "summary": {"battles": 5}}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.615Z, "eventType": "cycle_step_complete", "id": 2117350n, "metadata": null, "payload": {"duration": 500, "stepName": "repair_robots", "stepNumber": 2, "summary": {"repaired": 10}}, "robotId": null, "sequenceNumber": 3, "userId": null}, {"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.616Z, "eventType": "cycle_step_complete", "id": 2117353n, "metadata": null, "payload": {"duration": 300, "stepName": "matchmaking", "stepNumber": 3, "summary": {"matches": 8}}, "robotId": null, "sequenceNumber": 4, "userId": null}, {"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.618Z, "eventType": "cycle_complete", "id": 2117356n, "metadata": null, "payload": {"timestamp": "2026-02-23T15:01:32.618Z", "totalDuration": 1800}, "robotId": null, "sequenceNumber": 5, "userId": null}, {"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.611Z, "eventType": "credit_change", "id": 2117342n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 640, "userId": 6}, {"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.617Z, "eventType": "credit_change", "id": 2117354n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 641, "userId": 1}, {"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.618Z, "eventType": "credit_change", "id": 2117357n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 642, "userId": 1}, {"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.620Z, "eventType": "credit_change", "id": 2117360n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 643, "userId": 1}]

      182 |       });
      183 |       
    > 184 |       expect(allEvents).toHaveLength(5);
          |                         ^
      185 |       expect(allEvents[0].eventType).toBe('cycle_start');
      186 |       expect(allEvents[1].eventType).toBe('cycle_step_complete');
      187 |       expect(allEvents[2].eventType).toBe('cycle_step_complete');

      at Object.<anonymous> (tests/cycleExecutionTiming.test.ts:184:25)

  ● Cycle Execution Timing › Step duration recording › should record accurate step durations

    expect(received).toHaveLength(expected)

    Expected length: 4
    Received length: 3
    Received array:  [{"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.648Z, "eventType": "cycle_step_complete", "id": 2117390n, "metadata": null, "payload": {"duration": 250, "stepName": "step2", "stepNumber": 2, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.650Z, "eventType": "cycle_step_complete", "id": 2117393n, "metadata": null, "payload": {"duration": 500, "stepName": "step3", "stepNumber": 3, "summary": {}}, "robotId": null, "sequenceNumber": 3, "userId": null}, {"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.651Z, "eventType": "cycle_step_complete", "id": 2117398n, "metadata": null, "payload": {"duration": 1000, "stepName": "step4", "stepNumber": 4, "summary": {}}, "robotId": null, "sequenceNumber": 4, "userId": null}]

      233 |       });
      234 |       
    > 235 |       expect(events).toHaveLength(durations.length);
          |                      ^
      236 |       events.forEach((event, index) => {
      237 |         expect((event.payload as any).duration).toBe(durations[index]);
      238 |       });

      at Object.<anonymous> (tests/cycleExecutionTiming.test.ts:235:22)

  ● Cycle Execution Timing › Step duration recording › should sum step durations approximately equal to total cycle duration

    expect(received).toBe(expected) // Object.is equality

    Expected: 2000
    Received: 0

      273 |       
      274 |       const sumOfSteps = stepEvents.reduce((sum, e) => sum + ((e.payload as any).duration as number), 0);
    > 275 |       expect(sumOfSteps).toBe((completeEvent?.payload as any).totalDuration);
          |                          ^
      276 |     });
      277 |   });
      278 |

      at Object.<anonymous> (tests/cycleExecutionTiming.test.ts:275:26)

FAIL tests/facility.test.ts
  ● Facility Routes › POST /api/facility/upgrade › should handle upgrade attempt when at max level

    expect(received).toContain(expected) // indexOf

    Expected value: 404
    Received array: [200, 400, 403]

      118 |
      119 |       // Should either succeed, indicate max level reached, or insufficient credits
    > 120 |       expect([200, 400, 403]).toContain(response.status);
          |                               ^
      121 |       
      122 |       if (response.status === 400) {
      123 |         // Accept either max level or insufficient credits as valid responses

      at Object.<anonymous> (tests/facility.test.ts:120:31)

FAIL tests/battleEventLogging.test.ts
  ● Console

    console.log
      [Streaming] TestBot1_1771858892455 earned ₡1,000 from Battle #60892

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] TestBot2_1771858892455 earned ₡1,001 from Battle #60892

      at processBattle (src/services/battleOrchestrator.ts:667:15)

  ● Battle Event Logging Integration › should log battle_complete event when a battle is processed

    PrismaClientKnownRequestError: 
    Invalid `prisma.scheduledMatch.update()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:803:31

      800 // No need to update Battle table
      801 
      802 // Update scheduled match
    → 803 await prisma.scheduledMatch.update(
    An operation failed because it depends on one or more records that were required but not found. Record to update not found.

      801 |   
      802 |   // Update scheduled match
    > 803 |   await prisma.scheduledMatch.update({
          |   ^
      804 |     where: { id: scheduledMatch.id },
      805 |     data: {
      806 |       status: 'completed',

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at processBattle (src/services/battleOrchestrator.ts:803:3)
      at Object.<anonymous> (tests/battleEventLogging.test.ts:120:20)

  ● Battle Event Logging Integration › should maintain Battle table records alongside event logs

    PrismaClientKnownRequestError: 
    Invalid `prisma.battle.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:397:38

      394 }
      395 
      396 // Create battle record
    → 397 const battle = await prisma.battle.create(
    Foreign key constraint violated: `battles_robot1_id_fkey (index)`

      395 |   
      396 |   // Create battle record
    > 397 |   const battle = await prisma.battle.create({
          |                  ^
      398 |     data: {
      399 |       robot1Id: robot1.id,
      400 |       robot2Id: robot2.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createBattleRecord (src/services/battleOrchestrator.ts:397:18)
      at processBattle (src/services/battleOrchestrator.ts:641:18)
      at Object.<anonymous> (tests/battleEventLogging.test.ts:163:20)

PASS tests/weaponInventory.test.ts
FAIL tests/tournamentStreamingRevenue.test.ts
  ● Tournament Streaming Revenue › Tournament Battle Streaming Revenue › should award streaming revenue to both participants in a tournament battle

    PrismaClientKnownRequestError: 
    Invalid `prisma.battle.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/tournamentBattleOrchestrator.ts:403:38

      400 });
      401 
      402 // Create battle record
    → 403 const battle = await prisma.battle.create(
    Foreign key constraint violated: `battles_robot1_id_fkey (index)`

      401 |
      402 |   // Create battle record
    > 403 |   const battle = await prisma.battle.create({
          |                  ^
      404 |     data: {
      405 |       robot1Id: robot1.id,
      406 |       robot2Id: robot2.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTournamentBattleRecord (src/services/tournamentBattleOrchestrator.ts:403:18)
      at processTournamentBattle (src/services/tournamentBattleOrchestrator.ts:109:18)
      at Object.<anonymous> (tests/tournamentStreamingRevenue.test.ts:198:22)

  ● Tournament Streaming Revenue › Tournament Battle Streaming Revenue › should not award streaming revenue for bye matches

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tournamentStreamingRevenue.test.ts:239:54

      236 const testUser1Id = testUserIds[0];
      237 
      238 // Create a robot for bye match
    → 239 const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      237 |
      238 |       // Create a robot for bye match
    > 239 |       const weaponInv = await prisma.weaponInventory.create({
          |                         ^
      240 |         data: { userId: testUser1Id, weaponId: practiceSword.id },
      241 |       });
      242 |       testWeaponInvIds.push(weaponInv.id);

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/tournamentStreamingRevenue.test.ts:239:25)

FAIL tests/battleOrchestrator.test.ts
  ● Console

    console.log
      [Streaming] Test Fighter 1 earned ₡1,000 from Battle #60890

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] Test Fighter 2 earned ₡1,001 from Battle #60890

      at processBattle (src/services/battleOrchestrator.ts:667:15)

    console.log
      [Battle] League: bronze | Test Fighter 1 (User 38693) vs Test Fighter 2 (User 38693) | Winner: Test Fighter 2 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2 | Kill: Test Fighter 2

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Battle] League: bronze | Player Robot (User 38693) vs Bye Robot (User 38695) | Winner: Player Robot | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0 | Kill: Player Robot

      at processBattle (src/services/battleOrchestrator.ts:821:11)

    console.log
      [Streaming] Killer Robot earned ₡1,000 from Battle #60893

      at processBattle (src/services/battleOrchestrator.ts:663:15)

    console.log
      [Streaming] Victim Robot earned ₡1,001 from Battle #60893

      at processBattle (src/services/battleOrchestrator.ts:667:15)

  ● Battle Orchestrator › processBattle › should handle bye-robot battles correctly

    PrismaClientKnownRequestError: 
    Invalid `prisma.user.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/battleOrchestrator.test.ts:70:23

      67 await prisma.weaponInventory.deleteMany({
      68   where: { userId: testUser.id },
      69 });
    → 70 await prisma.user.deleteMany(
    Foreign key constraint violated: `battles_robot1_id_fkey (index)`

      68 |       where: { userId: testUser.id },
      69 |     });
    > 70 |     await prisma.user.deleteMany({
         |     ^
      71 |       where: { 
      72 |         id: { not: testUser.id },
      73 |       },

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/battleOrchestrator.test.ts:70:5)

  ● Battle Orchestrator › processBattle › should increment kills when a robot destroys its opponent

    PrismaClientKnownRequestError: 
    Invalid `prisma.battleParticipant.update()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:686:34

      683   },
      684 });
      685 
    → 686 await prisma.battleParticipant.update(
    An operation failed because it depends on one or more records that were required but not found. Record to update not found.

      684 |   });
      685 |   
    > 686 |   await prisma.battleParticipant.update({
          |   ^
      687 |     where: {
      688 |       battleId_robotId: {
      689 |         battleId: battle.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at processBattle (src/services/battleOrchestrator.ts:686:3)
      at Object.<anonymous> (tests/battleOrchestrator.test.ts:343:22)

  ● Battle Orchestrator › executeScheduledBattles › should execute multiple scheduled battles

    PrismaClientKnownRequestError: 
    Invalid `prisma.scheduledMatch.createMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/battleOrchestrator.test.ts:407:35

      404 
      405 // Create 2 scheduled matches
      406 const scheduledTime = new Date();
    → 407 await prisma.scheduledMatch.createMany(
    Foreign key constraint violated: `scheduled_matches_robot1_id_fkey (index)`

      405 |       // Create 2 scheduled matches
      406 |       const scheduledTime = new Date();
    > 407 |       await prisma.scheduledMatch.createMany({
          |       ^
      408 |         data: [
      409 |           {
      410 |             robot1Id: robots[0].id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/battleOrchestrator.test.ts:407:7)

  ● Battle Orchestrator › Streaming Revenue Integration › should calculate and award streaming revenue after battle

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/battleOrchestrator.test.ts:448:55

      445 describe('Streaming Revenue Integration', () => {
      446   it('should calculate and award streaming revenue after battle', async () => {
      447     // Create test robots with some fame and battles
    → 448     const weaponInv1 = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      446 |     it('should calculate and award streaming revenue after battle', async () => {
      447 |       // Create test robots with some fame and battles
    > 448 |       const weaponInv1 = await prisma.weaponInventory.create({
          |                          ^
      449 |         data: { userId: testUser.id, weaponId: practiceSword.id },
      450 |       });
      451 |       const weaponInv2 = await prisma.weaponInventory.create({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/battleOrchestrator.test.ts:448:26)

  ● Battle Orchestrator › Streaming Revenue Integration › should not award streaming revenue for bye matches

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/battleOrchestrator.test.ts:525:54

      522 
      523 it('should not award streaming revenue for bye matches', async () => {
      524   // Create player robot
    → 525   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      523 |     it('should not award streaming revenue for bye matches', async () => {
      524 |       // Create player robot
    > 525 |       const weaponInv = await prisma.weaponInventory.create({
          |                         ^
      526 |         data: { userId: testUser.id, weaponId: practiceSword.id },
      527 |       });
      528 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/battleOrchestrator.test.ts:525:25)

  ● Battle Orchestrator › Streaming Revenue Integration › should add streaming revenue to audit log

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/battleOrchestrator.test.ts:618:55

      615 
      616 it('should add streaming revenue to audit log', async () => {
      617   // Create test robots
    → 618   const weaponInv1 = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      616 |     it('should add streaming revenue to audit log', async () => {
      617 |       // Create test robots
    > 618 |       const weaponInv1 = await prisma.weaponInventory.create({
          |                          ^
      619 |         data: { userId: testUser.id, weaponId: practiceSword.id },
      620 |       });
      621 |       const weaponInv2 = await prisma.weaponInventory.create({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/battleOrchestrator.test.ts:618:26)

  ● Battle Orchestrator › Streaming Revenue Integration › should log streaming revenue to terminal

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/battleOrchestrator.test.ts:696:55

      693 
      694 it('should log streaming revenue to terminal', async () => {
      695   // Create test robots
    → 696   const weaponInv1 = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      694 |     it('should log streaming revenue to terminal', async () => {
      695 |       // Create test robots
    > 696 |       const weaponInv1 = await prisma.weaponInventory.create({
          |                          ^
      697 |         data: { userId: testUser.id, weaponId: practiceSword.id },
      698 |       });
      699 |       const weaponInv2 = await prisma.weaponInventory.create({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/battleOrchestrator.test.ts:696:26)

FAIL tests/finances.test.ts
  ● Finances Routes › GET /api/finances/daily › should get daily financial report with auth

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › GET /api/finances/daily › should return 401 without authentication

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › GET /api/finances/summary › should get financial summary with auth

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › GET /api/finances/summary › should return 401 without authentication

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › GET /api/finances/operating-costs › should get operating costs with auth

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › GET /api/finances/operating-costs › should return 401 without authentication

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › GET /api/finances/revenue-streams › should get revenue streams with auth

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › GET /api/finances/revenue-streams › should return 401 without authentication

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › GET /api/finances/projections › should get financial projections with auth

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › GET /api/finances/projections › should return 401 without authentication

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › GET /api/finances/per-robot › should get per-robot financial report with auth

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › GET /api/finances/per-robot › should return 401 without authentication

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › POST /api/finances/roi-calculator › should return 400 without required fields

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › POST /api/finances/roi-calculator › should calculate ROI with valid data

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › POST /api/finances/roi-calculator › should return 401 without authentication

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

FAIL tests/tagTeams.test.ts
  ● Tag Teams API Endpoints › POST /api/tag-teams › should create a tag team with valid robots

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › POST /api/tag-teams › should reject team creation without authentication

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › POST /api/tag-teams › should reject team creation with missing robot IDs

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › POST /api/tag-teams › should reject team creation with same robot in both positions

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › POST /api/tag-teams › should reject duplicate team creation

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › GET /api/tag-teams › should list all teams for the user

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › GET /api/tag-teams › should include robot details and readiness status

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › GET /api/tag-teams › should reject request without authentication

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › GET /api/tag-teams/:id › should get team details by ID

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › GET /api/tag-teams/:id › should get team details by ID

    TypeError: Cannot read properties of undefined (reading 'id')

      246 |         where: { stableId: testUserId },
      247 |       });
    > 248 |       teamId = teams[0].id;
          |                         ^
      249 |     });
      250 |
      251 |     it('should get team details by ID', async () => {

      at Object.<anonymous> (tests/tagTeams.test.ts:248:25)

  ● Tag Teams API Endpoints › GET /api/tag-teams/:id › should reject request for non-existent team

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › GET /api/tag-teams/:id › should reject request for non-existent team

    TypeError: Cannot read properties of undefined (reading 'id')

      246 |         where: { stableId: testUserId },
      247 |       });
    > 248 |       teamId = teams[0].id;
          |                         ^
      249 |     });
      250 |
      251 |     it('should get team details by ID', async () => {

      at Object.<anonymous> (tests/tagTeams.test.ts:248:25)

  ● Tag Teams API Endpoints › GET /api/tag-teams/:id › should reject request with invalid team ID

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › GET /api/tag-teams/:id › should reject request with invalid team ID

    TypeError: Cannot read properties of undefined (reading 'id')

      246 |         where: { stableId: testUserId },
      247 |       });
    > 248 |       teamId = teams[0].id;
          |                         ^
      249 |     });
      250 |
      251 |     it('should get team details by ID', async () => {

      at Object.<anonymous> (tests/tagTeams.test.ts:248:25)

  ● Tag Teams API Endpoints › DELETE /api/tag-teams/:id › should disband a team

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › DELETE /api/tag-teams/:id › should disband a team

    PrismaClientValidationError: 
    Invalid `prisma.tagTeam.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeams.test.ts:286:41

      283 
      284 beforeAll(async () => {
      285   // Create a team to delete
    → 286   const team = await prisma.tagTeam.create({
              data: {
                stableId: 38706,
                activeRobotId: undefined,
                reserveRobotId: undefined,
                tagTeamLeague: "bronze",
                tagTeamLeagueId: "bronze_1",
                tagTeamLeaguePoints: 0,
                cyclesInTagTeamLeague: 0,
                totalTagTeamWins: 0,
                totalTagTeamLosses: 0,
                totalTagTeamDraws: 0,
            +   stable: {
            +     create: UserCreateWithoutTagTeamsInput | UserUncheckedCreateWithoutTagTeamsInput,
            +     connectOrCreate: UserCreateOrConnectWithoutTagTeamsInput,
            +     connect: UserWhereUniqueInput
            +   }
              }
            })

    Argument `stable` is missing.

      284 |     beforeAll(async () => {
      285 |       // Create a team to delete
    > 286 |       const team = await prisma.tagTeam.create({
          |                    ^
      287 |         data: {
      288 |           stableId: testUserId,
      289 |           activeRobotId: robot2Id,

      at wn (node_modules/@prisma/client/runtime/library.js:29:1363)
      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:6958)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/tagTeams.test.ts:286:20)

  ● Tag Teams API Endpoints › DELETE /api/tag-teams/:id › should reject request for non-existent team

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › DELETE /api/tag-teams/:id › should reject request for non-existent team

    PrismaClientValidationError: 
    Invalid `prisma.tagTeam.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeams.test.ts:286:41

      283 
      284 beforeAll(async () => {
      285   // Create a team to delete
    → 286   const team = await prisma.tagTeam.create({
              data: {
                stableId: 38706,
                activeRobotId: undefined,
                reserveRobotId: undefined,
                tagTeamLeague: "bronze",
                tagTeamLeagueId: "bronze_1",
                tagTeamLeaguePoints: 0,
                cyclesInTagTeamLeague: 0,
                totalTagTeamWins: 0,
                totalTagTeamLosses: 0,
                totalTagTeamDraws: 0,
            +   stable: {
            +     create: UserCreateWithoutTagTeamsInput | UserUncheckedCreateWithoutTagTeamsInput,
            +     connectOrCreate: UserCreateOrConnectWithoutTagTeamsInput,
            +     connect: UserWhereUniqueInput
            +   }
              }
            })

    Argument `stable` is missing.

      284 |     beforeAll(async () => {
      285 |       // Create a team to delete
    > 286 |       const team = await prisma.tagTeam.create({
          |                    ^
      287 |         data: {
      288 |           stableId: testUserId,
      289 |           activeRobotId: robot2Id,

      at wn (node_modules/@prisma/client/runtime/library.js:29:1363)
      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:6958)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/tagTeams.test.ts:286:20)

  ● Tag Teams API Endpoints › DELETE /api/tag-teams/:id › should reject request with invalid team ID

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › DELETE /api/tag-teams/:id › should reject request with invalid team ID

    PrismaClientValidationError: 
    Invalid `prisma.tagTeam.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeams.test.ts:286:41

      283 
      284 beforeAll(async () => {
      285   // Create a team to delete
    → 286   const team = await prisma.tagTeam.create({
              data: {
                stableId: 38706,
                activeRobotId: undefined,
                reserveRobotId: undefined,
                tagTeamLeague: "bronze",
                tagTeamLeagueId: "bronze_1",
                tagTeamLeaguePoints: 0,
                cyclesInTagTeamLeague: 0,
                totalTagTeamWins: 0,
                totalTagTeamLosses: 0,
                totalTagTeamDraws: 0,
            +   stable: {
            +     create: UserCreateWithoutTagTeamsInput | UserUncheckedCreateWithoutTagTeamsInput,
            +     connectOrCreate: UserCreateOrConnectWithoutTagTeamsInput,
            +     connect: UserWhereUniqueInput
            +   }
              }
            })

    Argument `stable` is missing.

      284 |     beforeAll(async () => {
      285 |       // Create a team to delete
    > 286 |       const team = await prisma.tagTeam.create({
          |                    ^
      287 |         data: {
      288 |           stableId: testUserId,
      289 |           activeRobotId: robot2Id,

      at wn (node_modules/@prisma/client/runtime/library.js:29:1363)
      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:6958)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/tagTeams.test.ts:286:20)

FAIL tests/tagTeamService.test.ts
  ● TagTeamService › validateTeam › should validate a team with two ready robots from same stable

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › validateTeam › should reject robots from different stables

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › validateTeam › should reject team with unready robot (low HP)

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › validateTeam › should reject duplicate teams

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › validateTeam › should reject duplicate teams in reverse order

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › validateTeam › should enforce roster limit (max teams = roster size / 2)

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › createTeam › should create a valid team

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › createTeam › should place new teams in Bronze league with initial values

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › createTeam › should return errors for invalid team

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › createTeam › should reject team creation if user does not own robots

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › getTeamById › should retrieve a team by ID

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › getTeamById › should include robot details in response

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › getTeamById › should return null for non-existent team

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › getTeamsByStable › should retrieve all teams for a stable

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › getTeamsByStable › should include robot details for all teams

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › getTeamsByStable › should return empty array for stable with no teams

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › disbandTeam › should disband a team

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › disbandTeam › should reject disbanding team from wrong stable

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › disbandTeam › should return false for non-existent team

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › disbandTeam › should make robots available for new teams after disbanding

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

FAIL tests/tagTeamDatabaseSchema.test.ts
  ● Tag Team Database Schema Verification › TagTeam Model › should have check constraint for different robots

    expect(received).toContain(expected) // indexOf

    Expected value: "tag_teams_different_robots_check"
    Received array: []

      76 |
      77 |       const checkConstraints = constraints.map(c => c.conname);
    > 78 |       expect(checkConstraints).toContain('tag_teams_different_robots_check');
         |                                ^
      79 |     });
      80 |   });
      81 |

      at Object.<anonymous> (tests/tagTeamDatabaseSchema.test.ts:78:32)

FAIL tests/integration/bronzeLeagueRebalancing.test.ts
  ● Console

    console.log
      ════════════════════════════════════════════════════════════

      at rebalanceLeagues (src/services/leagueRebalancingService.ts:333:11)

    console.log
      [Rebalancing] Starting league rebalancing...

      at rebalanceLeagues (src/services/leagueRebalancingService.ts:334:11)

    console.log
      ════════════════════════════════════════════════════════════

      at rebalanceLeagues (src/services/leagueRebalancingService.ts:335:11)

    console.log
      [Rebalancing] Total robots in system: 350

      at rebalanceLeagues (src/services/leagueRebalancingService.ts:350:11)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at rebalanceTier (src/services/leagueRebalancingService.ts:248:11)

    console.log
      [Rebalancing] bronze: 350 total robots across 1 instances

      at rebalanceTier (src/services/leagueRebalancingService.ts:269:11)

    console.log
      [Rebalancing] Processing bronze_1...

      at rebalanceTier (src/services/leagueRebalancingService.ts:273:13)

    console.log
      [Rebalancing] bronze_1: 10 robots eligible for promotion (top 10% of 100 AND ≥25 league points, 100 met points threshold)

      at determinePromotions (src/services/leagueRebalancingService.ts:107:11)

    console.log
      [Rebalancing] Promoted: Initial Robot 0 (bronze → silver, LP: 50 retained)

      at promoteRobot (src/services/leagueRebalancingService.ts:210:11)

    console.log
      [Rebalancing] Promoted: Initial Robot 1 (bronze → silver, LP: 50 retained)

      at promoteRobot (src/services/leagueRebalancingService.ts:210:11)

    console.log
      [Rebalancing] Promoted: Initial Robot 2 (bronze → silver, LP: 50 retained)

      at promoteRobot (src/services/leagueRebalancingService.ts:210:11)

    console.log
      [Rebalancing] Promoted: Initial Robot 3 (bronze → silver, LP: 50 retained)

      at promoteRobot (src/services/leagueRebalancingService.ts:210:11)

    console.log
      [Rebalancing] Promoted: Initial Robot 4 (bronze → silver, LP: 50 retained)

      at promoteRobot (src/services/leagueRebalancingService.ts:210:11)

    console.log
      [Rebalancing] Promoted: Initial Robot 5 (bronze → silver, LP: 50 retained)

      at promoteRobot (src/services/leagueRebalancingService.ts:210:11)

    console.log
      [Rebalancing] Promoted: Initial Robot 6 (bronze → silver, LP: 50 retained)

      at promoteRobot (src/services/leagueRebalancingService.ts:210:11)

    console.log
      [Rebalancing] Promoted: Initial Robot 7 (bronze → silver, LP: 50 retained)

      at promoteRobot (src/services/leagueRebalancingService.ts:210:11)

    console.log
      [Rebalancing] Promoted: Initial Robot 8 (bronze → silver, LP: 50 retained)

      at promoteRobot (src/services/leagueRebalancingService.ts:210:11)

    console.log
      [Rebalancing] Promoted: Initial Robot 9 (bronze → silver, LP: 50 retained)

      at promoteRobot (src/services/leagueRebalancingService.ts:210:11)

    console.log
      [Rebalancing] bronze: Promoted 10, Demoted 0 across 1 instances

      at rebalanceTier (src/services/leagueRebalancingService.ts:324:11)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at rebalanceTier (src/services/leagueRebalancingService.ts:248:11)

    console.log
      [Rebalancing] silver: 10 total robots across 1 instances

      at rebalanceTier (src/services/leagueRebalancingService.ts:269:11)

    console.log
      [Rebalancing] Processing silver_1...

      at rebalanceTier (src/services/leagueRebalancingService.ts:273:13)

    console.log
      [Rebalancing] silver_1: Skipping (0 eligible, need 10)

      at rebalanceTier (src/services/leagueRebalancingService.ts:291:15)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 1 instances

      at rebalanceTier (src/services/leagueRebalancingService.ts:324:11)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at rebalanceTier (src/services/leagueRebalancingService.ts:248:11)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at rebalanceTier (src/services/leagueRebalancingService.ts:269:11)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at rebalanceTier (src/services/leagueRebalancingService.ts:324:11)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at rebalanceTier (src/services/leagueRebalancingService.ts:248:11)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at rebalanceTier (src/services/leagueRebalancingService.ts:269:11)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at rebalanceTier (src/services/leagueRebalancingService.ts:324:11)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at rebalanceTier (src/services/leagueRebalancingService.ts:248:11)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at rebalanceTier (src/services/leagueRebalancingService.ts:269:11)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at rebalanceTier (src/services/leagueRebalancingService.ts:324:11)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at rebalanceTier (src/services/leagueRebalancingService.ts:248:11)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at rebalanceTier (src/services/leagueRebalancingService.ts:269:11)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at rebalanceTier (src/services/leagueRebalancingService.ts:324:11)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at rebalanceLeagues (src/services/leagueRebalancingService.ts:370:11)

    console.log
      [Rebalancing] bronze: Instance exceeds 100 robots, rebalancing...

      at rebalanceLeagues (src/services/leagueRebalancingService.ts:377:17)

    console.log
      [LeagueInstance] Rebalancing bronze instances...

      at rebalanceInstances (src/services/leagueInstanceService.ts:127:11)

    console.log
        Total robots: 340

      at rebalanceInstances (src/services/leagueInstanceService.ts:128:11)

    console.log
        Instances: 1

      at rebalanceInstances (src/services/leagueInstanceService.ts:129:11)

    console.log
        Average per instance: 340.0

      at rebalanceInstances (src/services/leagueInstanceService.ts:130:11)

    console.log
        Target instances: 4

      at rebalanceInstances (src/services/leagueInstanceService.ts:149:11)

    console.log
      [LeagueInstance] Rebalanced 255 robots across 4 instances

      at rebalanceInstances (src/services/leagueInstanceService.ts:172:11)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at rebalanceLeagues (src/services/leagueRebalancingService.ts:380:17)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at rebalanceLeagues (src/services/leagueRebalancingService.ts:380:17)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at rebalanceLeagues (src/services/leagueRebalancingService.ts:380:17)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at rebalanceLeagues (src/services/leagueRebalancingService.ts:380:17)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at rebalanceLeagues (src/services/leagueRebalancingService.ts:380:17)

    console.log
      
      ════════════════════════════════════════════════════════════

      at rebalanceLeagues (src/services/leagueRebalancingService.ts:387:11)

    console.log
      [Rebalancing] League rebalancing complete!

      at rebalanceLeagues (src/services/leagueRebalancingService.ts:388:11)

    console.log
        Total promoted: 10

      at rebalanceLeagues (src/services/leagueRebalancingService.ts:389:11)

    console.log
        Total demoted: 0

      at rebalanceLeagues (src/services/leagueRebalancingService.ts:390:11)

    console.log
        Errors: 0

      at rebalanceLeagues (src/services/leagueRebalancingService.ts:391:11)

    console.log
      ════════════════════════════════════════════════════════════

      at rebalanceLeagues (src/services/leagueRebalancingService.ts:392:11)

  ● Bronze League Rebalancing - Integration Test › should correctly rebalance 331 robots from single bronze instance into multiple instances

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.createMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/integration/bronzeLeagueRebalancing.test.ts:105:24

      102     maxShield: 2,
      103   });
      104 }
    → 105 await prisma.robot.createMany(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      103 |       });
      104 |     }
    > 105 |     await prisma.robot.createMany({ data: robots });
          |     ^
      106 |
      107 |     // Verify initial state - all robots in one instance
      108 |     const initialStats = await getLeagueInstanceStats('bronze');

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/integration/bronzeLeagueRebalancing.test.ts:105:5)

PASS tests/records.test.ts
FAIL tests/matches.test.ts
  ● Matches Routes › GET /api/matches/upcoming › should get upcoming matches with auth

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |     
      29 |     // Create test user
      30 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/matches.test.ts:27:5)

  ● Matches Routes › GET /api/matches/upcoming › should return 401 without authentication

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |     
      29 |     // Create test user
      30 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/matches.test.ts:27:5)

  ● Matches Routes › GET /api/matches/upcoming › should return 403 with invalid token

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |     
      29 |     // Create test user
      30 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/matches.test.ts:27:5)

  ● Matches Routes › GET /api/matches/history › should get match history with auth

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |     
      29 |     // Create test user
      30 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/matches.test.ts:27:5)

  ● Matches Routes › GET /api/matches/history › should support pagination

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |     
      29 |     // Create test user
      30 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/matches.test.ts:27:5)

  ● Matches Routes › GET /api/matches/history › should filter by robot ID

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |     
      29 |     // Create test user
      30 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/matches.test.ts:27:5)

  ● Matches Routes › GET /api/matches/history › should return 401 without authentication

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |     
      29 |     // Create test user
      30 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/matches.test.ts:27:5)

  ● Matches Routes › GET /api/matches/battles/:id/log › should return 401 without authentication

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |     
      29 |     // Create test user
      30 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/matches.test.ts:27:5)

  ● Matches Routes › GET /api/matches/battles/:id/log › should return 403 with invalid token

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |     
      29 |     // Create test user
      30 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/matches.test.ts:27:5)

  ● Matches Routes › GET /api/matches/battles/:id/log › should handle non-existent battle ID with auth

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |     
      29 |     // Create test user
      30 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/matches.test.ts:27:5)

FAIL tests/tagTeamLeagueStandings.property.test.ts
  ● Tag Team League Standings Property Tests › should maintain independent 1v1 and tag team league standings

    TypeError: Cannot read properties of null (reading 'id')

      34 |     // Get a weapon for testing
      35 |     const weapon = await prisma.weapon.findFirst();
    > 36 |     weaponId = weapon!.id;
         |                        ^
      37 |   });
      38 |
      39 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamLeagueStandings.property.test.ts:36:24)

  ● Tag Team League Standings Property Tests › should not affect robot 1v1 standings when tag team league changes

    TypeError: Cannot read properties of null (reading 'id')

      34 |     // Get a weapon for testing
      35 |     const weapon = await prisma.weapon.findFirst();
    > 36 |     weaponId = weapon!.id;
         |                        ^
      37 |   });
      38 |
      39 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamLeagueStandings.property.test.ts:36:24)

  ● Tag Team League Standings Property Tests › should allow robots with different 1v1 leagues to be in the same tag team

    TypeError: Cannot read properties of null (reading 'id')

      34 |     // Get a weapon for testing
      35 |     const weapon = await prisma.weapon.findFirst();
    > 36 |     weaponId = weapon!.id;
         |                        ^
      37 |   });
      38 |
      39 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamLeagueStandings.property.test.ts:36:24)


  ● Test suite failed to run

    PrismaClientKnownRequestError: 
    Invalid `prisma.tagTeam.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeamLeagueStandings.property.test.ts:41:26

      38 
      39 afterAll(async () => {
      40   // Clean up test data
    → 41   await prisma.tagTeam.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already
    Prisma Accelerate has built-in connection pooling to prevent such errors: https://pris.ly/client/error-accelerate

      39 |   afterAll(async () => {
      40 |     // Clean up test data
    > 41 |     await prisma.tagTeam.deleteMany({
         |     ^
      42 |       where: { stableId: testUserId },
      43 |     });
      44 |     await prisma.robot.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/tagTeamLeagueStandings.property.test.ts:41:5)

FAIL tests/profileUpdate.test.ts
  ● Profile Update Endpoint › PUT /api/user/profile › should update stable name successfully

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should update profile visibility successfully

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should update notification preferences successfully

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should update theme preference successfully

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should update multiple fields at once

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should change password successfully with correct current password

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject password change with incorrect current password

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject password change without current password

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject stable name that is too short

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject stable name that is too long

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject stable name with invalid characters

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject stable name with profanity

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject duplicate stable name

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject weak password (too short)

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject weak password (no uppercase)

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject weak password (no lowercase)

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject weak password (no number)

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject invalid profile visibility value

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject invalid theme preference value

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject request without authentication token

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject request with invalid authentication token

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should preserve unchanged fields when updating partial data

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should return all profile fields in response

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should have default visibility set to public for new users

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should return 400 with validation errors for multiple invalid fields

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

FAIL tests/leagues.test.ts
  ● Leagues Routes › GET /api/leagues/:tier/standings › should get bronze league standings

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      24 |
      25 |   beforeAll(async () => {
    > 26 |     await prisma.$connect();
         |     ^
      27 |     
      28 |     // Create test user
      29 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leagues.test.ts:26:5)

  ● Leagues Routes › GET /api/leagues/:tier/standings › should get silver league standings

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      24 |
      25 |   beforeAll(async () => {
    > 26 |     await prisma.$connect();
         |     ^
      27 |     
      28 |     // Create test user
      29 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leagues.test.ts:26:5)

  ● Leagues Routes › GET /api/leagues/:tier/standings › should return 400 for invalid tier

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      24 |
      25 |   beforeAll(async () => {
    > 26 |     await prisma.$connect();
         |     ^
      27 |     
      28 |     // Create test user
      29 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leagues.test.ts:26:5)

  ● Leagues Routes › GET /api/leagues/:tier/standings › should support pagination

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      24 |
      25 |   beforeAll(async () => {
    > 26 |     await prisma.$connect();
         |     ^
      27 |     
      28 |     // Create test user
      29 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leagues.test.ts:26:5)

  ● Leagues Routes › GET /api/leagues/:tier/instances › should get bronze league instances

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      24 |
      25 |   beforeAll(async () => {
    > 26 |     await prisma.$connect();
         |     ^
      27 |     
      28 |     // Create test user
      29 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leagues.test.ts:26:5)

  ● Leagues Routes › GET /api/leagues/:tier/instances › should return 400 for invalid tier

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      24 |
      25 |   beforeAll(async () => {
    > 26 |     await prisma.$connect();
         |     ^
      27 |     
      28 |     // Create test user
      29 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leagues.test.ts:26:5)

PASS tests/robotNameUniqueness.test.ts
  ● Console

    console.log
      [Robot] | User 38710 | Created: "TestBot_Unique" | Cost: ₡500,000 | Balance: ₡10,000,000 → ₡9,500,000

      at src/routes/robots.ts:244:15

    console.log
      [Robot] | User 38710 | Created: "TestBot_Unique" | Cost: ₡500,000 | Balance: ₡9,500,000 → ₡9,000,000

      at src/routes/robots.ts:244:15

    console.log
      [Robot] | User 38710 | Created: "TestBot_Unique" | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/robots.ts:244:15

    console.log
      [Robot] | User 38715 | Created: "TestBot_Unique" | Cost: ₡500,000 | Balance: ₡10,000,000 → ₡9,500,000

      at src/routes/robots.ts:244:15

    console.log
      [Robot] | User 38710 | Created: "TestBot" | Cost: ₡500,000 | Balance: ₡8,500,000 → ₡8,000,000

      at src/routes/robots.ts:244:15

    console.log
      [Robot] | User 38710 | Created: "testbot" | Cost: ₡500,000 | Balance: ₡8,000,000 → ₡7,500,000

      at src/routes/robots.ts:244:15

    console.log
      [Robot] | User 38710 | Created: "aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa" | Cost: ₡500,000 | Balance: ₡7,500,000 → ₡7,000,000

      at src/routes/robots.ts:244:15

FAIL tests/weapons.test.ts
  ● Weapons Routes › GET /api/weapons › should get all weapons with auth

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      24 |
      25 |   beforeAll(async () => {
    > 26 |     await prisma.$connect();
         |     ^
      27 |     
      28 |     // Create test user
      29 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/weapons.test.ts:26:5)

  ● Weapons Routes › GET /api/weapons › should return weapons sorted by cost

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      24 |
      25 |   beforeAll(async () => {
    > 26 |     await prisma.$connect();
         |     ^
      27 |     
      28 |     // Create test user
      29 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/weapons.test.ts:26:5)

  ● Weapons Routes › GET /api/weapons › should return 401 without authentication

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      24 |
      25 |   beforeAll(async () => {
    > 26 |     await prisma.$connect();
         |     ^
      27 |     
      28 |     // Create test user
      29 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/weapons.test.ts:26:5)

  ● Weapons Routes › GET /api/weapons › should return 403 with invalid token

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      24 |
      25 |   beforeAll(async () => {
    > 26 |     await prisma.$connect();
         |     ^
      27 |     
      28 |     // Create test user
      29 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/weapons.test.ts:26:5)

FAIL tests/integration/tagTeamLeagueRebalancing.test.ts
  ● Tag Team League Rebalancing Integration Test › should promote top 10% and demote bottom 10% with varying league points

    No weapons found. Run seed first.

      28 |     const weapon = await prisma.weapon.findFirst();
      29 |     if (!weapon) {
    > 30 |       throw new Error('No weapons found. Run seed first.');
         |             ^
      31 |     }
      32 |
      33 |     // Create 20 test users (for 20 teams in bronze league)

      at Object.<anonymous> (tests/integration/tagTeamLeagueRebalancing.test.ts:30:13)

  ● Tag Team League Rebalancing Integration Test › should not promote/demote teams with < 5 cycles in tier

    No weapons found. Run seed first.

      28 |     const weapon = await prisma.weapon.findFirst();
      29 |     if (!weapon) {
    > 30 |       throw new Error('No weapons found. Run seed first.');
         |             ^
      31 |     }
      32 |
      33 |     // Create 20 test users (for 20 teams in bronze league)

      at Object.<anonymous> (tests/integration/tagTeamLeagueRebalancing.test.ts:30:13)

  ● Tag Team League Rebalancing Integration Test › should handle demotion from silver to bronze

    No weapons found. Run seed first.

      28 |     const weapon = await prisma.weapon.findFirst();
      29 |     if (!weapon) {
    > 30 |       throw new Error('No weapons found. Run seed first.');
         |             ^
      31 |     }
      32 |
      33 |     // Create 20 test users (for 20 teams in bronze league)

      at Object.<anonymous> (tests/integration/tagTeamLeagueRebalancing.test.ts:30:13)

  ● Tag Team League Rebalancing Integration Test › should handle minimum team count for rebalancing (< 10 teams)

    No weapons found. Run seed first.

      28 |     const weapon = await prisma.weapon.findFirst();
      29 |     if (!weapon) {
    > 30 |       throw new Error('No weapons found. Run seed first.');
         |             ^
      31 |     }
      32 |
      33 |     // Create 20 test users (for 20 teams in bronze league)

      at Object.<anonymous> (tests/integration/tagTeamLeagueRebalancing.test.ts:30:13)

FAIL tests/leaderboards.test.ts
  ● Leaderboards Routes › GET /api/leaderboards/fame › should get fame leaderboard

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      18 | describe('Leaderboards Routes', () => {
      19 |   beforeAll(async () => {
    > 20 |     await prisma.$connect();
         |     ^
      21 |   });
      22 |
      23 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leaderboards.test.ts:20:5)

  ● Leaderboards Routes › GET /api/leaderboards/fame › should support pagination

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      18 | describe('Leaderboards Routes', () => {
      19 |   beforeAll(async () => {
    > 20 |     await prisma.$connect();
         |     ^
      21 |   });
      22 |
      23 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leaderboards.test.ts:20:5)

  ● Leaderboards Routes › GET /api/leaderboards/fame › should filter by league

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      18 | describe('Leaderboards Routes', () => {
      19 |   beforeAll(async () => {
    > 20 |     await prisma.$connect();
         |     ^
      21 |   });
      22 |
      23 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leaderboards.test.ts:20:5)

  ● Leaderboards Routes › GET /api/leaderboards/fame › should filter by minimum battles

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      18 | describe('Leaderboards Routes', () => {
      19 |   beforeAll(async () => {
    > 20 |     await prisma.$connect();
         |     ^
      21 |   });
      22 |
      23 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leaderboards.test.ts:20:5)

  ● Leaderboards Routes › GET /api/leaderboards/losses › should get losses leaderboard

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      18 | describe('Leaderboards Routes', () => {
      19 |   beforeAll(async () => {
    > 20 |     await prisma.$connect();
         |     ^
      21 |   });
      22 |
      23 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leaderboards.test.ts:20:5)

  ● Leaderboards Routes › GET /api/leaderboards/losses › should support pagination

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      18 | describe('Leaderboards Routes', () => {
      19 |   beforeAll(async () => {
    > 20 |     await prisma.$connect();
         |     ^
      21 |   });
      22 |
      23 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leaderboards.test.ts:20:5)

  ● Leaderboards Routes › GET /api/leaderboards/prestige › should get prestige leaderboard

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      18 | describe('Leaderboards Routes', () => {
      19 |   beforeAll(async () => {
    > 20 |     await prisma.$connect();
         |     ^
      21 |   });
      22 |
      23 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leaderboards.test.ts:20:5)

  ● Leaderboards Routes › GET /api/leaderboards/prestige › should support pagination

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      18 | describe('Leaderboards Routes', () => {
      19 |   beforeAll(async () => {
    > 20 |     await prisma.$connect();
         |     ^
      21 |   });
      22 |
      23 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leaderboards.test.ts:20:5)

FAIL tests/integration/tagTeamAutoRepair.test.ts
  ● Tag Team Auto-Repair Integration Test › should auto-repair damaged robots before battle and deduct costs

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |
      29 |     // Get a weapon for robots
      30 |     weapon = await prisma.weapon.findFirst();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/integration/tagTeamAutoRepair.test.ts:27:5)

  ● Tag Team Auto-Repair Integration Test › should allow users to go into negative currency for repairs

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |
      29 |     // Get a weapon for robots
      30 |     weapon = await prisma.weapon.findFirst();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/integration/tagTeamAutoRepair.test.ts:27:5)

FAIL tests/twoRobotTagTeamGeneration.test.ts
  ● Two-Robot Specialist Tag Team Generation › should create tag team for Two-Robot Specialist archetype (cycle 4, position 9)

    Practice Sword weapon not found. Run seed first.

      19 |
      20 |     if (!practiceSword) {
    > 21 |       throw new Error('Practice Sword weapon not found. Run seed first.');
         |             ^
      22 |     }
      23 |   });
      24 |

      at Object.<anonymous> (tests/twoRobotTagTeamGeneration.test.ts:21:13)

  ● Two-Robot Specialist Tag Team Generation › should create tag team for Two-Robot Specialist in cycle 1 (position 9 wraps to cycle 10)

    Practice Sword weapon not found. Run seed first.

      19 |
      20 |     if (!practiceSword) {
    > 21 |       throw new Error('Practice Sword weapon not found. Run seed first.');
         |             ^
      22 |     }
      23 |   });
      24 |

      at Object.<anonymous> (tests/twoRobotTagTeamGeneration.test.ts:21:13)

  ● Two-Robot Specialist Tag Team Generation › should not create tag teams for single-robot archetypes

    Practice Sword weapon not found. Run seed first.

      19 |
      20 |     if (!practiceSword) {
    > 21 |       throw new Error('Practice Sword weapon not found. Run seed first.');
         |             ^
      22 |     }
      23 |   });
      24 |

      at Object.<anonymous> (tests/twoRobotTagTeamGeneration.test.ts:21:13)

  ● Two-Robot Specialist Tag Team Generation › should create tag teams with correct robot assignments

    Practice Sword weapon not found. Run seed first.

      19 |
      20 |     if (!practiceSword) {
    > 21 |       throw new Error('Practice Sword weapon not found. Run seed first.');
         |             ^
      22 |     }
      23 |   });
      24 |

      at Object.<anonymous> (tests/twoRobotTagTeamGeneration.test.ts:21:13)

FAIL tests/tagTeamStreamingRevenue.test.ts
  ● Tag Team Streaming Revenue Integration › should calculate and award streaming revenue for Tag Team battles

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |
      31 |     // Get a weapon for robots
      32 |     weapon = await prisma.weapon.findFirst();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/tagTeamStreamingRevenue.test.ts:29:5)

  ● Tag Team Streaming Revenue Integration › should calculate and award streaming revenue for Tag Team battles

    PrismaClientInitializationError: 
    Invalid `prisma.tagTeamMatch.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeamStreamingRevenue.test.ts:119:31

      116 
      117 afterEach(async () => {
      118   // Clean up test data between tests (keep users and weapons from beforeAll)
    → 119   await prisma.tagTeamMatch.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      117 |   afterEach(async () => {
      118 |     // Clean up test data between tests (keep users and weapons from beforeAll)
    > 119 |     await prisma.tagTeamMatch.deleteMany({});
          |     ^
      120 |     await prisma.battleParticipant.deleteMany({});
      121 |     await prisma.battle.deleteMany({});
      122 |     await prisma.tagTeam.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/tagTeamStreamingRevenue.test.ts:119:5)

FAIL tests/matchmakingService.test.ts
  ● Matchmaking Service › checkBattleReadiness › should mark robot as ready when HP >= 75% and weapon equipped

    PrismaClientInitializationError: 
    Invalid `prisma.scheduledMatch.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/matchmakingService.test.ts:21:33

      18 
      19 beforeAll(async () => {
      20   // Clean up in correct order
    → 21   await prisma.scheduledMatch.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      19 |   beforeAll(async () => {
      20 |     // Clean up in correct order
    > 21 |     await prisma.scheduledMatch.deleteMany({});
         |     ^
      22 |     await prisma.battleParticipant.deleteMany({});
      23 |     await prisma.battle.deleteMany({});
      24 |     await prisma.tagTeamMatch.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/matchmakingService.test.ts:21:5)

  ● Matchmaking Service › checkBattleReadiness › should mark robot as not ready when HP < 75%

    PrismaClientInitializationError: 
    Invalid `prisma.scheduledMatch.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/matchmakingService.test.ts:21:33

      18 
      19 beforeAll(async () => {
      20   // Clean up in correct order
    → 21   await prisma.scheduledMatch.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      19 |   beforeAll(async () => {
      20 |     // Clean up in correct order
    > 21 |     await prisma.scheduledMatch.deleteMany({});
         |     ^
      22 |     await prisma.battleParticipant.deleteMany({});
      23 |     await prisma.battle.deleteMany({});
      24 |     await prisma.tagTeamMatch.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/matchmakingService.test.ts:21:5)

  ● Matchmaking Service › checkBattleReadiness › should mark robot as not ready when HP is at or below yield threshold

    PrismaClientInitializationError: 
    Invalid `prisma.scheduledMatch.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/matchmakingService.test.ts:21:33

      18 
      19 beforeAll(async () => {
      20   // Clean up in correct order
    → 21   await prisma.scheduledMatch.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      19 |   beforeAll(async () => {
      20 |     // Clean up in correct order
    > 21 |     await prisma.scheduledMatch.deleteMany({});
         |     ^
      22 |     await prisma.battleParticipant.deleteMany({});
      23 |     await prisma.battle.deleteMany({});
      24 |     await prisma.tagTeamMatch.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/matchmakingService.test.ts:21:5)

  ● Matchmaking Service › checkBattleReadiness › should mark robot as not ready when weapon not equipped

    PrismaClientInitializationError: 
    Invalid `prisma.scheduledMatch.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/matchmakingService.test.ts:21:33

      18 
      19 beforeAll(async () => {
      20   // Clean up in correct order
    → 21   await prisma.scheduledMatch.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      19 |   beforeAll(async () => {
      20 |     // Clean up in correct order
    > 21 |     await prisma.scheduledMatch.deleteMany({});
         |     ^
      22 |     await prisma.battleParticipant.deleteMany({});
      23 |     await prisma.battle.deleteMany({});
      24 |     await prisma.tagTeamMatch.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/matchmakingService.test.ts:21:5)

  ● Matchmaking Service › checkBattleReadiness › should check dual wield loadout correctly

    PrismaClientInitializationError: 
    Invalid `prisma.scheduledMatch.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/matchmakingService.test.ts:21:33

      18 
      19 beforeAll(async () => {
      20   // Clean up in correct order
    → 21   await prisma.scheduledMatch.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      19 |   beforeAll(async () => {
      20 |     // Clean up in correct order
    > 21 |     await prisma.scheduledMatch.deleteMany({});
         |     ^
      22 |     await prisma.battleParticipant.deleteMany({});
      23 |     await prisma.battle.deleteMany({});
      24 |     await prisma.tagTeamMatch.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/matchmakingService.test.ts:21:5)

  ● Matchmaking Service › runMatchmakingForTier › should create matches for available robots

    PrismaClientInitializationError: 
    Invalid `prisma.scheduledMatch.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/matchmakingService.test.ts:21:33

      18 
      19 beforeAll(async () => {
      20   // Clean up in correct order
    → 21   await prisma.scheduledMatch.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      19 |   beforeAll(async () => {
      20 |     // Clean up in correct order
    > 21 |     await prisma.scheduledMatch.deleteMany({});
         |     ^
      22 |     await prisma.battleParticipant.deleteMany({});
      23 |     await prisma.battle.deleteMany({});
      24 |     await prisma.tagTeamMatch.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/matchmakingService.test.ts:21:5)

  ● Matchmaking Service › runMatchmakingForTier › should create bye-match for odd number of robots

    PrismaClientInitializationError: 
    Invalid `prisma.scheduledMatch.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/matchmakingService.test.ts:21:33

      18 
      19 beforeAll(async () => {
      20   // Clean up in correct order
    → 21   await prisma.scheduledMatch.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      19 |   beforeAll(async () => {
      20 |     // Clean up in correct order
    > 21 |     await prisma.scheduledMatch.deleteMany({});
         |     ^
      22 |     await prisma.battleParticipant.deleteMany({});
      23 |     await prisma.battle.deleteMany({});
      24 |     await prisma.tagTeamMatch.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/matchmakingService.test.ts:21:5)

  ● Matchmaking Service › runMatchmakingForTier › should not create duplicate matches for already scheduled robots

    PrismaClientInitializationError: 
    Invalid `prisma.scheduledMatch.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/matchmakingService.test.ts:21:33

      18 
      19 beforeAll(async () => {
      20   // Clean up in correct order
    → 21   await prisma.scheduledMatch.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      19 |   beforeAll(async () => {
      20 |     // Clean up in correct order
    > 21 |     await prisma.scheduledMatch.deleteMany({});
         |     ^
      22 |     await prisma.battleParticipant.deleteMany({});
      23 |     await prisma.battle.deleteMany({});
      24 |     await prisma.tagTeamMatch.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/matchmakingService.test.ts:21:5)

  ● Matchmaking Service › runMatchmakingForTier › should skip robots that are not battle-ready

    PrismaClientInitializationError: 
    Invalid `prisma.scheduledMatch.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/matchmakingService.test.ts:21:33

      18 
      19 beforeAll(async () => {
      20   // Clean up in correct order
    → 21   await prisma.scheduledMatch.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      19 |   beforeAll(async () => {
      20 |     // Clean up in correct order
    > 21 |     await prisma.scheduledMatch.deleteMany({});
         |     ^
      22 |     await prisma.battleParticipant.deleteMany({});
      23 |     await prisma.battle.deleteMany({});
      24 |     await prisma.tagTeamMatch.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/matchmakingService.test.ts:21:5)

  ● Matchmaking Service › runMatchmaking (all tiers) › should run matchmaking across all tiers

    PrismaClientInitializationError: 
    Invalid `prisma.scheduledMatch.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/matchmakingService.test.ts:21:33

      18 
      19 beforeAll(async () => {
      20   // Clean up in correct order
    → 21   await prisma.scheduledMatch.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      19 |   beforeAll(async () => {
      20 |     // Clean up in correct order
    > 21 |     await prisma.scheduledMatch.deleteMany({});
         |     ^
      22 |     await prisma.battleParticipant.deleteMany({});
      23 |     await prisma.battle.deleteMany({});
      24 |     await prisma.tagTeamMatch.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/matchmakingService.test.ts:21:5)

FAIL tests/cycleSnapshotService.test.ts
  ● CycleSnapshotService › should create a cycle snapshot with cycle start and complete events

    PrismaClientInitializationError: 
    Invalid `prisma.cycleSnapshot.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSnapshotService.test.ts:18:32

      15 
      16 beforeAll(async () => {
      17   // Clean up any existing test data
    → 18   await prisma.cycleSnapshot.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      16 |   beforeAll(async () => {
      17 |     // Clean up any existing test data
    > 18 |     await prisma.cycleSnapshot.deleteMany({
         |     ^
      19 |       where: { cycleNumber: testCycleNumber },
      20 |     });
      21 |     await prisma.auditLog.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleSnapshotService.test.ts:18:5)

  ● CycleSnapshotService › should retrieve a snapshot by cycle number

    PrismaClientInitializationError: 
    Invalid `prisma.cycleSnapshot.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSnapshotService.test.ts:18:32

      15 
      16 beforeAll(async () => {
      17   // Clean up any existing test data
    → 18   await prisma.cycleSnapshot.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      16 |   beforeAll(async () => {
      17 |     // Clean up any existing test data
    > 18 |     await prisma.cycleSnapshot.deleteMany({
         |     ^
      19 |       where: { cycleNumber: testCycleNumber },
      20 |     });
      21 |     await prisma.auditLog.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleSnapshotService.test.ts:18:5)

  ● CycleSnapshotService › should return null for non-existent snapshot

    PrismaClientInitializationError: 
    Invalid `prisma.cycleSnapshot.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSnapshotService.test.ts:18:32

      15 
      16 beforeAll(async () => {
      17   // Clean up any existing test data
    → 18   await prisma.cycleSnapshot.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      16 |   beforeAll(async () => {
      17 |     // Clean up any existing test data
    > 18 |     await prisma.cycleSnapshot.deleteMany({
         |     ^
      19 |       where: { cycleNumber: testCycleNumber },
      20 |     });
      21 |     await prisma.auditLog.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleSnapshotService.test.ts:18:5)

  ● CycleSnapshotService › should retrieve snapshots for a range of cycles

    PrismaClientInitializationError: 
    Invalid `prisma.cycleSnapshot.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSnapshotService.test.ts:18:32

      15 
      16 beforeAll(async () => {
      17   // Clean up any existing test data
    → 18   await prisma.cycleSnapshot.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      16 |   beforeAll(async () => {
      17 |     // Clean up any existing test data
    > 18 |     await prisma.cycleSnapshot.deleteMany({
         |     ^
      19 |       where: { cycleNumber: testCycleNumber },
      20 |     });
      21 |     await prisma.auditLog.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleSnapshotService.test.ts:18:5)

  ● CycleSnapshotService › should throw error if cycle is incomplete (missing start event)

    PrismaClientInitializationError: 
    Invalid `prisma.cycleSnapshot.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSnapshotService.test.ts:18:32

      15 
      16 beforeAll(async () => {
      17   // Clean up any existing test data
    → 18   await prisma.cycleSnapshot.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      16 |   beforeAll(async () => {
      17 |     // Clean up any existing test data
    > 18 |     await prisma.cycleSnapshot.deleteMany({
         |     ^
      19 |       where: { cycleNumber: testCycleNumber },
      20 |     });
      21 |     await prisma.auditLog.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleSnapshotService.test.ts:18:5)

  ● CycleSnapshotService › should throw error if cycle is incomplete (missing complete event)

    PrismaClientInitializationError: 
    Invalid `prisma.cycleSnapshot.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSnapshotService.test.ts:18:32

      15 
      16 beforeAll(async () => {
      17   // Clean up any existing test data
    → 18   await prisma.cycleSnapshot.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      16 |   beforeAll(async () => {
      17 |     // Clean up any existing test data
    > 18 |     await prisma.cycleSnapshot.deleteMany({
         |     ^
      19 |       where: { cycleNumber: testCycleNumber },
      20 |     });
      21 |     await prisma.auditLog.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleSnapshotService.test.ts:18:5)

  ● CycleSnapshotService › should aggregate step durations from cycle step events

    PrismaClientInitializationError: 
    Invalid `prisma.cycleSnapshot.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSnapshotService.test.ts:18:32

      15 
      16 beforeAll(async () => {
      17   // Clean up any existing test data
    → 18   await prisma.cycleSnapshot.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      16 |   beforeAll(async () => {
      17 |     // Clean up any existing test data
    > 18 |     await prisma.cycleSnapshot.deleteMany({
         |     ^
      19 |       where: { cycleNumber: testCycleNumber },
      20 |     });
      21 |     await prisma.auditLog.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleSnapshotService.test.ts:18:5)


  ● Test suite failed to run

    PrismaClientInitializationError: 
    Invalid `prisma.cycleSnapshot.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSnapshotService.test.ts:28:32

      25 
      26 afterAll(async () => {
      27   // Clean up test data
    → 28   await prisma.cycleSnapshot.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      26 |   afterAll(async () => {
      27 |     // Clean up test data
    > 28 |     await prisma.cycleSnapshot.deleteMany({
         |     ^
      29 |       where: { cycleNumber: testCycleNumber },
      30 |     });
      31 |     await prisma.auditLog.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleSnapshotService.test.ts:28:5)

FAIL tests/dataIntegrityService.test.ts
  ● DataIntegrityService › validateCycleIntegrity › should pass validation for a complete, valid cycle

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      13 |
      14 |   beforeAll(async () => {
    > 15 |     await prisma.$connect();
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/dataIntegrityService.test.ts:15:5)

  ● DataIntegrityService › validateCycleIntegrity › should detect missing cycle_start event

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      13 |
      14 |   beforeAll(async () => {
    > 15 |     await prisma.$connect();
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/dataIntegrityService.test.ts:15:5)

  ● DataIntegrityService › validateCycleIntegrity › should detect missing cycle_complete event

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      13 |
      14 |   beforeAll(async () => {
    > 15 |     await prisma.$connect();
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/dataIntegrityService.test.ts:15:5)

  ● DataIntegrityService › validateCycleIntegrity › should detect incomplete cycle steps

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      13 |
      14 |   beforeAll(async () => {
    > 15 |     await prisma.$connect();
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/dataIntegrityService.test.ts:15:5)

  ● DataIntegrityService › checkSequenceNumbers › should detect sequence number gaps

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      13 |
      14 |   beforeAll(async () => {
    > 15 |     await prisma.$connect();
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/dataIntegrityService.test.ts:15:5)

  ● DataIntegrityService › checkSequenceNumbers › should pass with continuous sequence numbers

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      13 |
      14 |   beforeAll(async () => {
    > 15 |     await prisma.$connect();
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/dataIntegrityService.test.ts:15:5)

  ● DataIntegrityService › checkCreditConsistency › should detect credit sum mismatch

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      13 |
      14 |   beforeAll(async () => {
    > 15 |     await prisma.$connect();
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/dataIntegrityService.test.ts:15:5)

  ● DataIntegrityService › checkCreditConsistency › should pass with matching credit sums

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      13 |
      14 |   beforeAll(async () => {
    > 15 |     await prisma.$connect();
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/dataIntegrityService.test.ts:15:5)

  ● DataIntegrityService › checkCreditConsistency › should allow 1 credit tolerance for rounding

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      13 |
      14 |   beforeAll(async () => {
    > 15 |     await prisma.$connect();
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/dataIntegrityService.test.ts:15:5)

  ● DataIntegrityService › validateCycleRange › should validate multiple cycles

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      13 |
      14 |   beforeAll(async () => {
    > 15 |     await prisma.$connect();
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/dataIntegrityService.test.ts:15:5)

  ● DataIntegrityService › getIntegritySummary › should provide summary of integrity issues

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      13 |
      14 |   beforeAll(async () => {
    > 15 |     await prisma.$connect();
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/dataIntegrityService.test.ts:15:5)

FAIL tests/integration/tagTeamMultiMatchCycle.test.ts
  ● Tag Team Multi-Match Cycle Integration Test › should handle robot in both 1v1 and tag team match with cumulative damage

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |
      29 |     // Initialize cycle metadata to odd cycle (so tag team matchmaking runs)
      30 |     await prisma.cycleMetadata.upsert({

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/integration/tagTeamMultiMatchCycle.test.ts:27:5)

  ● Tag Team Multi-Match Cycle Integration Test › should exclude unready robots from tag team match after 1v1 damage

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |
      29 |     // Initialize cycle metadata to odd cycle (so tag team matchmaking runs)
      30 |     await prisma.cycleMetadata.upsert({

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/integration/tagTeamMultiMatchCycle.test.ts:27:5)

  ● Tag Team Multi-Match Cycle Integration Test › should process matches in correct order: 1v1 first, then tag team

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |
      29 |     // Initialize cycle metadata to odd cycle (so tag team matchmaking runs)
      30 |     await prisma.cycleMetadata.upsert({

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/integration/tagTeamMultiMatchCycle.test.ts:27:5)

FAIL tests/prestigeGates.test.ts
  ● Prestige Gates › Facility Config Prestige Requirements › Income Generator has correct prestige requirements

    expect(received).toBeDefined()

    Received: undefined

      89 |     test('Income Generator has correct prestige requirements', () => {
      90 |       const config = getFacilityConfig('income_generator');
    > 91 |       expect(config).toBeDefined();
         |                      ^
      92 |       expect(config?.prestigeRequirements).toEqual([0, 0, 0, 3000, 0, 0, 7500, 0, 15000, 0]);
      93 |     });
      94 |

      at Object.<anonymous> (tests/prestigeGates.test.ts:91:22)

FAIL tests/eventLogger.integration.test.ts
  ● EventLogger Integration › should successfully log events to the database

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/eventLogger.integration.test.ts:15:27

      12 
      13 beforeEach(async () => {
      14   // Clean up audit logs before each test
    → 15   await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      13 |   beforeEach(async () => {
      14 |     // Clean up audit logs before each test
    > 15 |     await prisma.auditLog.deleteMany({});
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/eventLogger.integration.test.ts:15:5)

  ● EventLogger Integration › should handle batch logging efficiently

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/eventLogger.integration.test.ts:15:27

      12 
      13 beforeEach(async () => {
      14   // Clean up audit logs before each test
    → 15   await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      13 |   beforeEach(async () => {
      14 |     // Clean up audit logs before each test
    > 15 |     await prisma.auditLog.deleteMany({});
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/eventLogger.integration.test.ts:15:5)

FAIL tests/cycleCsvStreamingRevenue.property.test.ts
  ● Property 15: Cycle CSV Contains Streaming Revenue Column › should include streaming_revenue column in CSV export

    PrismaClientInitializationError: 
    Invalid `prisma.user.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleCsvStreamingRevenue.property.test.ts:95:37

      92 
      93 beforeAll(async () => {
      94   // Create test users
    → 95   const user1 = await prisma.user.create(
    Too many database connections opened: FATAL: sorry, too many clients already

      93 |   beforeAll(async () => {
      94 |     // Create test users
    > 95 |     const user1 = await prisma.user.create({
         |                   ^
      96 |       data: {
      97 |         username: `test_csv_user1_${Date.now()}`,
      98 |         passwordHash: 'test',

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleCsvStreamingRevenue.property.test.ts:95:19)

  ● Property 15: Cycle CSV Contains Streaming Revenue Column › should include streaming_revenue column in CSV export

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleCsvStreamingRevenue.property.test.ts:132:27

      129 
      130 // Cleanup - delete in correct order to avoid foreign key constraints
      131 // Clean up audit log entries for this test cycle
    → 132 await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      130 |     // Cleanup - delete in correct order to avoid foreign key constraints
      131 |     // Clean up audit log entries for this test cycle
    > 132 |     await prisma.auditLog.deleteMany({
          |     ^
      133 |       where: {
      134 |         cycleNumber: {
      135 |           gte: testCycleNumber,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleCsvStreamingRevenue.property.test.ts:132:5)

  ● Property 15: Cycle CSV Contains Streaming Revenue Column › should show ₡0 for bye matches in CSV

    PrismaClientInitializationError: 
    Invalid `prisma.user.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleCsvStreamingRevenue.property.test.ts:95:37

      92 
      93 beforeAll(async () => {
      94   // Create test users
    → 95   const user1 = await prisma.user.create(
    Too many database connections opened: FATAL: sorry, too many clients already

      93 |   beforeAll(async () => {
      94 |     // Create test users
    > 95 |     const user1 = await prisma.user.create({
         |                   ^
      96 |       data: {
      97 |         username: `test_csv_user1_${Date.now()}`,
      98 |         passwordHash: 'test',

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleCsvStreamingRevenue.property.test.ts:95:19)

  ● Property 15: Cycle CSV Contains Streaming Revenue Column › should show ₡0 for bye matches in CSV

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleCsvStreamingRevenue.property.test.ts:132:27

      129 
      130 // Cleanup - delete in correct order to avoid foreign key constraints
      131 // Clean up audit log entries for this test cycle
    → 132 await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      130 |     // Cleanup - delete in correct order to avoid foreign key constraints
      131 |     // Clean up audit log entries for this test cycle
    > 132 |     await prisma.auditLog.deleteMany({
          |     ^
      133 |       where: {
      134 |         cycleNumber: {
      135 |           gte: testCycleNumber,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleCsvStreamingRevenue.property.test.ts:132:5)

  ● Property 15: Cycle CSV Contains Streaming Revenue Column › should include streaming revenue for both winner and loser

    PrismaClientInitializationError: 
    Invalid `prisma.user.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleCsvStreamingRevenue.property.test.ts:95:37

      92 
      93 beforeAll(async () => {
      94   // Create test users
    → 95   const user1 = await prisma.user.create(
    Too many database connections opened: FATAL: sorry, too many clients already

      93 |   beforeAll(async () => {
      94 |     // Create test users
    > 95 |     const user1 = await prisma.user.create({
         |                   ^
      96 |       data: {
      97 |         username: `test_csv_user1_${Date.now()}`,
      98 |         passwordHash: 'test',

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleCsvStreamingRevenue.property.test.ts:95:19)

  ● Property 15: Cycle CSV Contains Streaming Revenue Column › should include streaming revenue for both winner and loser

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleCsvStreamingRevenue.property.test.ts:132:27

      129 
      130 // Cleanup - delete in correct order to avoid foreign key constraints
      131 // Clean up audit log entries for this test cycle
    → 132 await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      130 |     // Cleanup - delete in correct order to avoid foreign key constraints
      131 |     // Clean up audit log entries for this test cycle
    > 132 |     await prisma.auditLog.deleteMany({
          |     ^
      133 |       where: {
      134 |         cycleNumber: {
      135 |           gte: testCycleNumber,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleCsvStreamingRevenue.property.test.ts:132:5)


  ● Test suite failed to run

    PrismaClientInitializationError: 
    Invalid `prisma.user.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleCsvStreamingRevenue.property.test.ts:185:23

      182 
      183 afterAll(async () => {
      184   // Final cleanup of users
    → 185   await prisma.user.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      183 |   afterAll(async () => {
      184 |     // Final cleanup of users
    > 185 |     await prisma.user.deleteMany({
          |     ^
      186 |       where: {
      187 |         OR: [{ id: testUserId1 }, { id: testUserId2 }],
      188 |       },

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleCsvStreamingRevenue.property.test.ts:185:5)

FAIL tests/financialReportStreamingRevenue.test.ts
  ● Financial Report - Streaming Revenue Integration › should include streaming revenue in financial report

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      18 |
      19 |   beforeAll(async () => {
    > 20 |     await prisma.$connect();
         |     ^
      21 |   });
      22 |
      23 |   afterEach(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/financialReportStreamingRevenue.test.ts:20:5)

  ● Financial Report - Streaming Revenue Integration › should include streaming revenue in financial report

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/financialReportStreamingRevenue.test.ts:25:27

      22 
      23 afterEach(async () => {
      24   // Clean up test data between tests
    → 25   await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      23 |   afterEach(async () => {
      24 |     // Clean up test data between tests
    > 25 |     await prisma.auditLog.deleteMany({});
         |     ^
      26 |     await prisma.battleParticipant.deleteMany({});
      27 |     await prisma.battle.deleteMany({});
      28 |     await prisma.robot.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/financialReportStreamingRevenue.test.ts:25:5)

  ● Financial Report - Streaming Revenue Integration › should show zero streaming revenue when no battles occurred

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      18 |
      19 |   beforeAll(async () => {
    > 20 |     await prisma.$connect();
         |     ^
      21 |   });
      22 |
      23 |   afterEach(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/financialReportStreamingRevenue.test.ts:20:5)

  ● Financial Report - Streaming Revenue Integration › should show zero streaming revenue when no battles occurred

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/financialReportStreamingRevenue.test.ts:25:27

      22 
      23 afterEach(async () => {
      24   // Clean up test data between tests
    → 25   await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      23 |   afterEach(async () => {
      24 |     // Clean up test data between tests
    > 25 |     await prisma.auditLog.deleteMany({});
         |     ^
      26 |     await prisma.battleParticipant.deleteMany({});
      27 |     await prisma.battle.deleteMany({});
      28 |     await prisma.robot.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/financialReportStreamingRevenue.test.ts:25:5)

  ● Financial Report - Streaming Revenue Integration › should only count streaming revenue from user's own robots

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      18 |
      19 |   beforeAll(async () => {
    > 20 |     await prisma.$connect();
         |     ^
      21 |   });
      22 |
      23 |   afterEach(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/financialReportStreamingRevenue.test.ts:20:5)

  ● Financial Report - Streaming Revenue Integration › should only count streaming revenue from user's own robots

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/financialReportStreamingRevenue.test.ts:25:27

      22 
      23 afterEach(async () => {
      24   // Clean up test data between tests
    → 25   await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      23 |   afterEach(async () => {
      24 |     // Clean up test data between tests
    > 25 |     await prisma.auditLog.deleteMany({});
         |     ^
      26 |     await prisma.battleParticipant.deleteMany({});
      27 |     await prisma.battle.deleteMany({});
      28 |     await prisma.robot.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/financialReportStreamingRevenue.test.ts:25:5)


  ● Test suite failed to run

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/financialReportStreamingRevenue.test.ts:42:27

      39 
      40 afterAll(async () => {
      41   // Final cleanup
    → 42   await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      40 |   afterAll(async () => {
      41 |     // Final cleanup
    > 42 |     await prisma.auditLog.deleteMany({});
         |     ^
      43 |     await prisma.battleParticipant.deleteMany({});
      44 |     await prisma.battle.deleteMany({});
      45 |     await prisma.robot.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/financialReportStreamingRevenue.test.ts:42:5)

FAIL tests/validation.test.ts
  ● Validation Service - Unit Tests › Stable Name Uniqueness Check › should return false when stable name is already taken by another user

    PrismaClientInitializationError: 
    Invalid `prisma.user.findFirst()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/validation.ts:68:42

      65  * Requirements: 1.6
      66  */
      67 export async function isStableNameUnique(name: string, userId: number): Promise<boolean> {
    → 68   const existingUser = await prisma.user.findFirst(
    Too many database connections opened: FATAL: sorry, too many clients already

      66 |  */
      67 | export async function isStableNameUnique(name: string, userId: number): Promise<boolean> {
    > 68 |   const existingUser = await prisma.user.findFirst({
         |                        ^
      69 |     where: {
      70 |       stableName: name,
      71 |       NOT: {

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at isStableNameUnique (src/utils/validation.ts:68:24)
      at Object.<anonymous> (tests/validation.test.ts:182:24)

  ● Validation Service - Unit Tests › Stable Name Uniqueness Check › should return true when stable name is not taken

    PrismaClientInitializationError: 
    Invalid `prisma.user.findFirst()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/validation.ts:68:42

      65  * Requirements: 1.6
      66  */
      67 export async function isStableNameUnique(name: string, userId: number): Promise<boolean> {
    → 68   const existingUser = await prisma.user.findFirst(
    Too many database connections opened: FATAL: sorry, too many clients already

      66 |  */
      67 | export async function isStableNameUnique(name: string, userId: number): Promise<boolean> {
    > 68 |   const existingUser = await prisma.user.findFirst({
         |                        ^
      69 |     where: {
      70 |       stableName: name,
      71 |       NOT: {

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at isStableNameUnique (src/utils/validation.ts:68:24)
      at Object.<anonymous> (tests/validation.test.ts:202:24)

  ● Validation Service - Unit Tests › Stable Name Uniqueness Check › should return true when stable name is owned by the current user

    PrismaClientInitializationError: 
    Invalid `prisma.user.findFirst()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/validation.ts:68:42

      65  * Requirements: 1.6
      66  */
      67 export async function isStableNameUnique(name: string, userId: number): Promise<boolean> {
    → 68   const existingUser = await prisma.user.findFirst(
    Too many database connections opened: FATAL: sorry, too many clients already

      66 |  */
      67 | export async function isStableNameUnique(name: string, userId: number): Promise<boolean> {
    > 68 |   const existingUser = await prisma.user.findFirst({
         |                        ^
      69 |     where: {
      70 |       stableName: name,
      71 |       NOT: {

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at isStableNameUnique (src/utils/validation.ts:68:24)
      at Object.<anonymous> (tests/validation.test.ts:223:24)

  ● Validation Service - Unit Tests › Stable Name Uniqueness Check › should be case-sensitive for uniqueness

    PrismaClientInitializationError: 
    Invalid `prisma.user.findFirst()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/validation.ts:68:42

      65  * Requirements: 1.6
      66  */
      67 export async function isStableNameUnique(name: string, userId: number): Promise<boolean> {
    → 68   const existingUser = await prisma.user.findFirst(
    Too many database connections opened: FATAL: sorry, too many clients already

      66 |  */
      67 | export async function isStableNameUnique(name: string, userId: number): Promise<boolean> {
    > 68 |   const existingUser = await prisma.user.findFirst({
         |                        ^
      69 |     where: {
      70 |       stableName: name,
      71 |       NOT: {

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at isStableNameUnique (src/utils/validation.ts:68:24)
      at Object.<anonymous> (tests/validation.test.ts:256:24)

FAIL tests/repairCostMultiRobot.property.test.ts


  ● Test suite failed to run

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)

FAIL tests/auth.test.ts
  ● Console

    console.error
      Login error: PrismaClientInitializationError: 
      Invalid `prisma.user.findUnique()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/auth.ts:19:36
      
        16 }
        17 
        18 // Find user by username
      → 19 const user = await prisma.user.findUnique(
      Too many database connections opened: FATAL: sorry, too many clients already
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7615)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/auth.ts:19:18 {
        clientVersion: '5.22.0',
        errorCode: undefined
      }

      54 |     });
      55 |   } catch (error) {
    > 56 |     console.error('Login error:', error);
         |             ^
      57 |     res.status(500).json({ error: 'Internal server error' });
      58 |   }
      59 | });

      at src/routes/auth.ts:56:13

    console.log
      Skipping test_user_001 test - seed data not present

      at Object.<anonymous> (tests/auth.test.ts:237:17)

  ● Authentication Endpoints › POST /api/auth/login › should successfully login with valid credentials

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      106 |         });
      107 |
    > 108 |       expect(response.status).toBe(200);
          |                               ^
      109 |       expect(response.body).toHaveProperty('token');
      110 |       expect(response.body).toHaveProperty('user');
      111 |       

      at Object.<anonymous> (tests/auth.test.ts:108:31)

PASS tests/tagTeamBattleOrchestrator.property.test.ts
PASS tests/economyCalculations.test.ts
PASS tests/streamingStudioUpgradeCosts.property.test.ts
PASS tests/validation.property.test.ts
PASS tests/streamingStudioOperatingCost.property.test.ts
PASS tests/combatMessageGenerator.test.ts
PASS tests/weaponValidation.test.ts
PASS tests/storageCalculations.test.ts
FAIL tests/facilityTransactionLogging.test.ts
  ● Facility Transaction Logging › should log facility_purchase event when purchasing a new facility

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      16 |
      17 |   beforeAll(async () => {
    > 18 |     await prisma.$connect();
         |     ^
      19 |   });
      20 |
      21 |   afterEach(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/facilityTransactionLogging.test.ts:18:5)

  ● Facility Transaction Logging › should log facility_purchase event when purchasing a new facility

    Property failed after 1 tests
    { seed: 443249998, path: "0:0:0", endOnFailure: true }
    Counterexample: [1,1]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.user.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/repairCostMultiRobot.property.test.ts:887:44

      884 fc.integer({ min: 1, max: 5 }), // number of damaged robots
      885 async (numHealthy, numDamaged) => {
      886   // Create test user for this iteration
    → 887   const user = await prisma.user.create(
    Too many database connections opened: FATAL: sorry, too many clients already
    Prisma Accelerate has built-in connection pooling to prevent such errors: https://pris.ly/client/error-accelerate

      885 |           async (numHealthy, numDamaged) => {
      886 |             // Create test user for this iteration
    > 887 |             const user = await prisma.user.create({
          |                          ^
      888 |               data: {
      889 |                 username: `rc_test_${Date.now()}_${Math.floor(Math.random() * 1000000)}`,
      890 |                 passwordHash: 'test_hash',

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at tests/repairCostMultiRobot.property.test.ts:887:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)

  ● Facility Transaction Logging › should log facility_purchase event when purchasing a new facility

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/facilityTransactionLogging.test.ts:23:27

      20 
      21 afterEach(async () => {
      22   // Clean up test data after each test
    → 23   await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      21 |   afterEach(async () => {
      22 |     // Clean up test data after each test
    > 23 |     await prisma.auditLog.deleteMany({
         |     ^
      24 |       where: {
      25 |         userId: testUserId,
      26 |         eventType: { in: ['facility_purchase', 'facility_upgrade'] },

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/facilityTransactionLogging.test.ts:23:5)

  ● Facility Transaction Logging › should log facility_upgrade event when upgrading an existing facility

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      16 |
      17 |   beforeAll(async () => {
    > 18 |     await prisma.$connect();
         |     ^
      19 |   });
      20 |
      21 |   afterEach(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/facilityTransactionLogging.test.ts:18:5)

  ● Facility Transaction Logging › should log facility_upgrade event when upgrading an existing facility

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/facilityTransactionLogging.test.ts:23:27

      20 
      21 afterEach(async () => {
      22   // Clean up test data after each test
    → 23   await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      21 |   afterEach(async () => {
      22 |     // Clean up test data after each test
    > 23 |     await prisma.auditLog.deleteMany({
         |     ^
      24 |       where: {
      25 |         userId: testUserId,
      26 |         eventType: { in: ['facility_purchase', 'facility_upgrade'] },

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/facilityTransactionLogging.test.ts:23:5)

  ● Facility Transaction Logging › should include all required fields in the event payload

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      16 |
      17 |   beforeAll(async () => {
    > 18 |     await prisma.$connect();
         |     ^
      19 |   });
      20 |
      21 |   afterEach(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/facilityTransactionLogging.test.ts:18:5)

  ● Facility Transaction Logging › should include all required fields in the event payload

    Property failed after 1 tests
    { seed: -1858135954, path: "0:0:0:0:0", endOnFailure: true }
    Counterexample: [1,1000,50,10]
    Shrunk 4 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.user.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/repairCostMultiRobot.property.test.ts:1025:44

      1022 fc.integer({ min: 10, max: 100 }), // hpPercent
      1023 async (repairBayLevel, sumOfAllAttributes, damagePercent, hpPercent) => {
      1024   // Create test user for this iteration
    → 1025   const user = await prisma.user.create(
    Too many database connections opened: FATAL: sorry, too many clients already
    Prisma Accelerate has built-in connection pooling to prevent such errors: https://pris.ly/client/error-accelerate

      1023 |           async (repairBayLevel, sumOfAllAttributes, damagePercent, hpPercent) => {
      1024 |             // Create test user for this iteration
    > 1025 |             const user = await prisma.user.create({
           |                          ^
      1026 |               data: {
      1027 |                 username: `rc_test_${Date.now()}_${Math.floor(Math.random() * 1000000)}`,
      1028 |                 passwordHash: 'test_hash',

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at tests/repairCostMultiRobot.property.test.ts:1025:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)

  ● Facility Transaction Logging › should include all required fields in the event payload

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/facilityTransactionLogging.test.ts:23:27

      20 
      21 afterEach(async () => {
      22   // Clean up test data after each test
    → 23   await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      21 |   afterEach(async () => {
      22 |     // Clean up test data after each test
    > 23 |     await prisma.auditLog.deleteMany({
         |     ^
      24 |       where: {
      25 |         userId: testUserId,
      26 |         eventType: { in: ['facility_purchase', 'facility_upgrade'] },

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/facilityTransactionLogging.test.ts:23:5)

  ● Facility Transaction Logging › should log events with correct cycle number

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      16 |
      17 |   beforeAll(async () => {
    > 18 |     await prisma.$connect();
         |     ^
      19 |   });
      20 |
      21 |   afterEach(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/facilityTransactionLogging.test.ts:18:5)

  ● Facility Transaction Logging › should log events with correct cycle number

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/facilityTransactionLogging.test.ts:23:27

      20 
      21 afterEach(async () => {
      22   // Clean up test data after each test
    → 23   await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      21 |   afterEach(async () => {
      22 |     // Clean up test data after each test
    > 23 |     await prisma.auditLog.deleteMany({
         |     ^
      24 |       where: {
      25 |         userId: testUserId,
      26 |         eventType: { in: ['facility_purchase', 'facility_upgrade'] },

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/facilityTransactionLogging.test.ts:23:5)

  ● Facility Transaction Logging › should distinguish between purchase and upgrade events

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      16 |
      17 |   beforeAll(async () => {
    > 18 |     await prisma.$connect();
         |     ^
      19 |   });
      20 |
      21 |   afterEach(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/facilityTransactionLogging.test.ts:18:5)

  ● Facility Transaction Logging › should distinguish between purchase and upgrade events

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/facilityTransactionLogging.test.ts:23:27

      20 
      21 afterEach(async () => {
      22   // Clean up test data after each test
    → 23   await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      21 |   afterEach(async () => {
      22 |     // Clean up test data after each test
    > 23 |     await prisma.auditLog.deleteMany({
         |     ^
      24 |       where: {
      25 |         userId: testUserId,
      26 |         eventType: { in: ['facility_purchase', 'facility_upgrade'] },

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/facilityTransactionLogging.test.ts:23:5)


  ● Test suite failed to run

    Property failed after 1 tests
    { seed: 300705198, path: "0:0", endOnFailure: true }
    Counterexample: [1]
    Shrunk 1 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

  ● Test suite failed to run

    Property failed after 1 tests
    { seed: 66571471, path: "0:0", endOnFailure: true }
    Counterexample: [1,1]
    Shrunk 1 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

PASS tests/damageDampeners.test.ts
PASS tests/repairCostMultiRobot.test.ts
FAIL tests/integration/tagTeamByeHandling.test.ts
  ● Test suite failed to run

    [96mtests/integration/tagTeamByeHandling.test.ts[0m:[93m245[0m:[93m27[0m - [91merror[0m[90m TS2552: [0mCannot find name 'testRobots'. Did you mean 'testRobotIds'?

    [7m245[0m     const originalRobot = testRobots.find(r => r.id === realTeamId);
    [7m   [0m [91m                          ~~~~~~~~~~[0m

      [96mtests/integration/tagTeamByeHandling.test.ts[0m:[93m24[0m:[93m7[0m
        [7m24[0m   let testRobotIds: number[] = [];
        [7m  [0m [96m      ~~~~~~~~~~~~[0m
        'testRobotIds' is declared here.
    [96mtests/integration/tagTeamByeHandling.test.ts[0m:[93m245[0m:[93m43[0m - [91merror[0m[90m TS7006: [0mParameter 'r' implicitly has an 'any' type.

    [7m245[0m     const originalRobot = testRobots.find(r => r.id === realTeamId);
    [7m   [0m [91m                                          ~[0m
    [96mtests/integration/tagTeamByeHandling.test.ts[0m:[93m257[0m:[93m26[0m - [91merror[0m[90m TS2552: [0mCannot find name 'testUsers'. Did you mean 'testUserIds'?

    [7m257[0m     const originalUser = testUsers.find(u => u.id === user!.id);
    [7m   [0m [91m                         ~~~~~~~~~[0m

      [96mtests/integration/tagTeamByeHandling.test.ts[0m:[93m23[0m:[93m7[0m
        [7m23[0m   let testUserIds: number[] = [];
        [7m  [0m [96m      ~~~~~~~~~~~[0m
        'testUserIds' is declared here.
    [96mtests/integration/tagTeamByeHandling.test.ts[0m:[93m257[0m:[93m41[0m - [91merror[0m[90m TS7006: [0mParameter 'u' implicitly has an 'any' type.

    [7m257[0m     const originalUser = testUsers.find(u => u.id === user!.id);
    [7m   [0m [91m                                        ~[0m

FAIL tests/integration/tagTeamCompleteCycle.test.ts
  ● Test suite failed to run

    [96mtests/integration/tagTeamCompleteCycle.test.ts[0m:[93m300[0m:[93m25[0m - [91merror[0m[90m TS2552: [0mCannot find name 'testRobots'. Did you mean 'testRobotIds'?

    [7m300[0m         robot1Id: { in: testRobots.map(r => r.id) },
    [7m   [0m [91m                        ~~~~~~~~~~[0m

      [96mtests/integration/tagTeamCompleteCycle.test.ts[0m:[93m25[0m:[93m7[0m
        [7m25[0m   let testRobotIds: number[] = [];
        [7m  [0m [96m      ~~~~~~~~~~~~[0m
        'testRobotIds' is declared here.
    [96mtests/integration/tagTeamCompleteCycle.test.ts[0m:[93m300[0m:[93m40[0m - [91merror[0m[90m TS7006: [0mParameter 'r' implicitly has an 'any' type.

    [7m300[0m         robot1Id: { in: testRobots.map(r => r.id) },
    [7m   [0m [91m                                       ~[0m

FAIL tests/userGeneration.test.ts
  ● Test suite failed to run

    [96mtests/userGeneration.test.ts[0m:[93m148[0m:[93m56[0m - [91merror[0m[90m TS2554: [0mExpected 1 arguments, but got 2.

    [7m148[0m       const result = await generateBattleReadyUsers(5, cycleNumber);
    [7m   [0m [91m                                                       ~~~~~~~~~~~[0m
    [96mtests/userGeneration.test.ts[0m:[93m166[0m:[93m41[0m - [91merror[0m[90m TS2554: [0mExpected 1 arguments, but got 2.

    [7m166[0m       await generateBattleReadyUsers(3, cycleNumber);
    [7m   [0m [91m                                        ~~~~~~~~~~~[0m
    [96mtests/userGeneration.test.ts[0m:[93m181[0m:[93m41[0m - [91merror[0m[90m TS2554: [0mExpected 1 arguments, but got 2.

    [7m181[0m       await generateBattleReadyUsers(1, cycleNumber);
    [7m   [0m [91m                                        ~~~~~~~~~~~[0m
    [96mtests/userGeneration.test.ts[0m:[93m208[0m:[93m41[0m - [91merror[0m[90m TS2554: [0mExpected 1 arguments, but got 2.

    [7m208[0m       await generateBattleReadyUsers(2, cycleNumber);
    [7m   [0m [91m                                        ~~~~~~~~~~~[0m
    [96mtests/userGeneration.test.ts[0m:[93m229[0m:[93m41[0m - [91merror[0m[90m TS2554: [0mExpected 1 arguments, but got 2.

    [7m229[0m       await generateBattleReadyUsers(1, cycleNumber);
    [7m   [0m [91m                                        ~~~~~~~~~~~[0m
    [96mtests/userGeneration.test.ts[0m:[93m247[0m:[93m41[0m - [91merror[0m[90m TS2554: [0mExpected 1 arguments, but got 2.

    [7m247[0m       await generateBattleReadyUsers(3, cycleNumber);
    [7m   [0m [91m                                        ~~~~~~~~~~~[0m
    [96mtests/userGeneration.test.ts[0m:[93m263[0m:[93m41[0m - [91merror[0m[90m TS2554: [0mExpected 1 arguments, but got 2.

    [7m263[0m       await generateBattleReadyUsers(5, cycleNumber);
    [7m   [0m [91m                                        ~~~~~~~~~~~[0m
    [96mtests/userGeneration.test.ts[0m:[93m301[0m:[93m41[0m - [91merror[0m[90m TS2554: [0mExpected 1 arguments, but got 2.

    [7m301[0m       await generateBattleReadyUsers(3, cycleNumber);
    [7m   [0m [91m                                        ~~~~~~~~~~~[0m
    [96mtests/userGeneration.test.ts[0m:[93m327[0m:[93m56[0m - [91merror[0m[90m TS2554: [0mExpected 1 arguments, but got 2.

    [7m327[0m       const result = await generateBattleReadyUsers(3, cycleNumber);
    [7m   [0m [91m                                                       ~~~~~~~~~~~[0m
    [96mtests/userGeneration.test.ts[0m:[93m351[0m:[93m5[0m - [91merror[0m[90m TS1005: [0m',' expected.

    [7m351[0m     });
    [7m   [0m [91m    ~[0m
    [96mtests/userGeneration.test.ts[0m:[93m421[0m:[93m3[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

    [7m421[0m   });
    [7m   [0m [91m  ~[0m
    [96mtests/userGeneration.test.ts[0m:[93m421[0m:[93m4[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

    [7m421[0m   });
    [7m   [0m [91m   ~[0m
    [96mtests/userGeneration.test.ts[0m:[93m422[0m:[93m1[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

    [7m422[0m });
    [7m   [0m [91m~[0m
    [96mtests/userGeneration.test.ts[0m:[93m422[0m:[93m2[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

    [7m422[0m });
    [7m   [0m [91m ~[0m

FAIL tests/integration/repairCostConsistency.test.ts
  ● Test suite failed to run

    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m40[0m:[93m18[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'robot' does not exist in type 'WeaponInventoryWhereInput'.

    [7m40[0m         where: { robot: { id: { in: testRobotIds } } },
    [7m  [0m [91m                 ~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m148[0m:[93m24[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m148[0m           loadoutType: 'single',
    [7m   [0m [91m                       ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m149[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'mainWeaponId'.

    [7m149[0m           mainWeaponId: weaponInv.id,
    [7m   [0m [91m          ~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m149[0m:[93m25[0m - [91merror[0m[90m TS2304: [0mCannot find name 'weaponInv'.

    [7m149[0m           mainWeaponId: weaponInv.id,
    [7m   [0m [91m                        ~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m150[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'currentLeague'.

    [7m150[0m           currentLeague: 'bronze',
    [7m   [0m [91m          ~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m150[0m:[93m26[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m150[0m           currentLeague: 'bronze',
    [7m   [0m [91m                         ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m151[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'leagueId'.

    [7m151[0m           leagueId: 'bronze_1',
    [7m   [0m [91m          ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m151[0m:[93m21[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m151[0m           leagueId: 'bronze_1',
    [7m   [0m [91m                    ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m152[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'leaguePoints'.

    [7m152[0m           leaguePoints: 0,
    [7m   [0m [91m          ~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m152[0m:[93m25[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m152[0m           leaguePoints: 0,
    [7m   [0m [91m                        ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m153[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'cyclesInCurrentLeague'.

    [7m153[0m           cyclesInCurrentLeague: 0,
    [7m   [0m [91m          ~~~~~~~~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m153[0m:[93m34[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m153[0m           cyclesInCurrentLeague: 0,
    [7m   [0m [91m                                 ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m155[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'combatPower'.

    [7m155[0m           combatPower: 10,
    [7m   [0m [91m          ~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m155[0m:[93m24[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m155[0m           combatPower: 10,
    [7m   [0m [91m                       ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m156[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'targetingSystems'.

    [7m156[0m           targetingSystems: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m156[0m:[93m29[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m156[0m           targetingSystems: 10,
    [7m   [0m [91m                            ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m157[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'criticalSystems'.

    [7m157[0m           criticalSystems: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m157[0m:[93m28[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m157[0m           criticalSystems: 10,
    [7m   [0m [91m                           ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m158[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'penetration'.

    [7m158[0m           penetration: 10,
    [7m   [0m [91m          ~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m158[0m:[93m24[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m158[0m           penetration: 10,
    [7m   [0m [91m                       ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m159[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'weaponControl'.

    [7m159[0m           weaponControl: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m159[0m:[93m26[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m159[0m           weaponControl: 10,
    [7m   [0m [91m                         ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m160[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'attackSpeed'.

    [7m160[0m           attackSpeed: 10,
    [7m   [0m [91m          ~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m160[0m:[93m24[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m160[0m           attackSpeed: 10,
    [7m   [0m [91m                       ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m161[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'armorPlating'.

    [7m161[0m           armorPlating: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m161[0m:[93m25[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m161[0m           armorPlating: 10,
    [7m   [0m [91m                        ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m162[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'shieldCapacity'.

    [7m162[0m           shieldCapacity: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m162[0m:[93m27[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m162[0m           shieldCapacity: 10,
    [7m   [0m [91m                          ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m163[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'evasionThrusters'.

    [7m163[0m           evasionThrusters: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m163[0m:[93m29[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m163[0m           evasionThrusters: 10,
    [7m   [0m [91m                            ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m164[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'damageDampeners'.

    [7m164[0m           damageDampeners: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m164[0m:[93m28[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m164[0m           damageDampeners: 10,
    [7m   [0m [91m                           ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m165[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'counterProtocols'.

    [7m165[0m           counterProtocols: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m165[0m:[93m29[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m165[0m           counterProtocols: 10,
    [7m   [0m [91m                            ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m166[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'hullIntegrity'.

    [7m166[0m           hullIntegrity: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m166[0m:[93m26[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m166[0m           hullIntegrity: 10,
    [7m   [0m [91m                         ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m167[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'servoMotors'.

    [7m167[0m           servoMotors: 10,
    [7m   [0m [91m          ~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m167[0m:[93m24[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m167[0m           servoMotors: 10,
    [7m   [0m [91m                       ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m168[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'gyroStabilizers'.

    [7m168[0m           gyroStabilizers: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m168[0m:[93m28[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m168[0m           gyroStabilizers: 10,
    [7m   [0m [91m                           ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m169[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'hydraulicSystems'.

    [7m169[0m           hydraulicSystems: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m169[0m:[93m29[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m169[0m           hydraulicSystems: 10,
    [7m   [0m [91m                            ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m170[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'powerCore'.

    [7m170[0m           powerCore: 10,
    [7m   [0m [91m          ~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m170[0m:[93m22[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m170[0m           powerCore: 10,
    [7m   [0m [91m                     ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m171[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'combatAlgorithms'.

    [7m171[0m           combatAlgorithms: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m171[0m:[93m29[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m171[0m           combatAlgorithms: 10,
    [7m   [0m [91m                            ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m172[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'threatAnalysis'.

    [7m172[0m           threatAnalysis: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m172[0m:[93m27[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m172[0m           threatAnalysis: 10,
    [7m   [0m [91m                          ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m173[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'adaptiveAI'.

    [7m173[0m           adaptiveAI: 10,
    [7m   [0m [91m          ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m173[0m:[93m23[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m173[0m           adaptiveAI: 10,
    [7m   [0m [91m                      ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m174[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'logicCores'.

    [7m174[0m           logicCores: 10,
    [7m   [0m [91m          ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m174[0m:[93m23[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m174[0m           logicCores: 10,
    [7m   [0m [91m                      ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m175[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'syncProtocols'.

    [7m175[0m           syncProtocols: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m175[0m:[93m26[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m175[0m           syncProtocols: 10,
    [7m   [0m [91m                         ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m176[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'supportSystems'.

    [7m176[0m           supportSystems: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m176[0m:[93m27[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m176[0m           supportSystems: 10,
    [7m   [0m [91m                          ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m177[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'formationTactics'.

    [7m177[0m           formationTactics: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m177[0m:[93m29[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m177[0m           formationTactics: 10,
    [7m   [0m [91m                            ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m180[0m:[93m7[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m180[0m       testRobots.push(robot);
    [7m   [0m [91m      ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m180[0m:[93m23[0m - [91merror[0m[90m TS2448: [0mBlock-scoped variable 'robot' used before its declaration.

    [7m180[0m       testRobots.push(robot);
    [7m   [0m [91m                      ~~~~~[0m

      [96mtests/integration/repairCostConsistency.test.ts[0m:[93m212[0m:[93m11[0m
        [7m212[0m     const robot = testRobots[0];
        [7m   [0m [96m          ~~~~~[0m
        'robot' is declared here.
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m181[0m:[93m7[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobotIds'.

    [7m181[0m       testRobotIds.push(robot.id);
    [7m   [0m [91m      ~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m181[0m:[93m25[0m - [91merror[0m[90m TS2448: [0mBlock-scoped variable 'robot' used before its declaration.

    [7m181[0m       testRobotIds.push(robot.id);
    [7m   [0m [91m                        ~~~~~[0m

      [96mtests/integration/repairCostConsistency.test.ts[0m:[93m212[0m:[93m11[0m
        [7m212[0m     const robot = testRobots[0];
        [7m   [0m [96m          ~~~~~[0m
        'robot' is declared here.
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m187[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m187[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m194[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m194[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m202[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m202[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m212[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m212[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m254[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m254[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m261[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m261[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m269[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m269[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m275[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m275[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m321[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m321[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m328[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m328[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m336[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m336[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m342[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m342[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m384[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m384[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m389[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m389[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m441[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m441[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m480[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m480[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m496[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m496[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m529[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m529[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m535[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m535[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m542[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m542[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m549[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m549[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m608[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m608[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m614[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m614[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m621[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m621[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m628[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m628[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m685[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m685[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m691[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m691[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m698[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m698[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m706[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m706[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m772[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m772[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m778[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m778[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m785[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m785[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m792[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m792[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m836[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m836[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m842[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m842[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m149[0m:[93m23[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m149[0m           mainWeaponId: weaponInv.id,
    [7m   [0m [91m                      ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m150[0m:[93m24[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m150[0m           currentLeague: 'bronze',
    [7m   [0m [91m                       ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m151[0m:[93m19[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m151[0m           leagueId: 'bronze_1',
    [7m   [0m [91m                  ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m152[0m:[93m23[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m152[0m           leaguePoints: 0,
    [7m   [0m [91m                      ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m153[0m:[93m32[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m153[0m           cyclesInCurrentLeague: 0,
    [7m   [0m [91m                               ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m155[0m:[93m22[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m155[0m           combatPower: 10,
    [7m   [0m [91m                     ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m156[0m:[93m27[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m156[0m           targetingSystems: 10,
    [7m   [0m [91m                          ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m157[0m:[93m26[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m157[0m           criticalSystems: 10,
    [7m   [0m [91m                         ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m158[0m:[93m22[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m158[0m           penetration: 10,
    [7m   [0m [91m                     ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m159[0m:[93m24[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m159[0m           weaponControl: 10,
    [7m   [0m [91m                       ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m160[0m:[93m22[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m160[0m           attackSpeed: 10,
    [7m   [0m [91m                     ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m161[0m:[93m23[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m161[0m           armorPlating: 10,
    [7m   [0m [91m                      ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m162[0m:[93m25[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m162[0m           shieldCapacity: 10,
    [7m   [0m [91m                        ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m163[0m:[93m27[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m163[0m           evasionThrusters: 10,
    [7m   [0m [91m                          ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m164[0m:[93m26[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m164[0m           damageDampeners: 10,
    [7m   [0m [91m                         ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m165[0m:[93m27[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m165[0m           counterProtocols: 10,
    [7m   [0m [91m                          ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m166[0m:[93m24[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m166[0m           hullIntegrity: 10,
    [7m   [0m [91m                       ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m167[0m:[93m22[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m167[0m           servoMotors: 10,
    [7m   [0m [91m                     ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m168[0m:[93m26[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m168[0m           gyroStabilizers: 10,
    [7m   [0m [91m                         ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m169[0m:[93m27[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m169[0m           hydraulicSystems: 10,
    [7m   [0m [91m                          ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m170[0m:[93m20[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m170[0m           powerCore: 10,
    [7m   [0m [91m                   ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m171[0m:[93m27[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m171[0m           combatAlgorithms: 10,
    [7m   [0m [91m                          ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m172[0m:[93m25[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m172[0m           threatAnalysis: 10,
    [7m   [0m [91m                        ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m173[0m:[93m21[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m173[0m           adaptiveAI: 10,
    [7m   [0m [91m                    ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m174[0m:[93m21[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m174[0m           logicCores: 10,
    [7m   [0m [91m                    ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m175[0m:[93m24[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m175[0m           syncProtocols: 10,
    [7m   [0m [91m                       ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m176[0m:[93m25[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m176[0m           supportSystems: 10,
    [7m   [0m [91m                        ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m177[0m:[93m27[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m177[0m           formationTactics: 10,
    [7m   [0m [91m                          ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m178[0m:[93m9[0m - [91merror[0m[90m TS1109: [0mExpression expected.

    [7m178[0m         },
    [7m   [0m [91m        ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m179[0m:[93m7[0m - [91merror[0m[90m TS1135: [0mArgument expression expected.

    [7m179[0m       });
    [7m   [0m [91m      ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m182[0m:[93m5[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

    [7m182[0m     }
    [7m   [0m [91m    ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m248[0m:[93m3[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

    [7m248[0m   });
    [7m   [0m [91m  ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m248[0m:[93m4[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

    [7m248[0m   });
    [7m   [0m [91m   ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m894[0m:[93m1[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

    [7m894[0m });
    [7m   [0m [91m~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m894[0m:[93m2[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

    [7m894[0m });
    [7m   [0m [91m ~[0m

FAIL tests/stanceAndYield.test.ts
  ● Test suite failed to run

    [96mtests/stanceAndYield.test.ts[0m:[93m13[0m:[93m65[0m - [91merror[0m[90m TS2322: [0mType '{ name: string; id: number; userId: number; frameId: number; paintJob: string | null; combatPower: Prisma.Decimal; targetingSystems: Prisma.Decimal; criticalSystems: Prisma.Decimal; ... 55 more ...; updatedAt: Date; }' is not assignable to type '{ name: string; id: number; userId: number; frameId: number; paintJob: string | null; combatPower: Decimal; targetingSystems: Decimal; criticalSystems: Decimal; ... 55 more ...; updatedAt: Date; }'.
      Types of property 'totalTagTeamBattles' are incompatible.
        Type 'number | undefined' is not assignable to type 'number'.
          Type 'undefined' is not assignable to type 'number'.

    [7m 13[0m const createMockRobot = (overrides?: Partial<Robot>): Robot => ({
    [7m   [0m [91m                                                                ~[0m
    [7m 14[0m   id: 1,
    [7m   [0m [91m~~~~~~~~[0m
    [7m...[0m 
    [7m 71[0m   ...overrides,
    [7m   [0m [91m~~~~~~~~~~~~~~~[0m
    [7m 72[0m });
    [7m   [0m [91m~[0m

FAIL tests/tagTeamModelIntegration.test.ts
  ● Test suite failed to run

    [96mtests/tagTeamModelIntegration.test.ts[0m:[93m307[0m:[93m14[0m - [91merror[0m[90m TS18047: [0m'match.team2' is possibly 'null'.

    [7m307[0m       expect(match?.team2.activeRobot.id).toBe(testRobot3Id);
    [7m   [0m [91m             ~~~~~~~~~~~~[0m
    [96mtests/tagTeamModelIntegration.test.ts[0m:[93m308[0m:[93m14[0m - [91merror[0m[90m TS18047: [0m'match.team2' is possibly 'null'.

    [7m308[0m       expect(match?.team2.reserveRobot.id).toBe(testRobot4Id);
    [7m   [0m [91m             ~~~~~~~~~~~~[0m

FAIL tests/robotCalculations.test.ts
  ● Test suite failed to run

    [96mtests/robotCalculations.test.ts[0m:[93m12[0m:[93m65[0m - [91merror[0m[90m TS2322: [0mType '{ name: string; id: number; userId: number; frameId: number; paintJob: string | null; combatPower: Prisma.Decimal; targetingSystems: Prisma.Decimal; criticalSystems: Prisma.Decimal; ... 55 more ...; updatedAt: Date; }' is not assignable to type '{ name: string; id: number; userId: number; frameId: number; paintJob: string | null; combatPower: Decimal; targetingSystems: Decimal; criticalSystems: Decimal; ... 55 more ...; updatedAt: Date; }'.
      Types of property 'totalTagTeamBattles' are incompatible.
        Type 'number | undefined' is not assignable to type 'number'.
          Type 'undefined' is not assignable to type 'number'.

    [7m 12[0m const createMockRobot = (overrides?: Partial<Robot>): Robot => ({
    [7m   [0m [91m                                                                ~[0m
    [7m 13[0m   id: 1,
    [7m   [0m [91m~~~~~~~~[0m
    [7m...[0m 
    [7m 70[0m   ...overrides,
    [7m   [0m [91m~~~~~~~~~~~~~~~[0m
    [7m 71[0m });
    [7m   [0m [91m~[0m

FAIL tests/robotStatsView.test.ts
  ● Test suite failed to run

    [96mtests/robotStatsView.test.ts[0m:[93m79[0m:[93m11[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m79[0m           userId: testUserId,
    [7m  [0m [91m          ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/robotStatsView.test.ts[0m:[93m113[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m113[0m         userId: testUserId,
    [7m   [0m [91m        ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'

FAIL tests/trendAnalysis.property.test.ts
  ● Test suite failed to run

    [96mtests/trendAnalysis.property.test.ts[0m:[93m12[0m:[93m38[0m - [91merror[0m[90m TS2307: [0mCannot find module '../src/services/trendAnalysisService' or its corresponding type declarations.

    [7m12[0m import { trendAnalysisService } from '../src/services/trendAnalysisService';
    [7m  [0m [91m                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96mtests/trendAnalysis.property.test.ts[0m:[93m192[0m:[93m59[0m - [91merror[0m[90m TS7006: [0mParameter 'd' implicitly has an 'any' type.

    [7m192[0m             const cycleNumbersInData = trendData.data.map(d => d.cycleNumber).sort((a, b) => a - b);
    [7m   [0m [91m                                                          ~[0m
    [96mtests/trendAnalysis.property.test.ts[0m:[93m192[0m:[93m85[0m - [91merror[0m[90m TS7006: [0mParameter 'a' implicitly has an 'any' type.

    [7m192[0m             const cycleNumbersInData = trendData.data.map(d => d.cycleNumber).sort((a, b) => a - b);
    [7m   [0m [91m                                                                                    ~[0m
    [96mtests/trendAnalysis.property.test.ts[0m:[93m192[0m:[93m88[0m - [91merror[0m[90m TS7006: [0mParameter 'b' implicitly has an 'any' type.

    [7m192[0m             const cycleNumbersInData = trendData.data.map(d => d.cycleNumber).sort((a, b) => a - b);
    [7m   [0m [91m                                                                                       ~[0m
    [96mtests/trendAnalysis.property.test.ts[0m:[93m203[0m:[93m53[0m - [91merror[0m[90m TS7006: [0mParameter 'd' implicitly has an 'any' type.

    [7m203[0m               const dataPoint = trendData.data.find(d => d.cycleNumber === startCycle + i);
    [7m   [0m [91m                                                    ~[0m
    [96mtests/trendAnalysis.property.test.ts[0m:[93m260[0m:[93m19[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'user' does not exist in type 'Without<BattleUncheckedCreateInput, BattleCreateInput> & BattleCreateInput'.

    [7m260[0m                   user: { connect: { id: user.id } },
    [7m   [0m [91m                  ~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/trendAnalysis.property.test.ts[0m:[93m318[0m:[93m59[0m - [91merror[0m[90m TS7006: [0mParameter 'd' implicitly has an 'any' type.

    [7m318[0m             const cycleNumbersInData = trendData.data.map(d => d.cycleNumber).sort((a, b) => a - b);
    [7m   [0m [91m                                                          ~[0m
    [96mtests/trendAnalysis.property.test.ts[0m:[93m318[0m:[93m85[0m - [91merror[0m[90m TS7006: [0mParameter 'a' implicitly has an 'any' type.

    [7m318[0m             const cycleNumbersInData = trendData.data.map(d => d.cycleNumber).sort((a, b) => a - b);
    [7m   [0m [91m                                                                                    ~[0m
    [96mtests/trendAnalysis.property.test.ts[0m:[93m318[0m:[93m88[0m - [91merror[0m[90m TS7006: [0mParameter 'b' implicitly has an 'any' type.

    [7m318[0m             const cycleNumbersInData = trendData.data.map(d => d.cycleNumber).sort((a, b) => a - b);
    [7m   [0m [91m                                                                                       ~[0m
    [96mtests/trendAnalysis.property.test.ts[0m:[93m329[0m:[93m53[0m - [91merror[0m[90m TS7006: [0mParameter 'd' implicitly has an 'any' type.

    [7m329[0m               const dataPoint = trendData.data.find(d => d.cycleNumber === startCycle + i);
    [7m   [0m [91m                                                    ~[0m
    [96mtests/trendAnalysis.property.test.ts[0m:[93m419[0m:[93m59[0m - [91merror[0m[90m TS7006: [0mParameter 'd' implicitly has an 'any' type.

    [7m419[0m             const cycleNumbersInData = trendData.data.map(d => d.cycleNumber);
    [7m   [0m [91m                                                          ~[0m

FAIL tests/tagTeamBattleLogCompleteness.property.test.ts
  ● Test suite failed to run

    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m65[0m:[93m13[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'BattleWhereInput'.

    [7m65[0m           { userId: testUserId1 },
    [7m  [0m [91m            ~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m66[0m:[93m13[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'BattleWhereInput'.

    [7m66[0m           { userId: testUserId2 },
    [7m  [0m [91m            ~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m125[0m:[93m13[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'BattleWhereInput'.

    [7m125[0m           { userId: testUserId1 },
    [7m   [0m [91m            ~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m125[0m:[93m21[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m125[0m           { userId: testUserId1 },
    [7m   [0m [91m                    ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m126[0m:[93m13[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'BattleWhereInput'.

    [7m126[0m           { userId: testUserId2 },
    [7m   [0m [91m            ~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m126[0m:[93m21[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m126[0m           { userId: testUserId2 },
    [7m   [0m [91m                    ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m133[0m:[93m32[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m133[0m           { team1: { stableId: testUserId1 } },
    [7m   [0m [91m                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m134[0m:[93m32[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m134[0m           { team1: { stableId: testUserId2 } },
    [7m   [0m [91m                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m135[0m:[93m32[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m135[0m           { team2: { stableId: testUserId1 } },
    [7m   [0m [91m                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m136[0m:[93m32[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m136[0m           { team2: { stableId: testUserId2 } },
    [7m   [0m [91m                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m143[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m143[0m           { stableId: testUserId1 },
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m144[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m144[0m           { stableId: testUserId2 },
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m151[0m:[93m21[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m151[0m           { userId: testUserId1 },
    [7m   [0m [91m                    ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m152[0m:[93m21[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m152[0m           { userId: testUserId2 },
    [7m   [0m [91m                    ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m159[0m:[93m21[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m159[0m           { userId: testUserId1 },
    [7m   [0m [91m                    ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m160[0m:[93m21[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m160[0m           { userId: testUserId2 },
    [7m   [0m [91m                    ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m186[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m186[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m186[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m186[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m189[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m189[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m189[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m189[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m192[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m192[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m192[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m192[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m195[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m195[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m195[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m195[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m201[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m201[0m               userId: testUserId1,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m216[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m216[0m               userId: testUserId1,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m232[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m232[0m               userId: testUserId2,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m247[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m247[0m               userId: testUserId2,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m261[0m:[93m48[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m261[0m           const team1Result = await createTeam(testUserId1, robot1.id, robot2.id);
    [7m   [0m [91m                                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m262[0m:[93m48[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m262[0m           const team2Result = await createTeam(testUserId2, robot3.id, robot4.id);
    [7m   [0m [91m                                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m337[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m337[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m337[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m337[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m340[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m340[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m340[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m340[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m343[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m343[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m343[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m343[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m346[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m346[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m346[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m346[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m352[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m352[0m               userId: testUserId1,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m367[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m367[0m               userId: testUserId1,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m382[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m382[0m               userId: testUserId2,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m397[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m397[0m               userId: testUserId2,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m411[0m:[93m48[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m411[0m           const team1Result = await createTeam(testUserId1, robot1.id, robot2.id);
    [7m   [0m [91m                                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m412[0m:[93m48[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m412[0m           const team2Result = await createTeam(testUserId2, robot3.id, robot4.id);
    [7m   [0m [91m                                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m492[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m492[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m492[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m492[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m495[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m495[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m495[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m495[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m498[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m498[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m498[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m498[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m501[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m501[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m501[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m501[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m507[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m507[0m               userId: testUserId1,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m522[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m522[0m               userId: testUserId1,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m537[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m537[0m               userId: testUserId2,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m552[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m552[0m               userId: testUserId2,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m566[0m:[93m48[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m566[0m           const team1Result = await createTeam(testUserId1, robot1.id, robot2.id);
    [7m   [0m [91m                                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m567[0m:[93m48[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m567[0m           const team2Result = await createTeam(testUserId2, robot3.id, robot4.id);
    [7m   [0m [91m                                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m648[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m648[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m648[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m648[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m651[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m651[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m651[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m651[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m654[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m654[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m654[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m654[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m657[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m657[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m657[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m657[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m663[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m663[0m               userId: testUserId1,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m678[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m678[0m               userId: testUserId1,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m693[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m693[0m               userId: testUserId2,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m708[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m708[0m               userId: testUserId2,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m722[0m:[93m48[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m722[0m           const team1Result = await createTeam(testUserId1, robot1.id, robot2.id);
    [7m   [0m [91m                                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m723[0m:[93m48[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m723[0m           const team2Result = await createTeam(testUserId2, robot3.id, robot4.id);
    [7m   [0m [91m                                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m803[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m803[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m803[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m803[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m806[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m806[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m806[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m806[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m809[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m809[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m809[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m809[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m812[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m812[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m812[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m812[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m818[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m818[0m               userId: testUserId1,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m833[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m833[0m               userId: testUserId1,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m848[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m848[0m               userId: testUserId2,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m863[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m863[0m               userId: testUserId2,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m877[0m:[93m48[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m877[0m           const team1Result = await createTeam(testUserId1, robot1.id, robot2.id);
    [7m   [0m [91m                                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m878[0m:[93m48[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m878[0m           const team2Result = await createTeam(testUserId2, robot3.id, robot4.id);
    [7m   [0m [91m                                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m944[0m:[93m1[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

    [7m944[0m });
    [7m   [0m [91m~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m944[0m:[93m2[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

    [7m944[0m });
    [7m   [0m [91m ~[0m

FAIL tests/migrateBattlesToEvents.test.ts
  ● Test suite failed to run

    [96mtests/migrateBattlesToEvents.test.ts[0m:[93m8[0m:[93m57[0m - [91merror[0m[90m TS2307: [0mCannot find module '../src/scripts/migrateBattlesToEvents' or its corresponding type declarations.

    [7m8[0m import { migrateBattlesToEvents, verifyMigration } from '../src/scripts/migrateBattlesToEvents';
    [7m [0m [91m                                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96mtests/migrateBattlesToEvents.test.ts[0m:[93m111[0m:[93m33[0m - [91merror[0m[90m TS2339: [0mProperty 'robot1DamageDealt' does not exist on type '{ id: number; robot1Id: number; robot2Id: number; winnerId: number | null; battleType: string; leagueType: string; tournamentId: number | null; tournamentRound: number | null; team1ActiveRobotId: number | null; ... 22 more ...; createdAt: Date; }'.

    [7m111[0m       robot1DamageDealt: battle.robot1DamageDealt,
    [7m   [0m [91m                                ~~~~~~~~~~~~~~~~~[0m
    [96mtests/migrateBattlesToEvents.test.ts[0m:[93m112[0m:[93m33[0m - [91merror[0m[90m TS2339: [0mProperty 'robot2DamageDealt' does not exist on type '{ id: number; robot1Id: number; robot2Id: number; winnerId: number | null; battleType: string; leagueType: string; tournamentId: number | null; tournamentRound: number | null; team1ActiveRobotId: number | null; ... 22 more ...; createdAt: Date; }'.

    [7m112[0m       robot2DamageDealt: battle.robot2DamageDealt,
    [7m   [0m [91m                                ~~~~~~~~~~~~~~~~~[0m

FAIL tests/profileApiResponse.property.test.ts
  ● Test suite failed to run

    [96mtests/profileApiResponse.property.test.ts[0m:[93m66[0m:[93m17[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'totalBattles' does not exist in type '(Without<UserCreateInput, UserUncheckedCreateInput> & UserUncheckedCreateInput) | (Without<...> & UserCreateInput)'.

    [7m66[0m                 totalBattles: userProfile.totalBattles,
    [7m  [0m [91m                ~~~~~~~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m3397[0m:[93m5[0m
        [7m3397[0m     data: XOR<UserCreateInput, UserUncheckedCreateInput>
        [7m    [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: UserSelect<DefaultArgs> | null | undefined; include?: UserInclude<DefaultArgs> | null | undefined; data: (Without<UserCreateInput, UserUncheckedCreateInput> & UserUncheckedCreateInput) | (Without<...> & UserCreateInput); }'

FAIL tests/profileUpdate.property.test.ts
  ● Test suite failed to run

    [96mtests/profileUpdate.property.test.ts[0m:[93m491[0m:[93m43[0m - [91merror[0m[90m TS7053: [0mElement implicitly has an 'any' type because expression of type 'string' can't be used to index type '{ stableName?: string | undefined; profileVisibility?: "public" | "private" | undefined; notificationsBattle?: boolean | undefined; notificationsLeague?: boolean | undefined; themePreference?: "dark" | ... 2 more ... | undefined; }'.
      No index signature with a parameter of type 'string' was found on type '{ stableName?: string | undefined; profileVisibility?: "public" | "private" | undefined; notificationsBattle?: boolean | undefined; notificationsLeague?: boolean | undefined; themePreference?: "dark" | ... 2 more ... | undefined; }'.

    [7m491[0m     return Object.keys(obj).some((key) => obj[key] !== undefined);
    [7m   [0m [91m                                          ~~~~~~~~[0m
    [96mtests/profileUpdate.property.test.ts[0m:[93m518[0m:[93m43[0m - [91merror[0m[90m TS7053: [0mElement implicitly has an 'any' type because expression of type 'string' can't be used to index type '{ stableName?: string | undefined; profileVisibility?: "public" | "private" | undefined; notificationsBattle?: boolean | undefined; notificationsLeague?: boolean | undefined; themePreference?: "dark" | ... 2 more ... | undefined; }'.
      No index signature with a parameter of type 'string' was found on type '{ stableName?: string | undefined; profileVisibility?: "public" | "private" | undefined; notificationsBattle?: boolean | undefined; notificationsLeague?: boolean | undefined; themePreference?: "dark" | ... 2 more ... | undefined; }'.

    [7m518[0m     return Object.keys(obj).some((key) => obj[key] !== undefined);
    [7m   [0m [91m                                          ~~~~~~~~[0m

FAIL tests/multiMatchScheduling.property.test.ts
  ● Test suite failed to run

    [96mtests/multiMatchScheduling.property.test.ts[0m:[93m226[0m:[93m26[0m - [91merror[0m[90m TS2322: [0mType 'number | null' is not assignable to type 'number | (TagTeamActiveRobotIdReserveRobotIdCompoundUniqueInput & number) | undefined'.
      Type 'null' is not assignable to type 'number | (TagTeamActiveRobotIdReserveRobotIdCompoundUniqueInput & number) | undefined'.

    [7m226[0m                 where: { id: match.team2Id },
    [7m   [0m [91m                         ~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m22658[0m:[93m5[0m
        [7m22658[0m     id?: number
        [7m     [0m [96m    ~~[0m
        The expected type comes from property 'id' which is declared here on type 'TagTeamWhereUniqueInput'

FAIL tests/facilityROI.property.test.ts
  ● Test suite failed to run

    [96mtests/facilityROI.property.test.ts[0m:[93m53[0m:[93m63[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m53[0m           await prisma.auditLog.deleteMany({ where: { userId: testUserId } });
    [7m  [0m [91m                                                              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m54[0m:[93m63[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m54[0m           await prisma.facility.deleteMany({ where: { userId: testUserId } });
    [7m  [0m [91m                                                              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m59[0m:[93m23[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m59[0m               userId: testUserId,
    [7m  [0m [91m                      ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m73[0m:[93m15[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m73[0m               testUserId,
    [7m  [0m [91m              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m89[0m:[93m15[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m89[0m               testUserId,
    [7m  [0m [91m              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m99[0m:[93m56[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m99[0m             await eventLogger.logOperatingCosts(cycle, testUserId, [
    [7m  [0m [91m                                                       ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m113[0m:[93m13[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m113[0m             testUserId,
    [7m   [0m [91m            ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m150[0m:[93m63[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m150[0m           await prisma.auditLog.deleteMany({ where: { userId: testUserId } });
    [7m   [0m [91m                                                              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m151[0m:[93m63[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m151[0m           await prisma.facility.deleteMany({ where: { userId: testUserId } });
    [7m   [0m [91m                                                              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m156[0m:[93m23[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m156[0m               userId: testUserId,
    [7m   [0m [91m                      ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m170[0m:[93m15[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m170[0m               testUserId,
    [7m   [0m [91m              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m197[0m:[93m25[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m197[0m                 userId: testUserId,
    [7m   [0m [91m                        ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m198[0m:[93m26[0m - [91merror[0m[90m TS2454: [0mVariable 'testRobotId' is used before being assigned.

    [7m198[0m                 robotId: testRobotId,
    [7m   [0m [91m                         ~~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m208[0m:[93m52[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m208[0m             await eventLogger.logOperatingCosts(i, testUserId, [
    [7m   [0m [91m                                                   ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m222[0m:[93m13[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m222[0m             testUserId,
    [7m   [0m [91m            ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m256[0m:[93m63[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m256[0m           await prisma.auditLog.deleteMany({ where: { userId: testUserId } });
    [7m   [0m [91m                                                              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m257[0m:[93m63[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m257[0m           await prisma.facility.deleteMany({ where: { userId: testUserId } });
    [7m   [0m [91m                                                              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m262[0m:[93m23[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m262[0m               userId: testUserId,
    [7m   [0m [91m                      ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m276[0m:[93m15[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m276[0m               testUserId,
    [7m   [0m [91m              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m303[0m:[93m25[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m303[0m                 userId: testUserId,
    [7m   [0m [91m                        ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m304[0m:[93m26[0m - [91merror[0m[90m TS2454: [0mVariable 'testRobotId' is used before being assigned.

    [7m304[0m                 robotId: testRobotId,
    [7m   [0m [91m                         ~~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m316[0m:[93m52[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m316[0m             await eventLogger.logOperatingCosts(i, testUserId, [
    [7m   [0m [91m                                                   ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m330[0m:[93m13[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m330[0m             testUserId,
    [7m   [0m [91m            ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m366[0m:[93m63[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m366[0m           await prisma.auditLog.deleteMany({ where: { userId: testUserId } });
    [7m   [0m [91m                                                              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m367[0m:[93m63[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m367[0m           await prisma.facility.deleteMany({ where: { userId: testUserId } });
    [7m   [0m [91m                                                              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m372[0m:[93m25[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m372[0m               { userId: testUserId, facilityType: 'income_generator', level: 1 },
    [7m   [0m [91m                        ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m373[0m:[93m25[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m373[0m               { userId: testUserId, facilityType: 'repair_bay', level: 1 },
    [7m   [0m [91m                        ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m380[0m:[93m13[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m380[0m             testUserId,
    [7m   [0m [91m            ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m389[0m:[93m13[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m389[0m             testUserId,
    [7m   [0m [91m            ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m407[0m:[93m15[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m407[0m               testUserId,
    [7m   [0m [91m              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m428[0m:[93m25[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m428[0m                 userId: testUserId,
    [7m   [0m [91m                        ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m429[0m:[93m26[0m - [91merror[0m[90m TS2454: [0mVariable 'testRobotId' is used before being assigned.

    [7m429[0m                 robotId: testRobotId,
    [7m   [0m [91m                         ~~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m439[0m:[93m56[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m439[0m             await eventLogger.logOperatingCosts(cycle, testUserId, [
    [7m   [0m [91m                                                       ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m455[0m:[93m13[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m455[0m             testUserId,
    [7m   [0m [91m            ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m459[0m:[93m13[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m459[0m             testUserId,
    [7m   [0m [91m            ~~~~~~~~~~[0m

FAIL tests/integration.test.ts
  ● Test suite failed to run

    [96mtests/integration.test.ts[0m:[93m159[0m:[93m22[0m - [91merror[0m[90m TS2322: [0mType 'null' is not assignable to type 'InputJsonValue | FieldRef<"Battle", "Json"> | JsonNullValueFilter | undefined'.

    [7m159[0m         battleLog: { not: null },
    [7m   [0m [91m                     ~~~[0m
    [96mtests/integration.test.ts[0m:[93m268[0m:[93m13[0m - [91merror[0m[90m TS2322: [0mType 'null' is not assignable to type 'number | IntFilter<"Battle"> | undefined'.

    [7m268[0m           { robot1Id: null },
    [7m   [0m [91m            ~~~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m21904[0m:[93m5[0m
        [7m21904[0m     robot1Id?: IntFilter<"Battle"> | number
        [7m     [0m [96m    ~~~~~~~~[0m
        The expected type comes from property 'robot1Id' which is declared here on type 'BattleWhereInput'
    [96mtests/integration.test.ts[0m:[93m269[0m:[93m13[0m - [91merror[0m[90m TS2322: [0mType 'null' is not assignable to type 'number | IntFilter<"Battle"> | undefined'.

    [7m269[0m           { robot2Id: null },
    [7m   [0m [91m            ~~~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m21905[0m:[93m5[0m
        [7m21905[0m     robot2Id?: IntFilter<"Battle"> | number
        [7m     [0m [96m    ~~~~~~~~[0m
        The expected type comes from property 'robot2Id' which is declared here on type 'BattleWhereInput'

FAIL tests/metricProgression.property.test.ts
  ● Test suite failed to run

    [96mtests/metricProgression.property.test.ts[0m:[93m131[0m:[93m42[0m - [91merror[0m[90m TS2339: [0mProperty 'robot1FameAwarded' does not exist on type '{ robot2Id: number; robot1Id: number; id: number; createdAt: Date; winnerId: number | null; battleType: string; leagueType: string; tournamentRound: number | null; team1ActiveRobotId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m131[0m               const fameAwarded = battle.robot1FameAwarded;
    [7m   [0m [91m                                         ~~~~~~~~~~~~~~~~~[0m
    [96mtests/metricProgression.property.test.ts[0m:[93m343[0m:[93m17[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m343[0m                 userId,
    [7m   [0m [91m                ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/metricProgression.property.test.ts[0m:[93m590[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m590[0m         userId,
    [7m   [0m [91m        ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/metricProgression.property.test.ts[0m:[93m644[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m644[0m         userId,
    [7m   [0m [91m        ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/metricProgression.property.test.ts[0m:[93m698[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m698[0m         userId,
    [7m   [0m [91m        ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/metricProgression.property.test.ts[0m:[93m752[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m752[0m         userId,
    [7m   [0m [91m        ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/metricProgression.property.test.ts[0m:[93m806[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m806[0m         userId,
    [7m   [0m [91m        ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'

FAIL tests/matchListInclusion.property.test.ts
  ● Test suite failed to run

    [96mtests/matchListInclusion.property.test.ts[0m:[93m298[0m:[93m17[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m298[0m                 userId: testUserId,
    [7m   [0m [91m                ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/matchListInclusion.property.test.ts[0m:[93m333[0m:[93m17[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m333[0m                 userId: testUserId,
    [7m   [0m [91m                ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'

FAIL tests/eventLogger.property.test.ts
  ● Test suite failed to run

    [96mtests/eventLogger.property.test.ts[0m:[93m92[0m:[93m15[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ eventType: EventType.BATTLE_COMPLETE | EventType.ROBOT_REPAIR | EventType.ROBOT_ATTRIBUTE_UPGRADE | EventType.ROBOT_LEAGUE_CHANGE | EventType.CREDIT_CHANGE | EventType.PRESTIGE_CHANGE | EventType.PASSIVE_INCOME | ... 10 more ... | EventType.CYCLE_COMPLETE; payload: { ...; }; userId: number | null; robotId: number ...' is not assignable to parameter of type '{ eventType: EventType; payload: BaseEventPayload; userId?: number | undefined; robotId?: number | undefined; metadata?: EventMetadata | undefined; timestamp?: Date | undefined; }[]'.
      Type '{ eventType: EventType.BATTLE_COMPLETE | EventType.ROBOT_REPAIR | EventType.ROBOT_ATTRIBUTE_UPGRADE | EventType.ROBOT_LEAGUE_CHANGE | EventType.CREDIT_CHANGE | EventType.PRESTIGE_CHANGE | EventType.PASSIVE_INCOME | ... 10 more ... | EventType.CYCLE_COMPLETE; payload: { ...; }; userId: number | null; robotId: number ...' is not assignable to type '{ eventType: EventType; payload: BaseEventPayload; userId?: number | undefined; robotId?: number | undefined; metadata?: EventMetadata | undefined; timestamp?: Date | undefined; }'.
        Types of property 'userId' are incompatible.
          Type 'number | null' is not assignable to type 'number | undefined'.
            Type 'null' is not assignable to type 'number | undefined'.

    [7m 92[0m               events.map(e => ({
    [7m   [0m [91m              ~~~~~~~~~~~~~~~~~~[0m
    [7m 93[0m                 eventType: e.eventType,
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m...[0m 
    [7m 96[0m                 robotId: e.robotId,
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m 97[0m               }))
    [7m   [0m [91m~~~~~~~~~~~~~~~~~[0m

FAIL tests/byeTeamBattles.property.test.ts
  ● Test suite failed to run

    [96mtests/byeTeamBattles.property.test.ts[0m:[93m16[0m:[93m3[0m - [91merror[0m[90m TS2322: [0mType '{ name: string; id: number; userId: number; frameId: number; paintJob: string | null; combatPower: Prisma.Decimal; targetingSystems: Prisma.Decimal; criticalSystems: Prisma.Decimal; ... 55 more ...; updatedAt: Date; }' is not assignable to type '{ name: string; id: number; userId: number; frameId: number; paintJob: string | null; combatPower: Decimal; targetingSystems: Decimal; criticalSystems: Decimal; ... 55 more ...; updatedAt: Date; }'.
      Types of property 'imageUrl' are incompatible.
        Type 'string | null | undefined' is not assignable to type 'string | null'.
          Type 'undefined' is not assignable to type 'string | null'.

    [7m16[0m   return {
    [7m  [0m [91m  ~~~~~~[0m

FAIL tests/eloProgression.property.test.ts
  ● Test suite failed to run

    [96mtests/eloProgression.property.test.ts[0m:[93m161[0m:[93m19[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m161[0m                   userId,
    [7m   [0m [91m                  ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/eloProgression.property.test.ts[0m:[93m351[0m:[93m19[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m351[0m                   userId,
    [7m   [0m [91m                  ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/eloProgression.property.test.ts[0m:[93m529[0m:[93m19[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m529[0m                   userId,
    [7m   [0m [91m                  ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/eloProgression.property.test.ts[0m:[93m684[0m:[93m17[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m684[0m                 userId,
    [7m   [0m [91m                ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'

FAIL tests/cycleSnapshot.property.test.ts
  ● Test suite failed to run

    [96mtests/cycleSnapshot.property.test.ts[0m:[93m282[0m:[93m19[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'user' does not exist in type 'Without<BattleUncheckedCreateInput, BattleCreateInput> & BattleCreateInput'.

    [7m282[0m                   user: { connect: { id: user.id } },
    [7m   [0m [91m                  ~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m359[0m:[93m57[0m - [91merror[0m[90m TS2339: [0mProperty 'robot1DamageDealt' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m359[0m               robot1Metric.damageDealt += createdBattle.robot1DamageDealt;
    [7m   [0m [91m                                                        ~~~~~~~~~~~~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m360[0m:[93m60[0m - [91merror[0m[90m TS2339: [0mProperty 'robot2DamageDealt' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m360[0m               robot1Metric.damageReceived += createdBattle.robot2DamageDealt;
    [7m   [0m [91m                                                           ~~~~~~~~~~~~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m362[0m:[93m56[0m - [91merror[0m[90m TS2339: [0mProperty 'robot1FameAwarded' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m362[0m               robot1Metric.fameChange += createdBattle.robot1FameAwarded;
    [7m   [0m [91m                                                       ~~~~~~~~~~~~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m381[0m:[93m57[0m - [91merror[0m[90m TS2339: [0mProperty 'robot2DamageDealt' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m381[0m               robot2Metric.damageDealt += createdBattle.robot2DamageDealt;
    [7m   [0m [91m                                                        ~~~~~~~~~~~~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m382[0m:[93m60[0m - [91merror[0m[90m TS2339: [0mProperty 'robot1DamageDealt' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m382[0m               robot2Metric.damageReceived += createdBattle.robot1DamageDealt;
    [7m   [0m [91m                                                           ~~~~~~~~~~~~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m384[0m:[93m56[0m - [91merror[0m[90m TS2339: [0mProperty 'robot2FameAwarded' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m384[0m               robot2Metric.fameChange += createdBattle.robot2FameAwarded;
    [7m   [0m [91m                                                       ~~~~~~~~~~~~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m528[0m:[93m19[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'user' does not exist in type 'Without<BattleUncheckedCreateInput, BattleCreateInput> & BattleCreateInput'.

    [7m528[0m                   user: { connect: { id: user.id } },
    [7m   [0m [91m                  ~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m592[0m:[93m40[0m - [91merror[0m[90m TS2339: [0mProperty 'userId' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m592[0m               actualUserIds.add(battle.userId);
    [7m   [0m [91m                                       ~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m594[0m:[93m53[0m - [91merror[0m[90m TS2339: [0mProperty 'userId' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m594[0m               if (!expectedStableMetrics.has(battle.userId)) {
    [7m   [0m [91m                                                    ~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m595[0m:[93m50[0m - [91merror[0m[90m TS2339: [0mProperty 'userId' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m595[0m                 expectedStableMetrics.set(battle.userId, {
    [7m   [0m [91m                                                 ~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m602[0m:[93m64[0m - [91merror[0m[90m TS2339: [0mProperty 'userId' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m602[0m               const metrics = expectedStableMetrics.get(battle.userId)!;
    [7m   [0m [91m                                                               ~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m605[0m:[93m53[0m - [91merror[0m[90m TS2339: [0mProperty 'robot1PrestigeAwarded' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m605[0m               metrics.totalPrestigeEarned += battle.robot1PrestigeAwarded + battle.robot2PrestigeAwarded;
    [7m   [0m [91m                                                    ~~~~~~~~~~~~~~~~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m605[0m:[93m84[0m - [91merror[0m[90m TS2339: [0mProperty 'robot2PrestigeAwarded' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m605[0m               metrics.totalPrestigeEarned += battle.robot1PrestigeAwarded + battle.robot2PrestigeAwarded;
    [7m   [0m [91m                                                                                   ~~~~~~~~~~~~~~~~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m606[0m:[93m51[0m - [91merror[0m[90m TS2339: [0mProperty 'robot1RepairCost' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m606[0m               metrics.totalRepairCosts += (battle.robot1RepairCost || 0) + (battle.robot2RepairCost || 0);
    [7m   [0m [91m                                                  ~~~~~~~~~~~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m606[0m:[93m84[0m - [91merror[0m[90m TS2339: [0mProperty 'robot2RepairCost' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m606[0m               metrics.totalRepairCosts += (battle.robot1RepairCost || 0) + (battle.robot2RepairCost || 0);
    [7m   [0m [91m                                                                                   ~~~~~~~~~~~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m659[0m:[93m17[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'user' does not exist in type 'Without<BattleUncheckedCreateInput, BattleCreateInput> & BattleCreateInput'.

    [7m659[0m                 user: { connect: { id: user.id } },
    [7m   [0m [91m                ~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'

FAIL tests/battleLogStreamingRevenue.property.test.ts
  ● Test suite failed to run

    [96mtests/battleLogStreamingRevenue.property.test.ts[0m:[93m111[0m:[93m7[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m111[0m       userId,
    [7m   [0m [91m      ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'

FAIL tests/analyticsApi.test.ts
  ● Test suite failed to run

    [96mtests/analyticsApi.test.ts[0m:[93m228[0m:[93m11[0m - [91merror[0m[90m TS2322: [0mType 'JsonValue' is not assignable to type 'JsonNull | InputJsonValue'.
      Type 'null' is not assignable to type 'JsonNull | InputJsonValue'.

    [7m228[0m           stableMetrics: snapshot.stableMetrics,
    [7m   [0m [91m          ~~~~~~~~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m24461[0m:[93m5[0m
        [7m24461[0m     stableMetrics: JsonNullValueInput | InputJsonValue
        [7m     [0m [96m    ~~~~~~~~~~~~~[0m
        The expected type comes from property 'stableMetrics' which is declared here on type '(Without<CycleSnapshotCreateInput, CycleSnapshotUncheckedCreateInput> & CycleSnapshotUncheckedCreateInput) | (Without<...> & CycleSnapshotCreateInput)'
    [96mtests/analyticsApi.test.ts[0m:[93m229[0m:[93m11[0m - [91merror[0m[90m TS2322: [0mType 'JsonValue' is not assignable to type 'JsonNull | InputJsonValue'.
      Type 'null' is not assignable to type 'JsonNull | InputJsonValue'.

    [7m229[0m           robotMetrics: snapshot.robotMetrics,
    [7m   [0m [91m          ~~~~~~~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m24462[0m:[93m5[0m
        [7m24462[0m     robotMetrics: JsonNullValueInput | InputJsonValue
        [7m     [0m [96m    ~~~~~~~~~~~~[0m
        The expected type comes from property 'robotMetrics' which is declared here on type '(Without<CycleSnapshotCreateInput, CycleSnapshotUncheckedCreateInput> & CycleSnapshotUncheckedCreateInput) | (Without<...> & CycleSnapshotCreateInput)'
    [96mtests/analyticsApi.test.ts[0m:[93m230[0m:[93m11[0m - [91merror[0m[90m TS2322: [0mType 'JsonValue' is not assignable to type 'JsonNull | InputJsonValue'.
      Type 'null' is not assignable to type 'JsonNull | InputJsonValue'.

    [7m230[0m           stepDurations: snapshot.stepDurations,
    [7m   [0m [91m          ~~~~~~~~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m24463[0m:[93m5[0m
        [7m24463[0m     stepDurations: JsonNullValueInput | InputJsonValue
        [7m     [0m [96m    ~~~~~~~~~~~~~[0m
        The expected type comes from property 'stepDurations' which is declared here on type '(Without<CycleSnapshotCreateInput, CycleSnapshotUncheckedCreateInput> & CycleSnapshotUncheckedCreateInput) | (Without<...> & CycleSnapshotCreateInput)'
    [96mtests/analyticsApi.test.ts[0m:[93m1220[0m:[93m11[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m1220[0m           userId: testUserId,
    [7m    [0m [91m          ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/analyticsApi.test.ts[0m:[93m1724[0m:[93m13[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m1724[0m             userId: testUserId,
    [7m    [0m [91m            ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/analyticsApi.test.ts[0m:[93m2068[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m2068[0m         userId: testUserId,
    [7m    [0m [91m        ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/analyticsApi.test.ts[0m:[93m2211[0m:[93m13[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m2211[0m             userId: testUserId,
    [7m    [0m [91m            ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'

FAIL tests/streamingStudioPrestigeValidation.test.ts
  ● Console

    console.log
      [Facility] User 38709 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38711 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38711 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38713 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38713 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38713 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38717 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38717 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38717 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38719 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38719 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38719 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38719 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38721 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38721 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38721 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38721 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38725 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38725 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38725 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38725 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38729 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38729 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38729 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38729 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38729 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38735 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38735 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38735 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38735 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38735 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38743 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38743 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38743 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38743 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38743 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38743 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38744 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38744 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38744 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38744 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38744 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38744 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38744 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38745 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38745 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38745 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38745 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38745 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38745 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38745 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38745 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38747 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38747 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38747 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38747 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38747 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38747 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38747 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,900,000 → ₡7,200,000

      at src/routes/facility.ts:212:15

    console.error
      Facility upgrade error: PrismaClientKnownRequestError: Too many database connections opened: FATAL: sorry, too many clients already
          at _r.transaction (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:111:12319)
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:7924)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/facility.ts:162:20 {
        code: 'P2037',
        clientVersion: '5.22.0',
        meta: { message: 'FATAL: sorry, too many clients already' }
      }

      222 |     });
      223 |   } catch (error) {
    > 224 |     console.error('Facility upgrade error:', error);
          |             ^
      225 |     res.status(500).json({ error: 'Internal server error' });
      226 |   }
      227 | });

      at src/routes/facility.ts:224:13

    console.log
      [Facility] User 38747 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,200,000 → ₡6,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38747 | Upgraded: Streaming Studio | Level: 9 | Cost: ₡900,000 | Balance: ₡6,400,000 → ₡5,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38760 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38760 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38760 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38760 | Upgraded: Streaming Studio | Level: 4 | Cost: ₡400,000 | Balance: ₡9,400,000 → ₡9,000,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38760 | Upgraded: Streaming Studio | Level: 5 | Cost: ₡500,000 | Balance: ₡9,000,000 → ₡8,500,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38760 | Upgraded: Streaming Studio | Level: 6 | Cost: ₡600,000 | Balance: ₡8,500,000 → ₡7,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38760 | Upgraded: Streaming Studio | Level: 7 | Cost: ₡700,000 | Balance: ₡7,899,500 → ₡7,199,500

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38760 | Upgraded: Streaming Studio | Level: 8 | Cost: ₡800,000 | Balance: ₡7,199,500 → ₡6,399,500

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38760 | Upgraded: Streaming Studio | Level: 9 | Cost: ₡900,000 | Balance: ₡6,399,500 → ₡5,499,500

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38760 | Upgraded: Streaming Studio | Level: 10 | Cost: ₡1,000,000 | Balance: ₡5,499,500 → ₡4,499,500

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38783 | Purchased: Streaming Studio | Level: 1 | Cost: ₡100,000 | Balance: ₡10,000,000 → ₡9,900,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38783 | Upgraded: Streaming Studio | Level: 2 | Cost: ₡200,000 | Balance: ₡9,900,000 → ₡9,700,000

      at src/routes/facility.ts:212:15

    console.log
      [Facility] User 38783 | Upgraded: Streaming Studio | Level: 3 | Cost: ₡300,000 | Balance: ₡9,700,000 → ₡9,400,000

      at src/routes/facility.ts:212:15

  ● Streaming Studio Prestige Validation › Higher levels: Progressive prestige requirements › should enforce 50,000 prestige for Level 10

    expect(received).toBe(expected) // Object.is equality

    Expected: 403
    Received: 200

      340 |         .send({ facilityType: 'streaming_studio' });
      341 |
    > 342 |       expect(response.status).toBe(403);
          |                               ^
      343 |       expect(response.body.required).toBe(50000);
      344 |     });
      345 |

      at Object.<anonymous> (tests/streamingStudioPrestigeValidation.test.ts:342:31)

FAIL tests/incomeGeneratorNoStreaming.property.test.ts
  ● Property 18: Income Generator No Longer Provides Streaming Revenue › Property 18.2: Passive income is independent of robot stats

    Property failed after 15 tests
    { seed: -1287251150, path: "14", endOnFailure: true }
    Counterexample: [10,44060]
    Shrunk 0 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.user.update()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/incomeGeneratorNoStreaming.property.test.ts:199:29

      196 });
      197 
      198 // Update user prestige
    → 199 await prisma.user.update(
    Too many database connections opened: FATAL: sorry, too many clients already
    Prisma Accelerate has built-in connection pooling to prevent such errors: https://pris.ly/client/error-accelerate

      197 |
      198 |           // Update user prestige
    > 199 |           await prisma.user.update({
          |           ^
      200 |             where: { id: testUserId },
      201 |             data: { prestige },
      202 |           });

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at tests/incomeGeneratorNoStreaming.property.test.ts:199:11
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/incomeGeneratorNoStreaming.property.test.ts:185:5)

FAIL tests/eventQueryability.property.test.ts (19.107 s)
  ● Property 5: Event Queryability › cycle range filtering returns only events within range

    Property failed after 1 tests
    { seed: 2143166356, path: "0:0:0:0:0:0:0:0:1:0:1:0:0:0:2", endOnFailure: true }
    Counterexample: [[1,1,1,1,1],1,6]
    Shrunk 14 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: 7

      67 |           // Verify count matches
      68 |           const expectedCount = cycles.filter(c => c >= start && c <= end).length;
    > 69 |           expect(result.events.length).toBe(expectedCount);
         |                                        ^
      70 |         }
      71 |       ),
      72 |       { numRuns: 30 }

      at tests/eventQueryability.property.test.ts:69:40
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/eventQueryability.property.test.ts:34:5)

  ● Property 5: Event Queryability › user filtering returns only events for that user

    Property failed after 6 tests
    { seed: -2089765227, path: "5:12:3:9:0:0:0:0:3:0:0:0:0:0:0:0:0:2:1:2:2:0:0:0", endOnFailure: true }
    Counterexample: [1,[{"userId":1,"amount":0},{"userId":1,"amount":0},{__proto__:null,"userId":1,"amount":227},{"userId":1,"amount":0},{"userId":1,"amount":0}]]
    Shrunk 23 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: 2

      117 |           // Verify count matches
      118 |           const expectedCount = events.filter(e => e.userId === targetUserId).length;
    > 119 |           expect(result.events.length).toBe(expectedCount);
          |                                        ^
      120 |         }
      121 |       ),
      122 |       { numRuns: 30 }

      at tests/eventQueryability.property.test.ts:119:40
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/eventQueryability.property.test.ts:82:5)

  ● Property 5: Event Queryability › event type filtering returns only matching types

    Property failed after 1 tests
    { seed: -1612597215, path: "0:1", endOnFailure: true }
    Counterexample: [["cycle_step_complete"],5]
    Shrunk 1 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: 1

      165 |
      166 |           // Verify count matches
    > 167 |           expect(result.events.length).toBe(expectedCount);
          |                                        ^
      168 |         }
      169 |       ),
      170 |       { numRuns: 25 }

      at tests/eventQueryability.property.test.ts:167:40
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/eventQueryability.property.test.ts:132:5)

  ● Property 5: Event Queryability › pagination returns correct subset

    Property failed after 1 tests
    { seed: -848836706, path: "0:0:0:0", endOnFailure: true }
    Counterexample: [10,1,0]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 10
    Received: 31

      208 |
      209 |           // Verify total count
    > 210 |           expect(result.total).toBe(totalEvents);
          |                                ^
      211 |         }
      212 |       ),
      213 |       { numRuns: 30 }

      at tests/eventQueryability.property.test.ts:210:32
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/eventQueryability.property.test.ts:180:5)

  ● Property 5: Event Queryability › sorting maintains order

    Property failed after 7 tests
    { seed: 1274363055, path: "6:9:59:35:1:43:32:40:41:2:9:3", endOnFailure: true }
    Counterexample: [[1,13,1,10,4,8,15,5,4],"asc"]
    Shrunk 11 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStart (src/services/eventLogger.ts:271:5)
      at tests/eventQueryability.property.test.ts:236:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/eventQueryability.property.test.ts:223:5)

  ● Property 5: Event Queryability › combined filters are applied correctly

    Property failed after 8 tests
    { seed: 1248912910, path: "7:1:0:1:26:0:2:0:0:1:12:1:2:0:0:0:0:22:9:1:1:1:0:0:1:1:1:1:0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [1,1,6,[{__proto__:null,"cycle":6,"userId":5},{"cycle":1,"userId":6},{"cycle":10,"userId":8},{"cycle":3,"userId":7},{"cycle":2,"userId":1},{__proto__:null,"cycle":1,"userId":1},{"cycle":1,"userId":1},{"cycle":1,"userId":1},{"cycle":1,"userId":1},{"cycle":1,"userId":1}]]
    Shrunk 33 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 6
    Received: 0

      315 |               e.cycle <= rangeEnd
      316 |           ).length;
    > 317 |           expect(result.events.length).toBe(expectedCount);
          |                                        ^
      318 |         }
      319 |       ),
      320 |       { numRuns: 25 }

      at tests/eventQueryability.property.test.ts:317:40
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/eventQueryability.property.test.ts:268:5)

  ● Property 5: Event Queryability › count matches filtered results

    Property failed after 3 tests
    { seed: 237222476, path: "2:1:0:4:29:7:25:1:0:37:0", endOnFailure: true }
    Counterexample: [[{__proto__:null,"cycle":15,"userId":4},{__proto__:null,"cycle":2,"userId":7},{__proto__:null,"cycle":13,"userId":1},{__proto__:null,"cycle":7,"userId":8},{"cycle":15,"userId":3},{"cycle":20,"userId":8},{"cycle":1,"userId":1},{"cycle":11,"userId":5},{"cycle":8,"userId":6},{__proto__:null,"cycle":15,"userId":9}],3]
    Shrunk 10 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCreditChange (src/services/eventLogger.ts:401:5)
      at tests/eventQueryability.property.test.ts:378:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/eventQueryability.property.test.ts:362:5)

FAIL tests/performanceDegradation.property.test.ts (31.518 s)
  ● Property 16: Performance Degradation Detection › Property 16.1: Degradation detected when recent average > 150% of baseline

    Property failed after 1 tests
    { seed: 615362161, path: "0:0:0", endOnFailure: true }
    Counterexample: [100,1.5099999904632568,"step_a"]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).not.toBeNull()

    Received: null

      66 |           const alert = await service.detectStepDegradation(stepName, 10, 100);
      67 |
    > 68 |           expect(alert).not.toBeNull();
         |                             ^
      69 |           expect(alert!.stepName).toBe(stepName);
      70 |           expect(alert!.currentAverageDuration).toBe(recentDuration);
      71 |           expect(alert!.baselineAverageDuration).toBe(baselineDuration);

      at tests/performanceDegradation.property.test.ts:68:29
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/performanceDegradation.property.test.ts:39:5)

  ● Property 16: Performance Degradation Detection › Property 16.2: No degradation when recent average <= 150% of baseline

    Property failed after 1 tests
    { seed: -1468190363, path: "0:0:0:0", endOnFailure: true }
    Counterexample: [100,0.5,"step_x"]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStepComplete (src/services/eventLogger.ts:287:5)
      at tests/performanceDegradation.property.test.ts:98:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/performanceDegradation.property.test.ts:85:5)

  ● Property 16: Performance Degradation Detection › Property 16.3: Degradation severity correctly classified (warning vs critical)

    Property failed after 1 tests
    { seed: -1094509690, path: "0:0:0:0", endOnFailure: true }
    Counterexample: [100,1.5099999904632568,"step_1"]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStepComplete (src/services/eventLogger.ts:287:5)
      at tests/performanceDegradation.property.test.ts:139:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/performanceDegradation.property.test.ts:125:5)

  ● Property 16: Performance Degradation Detection › Property 16.4: Multiple steps monitored independently

    Property failed after 1 tests
    { seed: -1021460863, path: "0:0:1:1:0:1:0", endOnFailure: true }
    Counterexample: [[{"stepName":"step_a","baselineDuration":100,"isDegraded":false},{__proto__:null,"stepName":"step_a","baselineDuration":100,"isDegraded":false}]]
    Shrunk 6 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStepComplete (src/services/eventLogger.ts:287:5)
      at tests/performanceDegradation.property.test.ts:200:15
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/performanceDegradation.property.test.ts:172:5)

  ● Property 16: Performance Degradation Detection › Property 16.5: Detection consistent across different baseline sizes

    Property failed after 1 tests
    { seed: 1600627866, path: "0:0:0", endOnFailure: true }
    Counterexample: [500,20,"test_step_a"]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStepComplete (src/services/eventLogger.ts:287:5)
      at tests/performanceDegradation.property.test.ts:254:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/performanceDegradation.property.test.ts:241:5)

  ● Property 16: Performance Degradation Detection › Property 16.6: Alerts sorted by degradation percentage (highest first)

    Property failed after 2 tests
    { seed: 1975532964, path: "1:0:0:0:0:1:0:0:2:0:0:0:27:3:3", endOnFailure: true }
    Counterexample: [[{"stepName":"s1","degradationMultiplier":1.600000023841858},{"stepName":"s1","degradationMultiplier":1.6049456596374512},{"stepName":"s4","degradationMultiplier":2.433058023452759}]]
    Shrunk 14 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStepComplete (src/services/eventLogger.ts:287:5)
      at tests/performanceDegradation.property.test.ts:308:15
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/performanceDegradation.property.test.ts:282:5)

FAIL tests/integration/adminCycleGeneration.test.ts (36.929 s)
  ● Console

    console.log
      [Admin] Running 3 bulk cycles (includeTournaments: false, generateUsersPerCycle: true)...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 17 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 17 (1/3)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 17 (1/3) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:20.566Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Streaming] TestRobot1_1771858880440_0.602182634730807 earned ₡2,008 from Battle #60694

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Streaming] TestRobot2_1771858880440_0.9193466933876333 earned ₡21,509 from Battle #60694

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Battle] League: bronze | TestRobot1_1771858880440_0.602182634730807 (User 38460) vs TestRobot2_1771858880440_0.9193466933876333 (User 38461) | Winner: TestRobot1_1771858880440_0.602182634730807 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +3

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [BattleOrchestrator] Failed to process match 40539: Error: Robot 550162 not found
          at calculateStreamingRevenue (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/streamingRevenueService.ts:90:11)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:656:25)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:431:31

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at src/routes/admin.ts:431:31

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 1 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 3 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38460 | Robot 550139 (TestRobot1_1771858880192_0.09258731745866144) | Cost: ₡17,940 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38460 | Robot 550150 (TestRobot1_1771858880440_0.602182634730807) | Cost: ₡19,320 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38461 | Robot 550140 (TestRobot2_1771858880192_0.09235203722576901) | Cost: ₡18,400 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38461 | Robot 550152 (TestRobot2_1771858880440_0.9193466933876333) | Cost: ₡31,740 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Execute Tag Team Battles (Cycle 17)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Found 0 scheduled tag team matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Execution complete: 0 battles, 0 wins, 0 draws, 0 losses, 0 skipped due to unready robots

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38461 | Robot 550176 (TestRobot2_1771858880672_0.2880802867574742) | Cost: ₡8,740 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38460 | Robot 550175 (TestRobot1_1771858880672_0.2395032711865187) | Cost: ₡31,740 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 13

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 12 total robots across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Processing bronze_1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze_1: Skipping (0 eligible, need 10)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Rebalance Tag Team Leagues (Cycle 17)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Starting tag team league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Total teams in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Tag team league rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Rebalancing instances across all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] bronze instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] silver instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] gold instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] platinum instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] diamond instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] champion instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Generating 17 archetype users for Cycle 17...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Creating user 1/17: archetype_melee_specialist_17_1 (archetype: melee_specialist)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [UserGeneration] Error creating user 1: Error: Missing weapons for archetype melee_specialist. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at generateBattleReadyUsers (src/utils/userGeneration.ts:611:15)
      at src/routes/admin.ts:616:37

    console.error
      [Admin] Error generating users: Error: Missing weapons for archetype melee_specialist. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:619:21

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:22.041Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Processing bronze_1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Queue for bronze_1: 0 robots available (19 total, 0 ready)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] bronze_1: Not enough robots for matches (0 available)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Matchmaking for Tag Teams (Cycle 17)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Starting tag team matchmaking for all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Complete: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Error in cycle 17: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logCycleStepComplete (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:287:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:698:9 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:942:17

    console.log
      [ERROR] Cycle 17 failed {"error":"\nInvalid `prisma.auditLog.create()` invocation in\n/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27\n\n  194 };\n  195 \n  196 // Insert into database\n→ 197 await prisma.auditLog.create(\nUnique constraint failed on the fields: (`cycle_number`,`sequence_number`)"}

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] === Cycle 17 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 133 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle17.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [INFO] === Cycle 18 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 18 (2/3)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 18 (2/3) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:21.090Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Streaming] TestRobot1_1771858880991_0.3815794846376095 earned ₡16,567 from Battle #60706

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Streaming] TestRobot2_1771858880993_0.12574180703754545 earned ₡17,896 from Battle #60706

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [BattleOrchestrator] Failed to process match 40543: PrismaClientKnownRequestError: 
      Invalid `prisma.scheduledMatch.update()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:803:31
      
        800 // No need to update Battle table
        801 
        802 // Update scheduled match
      → 803 await prisma.scheduledMatch.update(
      An operation failed because it depends on one or more records that were required but not found. Record to update not found.
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:803:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:431:31 {
        code: 'P2025',
        clientVersion: '5.22.0',
        meta: { modelName: 'ScheduledMatch', cause: 'Record to update not found.' }
      }

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at src/routes/admin.ts:431:31

    console.log
      [Streaming] TestRobot1_1771858881044_0.17627262520634135 earned ₡2,004 from Battle #60708

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Streaming] TestRobot2_1771858881044_0.7459075297126387 earned ₡9,025 from Battle #60708

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Battle] League: bronze | TestRobot1_1771858881044_0.17627262520634135 (User 38460) vs TestRobot2_1771858881044_0.7459075297126387 (User 38461) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 1 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38460 | Robot 550196 (TestRobot1_1771858880874_0.7969556892285852) | Cost: ₡32,775 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38460 | Robot 550221 (TestRobot1_1771858881044_0.17627262520634135) | Cost: ₡32,775 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38461 | Robot 550197 (TestRobot2_1771858880874_0.9050349615869661) | Cost: ₡10,350 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38461 | Robot 550222 (TestRobot2_1771858881044_0.7459075297126387) | Cost: ₡16,330 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Skipping Tag Team Battles (even cycle 18)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38463 | Robot 550239 (TestRobot2_1771858881188_0.9960772427675278) | Cost: ₡12,650 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38462 | Robot 550238 (TestRobot1_1771858881185_0.9029383247340351) | Cost: ₡31,395 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38463 | Robot 550239 (TestRobot2_1771858881188_0.9960772427675278) | Cost: ₡17,020 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 28

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 28 total robots across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Processing bronze_1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze_1: Skipping (0 eligible, need 10)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Skipping Tag Team Rebalancing (even cycle 18)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Generating 18 archetype users for Cycle 18...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Creating user 1/18: archetype_prestige_rusher_18_1 (archetype: prestige_rusher)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [UserGeneration] Error creating user 1: Error: Missing weapons for archetype prestige_rusher. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at generateBattleReadyUsers (src/utils/userGeneration.ts:611:15)
      at src/routes/admin.ts:616:37

    console.error
      [Admin] Error generating users: Error: Missing weapons for archetype prestige_rusher. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:619:21

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:22.476Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Processing bronze_1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Queue for bronze_1: 0 robots available (30 total, 0 ready)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] bronze_1: Not enough robots for matches (0 available)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Skipping Tag Team Matchmaking (even cycle 18)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38479 | Total: ₡1,000 | Facilities: roster_expansion(L0): ₡1000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38470 | Total: ₡1,000 | Facilities: roster_expansion(L0): ₡1000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38478 | Total: ₡1,000 | Facilities: roster_expansion(L0): ₡1000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38460 | Total: ₡3,100 | Facilities: streaming_studio(L1): ₡100, roster_expansion(L0): ₡3000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38461 | Total: ₡3,800 | Facilities: streaming_studio(L8): ₡800, roster_expansion(L0): ₡3000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38480 | Total: ₡700 | Facilities: streaming_studio(L7): ₡700

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38462 | Total: ₡200 | Facilities: streaming_studio(L2): ₡200

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38463 | Total: ₡400 | Facilities: streaming_studio(L4): ₡400

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38469 | Total: ₡500 | Facilities: roster_expansion(L0): ₡500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38474 | Total: ₡500 | Facilities: roster_expansion(L0): ₡500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡0, Operating costs: ₡12,200

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 18 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38460 | Stable: test_terminal_log_user1_1771858880151 | Balance: ₡1,079,787

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38461 | Stable: test_terminal_log_user2_1771858880185 | Balance: ₡1,392,299

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38465 | Stable: test_user_1771858880251 | Balance: ₡100,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38467 | Stable: test_user_1771858880340_zphk7 | Balance: ₡3,585,114

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38468 | Stable: admin_test_1771858880501 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38469 | Stable: test_user_1771858880664_m5lhxc | Balance: ₡999,512

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38470 | Stable: test_user_1771858880849_houeqj | Balance: ₡9,998,992

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38474 | Stable: test_user_1771858880970_ov08z | Balance: ₡5,730,363

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38478 | Stable: test_user_1771858881108_rqyhaq | Balance: ₡2,694,427

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38479 | Stable: test_user_1771858881242_bzyd5v | Balance: ₡1,762,581

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38480 | Stable: test_user_1771858881330_gjz05c | Balance: ₡6,400,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38482 | Stable: test_user_1771858881525_d9heo | Balance: ₡5,378,072

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38483 | Stable: test_user_1771858881765_vshad8 | Balance: ₡7,827,163

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38484 | Stable: test_user_1771858881964_x7f6n5 | Balance: ₡5,748,008

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38485 | Stable: test_user_1771858882172_sz04br | Balance: ₡8,960,112

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38486 | Stable: test_user_1771858882288_oogw8 | Balance: ₡1,000,017

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38487 | Stable: test_user_1771858882550_9yuvz9 | Balance: ₡1,000,017

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 18

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Failed to create cycle snapshot: Error: Cycle 18 is incomplete - missing start or complete events
          at CycleSnapshotService.createSnapshot (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/cycleSnapshotService.ts:91:13)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:899:11

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:909:19

    console.log
      [Admin] === Cycle 18 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 2

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 18 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 133 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle18.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [INFO] === Cycle 19 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 19 (3/3)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 19 (3/3) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:22.797Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Streaming] Robot1_1771858882764_0.364383727608678 earned ₡8,996 from Battle #60739

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Streaming] Robot2_1771858882764_0.014134021896164639 earned ₡8,903 from Battle #60739

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Battle] League: bronze | Robot1_1771858882764_0.364383727608678 (User 38460) vs Robot2_1771858882764_0.014134021896164639 (User 38461) | Winner: Draw | Rewards: ₡1,500 / ₡1,500 | Prestige: +0 | Fame: +0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38460 | Robot 550436 (Robot1_1771858882764_0.364383727608678) | Cost: ₡18,400 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38461 | Robot 550437 (Robot2_1771858882764_0.014134021896164639) | Cost: ₡16,560 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Execute Tag Team Battles (Cycle 19)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Found 0 scheduled tag team matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Execution complete: 0 battles, 0 wins, 0 draws, 0 losses, 0 skipped due to unready robots

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38460 | Robot 550448 (Robot1_1771858882858_0.20273554370081692) | Cost: ₡13,570 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38461 | Robot 550449 (Robot2_1771858882858_0.7556997578929281) | Cost: ₡33,465 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 25

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 25 total robots across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Processing bronze_1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze_1: Skipping (0 eligible, need 10)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Rebalance Tag Team Leagues (Cycle 19)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Starting tag team league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Total teams in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Tag team league rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Rebalancing instances across all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] bronze instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] silver instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] gold instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] platinum instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] diamond instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] champion instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Generating 19 archetype users for Cycle 19...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Creating user 1/19: archetype_glass_cannon_c_19_1 (archetype: glass_cannon_c)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [UserGeneration] Error creating user 1: Error: Missing weapons for archetype glass_cannon_c. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at generateBattleReadyUsers (src/utils/userGeneration.ts:611:15)
      at src/routes/admin.ts:616:37

    console.error
      [Admin] Error generating users: Error: Missing weapons for archetype glass_cannon_c. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:619:21

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:24.082Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Processing bronze_1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Queue for bronze_1: 0 robots available (27 total, 0 ready)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] bronze_1: Not enough robots for matches (0 available)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Matchmaking for Tag Teams (Cycle 19)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Starting tag team matchmaking for all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Complete: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38465 | Total: ₡700 | Facilities: streaming_studio(L2): ₡200, roster_expansion(L0): ₡500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38460 | Total: ₡700 | Facilities: streaming_studio(L2): ₡200, roster_expansion(L0): ₡500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38470 | Total: ₡1,000 | Facilities: roster_expansion(L0): ₡1000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38478 | Total: ₡1,000 | Facilities: roster_expansion(L0): ₡1000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38461 | Total: ₡700 | Facilities: streaming_studio(L2): ₡200, roster_expansion(L0): ₡500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38486 | Total: ₡1,000 | Facilities: roster_expansion(L0): ₡1000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38490 | Total: ₡200 | Facilities: streaming_studio(L2): ₡200

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38480 | Total: ₡400 | Facilities: streaming_studio(L4): ₡400

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38469 | Total: ₡500 | Facilities: roster_expansion(L0): ₡500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38474 | Total: ₡500 | Facilities: roster_expansion(L0): ₡500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38479 | Total: ₡1,000 | Facilities: roster_expansion(L0): ₡1000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38489 | Total: ₡500 | Facilities: roster_expansion(L0): ₡500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡0, Operating costs: ₡8,200

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 19 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38460 | Stable: test_terminal_log_user1_1771858880151 | Balance: ₡1,260,906

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38461 | Stable: test_terminal_log_user2_1771858880185 | Balance: ₡1,563,155

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38467 | Stable: test_user_1771858880340_zphk7 | Balance: ₡3,585,114

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38468 | Stable: admin_test_1771858880501 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38469 | Stable: test_user_1771858880664_m5lhxc | Balance: ₡999,012

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38470 | Stable: test_user_1771858880849_houeqj | Balance: ₡9,997,992

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38474 | Stable: test_user_1771858880970_ov08z | Balance: ₡5,729,863

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38478 | Stable: test_user_1771858881108_rqyhaq | Balance: ₡2,693,427

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38479 | Stable: test_user_1771858881242_bzyd5v | Balance: ₡1,761,581

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38480 | Stable: test_user_1771858881330_gjz05c | Balance: ₡6,400,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38482 | Stable: test_user_1771858881525_d9heo | Balance: ₡5,378,072

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38483 | Stable: test_user_1771858881765_vshad8 | Balance: ₡7,827,163

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38484 | Stable: test_user_1771858881964_x7f6n5 | Balance: ₡5,748,008

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38485 | Stable: test_user_1771858882172_sz04br | Balance: ₡8,960,112

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38486 | Stable: test_user_1771858882288_oogw8 | Balance: ₡999,017

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38487 | Stable: test_user_1771858882550_9yuvz9 | Balance: ₡1,000,017

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38488 | Stable: test_user_1771858882688_z0ck4w | Balance: ₡9,021,214

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38489 | Stable: test_user_1771858882820_h8yhb | Balance: ₡9,999,485

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38491 | Stable: test_user_1771858883004_i117s | Balance: ₡8,999,821

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38493 | Stable: test_user_1771858883149_z48h3q | Balance: ₡9,631,698

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38494 | Stable: test_user_1771858883270_2lsd5 | Balance: ₡8,618,147

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38495 | Stable: test_user_prop4_1771858883422 | Balance: ₡100,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38496 | Stable: test_user_1771858883497_fwr34d | Balance: ₡4,128,146

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38497 | Stable: test_user_1771858883620_rlszi | Balance: ₡9,192,268

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38504 | Stable: test_user_1771858883820_tcqm2 | Balance: ₡4,915,749

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38505 | Stable: test_user_1771858883942_vgdw1 | Balance: ₡7,691,952

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38506 | Stable: test_user_1771858884084_sh99j9 | Balance: ₡7,765,289

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38507 | Stable: test_user_prop5_1_1771858884201 | Balance: ₡113,842

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38508 | Stable: test_user_prop5_2_1771858884217 | Balance: ₡118,676

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38509 | Stable: test_user_1771858884212_k2kg0a | Balance: ₡1,000,019

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 19

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Failed to create cycle snapshot: Error: Cycle 19 is incomplete - missing start or complete events
          at CycleSnapshotService.createSnapshot (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/cycleSnapshotService.ts:91:13)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:899:11

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:909:19

    console.log
      [Admin] === Cycle 19 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 1

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 19 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 181 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle19.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [Admin] Running 5 bulk cycles (includeTournaments: false, generateUsersPerCycle: true)...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 1 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 1 (1/5)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 1 (1/5) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:24.503Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Streaming] Robot1_1771858884459_0.4454343011126173 earned ₡8,996 from Battle #60760

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Streaming] Robot2_1771858884459_0.7218597843494668 earned ₡8,903 from Battle #60760

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Battle] League: bronze | Robot1_1771858884459_0.4454343011126173 (User 38460) vs Robot2_1771858884459_0.7218597843494668 (User 38461) | Winner: Robot1_1771858884459_0.4454343011126173 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Streaming] TestRobot1_1771858884466_0.41941401880065476 earned ₡1,002 from Battle #60763

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Streaming] TestRobot2_1771858884469_0.6164645118929425 earned ₡4,093 from Battle #60763

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Battle] League: bronze | TestRobot1_1771858884466_0.41941401880065476 (User 38507) vs TestRobot2_1771858884469_0.6164645118929425 (User 38508) | Winner: TestRobot2_1771858884469_0.6164645118929425 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +3

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 10 prestige, 5 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38461 | Robot 550684 (Robot2_1771858884459_0.7218597843494668) | Cost: ₡31,740 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38507 | Robot 550656 (TestRobot1_1771858884223_0.3998145265637485) | Cost: ₡31,740 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38507 | Robot 550674 (TestRobot1_1771858884374_0.34305294060837543) | Cost: ₡31,395 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38507 | Robot 550698 (TestRobot1_1771858884571_0.9206582319108751) | Cost: ₡20,470 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38507 | Robot 550685 (TestRobot1_1771858884466_0.41941401880065476) | Cost: ₡31,740 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38508 | Robot 550657 (TestRobot2_1771858884227_0.035538474698961986) | Cost: ₡19,550 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38508 | Robot 550676 (TestRobot2_1771858884377_0.06757752829223629) | Cost: ₡11,270 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38508 | Robot 550700 (TestRobot2_1771858884574_0.21689052351342086) | Cost: ₡16,100 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38508 | Robot 550686 (TestRobot2_1771858884469_0.6164645118929425) | Cost: ₡19,090 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38460 | Robot 550683 (Robot1_1771858884459_0.4454343011126173) | Cost: ₡8,280 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Execute Tag Team Battles (Cycle 1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Found 0 scheduled tag team matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Execution complete: 0 battles, 0 wins, 0 draws, 0 losses, 0 skipped due to unready robots

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38507 | Robot 550707 (TestRobot1_1771858884680_0.4150619395484886) | Cost: ₡13,570 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38508 | Robot 550708 (TestRobot2_1771858884684_0.5677860777347072) | Cost: ₡33,120 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 56

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 56 total robots across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Processing bronze_1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze_1: Skipping (0 eligible, need 10)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Rebalance Tag Team Leagues (Cycle 1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Starting tag team league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Total teams in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Tag team league rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Rebalancing instances across all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] bronze instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] silver instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] gold instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] platinum instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] diamond instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] champion instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Generating 1 archetype users for Cycle 1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Creating user 1/1: archetype_tank_fortress_1_1 (archetype: tank_fortress)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [UserGeneration] Error creating user 1: Error: Missing weapons for archetype tank_fortress. Expected 2 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at generateBattleReadyUsers (src/utils/userGeneration.ts:611:15)
      at src/routes/admin.ts:616:37

    console.error
      [Admin] Error generating users: Error: Missing weapons for archetype tank_fortress. Expected 2 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:619:21

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:25.944Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Processing bronze_1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Queue for bronze_1: 0 robots available (49 total, 0 ready)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] bronze_1: Not enough robots for matches (0 available)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Matchmaking for Tag Teams (Cycle 1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Starting tag team matchmaking for all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Complete: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38489 | Total: ₡500 | Facilities: roster_expansion(L0): ₡500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38513 | Total: ₡1,000 | Facilities: roster_expansion(L0): ₡1000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38470 | Total: ₡1,000 | Facilities: roster_expansion(L0): ₡1000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38494 | Total: ₡500 | Facilities: roster_expansion(L0): ₡500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38469 | Total: ₡500 | Facilities: roster_expansion(L0): ₡500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38509 | Total: ₡1,000 | Facilities: roster_expansion(L0): ₡1000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38478 | Total: ₡1,000 | Facilities: roster_expansion(L0): ₡1000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38474 | Total: ₡500 | Facilities: roster_expansion(L0): ₡500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38496 | Total: ₡500 | Facilities: roster_expansion(L0): ₡500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38479 | Total: ₡1,000 | Facilities: roster_expansion(L0): ₡1000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38510 | Total: ₡500 | Facilities: roster_expansion(L0): ₡500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38486 | Total: ₡1,000 | Facilities: roster_expansion(L0): ₡1000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38511 | Total: ₡1,000 | Facilities: roster_expansion(L0): ₡1000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38515 | Total: ₡500 | Facilities: roster_expansion(L0): ₡500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38506 | Total: ₡1,000 | Facilities: roster_expansion(L0): ₡1000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38512 | Total: ₡100 | Facilities: streaming_studio(L1): ₡100

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38460 | Total: ₡1,200 | Facilities: streaming_studio(L2): ₡200, roster_expansion(L0): ₡1000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38461 | Total: ₡1,200 | Facilities: streaming_studio(L2): ₡200, roster_expansion(L0): ₡1000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡0, Operating costs: ₡14,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 1 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38460 | Stable: test_terminal_log_user1_1771858880151 | Balance: ₡1,446,624

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Error in cycle 1: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logCycleEndBalance (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:618:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:877:11 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:942:17

    console.log
      [ERROR] Cycle 1 failed {"error":"\nInvalid `prisma.auditLog.create()` invocation in\n/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27\n\n  194 };\n  195 \n  196 // Insert into database\n→ 197 await prisma.auditLog.create(\nUnique constraint failed on the fields: (`cycle_number`,`sequence_number`)"}

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] === Cycle 1 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 165 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle1.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [INFO] === Cycle 2 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 2 (2/5)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 2 (2/5) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:26.389Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 2 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Streaming] TestRobot1_1771858886362_0.38374780647703477 earned ₡3,236 from Battle #60799

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Streaming] TestRobot2_1771858886366_0.4056536810367052 earned ₡1,002 from Battle #60799

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [BattleOrchestrator] Failed to process match 40611: PrismaClientKnownRequestError: 
      Invalid `prisma.battleParticipant.update()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:672:34
      
        669 }
        670 
        671 // Update BattleParticipant records with prestige, fame, and streaming revenue
      → 672 await prisma.battleParticipant.update(
      An operation failed because it depends on one or more records that were required but not found. Record to update not found.
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:672:3)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:431:31 {
        code: 'P2025',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'BattleParticipant',
          cause: 'Record to update not found.'
        }
      }

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at src/routes/admin.ts:431:31

    console.log
      [Streaming] Robot1_1771858886377_0.9348543202848533 earned ₡8,996 from Battle #60802

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Streaming] Robot2_1771858886377_0.8928731190315927 earned ₡8,575 from Battle #60802

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Battle] League: bronze | Robot1_1771858886377_0.9348543202848533 (User 38460) vs Robot2_1771858886377_0.8928731190315927 (User 38461) | Winner: Robot1_1771858886377_0.9348543202848533 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 1 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 2 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38507 | Robot 550901 (TestRobot1_1771858886083_0.5158938065945594) | Cost: ₡9,890 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38507 | Robot 550944 (TestRobot1_1771858886454_0.8014787935974518) | Cost: ₡12,650 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38508 | Robot 550903 (TestRobot2_1771858886086_0.12970037173932725) | Cost: ₡32,430 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38508 | Robot 550945 (TestRobot2_1771858886457_0.8637170017089737) | Cost: ₡32,430 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38460 | Robot 550935 (Robot1_1771858886377_0.9348543202848533) | Cost: ₡8,740 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38461 | Robot 550937 (Robot2_1771858886377_0.8928731190315927) | Cost: ₡31,740 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Skipping Tag Team Battles (even cycle 2)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38507 | Robot 550952 (TestRobot1_1771858886534_0.2321912349551366) | Cost: ₡46,000 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38507 | Robot 550944 (TestRobot1_1771858886454_0.8014787935974518) | Cost: ₡33,810 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38508 | Robot 550955 (TestRobot2_1771858886537_0.24545279250026686) | Cost: ₡14,490 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38508 | Robot 550945 (TestRobot2_1771858886457_0.8637170017089737) | Cost: ₡11,500 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 14

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 14 total robots across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Processing bronze_1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze_1: Skipping (0 eligible, need 10)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Skipping Tag Team Rebalancing (even cycle 2)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Generating 2 archetype users for Cycle 2...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Creating user 1/2: archetype_glass_cannon_a_2_1 (archetype: glass_cannon_a)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [UserGeneration] Error creating user 1: Error: Missing weapons for archetype glass_cannon_a. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at generateBattleReadyUsers (src/utils/userGeneration.ts:611:15)
      at src/routes/admin.ts:616:37

    console.error
      [Admin] Error generating users: Error: Missing weapons for archetype glass_cannon_a. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:619:21

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:27.743Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Processing bronze_1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Queue for bronze_1: 0 robots available (17 total, 0 ready)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] bronze_1: Not enough robots for matches (0 available)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Skipping Tag Team Matchmaking (even cycle 2)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38495 | Total: ₡600 | Facilities: streaming_studio(L1): ₡100, roster_expansion(L0): ₡500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38507 | Total: ₡1,500 | Facilities: roster_expansion(L0): ₡1500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38508 | Total: ₡1,500 | Facilities: roster_expansion(L0): ₡1500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38519 | Total: ₡300 | Facilities: streaming_studio(L3): ₡300

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38460 | Total: ₡1,700 | Facilities: streaming_studio(L2): ₡200, roster_expansion(L0): ₡1500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38461 | Total: ₡1,700 | Facilities: streaming_studio(L2): ₡200, roster_expansion(L0): ₡1500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡0, Operating costs: ₡7,300

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 2 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38460 | Stable: test_terminal_log_user1_1771858880151 | Balance: ₡1,572,538

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38461 | Stable: test_terminal_log_user2_1771858880185 | Balance: ₡1,845,894

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38468 | Stable: admin_test_1771858880501 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38507 | Stable: test_user_prop5_1_1771858884201 | Balance: ₡374,814

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38508 | Stable: test_user_prop5_2_1771858884217 | Balance: ₡257,209

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38519 | Stable: test_user_1771858885657_v2rd6k | Balance: ₡7,900,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38524 | Stable: test_user_1771858886394_ddls7r | Balance: ₡5,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38525 | Stable: test_user_1771858886472_jiz40d | Balance: ₡5,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38526 | Stable: test_user_1771858886549_rqs08b | Balance: ₡5,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38527 | Stable: test_user_1771858886624_0msye | Balance: ₡5,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38529 | Stable: test_user_1771858886704_e94wbh | Balance: ₡5,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38530 | Stable: test_user_1771858886784_jw3l2 | Balance: ₡5,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38531 | Stable: test_user_prop6_1771858886894 | Balance: ₡100,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38532 | Stable: test_user_1771858886862_1yzjzly | Balance: ₡5,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38533 | Stable: test_user_1771858886936_7ayd7q | Balance: ₡5,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38534 | Stable: test_user_1771858887011_lld6gj | Balance: ₡5,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38535 | Stable: test_user_1771858887088_79drza | Balance: ₡5,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38536 | Stable: test_user_1771858887162_xl42w | Balance: ₡5,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38537 | Stable: test_user_1771858887237_mtirwm | Balance: ₡5,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38538 | Stable: test_user_1771858887315_w5q1nr | Balance: ₡5,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38539 | Stable: test_user_1771858887389_eloynn | Balance: ₡5,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38540 | Stable: test_user_1771858887467_eb9lei | Balance: ₡5,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38541 | Stable: test_user_1771858887545_osj5j | Balance: ₡5,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38542 | Stable: test_user_1771858887621_mmmwyh | Balance: ₡5,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38543 | Stable: test_user_1771858887695_ztktn | Balance: ₡5,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38544 | Stable: test_user_1771858887768_mti1rg | Balance: ₡5,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38545 | Stable: test_user_1771858887845_p4rybq | Balance: ₡5,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 2

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Failed to create cycle snapshot: Error: Cycle 2 is incomplete - missing start or complete events
          at CycleSnapshotService.createSnapshot (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/cycleSnapshotService.ts:91:13)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:899:11

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:909:19

    console.log
      [Admin] === Cycle 2 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 2

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 2 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 142 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle2.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [INFO] === Cycle 3 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 3 (3/5)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 3 (3/5) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:28.043Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 3 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Streaming] TestRobot1_1771858887166_0.9028588570618461 earned ₡2,821 from Battle #60841

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Streaming] TestRobot2_1771858887167_0.301559992332477 earned ₡1,008 from Battle #60841

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Battle] League: bronze | TestRobot1_1771858887166_0.9028588570618461 (User 38507) vs TestRobot2_1771858887167_0.301559992332477 (User 38508) | Winner: TestRobot2_1771858887167_0.301559992332477 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Streaming] TestRobot1_1771858887877_0.20688885905033338 earned ₡2,806 from Battle #60844

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Streaming] TestRobot2_1771858887880_0.6195960670375037 earned ₡1,003 from Battle #60844

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Battle] League: bronze | TestRobot1_1771858887877_0.20688885905033338 (User 38507) vs TestRobot2_1771858887880_0.6195960670375037 (User 38508) | Winner: TestRobot2_1771858887880_0.6195960670375037 | Rewards: ₡9,000 / ₡1,500 | Prestige: +5 | Fame: +2

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [BattleOrchestrator] Failed to process match 40639: Error: Robots not found for match 40639
          at processBattle (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:606:11)
          at executeScheduledBattles (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:880:22)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:431:31

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at executeScheduledBattles (src/services/battleOrchestrator.ts:934:15)
      at src/routes/admin.ts:431:31

    console.log
      [BattleOrchestrator] Execution complete: 2 successful, 1 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 10 prestige, 4 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38507 | Robot 550964 (TestRobot1_1771858886626_0.9267471822723145) | Cost: ₡5,290 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38507 | Robot 550985 (TestRobot1_1771858886803_0.27707056638767114) | Cost: ₡7,820 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38507 | Robot 551031 (TestRobot1_1771858887166_0.9028588570618461) | Cost: ₡31,740 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38507 | Robot 551136 (TestRobot1_1771858887877_0.20688885905033338) | Cost: ₡31,395 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Error in cycle 3: PrismaClientKnownRequestError: 
      Invalid `prisma.robot.update()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/repairService.ts:135:26
      
        132 userFinalCost += repairCost;
        133 
        134 // Update robot HP and set battle ready
      → 135 await prisma.robot.update(
      An operation failed because it depends on one or more records that were required but not found. Record to update not found.
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at repairAllRobots (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/repairService.ts:135:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:443:32 {
        code: 'P2025',
        clientVersion: '5.22.0',
        meta: { modelName: 'Robot', cause: 'Record to update not found.' }
      }

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:942:17

    console.log
      [ERROR] Cycle 3 failed {"error":"\nInvalid `prisma.robot.update()` invocation in\n/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/repairService.ts:135:26\n\n  132 userFinalCost += repairCost;\n  133 \n  134 // Update robot HP and set battle ready\n→ 135 await prisma.robot.update(\nAn operation failed because it depends on one or more records that were required but not found. Record to update not found."}

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] === Cycle 3 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 23 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle3.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [INFO] === Cycle 4 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 4 (4/5)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 4 (4/5) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:28.276Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Streaming] Robot1_1771858888233_0.6126568771251876 earned ₡8,994 from Battle #60848

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Streaming] Robot2_1771858888233_0.3595921647592526 earned ₡8,495 from Battle #60848

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Battle] League: bronze | Robot1_1771858888233_0.6126568771251876 (User 38460) vs Robot2_1771858888233_0.3595921647592526 (User 38461) | Winner: Robot2_1771858888233_0.3595921647592526 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +3

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 3 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38508 | Robot 550966 (TestRobot2_1771858886629_0.6966059369859575) | Cost: ₡31,395 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38508 | Robot 550986 (TestRobot2_1771858886807_0.4895543051977098) | Cost: ₡33,120 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38508 | Robot 551032 (TestRobot2_1771858887167_0.301559992332477) | Cost: ₡15,870 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38508 | Robot 551138 (TestRobot2_1771858887880_0.6195960670375037) | Cost: ₡5,980 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Error in cycle 4: PrismaClientKnownRequestError: 
      Invalid `prisma.robot.update()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/repairService.ts:135:26
      
        132 userFinalCost += repairCost;
        133 
        134 // Update robot HP and set battle ready
      → 135 await prisma.robot.update(
      An operation failed because it depends on one or more records that were required but not found. Record to update not found.
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at repairAllRobots (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/repairService.ts:135:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:443:32 {
        code: 'P2025',
        clientVersion: '5.22.0',
        meta: { modelName: 'Robot', cause: 'Record to update not found.' }
      }

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:942:17

    console.log
      [ERROR] Cycle 4 failed {"error":"\nInvalid `prisma.robot.update()` invocation in\n/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/repairService.ts:135:26\n\n  132 userFinalCost += repairCost;\n  133 \n  134 // Update robot HP and set battle ready\n→ 135 await prisma.robot.update(\nAn operation failed because it depends on one or more records that were required but not found. Record to update not found."}

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] === Cycle 4 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 19 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle4.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [INFO] === Cycle 5 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 5 (5/5)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 5 (5/5) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:28.390Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 1 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Streaming] Robot1_1771858888352_0.2240864243221754 earned ₡8,940 from Battle #60852

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Streaming] Robot2_1771858888352_0.4130381603939325 earned ₡8,493 from Battle #60852

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Battle] League: bronze | Robot1_1771858888352_0.2240864243221754 (User 38460) vs Robot2_1771858888352_0.4130381603939325 (User 38461) | Winner: Robot1_1771858888352_0.2240864243221754 | Rewards: ₡9,375 / ₡1,500 | Prestige: +5 | Fame: +3

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 1 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 5 prestige, 3 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38460 | Robot 551182 (Robot1_1771858888233_0.6126568771251876) | Cost: ₡32,430 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38460 | Robot 551199 (Robot1_1771858888352_0.2240864243221754) | Cost: ₡4,370 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38461 | Robot 551184 (Robot2_1771858888233_0.3595921647592526) | Cost: ₡4,140 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38461 | Robot 551201 (Robot2_1771858888352_0.4130381603939325) | Cost: ₡32,430 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38508 | Robot 551209 (TestRobot2_1771858888410_0.03622984979192323) | Cost: ₡31,740 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38507 | Robot 551207 (TestRobot1_1771858888403_0.8541941132663584) | Cost: ₡7,440 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Execute Tag Team Battles (Cycle 5)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Found 0 scheduled tag team matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Execution complete: 0 battles, 0 wins, 0 draws, 0 losses, 0 skipped due to unready robots

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38508 | Robot 551209 (TestRobot2_1771858888410_0.03622984979192323) | Cost: ₡31,740 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [RepairService] | User 38507 | Robot 551221 (TestRobot1_1771858888491_0.4201576123434091) | Cost: ₡4,030 | Discount: 0%

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [RepairService] | ERROR | User 38508 | Robot 551222 | Failed to log repair event: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at repairAllRobots (src/services/repairService.ts:166:17)
      at src/routes/admin.ts:572:32

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 18

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 13 total robots across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Processing bronze_1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze_1: Skipping (0 eligible, need 10)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 4 total robots across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Processing silver_1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver_1: Skipping (0 eligible, need 10)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Rebalance Tag Team Leagues (Cycle 5)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Starting tag team league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Total teams in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Tag team league rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Rebalancing instances across all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] bronze instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] silver instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] gold instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] platinum instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] diamond instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] champion instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Generating 5 archetype users for Cycle 5...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Creating user 1/5: archetype_melee_specialist_5_1 (archetype: melee_specialist)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [UserGeneration] Error creating user 1: Error: Missing weapons for archetype melee_specialist. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at generateBattleReadyUsers (src/utils/userGeneration.ts:611:15)
      at src/routes/admin.ts:616:37

    console.error
      [Admin] Error generating users: Error: Missing weapons for archetype melee_specialist. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:619:21

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:29.697Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Processing bronze_1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Queue for bronze_1: 0 robots available (16 total, 0 ready)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] bronze_1: Not enough robots for matches (0 available)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Matchmaking for Tag Teams (Cycle 5)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Starting tag team matchmaking for all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Complete: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38507 | Total: ₡500 | Facilities: roster_expansion(L0): ₡500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38531 | Total: ₡400 | Facilities: streaming_studio(L4): ₡400

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38554 | Total: ₡200 | Facilities: streaming_studio(L2): ₡200

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38461 | Total: ₡2,700 | Facilities: streaming_studio(L2): ₡200, roster_expansion(L0): ₡2500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38460 | Total: ₡2,700 | Facilities: streaming_studio(L2): ₡200, roster_expansion(L0): ₡2500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡0, Operating costs: ₡6,500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 5 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38460 | Stable: test_terminal_log_user1_1771858880151 | Balance: ₡1,773,670

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38461 | Stable: test_terminal_log_user2_1771858880185 | Balance: ₡2,023,665

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38468 | Stable: admin_test_1771858880501 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38531 | Stable: test_user_prop6_1771858886894 | Balance: ₡99,600

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38554 | Stable: test_user_1771858888424_1scsmc | Balance: ₡6,400,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38585 | Stable: test_user_prop21_1771858889239 | Balance: ₡10,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38593 | Stable: test_user_1771858889682_k6acva | Balance: ₡10,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38597 | Stable: testuser_1771858889999 | Balance: ₡10,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 5

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Failed to create cycle snapshot: Error: Cycle 5 is incomplete - missing start or complete events
          at CycleSnapshotService.createSnapshot (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/cycleSnapshotService.ts:91:13)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:899:11

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:909:19

    console.log
      [Admin] === Cycle 5 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 1

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 5 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 159 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle5.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [Admin] Running 3 bulk cycles (includeTournaments: false, generateUsersPerCycle: false)...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 1 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 1 (1/3)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 1 (1/3) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:30.065Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Error in cycle 1: PrismaClientKnownRequestError: 
      Invalid `prisma.robot.update()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/repairService.ts:135:26
      
        132 userFinalCost += repairCost;
        133 
        134 // Update robot HP and set battle ready
      → 135 await prisma.robot.update(
      An operation failed because it depends on one or more records that were required but not found. Record to update not found.
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at repairAllRobots (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/repairService.ts:135:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:443:32 {
        code: 'P2025',
        clientVersion: '5.22.0',
        meta: { modelName: 'Robot', cause: 'Record to update not found.' }
      }

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:942:17

    console.log
      [ERROR] Cycle 1 failed {"error":"\nInvalid `prisma.robot.update()` invocation in\n/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/repairService.ts:135:26\n\n  132 userFinalCost += repairCost;\n  133 \n  134 // Update robot HP and set battle ready\n→ 135 await prisma.robot.update(\nAn operation failed because it depends on one or more records that were required but not found. Record to update not found."}

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] === Cycle 1 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 13 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle1.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [INFO] === Cycle 2 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 2 (2/3)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 2 (2/3) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:30.079Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Skipping Tag Team Battles (even cycle 2)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 10

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 10 total robots across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Processing bronze_1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze_1: Skipping (0 eligible, need 10)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Skipping Tag Team Rebalancing (even cycle 2)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:31.129Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Processing bronze_1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Queue for bronze_1: 0 robots available (5 total, 0 ready)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] bronze_1: Not enough robots for matches (0 available)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Skipping Tag Team Matchmaking (even cycle 2)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38531 | Total: ₡700 | Facilities: streaming_studio(L7): ₡700

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38460 | Total: ₡200 | Facilities: streaming_studio(L2): ₡200

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38593 | Total: ₡600 | Facilities: merchandising_hub(L3): ₡600

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38600 | Total: ₡39,500 | Facilities: roster_expansion(L0): ₡39500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38554 | Total: ₡200 | Facilities: streaming_studio(L2): ₡200

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡16,500, Operating costs: ₡41,200

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 2 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38616 | Stable: rebalancing_test_user | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38617 | Stable: test_user_1771858891294_cslst | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 2

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Failed to create cycle snapshot: Error: Cycle 2 is incomplete - missing start or complete events
          at CycleSnapshotService.createSnapshot (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/cycleSnapshotService.ts:91:13)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:899:11

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:909:19

    console.log
      [Admin] === Cycle 2 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 2 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 96 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle2.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [INFO] === Cycle 3 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 3 (3/3)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 3 (3/3) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:31.393Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Execute Tag Team Battles (Cycle 3)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Found 0 scheduled tag team matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Execution complete: 0 battles, 0 wins, 0 draws, 0 losses, 0 skipped due to unready robots

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 21

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 21 total robots across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Processing bronze_1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze_1: 2 robots eligible for promotion (top 10% of 20 AND ≥25 league points, 15 met points threshold)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Promoted: Bronze Robot 19 (bronze → silver, LP: 95 retained)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Promoted: Bronze Robot 18 (bronze → silver, LP: 90 retained)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 2, Demoted 0 across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 2 total robots across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Processing silver_1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver_1: Skipping (0 eligible, need 10)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 2

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Rebalance Tag Team Leagues (Cycle 3)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Starting tag team league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Total teams in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Tag team league rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Rebalancing instances across all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] bronze instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] silver instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] gold instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] platinum instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] diamond instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] champion instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:32.510Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Processing bronze_1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Queue for bronze_1: 0 robots available (0 total, 0 ready)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] bronze_1: Not enough robots for matches (0 available)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Matchmaking for Tag Teams (Cycle 3)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Starting tag team matchmaking for all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Complete: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡0, Operating costs: ₡0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 3 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38693 | Stable: battle_test_user_1771858892143 | Balance: ₡1,026,502

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38695 | Stable: bye_test | Balance: ₡3,001,500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38696 | Stable: testuser1_1771858892455 | Balance: ₡102,500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38697 | Stable: testuser2_1771858892455 | Balance: ₡110,001

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38698 | Stable: tournament_test_user1_1771858892568 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38699 | Stable: tournament_test_user2_1771858892568 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38700 | Stable: test_user_1771858892551_i441i | Balance: ₡10,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38701 | Stable: test_user_1771858892559_wfz948 | Balance: ₡10,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 3

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Failed to create cycle snapshot: Error: Cycle 3 is incomplete - missing start or complete events
          at CycleSnapshotService.createSnapshot (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/cycleSnapshotService.ts:91:13)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:899:11

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:909:19

    console.log
      [Admin] === Cycle 3 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 3 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 140 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle3.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [Admin] Running 2 bulk cycles (includeTournaments: false, generateUsersPerCycle: false)...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 1 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 1 (1/2)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 1 (1/2) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:32.705Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Execute Tag Team Battles (Cycle 1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Found 0 scheduled tag team matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Execution complete: 0 battles, 0 wins, 0 draws, 0 losses, 0 skipped due to unready robots

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Rebalance Tag Team Leagues (Cycle 1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Starting tag team league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Total teams in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Tag team league rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Rebalancing instances across all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] bronze instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] silver instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] gold instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] platinum instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] diamond instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] champion instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:33.823Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Matchmaking for Tag Teams (Cycle 1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Starting tag team matchmaking for all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Complete: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38704 | Total: ₡1,000 | Facilities: merchandising_hub(L5): ₡1000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡25,040, Operating costs: ₡1,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 1 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38704 | Stable: test_user_prop18_1771858892813 | Balance: ₡1,024,040

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38716 | Stable: pbt_standings_user_1771858893394 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38729 | Stable: test_user_1771858893912_cup3ra | Balance: ₡9,700,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 1

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Failed to create cycle snapshot: Error: Cycle 1 is incomplete - missing start or complete events
          at CycleSnapshotService.createSnapshot (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/cycleSnapshotService.ts:91:13)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:899:11

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:909:19

    console.log
      [Admin] === Cycle 1 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 1 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 128 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle1.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [INFO] === Cycle 2 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 2 (2/2)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 2 (2/2) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:34.020Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Skipping Tag Team Battles (even cycle 2)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Skipping Tag Team Rebalancing (even cycle 2)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:35.097Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Processing bronze_1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Queue for bronze_1: 0 robots available (1 total, 0 ready)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] bronze_1: Not enough robots for matches (0 available)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Skipping Tag Team Matchmaking (even cycle 2)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38735 | Total: ₡100 | Facilities: streaming_studio(L1): ₡100

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡0, Operating costs: ₡100

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 2 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38704 | Stable: test_user_prop18_1771858892813 | Balance: ₡1,024,040

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38716 | Stable: pbt_standings_user_1771858893394 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38737 | Stable: rc_test_1771858894130_154390 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38746 | Stable: rc_test_1771858895231_771466 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38747 | Stable: test_user_1771858895203_vhp0so | Balance: ₡9,400,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 2

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Failed to create cycle snapshot: Error: Cycle 2 is incomplete - missing start or complete events
          at CycleSnapshotService.createSnapshot (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/cycleSnapshotService.ts:91:13)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:899:11

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:909:19

    console.log
      [Admin] === Cycle 2 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 2 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 93 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle2.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [Admin] Running 2 bulk cycles (includeTournaments: false, generateUsersPerCycle: true)...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 1 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 1 (1/2)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 1 (1/2) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:35.363Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Execute Tag Team Battles (Cycle 1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Found 0 scheduled tag team matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Execution complete: 0 battles, 0 wins, 0 draws, 0 losses, 0 skipped due to unready robots

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Error in cycle 1: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logCycleStepComplete (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:287:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:460:11 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:942:17

    console.log
      [ERROR] Cycle 1 failed {"error":"\nInvalid `prisma.auditLog.create()` invocation in\n/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27\n\n  194 };\n  195 \n  196 // Insert into database\n→ 197 await prisma.auditLog.create(\nUnique constraint failed on the fields: (`cycle_number`,`sequence_number`)"}

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] === Cycle 1 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 16 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle1.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [INFO] === Cycle 2 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 2 (2/2)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 2 (2/2) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:35.381Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Skipping Tag Team Battles (even cycle 2)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 1

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 1 total robots across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Processing bronze_1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze_1: Skipping (0 eligible, need 10)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Skipping Tag Team Rebalancing (even cycle 2)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Generating 2 archetype users for Cycle 2...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Creating user 1/2: archetype_glass_cannon_a_2_1 (archetype: glass_cannon_a)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [UserGeneration] Error creating user 1: Error: Missing weapons for archetype glass_cannon_a. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at generateBattleReadyUsers (src/utils/userGeneration.ts:611:15)
      at src/routes/admin.ts:616:37

    console.error
      [Admin] Error generating users: Error: Missing weapons for archetype glass_cannon_a. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:619:21

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:36.512Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Processing bronze_1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Queue for bronze_1: 0 robots available (6 total, 0 ready)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] bronze_1: Not enough robots for matches (0 available)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 1 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Skipping Tag Team Matchmaking (even cycle 2)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38704 | Total: ₡800 | Facilities: merchandising_hub(L4): ₡800

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [OperatingCosts] User 38760 | Total: ₡500 | Facilities: streaming_studio(L5): ₡500

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡94,344, Operating costs: ₡1,300

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 2 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38716 | Stable: pbt_standings_user_1771858893394 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38737 | Stable: rc_test_1771858894130_154390 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 2

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Failed to create cycle snapshot: Error: Cycle 2 is incomplete - missing start or complete events
          at CycleSnapshotService.createSnapshot (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/cycleSnapshotService.ts:91:13)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:899:11

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:909:19

    console.log
      [Admin] === Cycle 2 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 2 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 97 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle2.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [Admin] Running 2 bulk cycles (includeTournaments: false, generateUsersPerCycle: true)...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 1 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 1 (1/2)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 1 (1/2) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:36.726Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Execute Tag Team Battles (Cycle 1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Found 0 scheduled tag team matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Execution complete: 0 battles, 0 wins, 0 draws, 0 losses, 0 skipped due to unready robots

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Rebalance Tag Team Leagues (Cycle 1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Starting tag team league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Total teams in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Tag team league rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Rebalancing instances across all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] bronze instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] silver instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] gold instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] platinum instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] diamond instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] champion instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Generating 1 archetype users for Cycle 1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Creating user 1/1: archetype_tank_fortress_1_1 (archetype: tank_fortress)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [UserGeneration] Error creating user 1: Error: Missing weapons for archetype tank_fortress. Expected 2 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at generateBattleReadyUsers (src/utils/userGeneration.ts:611:15)
      at src/routes/admin.ts:616:37

    console.error
      [Admin] Error generating users: Error: Missing weapons for archetype tank_fortress. Expected 2 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:619:21

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:37.835Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Matchmaking for Tag Teams (Cycle 1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Starting tag team matchmaking for all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Complete: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡0, Operating costs: ₡0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 1 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38716 | Stable: pbt_standings_user_1771858893394 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38737 | Stable: rc_test_1771858894130_154390 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 1

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Failed to create cycle snapshot: Error: Cycle 1 is incomplete - missing start or complete events
          at CycleSnapshotService.createSnapshot (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/cycleSnapshotService.ts:91:13)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:899:11

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:909:19

    console.log
      [Admin] === Cycle 1 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 1 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 130 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle1.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [INFO] === Cycle 2 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 2 (2/2)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 2 (2/2) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:37.975Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Skipping Tag Team Battles (even cycle 2)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Error in cycle 2: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logCycleStepComplete (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:287:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:475:9 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:942:17

    console.log
      [ERROR] Cycle 2 failed {"error":"\nInvalid `prisma.auditLog.create()` invocation in\n/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27\n\n  194 };\n  195 \n  196 // Insert into database\n→ 197 await prisma.auditLog.create(\nUnique constraint failed on the fields: (`cycle_number`,`sequence_number`)"}

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] === Cycle 2 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 14 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle2.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [Admin] Running 1 bulk cycles (includeTournaments: false, generateUsersPerCycle: true)...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 1 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 1 (1/1)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 1 (1/1) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:38.071Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Execute Tag Team Battles (Cycle 1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Found 0 scheduled tag team matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Execution complete: 0 battles, 0 wins, 0 draws, 0 losses, 0 skipped due to unready robots

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Rebalance Tag Team Leagues (Cycle 1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Starting tag team league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Total teams in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Tag team league rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Rebalancing instances across all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] bronze instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] silver instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] gold instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] platinum instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] diamond instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] champion instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Generating 1 archetype users for Cycle 1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Creating user 1/1: archetype_tank_fortress_1_1 (archetype: tank_fortress)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [UserGeneration] Error creating user 1: Error: Missing weapons for archetype tank_fortress. Expected 2 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at generateBattleReadyUsers (src/utils/userGeneration.ts:611:15)
      at src/routes/admin.ts:616:37

    console.error
      [Admin] Error generating users: Error: Missing weapons for archetype tank_fortress. Expected 2 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:619:21

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:39.178Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Matchmaking for Tag Teams (Cycle 1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Starting tag team matchmaking for all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Complete: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡0, Operating costs: ₡0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 1 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38716 | Stable: pbt_standings_user_1771858893394 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38737 | Stable: rc_test_1771858894130_154390 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 1

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Failed to create cycle snapshot: Error: Cycle 1 is incomplete - missing start or complete events
          at CycleSnapshotService.createSnapshot (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/cycleSnapshotService.ts:91:13)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:899:11

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:909:19

    console.log
      [Admin] === Cycle 1 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 1 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 130 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle1.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [Admin] Running 10 bulk cycles (includeTournaments: false, generateUsersPerCycle: true)...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 1 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 1 (1/10)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 1 (1/10) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:39.318Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Execute Tag Team Battles (Cycle 1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Found 0 scheduled tag team matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Execution complete: 0 battles, 0 wins, 0 draws, 0 losses, 0 skipped due to unready robots

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Rebalance Tag Team Leagues (Cycle 1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Starting tag team league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Total teams in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Tag team league rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Rebalancing instances across all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] bronze instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] silver instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] gold instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] platinum instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] diamond instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] champion instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Generating 1 archetype users for Cycle 1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Creating user 1/1: archetype_tank_fortress_1_1 (archetype: tank_fortress)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [UserGeneration] Error creating user 1: Error: Missing weapons for archetype tank_fortress. Expected 2 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at generateBattleReadyUsers (src/utils/userGeneration.ts:611:15)
      at src/routes/admin.ts:616:37

    console.error
      [Admin] Error generating users: Error: Missing weapons for archetype tank_fortress. Expected 2 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:619:21

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:40.426Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Matchmaking for Tag Teams (Cycle 1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Starting tag team matchmaking for all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Complete: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡0, Operating costs: ₡0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 1 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38716 | Stable: pbt_standings_user_1771858893394 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38737 | Stable: rc_test_1771858894130_154390 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 1

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Failed to create cycle snapshot: Error: Cycle 1 is incomplete - missing start or complete events
          at CycleSnapshotService.createSnapshot (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/cycleSnapshotService.ts:91:13)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:899:11

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:909:19

    console.log
      [Admin] === Cycle 1 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 1 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 130 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle1.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [INFO] === Cycle 2 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 2 (2/10)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 2 (2/10) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:40.562Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Skipping Tag Team Battles (even cycle 2)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Skipping Tag Team Rebalancing (even cycle 2)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Generating 2 archetype users for Cycle 2...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Creating user 1/2: archetype_glass_cannon_a_2_1 (archetype: glass_cannon_a)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [UserGeneration] Error creating user 1: Error: Missing weapons for archetype glass_cannon_a. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at generateBattleReadyUsers (src/utils/userGeneration.ts:611:15)
      at src/routes/admin.ts:616:37

    console.error
      [Admin] Error generating users: Error: Missing weapons for archetype glass_cannon_a. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:619:21

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:41.653Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Skipping Tag Team Matchmaking (even cycle 2)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡0, Operating costs: ₡0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 2 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38716 | Stable: pbt_standings_user_1771858893394 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38737 | Stable: rc_test_1771858894130_154390 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 2

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Failed to create cycle snapshot: Error: Cycle 2 is incomplete - missing start or complete events
          at CycleSnapshotService.createSnapshot (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/cycleSnapshotService.ts:91:13)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:899:11

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:909:19

    console.log
      [Admin] === Cycle 2 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 2 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 90 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle2.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [INFO] === Cycle 3 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 3 (3/10)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 3 (3/10) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:41.781Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Execute Tag Team Battles (Cycle 3)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Found 0 scheduled tag team matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Execution complete: 0 battles, 0 wins, 0 draws, 0 losses, 0 skipped due to unready robots

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Rebalance Tag Team Leagues (Cycle 3)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Starting tag team league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Total teams in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Tag team league rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Rebalancing instances across all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] bronze instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] silver instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] gold instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] platinum instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] diamond instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] champion instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Generating 3 archetype users for Cycle 3...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Creating user 1/3: archetype_glass_cannon_c_3_1 (archetype: glass_cannon_c)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [UserGeneration] Error creating user 1: Error: Missing weapons for archetype glass_cannon_c. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at generateBattleReadyUsers (src/utils/userGeneration.ts:611:15)
      at src/routes/admin.ts:616:37

    console.error
      [Admin] Error generating users: Error: Missing weapons for archetype glass_cannon_c. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:619:21

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:42.895Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Matchmaking for Tag Teams (Cycle 3)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Starting tag team matchmaking for all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Complete: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡0, Operating costs: ₡0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 3 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38716 | Stable: pbt_standings_user_1771858893394 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38737 | Stable: rc_test_1771858894130_154390 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 3

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Failed to create cycle snapshot: Error: Cycle 3 is incomplete - missing start or complete events
          at CycleSnapshotService.createSnapshot (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/cycleSnapshotService.ts:91:13)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:899:11

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:909:19

    console.log
      [Admin] === Cycle 3 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 3 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 129 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle3.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [INFO] === Cycle 4 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 4 (4/10)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 4 (4/10) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:43.028Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Skipping Tag Team Battles (even cycle 4)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Skipping Tag Team Rebalancing (even cycle 4)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Generating 4 archetype users for Cycle 4...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Creating user 1/4: archetype_speed_demon_c_4_1 (archetype: speed_demon_c)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [UserGeneration] Error creating user 1: Error: Missing weapons for archetype speed_demon_c. Expected 2 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at generateBattleReadyUsers (src/utils/userGeneration.ts:611:15)
      at src/routes/admin.ts:616:37

    console.error
      [Admin] Error generating users: Error: Missing weapons for archetype speed_demon_c. Expected 2 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:619:21

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:44.115Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Skipping Tag Team Matchmaking (even cycle 4)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡0, Operating costs: ₡0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 4 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38716 | Stable: pbt_standings_user_1771858893394 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38737 | Stable: rc_test_1771858894130_154390 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 4

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Failed to create cycle snapshot: Error: Cycle 4 is incomplete - missing start or complete events
          at CycleSnapshotService.createSnapshot (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/cycleSnapshotService.ts:91:13)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:899:11

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:909:19

    console.log
      [Admin] === Cycle 4 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 4 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 90 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle4.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [INFO] === Cycle 5 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 5 (5/10)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 5 (5/10) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:44.247Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Execute Tag Team Battles (Cycle 5)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Found 0 scheduled tag team matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Execution complete: 0 battles, 0 wins, 0 draws, 0 losses, 0 skipped due to unready robots

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Rebalance Tag Team Leagues (Cycle 5)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Starting tag team league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Total teams in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Tag team league rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Rebalancing instances across all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] bronze instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] silver instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] gold instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] platinum instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] diamond instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] champion instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Generating 5 archetype users for Cycle 5...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Creating user 1/5: archetype_melee_specialist_5_1 (archetype: melee_specialist)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [UserGeneration] Error creating user 1: Error: Missing weapons for archetype melee_specialist. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at generateBattleReadyUsers (src/utils/userGeneration.ts:611:15)
      at src/routes/admin.ts:616:37

    console.error
      [Admin] Error generating users: Error: Missing weapons for archetype melee_specialist. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:619:21

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:45.350Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Matchmaking for Tag Teams (Cycle 5)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Starting tag team matchmaking for all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Complete: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡0, Operating costs: ₡0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 5 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38716 | Stable: pbt_standings_user_1771858893394 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38737 | Stable: rc_test_1771858894130_154390 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 5

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Failed to create cycle snapshot: Error: Cycle 5 is incomplete - missing start or complete events
          at CycleSnapshotService.createSnapshot (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/cycleSnapshotService.ts:91:13)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:899:11

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:909:19

    console.log
      [Admin] === Cycle 5 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 5 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 129 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle5.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [INFO] === Cycle 6 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 6 (6/10)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 6 (6/10) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:45.486Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Skipping Tag Team Battles (even cycle 6)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Skipping Tag Team Rebalancing (even cycle 6)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Generating 6 archetype users for Cycle 6...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Creating user 1/6: archetype_glass_cannon_a_6_1 (archetype: glass_cannon_a)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [UserGeneration] Error creating user 1: Error: Missing weapons for archetype glass_cannon_a. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at generateBattleReadyUsers (src/utils/userGeneration.ts:611:15)
      at src/routes/admin.ts:616:37

    console.error
      [Admin] Error generating users: Error: Missing weapons for archetype glass_cannon_a. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:619:21

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:46.574Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Skipping Tag Team Matchmaking (even cycle 6)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡0, Operating costs: ₡0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 6 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38716 | Stable: pbt_standings_user_1771858893394 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38737 | Stable: rc_test_1771858894130_154390 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 6

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Failed to create cycle snapshot: Error: Cycle 6 is incomplete - missing start or complete events
          at CycleSnapshotService.createSnapshot (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/cycleSnapshotService.ts:91:13)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:899:11

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:909:19

    console.log
      [Admin] === Cycle 6 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 6 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 90 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle6.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [INFO] === Cycle 7 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 7 (7/10)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 7 (7/10) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:46.703Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Execute Tag Team Battles (Cycle 7)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Found 0 scheduled tag team matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Execution complete: 0 battles, 0 wins, 0 draws, 0 losses, 0 skipped due to unready robots

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Rebalance Tag Team Leagues (Cycle 7)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Starting tag team league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Total teams in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Tag team league rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Rebalancing instances across all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] bronze instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] silver instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] gold instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] platinum instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] diamond instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] champion instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Generating 7 archetype users for Cycle 7...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Creating user 1/7: archetype_balanced_brawler_7_1 (archetype: balanced_brawler)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [UserGeneration] Error creating user 1: Error: Missing weapons for archetype balanced_brawler. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at generateBattleReadyUsers (src/utils/userGeneration.ts:611:15)
      at src/routes/admin.ts:616:37

    console.error
      [Admin] Error generating users: Error: Missing weapons for archetype balanced_brawler. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:619:21

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:47.813Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Matchmaking for Tag Teams (Cycle 7)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Starting tag team matchmaking for all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Complete: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡0, Operating costs: ₡0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 7 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38716 | Stable: pbt_standings_user_1771858893394 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38737 | Stable: rc_test_1771858894130_154390 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 7

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Failed to create cycle snapshot: Error: Cycle 7 is incomplete - missing start or complete events
          at CycleSnapshotService.createSnapshot (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/cycleSnapshotService.ts:91:13)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:899:11

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:909:19

    console.log
      [Admin] === Cycle 7 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 7 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 129 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle7.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [INFO] === Cycle 8 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 8 (8/10)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 8 (8/10) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:47.947Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Skipping Tag Team Battles (even cycle 8)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Error in cycle 8: PrismaClientKnownRequestError: 
      Invalid `prisma.auditLog.create()` invocation in
      /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27
      
        194 };
        195 
        196 // Insert into database
      → 197 await prisma.auditLog.create(
      Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)
          at $n.handleRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:7315)
          at $n.handleAndLogRequestError (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6623)
          at $n.request (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:121:6307)
          at l (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:9633)
          at EventLogger.logEvent (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:5)
          at EventLogger.logCycleStepComplete (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:287:5)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:585:9 {
        code: 'P2002',
        clientVersion: '5.22.0',
        meta: {
          modelName: 'AuditLog',
          target: [ 'cycle_number', 'sequence_number' ]
        }
      }

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:942:17

    console.log
      [ERROR] Cycle 8 failed {"error":"\nInvalid `prisma.auditLog.create()` invocation in\n/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27\n\n  194 };\n  195 \n  196 // Insert into database\n→ 197 await prisma.auditLog.create(\nUnique constraint failed on the fields: (`cycle_number`,`sequence_number`)"}

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] === Cycle 8 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 52 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle8.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [INFO] === Cycle 9 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 9 (9/10)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 9 (9/10) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:47.977Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Execute Tag Team Battles (Cycle 9)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Found 0 scheduled tag team matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Execution complete: 0 battles, 0 wins, 0 draws, 0 losses, 0 skipped due to unready robots

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Rebalance Tag Team Leagues (Cycle 9)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Starting tag team league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Total teams in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Tag team league rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Rebalancing instances across all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] bronze instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] silver instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] gold instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] platinum instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] diamond instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] champion instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Generating 9 archetype users for Cycle 9...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Creating user 1/9: archetype_facility_investor_9_1 (archetype: facility_investor)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [UserGeneration] Error creating user 1: Error: Missing weapons for archetype facility_investor. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at generateBattleReadyUsers (src/utils/userGeneration.ts:611:15)
      at src/routes/admin.ts:616:37

    console.error
      [Admin] Error generating users: Error: Missing weapons for archetype facility_investor. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:619:21

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:49.082Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Matchmaking for Tag Teams (Cycle 9)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Starting tag team matchmaking for all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Complete: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡0, Operating costs: ₡0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 9 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38716 | Stable: pbt_standings_user_1771858893394 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38737 | Stable: rc_test_1771858894130_154390 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 9

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [Admin] Failed to create cycle snapshot: Error: Cycle 9 is incomplete - missing start or complete events
          at CycleSnapshotService.createSnapshot (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/cycleSnapshotService.ts:91:13)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:899:11

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:909:19

    console.log
      [Admin] === Cycle 9 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 9 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 129 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle9.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [INFO] === Cycle 10 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 10 (10/10)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 10 (10/10) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:49.230Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Skipping Tag Team Battles (even cycle 10)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Skipping Tag Team Rebalancing (even cycle 10)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Generating 10 archetype users for Cycle 10...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Creating user 1/10: archetype_glass_cannon_c_10_1 (archetype: glass_cannon_c)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [UserGeneration] Error creating user 1: Error: Missing weapons for archetype glass_cannon_c. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at generateBattleReadyUsers (src/utils/userGeneration.ts:611:15)
      at src/routes/admin.ts:616:37

    console.error
      [Admin] Error generating users: Error: Missing weapons for archetype glass_cannon_c. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:619:21

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:50.345Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Skipping Tag Team Matchmaking (even cycle 10)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡0, Operating costs: ₡0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 10 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38716 | Stable: pbt_standings_user_1771858893394 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38737 | Stable: rc_test_1771858894130_154390 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 10

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Found 0 battle_complete events for cycle 10

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Found 2 cycle_end_balance events for cycle 10

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Snapshot created for cycle 10

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Cycle snapshot created for cycle 10

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === Cycle 10 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 10 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 93 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle10.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [Admin] Running 3 bulk cycles (includeTournaments: false, generateUsersPerCycle: true)...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 1 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 1 (1/3)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 1 (1/3) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:50.542Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Execute Tag Team Battles (Cycle 1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Found 0 scheduled tag team matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Execution complete: 0 battles, 0 wins, 0 draws, 0 losses, 0 skipped due to unready robots

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Rebalance Tag Team Leagues (Cycle 1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Starting tag team league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Total teams in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Tag team league rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Rebalancing instances across all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] bronze instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] silver instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] gold instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] platinum instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] diamond instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] champion instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Generating 1 archetype users for Cycle 1...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Creating user 1/1: archetype_tank_fortress_1_1 (archetype: tank_fortress)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [UserGeneration] Error creating user 1: Error: Missing weapons for archetype tank_fortress. Expected 2 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at generateBattleReadyUsers (src/utils/userGeneration.ts:611:15)
      at src/routes/admin.ts:616:37

    console.error
      [Admin] Error generating users: Error: Missing weapons for archetype tank_fortress. Expected 2 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:619:21

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:51.709Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Matchmaking for Tag Teams (Cycle 1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Starting tag team matchmaking for all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Complete: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡0, Operating costs: ₡0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 1 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38716 | Stable: pbt_standings_user_1771858893394 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38737 | Stable: rc_test_1771858894130_154390 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 1

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Found 0 battle_complete events for cycle 1

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Found 2 cycle_end_balance events for cycle 1

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Snapshot created for cycle 1

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Cycle snapshot created for cycle 1

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === Cycle 1 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 1 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 133 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle1.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [INFO] === Cycle 2 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 2 (2/3)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 2 (2/3) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:51.889Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Skipping Tag Team Battles (even cycle 2)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Skipping Tag Team Rebalancing (even cycle 2)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Generating 2 archetype users for Cycle 2...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Creating user 1/2: archetype_glass_cannon_a_2_1 (archetype: glass_cannon_a)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [UserGeneration] Error creating user 1: Error: Missing weapons for archetype glass_cannon_a. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at generateBattleReadyUsers (src/utils/userGeneration.ts:611:15)
      at src/routes/admin.ts:616:37

    console.error
      [Admin] Error generating users: Error: Missing weapons for archetype glass_cannon_a. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:619:21

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:53.016Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Skipping Tag Team Matchmaking (even cycle 2)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡0, Operating costs: ₡0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 2 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38716 | Stable: pbt_standings_user_1771858893394 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38737 | Stable: rc_test_1771858894130_154390 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 2

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Found 0 battle_complete events for cycle 2

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Found 2 cycle_end_balance events for cycle 2

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Snapshot created for cycle 2

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Cycle snapshot created for cycle 2

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === Cycle 2 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 2 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 93 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle2.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

    console.log
      [INFO] === Cycle 3 Started ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [INFO] Cycle 3 (3/3)

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      
      [Admin] === Cycle 3 (3/3) ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 1: Execute League Battles (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Executing battles scheduled for: 2026-02-23T15:01:53.205Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Found 0 matches to execute

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Execution complete: 0 successful, 0 failed, 0 bye-matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [BattleOrchestrator] Reputation: 0 prestige, 0 fame awarded

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 2: Repair All Robots (post-league)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 3: Execute Tag Team Battles (Cycle 3)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Found 0 scheduled tag team matches

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamBattles] Execution complete: 0 battles, 0 wins, 0 draws, 0 losses, 0 skipped due to unready robots

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 4: Repair All Robots (post-tag-team)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 5: Tournament Execution / Scheduling

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 6: Repair All Robots (post-tournament)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7: Rebalance Leagues

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Starting league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] Total robots in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: 0 total robots across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [Rebalancing] Checking instances for rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] bronze: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] silver: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] gold: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] platinum: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] diamond: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] champion: All instances at or under 100 robots, skipping rebalancing

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Rebalancing] League rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 7.5: Rebalance Tag Team Leagues (Cycle 3)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Starting tag team league rebalancing...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Total teams in system: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] bronze: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] silver: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] gold: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] platinum: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] diamond: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      [TagTeamRebalancing] Processing CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: 0 total teams across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] champion: Promoted 0, Demoted 0 across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Tag team league rebalancing complete!

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total promoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Total demoted: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
        Errors: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      ════════════════════════════════════════════════════════════

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamRebalancing] Rebalancing instances across all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] bronze instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] silver instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] gold instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] platinum instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] diamond instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamLeagueInstance] champion instances balanced, no action needed

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 8: Auto Generate New Users

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Generating 3 archetype users for Cycle 3...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [UserGeneration] Creating user 1/3: archetype_glass_cannon_c_3_1 (archetype: glass_cannon_c)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.error
      [UserGeneration] Error creating user 1: Error: Missing weapons for archetype glass_cannon_c. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at generateBattleReadyUsers (src/utils/userGeneration.ts:611:15)
      at src/routes/admin.ts:616:37

    console.error
      [Admin] Error generating users: Error: Missing weapons for archetype glass_cannon_c. Expected 1 unique weapons, found 0
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:509:17
          at Proxy._transactionWithCallback (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/node_modules/@prisma/client/runtime/library.js:130:8000)
          at generateBattleReadyUsers (/Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/userGeneration.ts:476:7)
          at /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/routes/admin.ts:616:37

       95 |       }
       96 |       
    >  97 |       self.originalConsoleError(...args);
          |            ^
       98 |     };
       99 |
      100 |     console.warn = function(...args: any[]) {

      at console.error (src/utils/cycleLogger.ts:97:12)
      at src/routes/admin.ts:619:21

    console.log
      [Admin] Step 9: Matchmaking for Leagues (1v1)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Starting matchmaking run...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Matches scheduled for: 2026-02-23T15:01:54.354Z

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for BRONZE league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] BRONZE: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for SILVER league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] SILVER: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for GOLD league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] GOLD: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for PLATINUM league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] PLATINUM: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for DIAMOND league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] DIAMOND: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] Running matchmaking for CHAMPION league...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] CHAMPION: Created 0 matches across 0 instances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] COMPLETE: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Matchmaking] ========================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 9.5: Matchmaking for Tag Teams (Cycle 3)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Starting tag team matchmaking for all tiers...

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [TagTeamMatchmaking] Complete: 0 total matches created

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 10: Increment Cycle Counters

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 11: Calculate Passive Income & Operating Costs

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Passive income: ₡0, Operating costs: ₡0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 12: Wait (1.1 second delay)

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 13: Log End-of-Cycle Balances

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === End of Cycle 3 Balances ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38716 | Stable: pbt_standings_user_1771858893394 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Balance] User 38737 | Stable: rc_test_1771858894130_154390 | Balance: ₡1,000,000

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Step 14: Create Cycle Snapshot

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Creating snapshot for cycle 3

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Found 0 battle_complete events for cycle 3

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Found 2 cycle_end_balance events for cycle 3

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [CycleSnapshotService] Snapshot created for cycle 3

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Cycle snapshot created for cycle 3

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] === Cycle 3 Summary ===

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] Battles: 0

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [Admin] ===================================

      at console.log (src/utils/cycleLogger.ts:76:12)

    console.log
      [INFO] === Cycle 3 Ended ===

      at CycleLogger.log (src/utils/cycleLogger.ts:142:10)

    console.log
      [CycleLogger] Saved 132 log entries to /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/cycle_logs/cycle3.csv

      at CycleLogger.saveCycleLogs (src/utils/cycleLogger.ts:173:12)

  ● Admin Cycle Generation Integration Tests › POST /api/admin/cycles/bulk with generateUsersPerCycle › should generate progressive users per cycle

    TypeError: Cannot read properties of undefined (reading 'usersCreated')

      139 |
      140 |       // Verify user generation in each cycle
    > 141 |       expect(response.body.results[0].userGeneration.usersCreated).toBe(1);
          |                                                      ^
      142 |       expect(response.body.results[1].userGeneration.usersCreated).toBe(2);
      143 |       expect(response.body.results[2].userGeneration.usersCreated).toBe(3);
      144 |

      at Object.<anonymous> (tests/integration/adminCycleGeneration.test.ts:141:54)

  ● Admin Cycle Generation Integration Tests › POST /api/admin/cycles/bulk with generateUsersPerCycle › should persist cycle count across multiple runs

    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: 40

      168 |       // Verify cycle metadata
      169 |       const metadata1 = await prisma.cycleMetadata.findUnique({ where: { id: 1 } });
    > 170 |       expect(metadata1!.totalCycles).toBe(5);
          |                                      ^
      171 |
      172 |       // Second run: 3 cycles (should start at cycle 6)
      173 |       const response2 = await request(app)

      at Object.<anonymous> (tests/integration/adminCycleGeneration.test.ts:170:38)

  ● Admin Cycle Generation Integration Tests › POST /api/admin/cycles/bulk with generateUsersPerCycle › should not generate users when flag is false

    expect(received).toBeNull()

    Received: undefined

      218 |       // Verify no user generation in results
      219 |       response.body.results.forEach((result: any) => {
    > 220 |         expect(result.userGeneration).toBeNull();
          |                                       ^
      221 |       });
      222 |
      223 |       // Verify no users were created

      at tests/integration/adminCycleGeneration.test.ts:220:39
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (tests/integration/adminCycleGeneration.test.ts:219:29)

  ● Admin Cycle Generation Integration Tests › POST /api/admin/cycles/bulk with generateUsersPerCycle › should return correct response structure

    expect(received).toHaveProperty(path)

    Expected path: "usersCreated"
    Received path: []

    Received value: {"error": "Missing weapons for archetype tank_fortress. Expected 2 unique weapons, found 0"}

      348 |         expect(result).toHaveProperty('cycle');
      349 |         expect(result).toHaveProperty('userGeneration');
    > 350 |         expect(result.userGeneration).toHaveProperty('usersCreated');
          |                                       ^
      351 |         expect(result.userGeneration).toHaveProperty('robotsCreated');
      352 |         expect(result.userGeneration).toHaveProperty('usernames');
      353 |       });

      at tests/integration/adminCycleGeneration.test.ts:350:39
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (tests/integration/adminCycleGeneration.test.ts:347:29)

  ● Admin Cycle Generation Integration Tests › POST /api/admin/cycles/bulk with generateUsersPerCycle › should auto-create CycleMetadata if missing

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: undefined

      392 |
      393 |       expect(response.status).toBe(200);
    > 394 |       expect(response.body.results[0].userGeneration.usersCreated).toBe(1);
          |                                                                    ^
      395 |
      396 |       // Verify CycleMetadata was created
      397 |       const metadata = await prisma.cycleMetadata.findUnique({ where: { id: 1 } });

      at Object.<anonymous> (tests/integration/adminCycleGeneration.test.ts:394:68)

  ● Admin Cycle Generation Integration Tests › POST /api/admin/cycles/bulk with generateUsersPerCycle › should generate correct total user count formula (N*(N+1)/2)

    expect(received).toBe(expected) // Object.is equality

    Expected: 55
    Received: 0

      419 |       });
      420 |
    > 421 |       expect(totalUsers).toBe(expectedTotal);
          |                          ^
      422 |     });
      423 |
      424 |     it('should create users eligible for matchmaking', async () => {

      at Object.<anonymous> (tests/integration/adminCycleGeneration.test.ts:421:26)

Summary of all failing tests
FAIL tests/tagTeamValidation.property.test.ts
  ● Tag Team Validation Property Tests › should only validate teams where both robots are from same stable and battle ready

    TypeError: Cannot read properties of null (reading 'id')

      43 |     // Get a weapon for testing
      44 |     const weapon = await prisma.weapon.findFirst();
    > 45 |     weaponId = weapon!.id;
         |                        ^
      46 |   });
      47 |
      48 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:45:24)

  ● Tag Team Validation Property Tests › should reject teams with robots from different stables

    TypeError: Cannot read properties of null (reading 'id')

      43 |     // Get a weapon for testing
      44 |     const weapon = await prisma.weapon.findFirst();
    > 45 |     weaponId = weapon!.id;
         |                        ^
      46 |   });
      47 |
      48 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:45:24)

  ● Tag Team Validation Property Tests › should reject teams with unready robots

    TypeError: Cannot read properties of null (reading 'id')

      43 |     // Get a weapon for testing
      44 |     const weapon = await prisma.weapon.findFirst();
    > 45 |     weaponId = weapon!.id;
         |                        ^
      46 |   });
      47 |
      48 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:45:24)

  ● Tag Team Validation Property Tests › should preserve team configuration through create and retrieve cycle

    TypeError: Cannot read properties of null (reading 'id')

      43 |     // Get a weapon for testing
      44 |     const weapon = await prisma.weapon.findFirst();
    > 45 |     weaponId = weapon!.id;
         |                        ^
      46 |   });
      47 |
      48 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:45:24)

  ● Tag Team Validation Property Tests › should place all new teams in Bronze league with initial values

    TypeError: Cannot read properties of null (reading 'id')

      43 |     // Get a weapon for testing
      44 |     const weapon = await prisma.weapon.findFirst();
    > 45 |     weaponId = weapon!.id;
         |                        ^
      46 |   });
      47 |
      48 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:45:24)

  ● Tag Team Validation Property Tests › should enforce team creation limit based on roster size

    TypeError: Cannot read properties of null (reading 'id')

      43 |     // Get a weapon for testing
      44 |     const weapon = await prisma.weapon.findFirst();
    > 45 |     weaponId = weapon!.id;
         |                        ^
      46 |   });
      47 |
      48 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:45:24)

  ● Tag Team Validation Property Tests › should remove team from database and free robots for new teams

    TypeError: Cannot read properties of null (reading 'id')

      43 |     // Get a weapon for testing
      44 |     const weapon = await prisma.weapon.findFirst();
    > 45 |     weaponId = weapon!.id;
         |                        ^
      46 |   });
      47 |
      48 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:45:24)

  ● Tag Team Validation Property Tests › should validate team readiness based on both robots meeting all requirements

    TypeError: Cannot read properties of null (reading 'id')

      43 |     // Get a weapon for testing
      44 |     const weapon = await prisma.weapon.findFirst();
    > 45 |     weaponId = weapon!.id;
         |                        ^
      46 |   });
      47 |
      48 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:45:24)

  ● Tag Team Validation Property Tests › should calculate combined ELO as sum of both robots ELOs

    TypeError: Cannot read properties of null (reading 'id')

      43 |     // Get a weapon for testing
      44 |     const weapon = await prisma.weapon.findFirst();
    > 45 |     weaponId = weapon!.id;
         |                        ^
      46 |   });
      47 |
      48 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:45:24)

  ● Tag Team Matchmaking Cycle Scheduling Property Tests › should alternate matchmaking between consecutive cycles

    Property failed after 35 tests
    { seed: -421635051, path: "34", endOnFailure: true }
    Counterexample: [76]
    Shrunk 0 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).not.toBe(expected) // Object.is equality

    Expected: not false

      1121 |
      1122 |           // Property: Consecutive cycles should have opposite values
    > 1123 |           expect(shouldRunCurrent).not.toBe(shouldRunNext);
           |                                        ^
      1124 |
      1125 |           // Property: If current cycle runs, next should not
      1126 |           if (shouldRunCurrent) {

      at tests/tagTeamValidation.property.test.ts:1123:40
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:1103:5)

  ● Tag Team Matchmaking Eligible Teams Property Tests › should exclude teams with unready robots from eligible teams

    TypeError: Cannot read properties of null (reading 'id')

      1207 |     // Get a weapon for testing
      1208 |     const weapon = await prisma.weapon.findFirst();
    > 1209 |     weaponId = weapon!.id;
           |                        ^
      1210 |   });
      1211 |
      1212 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:1209:24)

  ● Tag Team Matchmaking Eligible Teams Property Tests › should exclude teams where any robot has HP below 75%

    TypeError: Cannot read properties of null (reading 'id')

      1207 |     // Get a weapon for testing
      1208 |     const weapon = await prisma.weapon.findFirst();
    > 1209 |     weaponId = weapon!.id;
           |                        ^
      1210 |   });
      1211 |
      1212 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:1209:24)

  ● Tag Team Matchmaking ELO Matching Property Tests › should prefer matching teams with smaller ELO differences

    TypeError: Cannot read properties of null (reading 'id')

      1498 |     // Get a weapon for testing
      1499 |     const weapon = await prisma.weapon.findFirst();
    > 1500 |     weaponId = weapon!.id;
           |                        ^
      1501 |   });
      1502 |
      1503 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:1500:24)

  ● Tag Team Matchmaking Same-Stable Exclusion Property Tests › should strongly deprioritize same-stable matches

    TypeError: Cannot read properties of null (reading 'id')

      1684 |     // Get a weapon for testing
      1685 |     const weapon = await prisma.weapon.findFirst();
    > 1686 |     weaponId = weapon!.id;
           |                        ^
      1687 |   });
      1688 |
      1689 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:1686:24)

  ● Tag Team Matchmaking Recent Opponent Deprioritization Property Tests › should deprioritize recent opponents when multiple options exist

    TypeError: Cannot read properties of null (reading 'id')

      1934 |     // Get a weapon for testing
      1935 |     const weapon = await prisma.weapon.findFirst();
    > 1936 |     weaponId = weapon!.id;
           |                        ^
      1937 |   });
      1938 |
      1939 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamValidation.property.test.ts:1936:24)

FAIL tests/creditChangeAuditTrail.property.test.ts (5.273 s)
  ● Property 3: Credit Change Audit Trail › balance progression is continuous

    Property failed after 3 tests
    { seed: -885100289, path: "2", endOnFailure: true }
    Counterexample: [9,84,77398,[-269,1000]]
    Shrunk 0 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCreditChange (src/services/eventLogger.ts:401:5)
      at tests/creditChangeAuditTrail.property.test.ts:167:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/creditChangeAuditTrail.property.test.ts:148:5)

  ● Property 3: Credit Change Audit Trail › multiple users tracked independently

    Property failed after 1 tests
    { seed: 661200367, path: "0:0:1:0:0:0:0:0:0:0:0:1:0:0:0:0:0:0:0:0:0:0:2:6:3:3:1", endOnFailure: true }
    Counterexample: [1,[{"userId":1,"startingBalance":0,"changes":[0]},{"userId":1,"startingBalance":4,"changes":[-777]}]]
    Shrunk 26 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: -777
    Received: -553

      263 |             }, 0);
      264 |
    > 265 |             expect(sumOfChanges).toBe(expectedDelta);
          |                                  ^
      266 |           }
      267 |         }
      268 |       ),

      at tests/creditChangeAuditTrail.property.test.ts:265:34
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/creditChangeAuditTrail.property.test.ts:206:5)

  ● Property 3: Credit Change Audit Trail › credit changes across multiple cycles

    Property failed after 2 tests
    { seed: -261052029, path: "1:0:0:0:1:2:0:0:7:1:0:0:2:1:4:1:2:6:4:1:2:1:1:1:3:0:1:6:4:1:2:2:2:2:1:0:0:0:0:0:0:3:0", endOnFailure: true }
    Counterexample: [1,[{"cycleNumber":1,"startingBalance":0,"changes":[513]},{"cycleNumber":1,"startingBalance":11721,"changes":[0,13]}]]
    Shrunk 42 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 526
    Received: 13

      337 |             }, 0);
      338 |
    > 339 |             expect(sumOfChanges).toBe(expectedDelta);
          |                                  ^
      340 |           }
      341 |         }
      342 |       ),

      at tests/creditChangeAuditTrail.property.test.ts:339:34
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/creditChangeAuditTrail.property.test.ts:280:5)

  ● Property 3: Credit Change Audit Trail › credit source is preserved

    Property failed after 2 tests
    { seed: -1998131617, path: "1:4:1:4:0:0:0:0:3:1:1:1:3:3:2:2", endOnFailure: true }
    Counterexample: [1,1,0,[{"amount":0,"source":"battle"},{"amount":-2900,"source":"facility_purchase"}]]
    Shrunk 15 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 1

      399 |           });
      400 |
    > 401 |           expect(events.length).toBe(changes.length);
          |                                 ^
      402 |
      403 |           for (let i = 0; i < events.length; i++) {
      404 |             const payload = events[i].payload as any;

      at tests/creditChangeAuditTrail.property.test.ts:401:33
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/creditChangeAuditTrail.property.test.ts:353:5)

FAIL tests/financialReportStreamingRevenue.property.test.ts
  ● Property 17: Financial Report Includes Streaming Revenue › Property 17: Financial report includes streaming revenue line item

    Property failed after 1 tests
    { seed: -836021373, path: "0:0:0:0:1:0:0:0:0", endOnFailure: true }
    Counterexample: [{__proto__:null,"numBattles":1,"robotBattles":0,"robotFame":0,"studioLevel":0,"streamingRevenuePerBattle":[1000]}]
    Shrunk 8 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 1000
    Received: 0

      205 |
      206 |           // Property 3: Streaming revenue should equal sum of all battle streaming revenues
    > 207 |           expect(report.revenue.streaming).toBe(expectedTotalStreamingRevenue);
          |                                            ^
      208 |
      209 |           // Property 4: Streaming battle count should equal number of battles
      210 |           expect(report.revenue.streamingBattleCount).toBe(numBattles);

      at tests/financialReportStreamingRevenue.property.test.ts:207:44
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/financialReportStreamingRevenue.property.test.ts:127:5)

  ● Property 17: Financial Report Includes Streaming Revenue › Property 17.2: Only counts streaming revenue from user's robots

    Property failed after 1 tests
    { seed: 920757807, path: "0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [{"userBattles":1,"opponentBattles":1,"userStreamingRevenue":[1000],"opponentStreamingRevenue":[1000]}]
    Shrunk 5 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 2000
    Received:    0

      383 |             // Note: The report aggregates from last 7 days, so it may include more than just our test data
      384 |             // We verify that it includes AT LEAST the expected amount from our test
    > 385 |             expect(report.revenue.streaming).toBeGreaterThanOrEqual(expectedUserStreamingRevenue);
          |                                              ^
      386 |
      387 |             // Property: Should count at least the battles where user's robot participated
      388 |             expect(report.revenue.streamingBattleCount).toBeGreaterThanOrEqual(userBattles + opponentBattles);

      at tests/financialReportStreamingRevenue.property.test.ts:385:46
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/financialReportStreamingRevenue.property.test.ts:282:5)

  ● Property 17: Financial Report Includes Streaming Revenue › Property 17.3: Streaming revenue contributes to total revenue

    Property failed after 1 tests
    { seed: 1943544140, path: "0:1:0:0:0:0", endOnFailure: true }
    Counterexample: [{"numBattles":1,"streamingRevenuePerBattle":1000,"battleWinnings":0}]
    Shrunk 5 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 1000
    Received: 0

      454 |             expectedStreamingRevenue;
      455 |
    > 456 |           expect(report.revenue.total).toBe(expectedTotalRevenue);
          |                                        ^
      457 |
      458 |           // Property: Total revenue should be at least streaming revenue
      459 |           expect(report.revenue.total).toBeGreaterThanOrEqual(expectedStreamingRevenue);

      at tests/financialReportStreamingRevenue.property.test.ts:456:40
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/financialReportStreamingRevenue.property.test.ts:408:5)

  ● Property 17: Financial Report Includes Streaming Revenue › Property 17.4: Aggregates streaming revenue across multiple robots

    Property failed after 1 tests
    { seed: 1716770196, path: "0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [{"numRobots":2,"battlesPerRobot":[1,1],"revenuePerBattle":[1000,1000]}]
    Shrunk 5 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 2000
    Received: 0

      539 |
      540 |           // Property: Should aggregate streaming revenue from all robots
    > 541 |           expect(report.revenue.streaming).toBe(expectedTotalStreamingRevenue);
          |                                            ^
      542 |
      543 |           // Property: Should count all battles from all robots
      544 |           expect(report.revenue.streamingBattleCount).toBe(expectedTotalBattleCount);

      at tests/financialReportStreamingRevenue.property.test.ts:541:44
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/financialReportStreamingRevenue.property.test.ts:473:5)

FAIL tests/statsUpdatedBeforeStreamingRevenue.property.test.ts
  ● Property 5: Stats Updated Before Streaming Revenue Calculation › Property 5: Stats updated before streaming revenue calculation

    Property failed after 1 tests
    { seed: -1324507898, path: "0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0,0,0,0,"bronze"]
    Shrunk 5 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).not.toBeNull()

    Received: null

      267 |           });
      268 |
    > 269 |           expect(battleCompleteEvent).not.toBeNull();
          |                                           ^
      270 |           const payload = battleCompleteEvent!.payload as any;
      271 |
      272 |           // Get updated robot stats from database

      at tests/statsUpdatedBeforeStreamingRevenue.property.test.ts:269:43
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/statsUpdatedBeforeStreamingRevenue.property.test.ts:189:5)

  ● Property 5: Stats Updated Before Streaming Revenue Calculation › Property 5.1: Battle count increments by exactly 1 per battle

    Property failed after 13 tests
    { seed: 1996253306, path: "12:3:1:1:3:7", endOnFailure: true }
    Counterexample: [282,5919]
    Shrunk 5 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at processBattle (src/services/battleOrchestrator.ts:722:3)
      at tests/statsUpdatedBeforeStreamingRevenue.property.test.ts:408:11
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/statsUpdatedBeforeStreamingRevenue.property.test.ts:385:5)

  ● Property 5: Stats Updated Before Streaming Revenue Calculation › Property 5.2: Winner fame increases after battle

    Property failed after 1 tests
    { seed: 1494241162, path: "0:0:0", endOnFailure: true }
    Counterexample: [0,"bronze"]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    TypeError: Cannot read properties of null (reading 'payload')

      485 |           });
      486 |
    > 487 |           const payload = battleCompleteEvent!.payload as any;
          |                                                ^
      488 |
      489 |           // Get updated robot stats
      490 |           const updatedRobot1 = await prisma.robot.findUnique({

      at tests/statsUpdatedBeforeStreamingRevenue.property.test.ts:487:48
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/statsUpdatedBeforeStreamingRevenue.property.test.ts:438:5)

  ● Property 5: Stats Updated Before Streaming Revenue Calculation › Property 5.3: Stats are always updated before streaming revenue calculation

    Property failed after 1 tests
    { seed: 1925643995, path: "0:0", endOnFailure: true }
    Counterexample: [0,0]
    Shrunk 1 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    TypeError: Cannot read properties of null (reading 'payload')

      561 |           });
      562 |
    > 563 |           const payload = battleCompleteEvent!.payload as any;
          |                                                ^
      564 |
      565 |           // Property: The battle count used in streaming revenue should be 
      566 |           // the initial count + 1 (proving stats were updated first)

      at tests/statsUpdatedBeforeStreamingRevenue.property.test.ts:563:48
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/statsUpdatedBeforeStreamingRevenue.property.test.ts:526:5)

FAIL tests/tagTeamLeagueRebalancing.test.ts
  ● Tag Team League Rebalancing › determinePromotions › should return empty array when fewer than 10 teams

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:137:9)

  ● Tag Team League Rebalancing › determinePromotions › should return empty array when no teams have 5+ cycles

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:152:9)

  ● Tag Team League Rebalancing › determinePromotions › should promote top 10% of eligible teams with ≥25 league points

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:167:9)

  ● Tag Team League Rebalancing › determinePromotions › should return empty array when no teams have ≥25 league points

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:191:9)

  ● Tag Team League Rebalancing › determinePromotions › should exclude teams in excludeTeamIds set

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:207:22)

  ● Tag Team League Rebalancing › determineDemotions › should return empty array when fewer than 10 teams

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:237:9)

  ● Tag Team League Rebalancing › determineDemotions › should return empty array when no teams have 5+ cycles

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:252:9)

  ● Tag Team League Rebalancing › determineDemotions › should demote bottom 10% of eligible teams

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:267:9)

  ● Tag Team League Rebalancing › determineDemotions › should exclude teams in excludeTeamIds set

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:289:22)

  ● Tag Team League Rebalancing › promoteTeam › should promote team from bronze to silver

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:305:20)

  ● Tag Team League Rebalancing › promoteTeam › should promote team from silver to gold

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:320:20)

  ● Tag Team League Rebalancing › promoteTeam › should throw error when promoting from champion tier

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:334:20)

  ● Tag Team League Rebalancing › demoteTeam › should demote team from silver to bronze

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:344:20)

  ● Tag Team League Rebalancing › demoteTeam › should demote team from gold to silver

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:359:20)

  ● Tag Team League Rebalancing › demoteTeam › should throw error when demoting from bronze tier

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:373:20)

  ● Tag Team League Rebalancing › rebalanceTagTeamLeagues › should promote and demote teams across multiple tiers

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:399:9)

  ● Tag Team League Rebalancing › rebalanceTagTeamLeagues › should skip tiers with insufficient teams

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:427:9)

  ● Tag Team League Rebalancing › rebalanceTagTeamLeagues › should skip teams without 5+ cycles

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:443:9)

  ● Tag Team League Rebalancing › Edge Cases › should handle exactly 10 teams (minimum for rebalancing)

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:464:9)

  ● Tag Team League Rebalancing › Edge Cases › should handle 11 teams (10% rounds down to 1)

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:479:9)

  ● Tag Team League Rebalancing › Edge Cases › should handle teams with same league points (tiebreaker)

    TypeError: Cannot read properties of null (reading 'id')

      73 |     const weapon = await prisma.weapon.findFirst();
      74 |     const weaponInv = await prisma.weaponInventory.create({
    > 75 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      76 |     });
      77 |
      78 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.test.ts:75:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.test.ts:105:20)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.test.ts:493:9)

FAIL tests/cycleStepDuration.property.test.ts (6.818 s)
  ● Property 15: Cycle Step Duration Recording › Property 15.1: Each cycle step has a step completion event with duration

    Property failed after 1 tests
    { seed: -1194949916, path: "0:0:1:0:0:4:2:5:6:2:2:3:4:11:2:3:3", endOnFailure: true }
    Counterexample: [1,3,[2337,4982]]
    Shrunk 16 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 2337
    Received: 472

      93 |           for (let i = 0; i < numberOfSteps; i++) {
      94 |             const payload = stepEvents[i].payload as any;
    > 95 |             expect(payload.duration).toBe(stepDurations[i]);
         |                                      ^
      96 |           }
      97 |         }
      98 |       ),

      at tests/cycleStepDuration.property.test.ts:95:38
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/cycleStepDuration.property.test.ts:43:5)

  ● Property 15: Cycle Step Duration Recording › Property 15.2: Sum of step durations approximately equals total cycle duration (within 5% tolerance)

    Property failed after 2 tests
    { seed: 1836175004, path: "1:0:2:0:2:1:0:1:1:4:1:1:2:1:2:1:5:2:1:1:0:2:2:0:0:0:1:0:2:1:1:1", endOnFailure: true }
    Counterexample: [1,[100,100,839],3]
    Shrunk 31 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 1039
    Received: 839

      157 |
      158 |           // Property: Sum of steps equals what we logged
    > 159 |           expect(recordedSumOfSteps).toBe(sumOfSteps);
          |                                      ^
      160 |
      161 |           // Property: Total duration equals sum of steps + overhead
      162 |           expect(recordedTotalDuration).toBe(totalDuration);

      at tests/cycleStepDuration.property.test.ts:159:38
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/cycleStepDuration.property.test.ts:107:5)

  ● Property 15: Cycle Step Duration Recording › Property 15.3: Step durations are recorded in sequence order

    Property failed after 1 tests
    { seed: -505901614, path: "0:0:0:1:1:2:3:1:7:1:1:0:0:2:0:1:1:0:0:0:0", endOnFailure: true }
    Counterexample: [1,[295,50,96,155,50]]
    Shrunk 20 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: 3

      215 |           for (let i = 0; i < stepEvents.length; i++) {
      216 |             const payload = stepEvents[i].payload as any;
    > 217 |             expect(payload.stepNumber).toBe(i + 1);
          |                                        ^
      218 |           }
      219 |         }
      220 |       ),

      at tests/cycleStepDuration.property.test.ts:217:40
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/cycleStepDuration.property.test.ts:177:5)

  ● Property 15: Cycle Step Duration Recording › Property 15.5: Step completion events include step name and number

    Property failed after 2 tests
    { seed: -342129570, path: "1:3:0:0:0:0:0:0:1:0:0:2:1:1:1:3:1:4:1:0:3:1:0:8:1:6:10:0:0:2:3:6:3:1:4:1:14:6:5:6:8:4:4:4:2:4:0:7:9:4:4:1:3:11:1:1:1:6:3:0:4:1:6:1:6:5:0:1:1", endOnFailure: true }
    Counterexample: [1,[{__proto__:null,"name":"  J {","duration":1742},{__proto__:null,"name":"D/ n7","duration":1005},{__proto__:null,"name":"/ E',","duration":2532}]]
    Shrunk 68 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: "  J {"
    Received: "/ E',"

      310 |           for (let i = 0; i < steps.length; i++) {
      311 |             const payload = stepEvents[i].payload as any;
    > 312 |             expect(payload.stepName).toBe(steps[i].name as string);
          |                                      ^
      313 |             expect(payload.stepNumber).toBe(i + 1);
      314 |             expect(payload.duration).toBe(steps[i].duration as number);
      315 |           }

      at tests/cycleStepDuration.property.test.ts:312:38
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/cycleStepDuration.property.test.ts:273:5)

  ● Property 15: Cycle Step Duration Recording › Property 15.6: Multiple cycles can be logged independently with correct durations

    Property failed after 1 tests
    { seed: -610533521, path: "0:0:0:0:0:0:0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [[{"cycleNumber":1,"stepDurations":[100,100,100]},{"cycleNumber":1,"stepDurations":[100,100,100]}]]
    Shrunk 11 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toHaveLength(expected)

    Expected length: 3
    Received length: 1
    Received array:  [{"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:29.121Z, "eventType": "cycle_step_complete", "id": 2113140n, "metadata": null, "payload": {"duration": 100, "stepName": "step_3", "stepNumber": 3, "summary": {}}, "robotId": null, "sequenceNumber": 4, "userId": null}]

      378 |
      379 |             // Property: Correct number of steps per cycle
    > 380 |             expect(stepEvents).toHaveLength(cycle.stepDurations.length);
          |                                ^
      381 |
      382 |             // Property: Durations match for each cycle
      383 |             for (let i = 0; i < cycle.stepDurations.length; i++) {

      at tests/cycleStepDuration.property.test.ts:380:32
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/cycleStepDuration.property.test.ts:326:5)

FAIL tests/facilityRecommendation.property.test.ts (12.317 s)
  ● Property 22: Investment Recommendation Ranking › Property 22.2: Only facilities with positive projected ROI are recommended

    Property failed after 1 tests
    { seed: -152303241, path: "0:0:0:0", endOnFailure: true }
    Counterexample: [5,500000,2000]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

      177 |           // Property: All recommendations should have positive ROI
      178 |           for (const recommendation of result.recommendations) {
    > 179 |             expect(recommendation.projectedROI).toBeGreaterThan(0);
          |                                                 ^
      180 |           }
      181 |         }
      182 |       ),

      at tests/facilityRecommendation.property.test.ts:179:49
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/facilityRecommendation.property.test.ts:129:5)

  ● Property 22: Investment Recommendation Ranking › Property 22.4: High activity users get more discount facility recommendations

    Property failed after 1 tests
    { seed: -1282724766, path: "0:0:0:0", endOnFailure: true }
    Counterexample: [50000,30000,20]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBeGreaterThan(expected)

    Expected: > 0
    Received:   0

      307 |           // Discount facilities should have positive ROI
      308 |           for (const facility of discountFacilities) {
    > 309 |             expect(facility.projectedROI).toBeGreaterThan(0);
          |                                           ^
      310 |           }
      311 |         }
      312 |       ),

      at tests/facilityRecommendation.property.test.ts:309:43
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/facilityRecommendation.property.test.ts:235:5)

  ● Property 22: Investment Recommendation Ranking › Property 22.5: Recommendations include upgrade cost and payoff cycles

    Property failed after 1 tests
    { seed: 1869750377, path: "0:0:0", endOnFailure: true }
    Counterexample: [10,2000000]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBeTruthy()

    Received: ""

      371 |             
      372 |             // Should have a reason
    > 373 |             expect(recommendation.reason).toBeTruthy();
          |                                           ^
      374 |             expect(recommendation.reason.length).toBeGreaterThan(0);
      375 |             
      376 |             // Should have a priority

      at tests/facilityRecommendation.property.test.ts:373:43
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/facilityRecommendation.property.test.ts:318:5)

FAIL tests/roiCalculatorService.test.ts
  ● ROICalculatorService › calculateFacilityROI › should calculate ROI for income generator facility

    expect(received).not.toBeNull()

    Received: null

      117 |       );
      118 |
    > 119 |       expect(roi).not.toBeNull();
          |                       ^
      120 |       expect(roi!.facilityType).toBe('merchandising_hub');
      121 |       expect(roi!.currentLevel).toBe(1);
      122 |       expect(roi!.totalInvestment).toBe(150000); // Level 1 cost

      at Object.<anonymous> (tests/roiCalculatorService.test.ts:119:23)

  ● ROICalculatorService › calculateFacilityROI › should calculate ROI for repair bay facility with discounts

    expect(received).not.toBeNull()

    Received: null

      199 |       );
      200 |
    > 201 |       expect(roi).not.toBeNull();
          |                       ^
      202 |       expect(roi!.facilityType).toBe('repair_bay');
      203 |       expect(roi!.currentLevel).toBe(2);
      204 |       expect(roi!.totalInvestment).toBe(300000);

      at Object.<anonymous> (tests/roiCalculatorService.test.ts:201:23)

  ● ROICalculatorService › calculateFacilityROI › should calculate ROI for training facility with discounts

    expect(received).not.toBeNull()

    Received: null

      272 |       );
      273 |
    > 274 |       expect(roi).not.toBeNull();
          |                       ^
      275 |       expect(roi!.facilityType).toBe('training_facility');
      276 |       expect(roi!.currentLevel).toBe(1);
      277 |       expect(roi!.totalInvestment).toBe(150000);

      at Object.<anonymous> (tests/roiCalculatorService.test.ts:274:23)

  ● ROICalculatorService › calculateFacilityROI › should calculate breakeven cycle when facility becomes profitable

    expect(received).not.toBeNull()

    Received: null

      338 |       );
      339 |
    > 340 |       expect(roi).not.toBeNull();
          |                       ^
      341 |       expect(roi!.totalInvestment).toBe(900000); // 150k + 300k + 450k
      342 |       expect(roi!.totalReturns).toBe(1500000); // (12000 + 3000) * 100 cycles
      343 |       expect(roi!.totalOperatingCosts).toBe(800000); // 8000 * 100 cycles

      at Object.<anonymous> (tests/roiCalculatorService.test.ts:340:23)

  ● ROICalculatorService › calculateAllFacilityROIs › should calculate ROI for all purchased facilities

    expect(received).toHaveLength(expected)

    Expected length: 3
    Received length: 1
    Received array:  [{"breakevenCycle": null, "currentLevel": 1, "cyclesSincePurchase": 1, "facilityType": "merchandising_hub", "isProfitable": false, "netROI": -1, "totalInvestment": 150000, "totalOperatingCosts": 0, "totalReturns": 0}]

      392 |       const rois = await roiCalculatorService.calculateAllFacilityROIs(testUserId);
      393 |
    > 394 |       expect(rois).toHaveLength(3); // Only purchased facilities (level > 0)
          |                    ^
      395 |       expect(rois.map(r => r.facilityType).sort()).toEqual([
      396 |         'merchandising_hub',
      397 |         'repair_bay',

      at Object.<anonymous> (tests/roiCalculatorService.test.ts:394:20)

FAIL tests/facilityAdvisorStreamingStudioROI.property.test.ts
  ● Property 21: Facility Advisor Provides Streaming Studio ROI › Property 21: Facility Advisor provides Streaming Studio ROI metrics

    Property failed after 1 tests
    { seed: -1691627479, path: "0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,1,0,0,5]
    Shrunk 5 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toContain(expected) // indexOf

    Expected substring: "operating cost"
    Received string:    "Increases streaming revenue by 10% per battle (no battle history to estimate ROI)"

      310 |
      311 |                 // Property 17.5: Reason should mention operating cost
    > 312 |                 expect(studioRec.reason).toContain('operating cost');
          |                                          ^
      313 |
      314 |                 // Property 17.6: Should calculate payback period (battles needed)
      315 |                 // The payback period should be based on net benefit

      at tests/facilityAdvisorStreamingStudioROI.property.test.ts:312:42
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/facilityAdvisorStreamingStudioROI.property.test.ts:196:5)

  ● Property 21: Facility Advisor Provides Streaming Studio ROI › Property 21.2: Revenue increase per battle is calculated correctly

    Property failed after 1 tests
    { seed: 1208635561, path: "0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,100,1000,10]
    Shrunk 4 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBeCloseTo(expected, precision)

    Expected: 2.93
    Received: 0.2

    Expected precision:    5
    Expected difference: < 0.000005
    Received difference:   2.73

      492 |             // Property: ROI should be calculated correctly
      493 |             const expectedROI = (expectedNetBenefitPerCycle * 30 - studioRec.upgradeCost) / studioRec.upgradeCost;
    > 494 |             expect(studioRec.projectedROI).toBeCloseTo(expectedROI, 5);
          |                                            ^
      495 |           }
      496 |         }
      497 |       ),

      at tests/facilityAdvisorStreamingStudioROI.property.test.ts:494:44
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/facilityAdvisorStreamingStudioROI.property.test.ts:423:5)

  ● Property 21: Facility Advisor Provides Streaming Studio ROI › Property 21.4: Operating cost increase reduces net benefit

    Property failed after 1 tests
    { seed: 821040174, path: "0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,100,1000,5]
    Shrunk 4 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toContain(expected) // indexOf

    Expected substring: "operating cost"
    Received string:    "Increases streaming revenue by 10% per battle (no battle history to estimate ROI)"

      596 |
      597 |             // Property: Reason should mention operating cost
    > 598 |             expect(studioRec.reason).toContain('operating cost');
          |                                      ^
      599 |             expect(studioRec.reason).toContain(`₡${operatingCostIncrease}`);
      600 |
      601 |             // Property: Operating cost should reduce the net benefit

      at tests/facilityAdvisorStreamingStudioROI.property.test.ts:598:38
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/facilityAdvisorStreamingStudioROI.property.test.ts:549:5)

FAIL tests/streamingStudioPrestigeRequirements.property.test.ts (10.188 s)
  ● Property 9: Streaming Studio Prestige Requirements › Property 9.5: Prestige validation occurs regardless of currency

    Property failed after 5 tests
    { seed: 698438025, path: "4:0", endOnFailure: true }
    Counterexample: [4,0]
    Shrunk 1 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.user.update()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingStudioPrestigeRequirements.property.test.ts:415:29

      412 const maxPrestigeNeeded = Math.max(
      413   ...PRESTIGE_REQUIREMENTS.slice(0, targetLevel - 1)
      414 );
    → 415 await prisma.user.update(
    An operation failed because it depends on one or more records that were required but not found. Record to update not found.

      413 |             ...PRESTIGE_REQUIREMENTS.slice(0, targetLevel - 1)
      414 |           );
    > 415 |           await prisma.user.update({
          |           ^
      416 |             where: { id: testUser.id },
      417 |             data: { prestige: maxPrestigeNeeded, currency: 10000000 },
      418 |           });

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at tests/streamingStudioPrestigeRequirements.property.test.ts:415:11
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingStudioPrestigeRequirements.property.test.ts:396:5)

FAIL tests/terminalLogStreamingRevenue.property.test.ts (13.652 s)
  ● Property 14: Terminal Log Contains Streaming Revenue › Property 14: Terminal log contains streaming revenue for all battles

    Property failed after 1 tests
    { seed: -2099379571, path: "0:0:0:0:0:0:1:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0,0,0,0]
    Shrunk 9 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.delete()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:348:38

      345 // Cleanup - delete in correct order
      346 await prisma.battle.delete({ where: { id: battle!.id } });
      347 await prisma.scheduledMatch.delete({ where: { id: match.id } });
    → 348 await prisma.robot.delete(
    Foreign key constraint violated: `battles_robot1_id_fkey (index)`

      346 |             await prisma.battle.delete({ where: { id: battle!.id } });
      347 |             await prisma.scheduledMatch.delete({ where: { id: match.id } });
    > 348 |             await prisma.robot.delete({ where: { id: robot1.id } });
          |             ^
      349 |             await prisma.robot.delete({ where: { id: robot2.id } });
      350 |           } finally {
      351 |             capture.restore();

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at tests/terminalLogStreamingRevenue.property.test.ts:348:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:199:5)

  ● Property 14: Terminal Log Contains Streaming Revenue › Property 14.1: Streaming revenue logged immediately after battle completion

    Property failed after 5 tests
    { seed: 1070684108, path: "4:15:12:9:0", endOnFailure: true }
    Counterexample: [100,8529,108,7765,2]
    Shrunk 4 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBeGreaterThanOrEqual(expected)

    Expected: >= 2
    Received:    0

      448 |             );
      449 |
    > 450 |             expect(streamingLogs.length).toBeGreaterThanOrEqual(2);
          |                                          ^
      451 |
      452 |             // Property: Both robots should have streaming revenue logged
      453 |             const robot1Logged = streamingLogs.some(log => log.includes(robotName1));

      at tests/terminalLogStreamingRevenue.property.test.ts:450:42
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:364:5)

  ● Property 14: Terminal Log Contains Streaming Revenue › Property 14.2: No streaming revenue logged for bye matches

    Property failed after 17 tests
    { seed: -598911723, path: "16:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:20:29

      17 
      18 // Helper function to create a minimal test robot
      19 async function createTestRobot(userId: number, battles: number, fame: number, name: string) {
    → 20   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      18 | // Helper function to create a minimal test robot
      19 | async function createTestRobot(userId: number, battles: number, fame: number, name: string) {
    > 20 |   return await prisma.robot.create({
         |          ^
      21 |     data: {
      22 |       userId,
      23 |       name,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/terminalLogStreamingRevenue.property.test.ts:20:10)
      at tests/terminalLogStreamingRevenue.property.test.ts:511:25
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:503:5)

  ● Property 14: Terminal Log Contains Streaming Revenue › Property 14.3: Terminal log format is consistent

    Property failed after 1 tests
    { seed: -1970777393, path: "0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [[{"battles":0,"fame":0},{"battles":0,"fame":0}],0]
    Shrunk 5 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/terminalLogStreamingRevenue.property.test.ts:20:29

      17 
      18 // Helper function to create a minimal test robot
      19 async function createTestRobot(userId: number, battles: number, fame: number, name: string) {
    → 20   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      18 | // Helper function to create a minimal test robot
      19 | async function createTestRobot(userId: number, battles: number, fame: number, name: string) {
    > 20 |   return await prisma.robot.create({
         |          ^
      21 |     data: {
      22 |       userId,
      23 |       name,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/terminalLogStreamingRevenue.property.test.ts:20:10)
      at tests/terminalLogStreamingRevenue.property.test.ts:631:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/terminalLogStreamingRevenue.property.test.ts:616:5)

FAIL tests/cyclePerformanceMonitoring.test.ts
  ● Cycle Performance Monitoring Service › detectStepDegradation › should detect performance degradation when recent average exceeds 150% of baseline

    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStart (src/services/eventLogger.ts:271:5)
      at Object.<anonymous> (tests/cyclePerformanceMonitoring.test.ts:42:9)

  ● Cycle Performance Monitoring Service › detectStepDegradation › should not detect degradation when recent average is within threshold

    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStart (src/services/eventLogger.ts:271:5)
      at Object.<anonymous> (tests/cyclePerformanceMonitoring.test.ts:69:9)

  ● Cycle Performance Monitoring Service › detectStepDegradation › should return null when there is no baseline data

    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStart (src/services/eventLogger.ts:271:5)
      at Object.<anonymous> (tests/cyclePerformanceMonitoring.test.ts:91:9)

  ● Cycle Performance Monitoring Service › detectStepDegradation › should classify degradation severity correctly

    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStepComplete (src/services/eventLogger.ts:287:5)
      at Object.<anonymous> (tests/cyclePerformanceMonitoring.test.ts:107:9)

  ● Cycle Performance Monitoring Service › detectAllStepDegradations › should detect degradation across multiple steps

    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStepComplete (src/services/eventLogger.ts:287:5)
      at Object.<anonymous> (tests/cyclePerformanceMonitoring.test.ts:137:11)

  ● Cycle Performance Monitoring Service › getCyclePerformanceMetrics › should calculate performance metrics for a cycle range

    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStepComplete (src/services/eventLogger.ts:287:5)
      at Object.<anonymous> (tests/cyclePerformanceMonitoring.test.ts:169:9)

  ● Cycle Performance Monitoring Service › getCycleExecutionTrend › should detect improving trend when recent cycles are faster

    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStart (src/services/eventLogger.ts:271:5)
      at Object.<anonymous> (tests/cyclePerformanceMonitoring.test.ts:240:9)

  ● Cycle Performance Monitoring Service › getCycleExecutionTrend › should detect degrading trend when recent cycles are slower

    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStart (src/services/eventLogger.ts:271:5)
      at Object.<anonymous> (tests/cyclePerformanceMonitoring.test.ts:261:9)

  ● Cycle Performance Monitoring Service › getCycleExecutionTrend › should detect stable trend when durations are consistent

    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleComplete (src/services/eventLogger.ts:302:5)
      at Object.<anonymous> (tests/cyclePerformanceMonitoring.test.ts:283:9)

FAIL tests/leagueRebalancingService.test.ts
  ● League Rebalancing Service › determinePromotions › should return top 10% of robots with ≥5 cycles AND ≥25 league points

    expect(received).toBe(expected) // Object.is equality

    Expected: 2
    Received: 0

       99 |       // Should get top 10% of 20 = 2 robots, but only from those with ≥25 points
      100 |       // Robots 5-19 have ≥25 points (15 robots), top 2 are robots 19 and 18
    > 101 |       expect(toPromote.length).toBe(2);
          |                                ^
      102 |       expect(toPromote[0].name).toBe('Bronze Robot 19'); // 95 points
      103 |       expect(toPromote[1].name).toBe('Bronze Robot 18'); // 90 points
      104 |       expect(toPromote[0].leaguePoints).toBeGreaterThanOrEqual(25);

      at Object.<anonymous> (tests/leagueRebalancingService.test.ts:101:32)

  ● League Rebalancing Service › determinePromotions › should skip robots with <5 cycles in current league

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/leagueRebalancingService.test.ts:117:56

      114 it('should skip robots with <5 cycles in current league', async () => {
      115   const robots = [];
      116   for (let i = 0; i < 20; i++) {
    → 117     const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      115 |       const robots = [];
      116 |       for (let i = 0; i < 20; i++) {
    > 117 |         const weaponInv = await prisma.weaponInventory.create({
          |                           ^
      118 |           data: { userId: testUser.id, weaponId: practiceSword.id },
      119 |         });
      120 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/leagueRebalancingService.test.ts:117:27)

  ● League Rebalancing Service › determinePromotions › should return empty array when no robots have ≥25 league points

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/leagueRebalancingService.test.ts:168:56

      165 // Create 20 robots but none with ≥25 league points
      166 const robots = [];
      167 for (let i = 0; i < 20; i++) {
    → 168   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      166 |       const robots = [];
      167 |       for (let i = 0; i < 20; i++) {
    > 168 |         const weaponInv = await prisma.weaponInventory.create({
          |                           ^
      169 |           data: { userId: testUser.id, weaponId: practiceSword.id },
      170 |         });
      171 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/leagueRebalancingService.test.ts:168:27)

  ● League Rebalancing Service › determinePromotions › should return empty array when too few robots

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/leagueRebalancingService.test.ts:207:56

      204 // Create only 5 robots (< 10 minimum)
      205 const robots = [];
      206 for (let i = 0; i < 5; i++) {
    → 207   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      205 |       const robots = [];
      206 |       for (let i = 0; i < 5; i++) {
    > 207 |         const weaponInv = await prisma.weaponInventory.create({
          |                           ^
      208 |           data: { userId: testUser.id, weaponId: practiceSword.id },
      209 |         });
      210 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/leagueRebalancingService.test.ts:207:27)

  ● League Rebalancing Service › determineDemotions › should return bottom 10% of robots with ≥5 cycles in current league

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/leagueRebalancingService.test.ts:247:56

      244 it('should return bottom 10% of robots with ≥5 cycles in current league', async () => {
      245   const robots = [];
      246   for (let i = 0; i < 20; i++) {
    → 247     const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      245 |       const robots = [];
      246 |       for (let i = 0; i < 20; i++) {
    > 247 |         const weaponInv = await prisma.weaponInventory.create({
          |                           ^
      248 |           data: { userId: testUser.id, weaponId: practiceSword.id },
      249 |         });
      250 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/leagueRebalancingService.test.ts:247:27)

  ● League Rebalancing Service › promoteRobot › should move robot to next tier and reset league points and cycles

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/leagueRebalancingService.test.ts:294:54

      291 
      292 describe('promoteRobot', () => {
      293   it('should move robot to next tier and reset league points and cycles', async () => {
    → 294     const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      292 |   describe('promoteRobot', () => {
      293 |     it('should move robot to next tier and reset league points and cycles', async () => {
    > 294 |       const weaponInv = await prisma.weaponInventory.create({
          |                         ^
      295 |         data: { userId: testUser.id, weaponId: practiceSword.id },
      296 |       });
      297 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/leagueRebalancingService.test.ts:294:25)

  ● League Rebalancing Service › promoteRobot › should throw error when trying to promote from champion

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/leagueRebalancingService.test.ts:331:54

      328 });
      329 
      330 it('should throw error when trying to promote from champion', async () => {
    → 331   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      329 |
      330 |     it('should throw error when trying to promote from champion', async () => {
    > 331 |       const weaponInv = await prisma.weaponInventory.create({
          |                         ^
      332 |         data: { userId: testUser.id, weaponId: practiceSword.id },
      333 |       });
      334 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/leagueRebalancingService.test.ts:331:25)

  ● League Rebalancing Service › demoteRobot › should move robot to previous tier and reset league points

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/leagueRebalancingService.test.ts:362:54

      359 
      360 describe('demoteRobot', () => {
      361   it('should move robot to previous tier and reset league points', async () => {
    → 362     const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      360 |   describe('demoteRobot', () => {
      361 |     it('should move robot to previous tier and reset league points', async () => {
    > 362 |       const weaponInv = await prisma.weaponInventory.create({
          |                         ^
      363 |         data: { userId: testUser.id, weaponId: practiceSword.id },
      364 |       });
      365 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/leagueRebalancingService.test.ts:362:25)

  ● League Rebalancing Service › demoteRobot › should throw error when trying to demote from bronze

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/leagueRebalancingService.test.ts:397:54

      394 });
      395 
      396 it('should throw error when trying to demote from bronze', async () => {
    → 397   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      395 |
      396 |     it('should throw error when trying to demote from bronze', async () => {
    > 397 |       const weaponInv = await prisma.weaponInventory.create({
          |                         ^
      398 |         data: { userId: testUser.id, weaponId: practiceSword.id },
      399 |       });
      400 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/leagueRebalancingService.test.ts:397:25)

  ● League Rebalancing Service › rebalanceLeagues › should process all tiers and return summary

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/leagueRebalancingService.test.ts:433:56

      430 
      431 // 20 bronze robots
      432 for (let i = 0; i < 20; i++) {
    → 433   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      431 |       // 20 bronze robots
      432 |       for (let i = 0; i < 20; i++) {
    > 433 |         const weaponInv = await prisma.weaponInventory.create({
          |                           ^
      434 |           data: { userId: testUser.id, weaponId: practiceSword.id },
      435 |         });
      436 |         const robot = await prisma.robot.create({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/leagueRebalancingService.test.ts:433:27)

  ● League Rebalancing Service › rebalanceLeagues › should not promote or demote robots multiple times in same cycle

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/leagueRebalancingService.test.ts:478:56

      475 
      476 // Create 100 bronze robots (to trigger promotion)
      477 for (let i = 0; i < 100; i++) {
    → 478   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      476 |       // Create 100 bronze robots (to trigger promotion)
      477 |       for (let i = 0; i < 100; i++) {
    > 478 |         const weaponInv = await prisma.weaponInventory.create({
          |                           ^
      479 |           data: { userId: testUser.id, weaponId: practiceSword.id },
      480 |         });
      481 |         const robot = await prisma.robot.create({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/leagueRebalancingService.test.ts:478:27)

FAIL tests/trainingAcademyCaps.test.ts
  ● Training Academy Cap Enforcement › Test 1: Base cap of 10 without any academy › should allow upgrading combatPower to level 10

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 404

      83 |           });
      84 |
    > 85 |         expect(response.status).toBe(200);
         |                                 ^
      86 |       }
      87 |
      88 |       // Verify the robot is at level 10

      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:85:33)

  ● Training Academy Cap Enforcement › Test 1: Base cap of 10 without any academy › should block upgrading combatPower from level 10 to level 11 without academy

    expect(received).toBe(expected) // Object.is equality

    Expected: 400
    Received: 404

      106 |         .send({ attribute: 'combatPower' });
      107 |
    > 108 |       expect(response.status).toBe(400);
          |                               ^
      109 |       expect(response.body.error).toContain('Attribute cap of 10 reached');
      110 |       expect(response.body.error).toContain('Combat Training Academy');
      111 |     });

      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:108:31)

  ● Training Academy Cap Enforcement › Test 2: Academy Level 1 cap (15) › should allow upgrading combatPower to level 15 with academy level 1

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.update()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/trainingAcademyCaps.test.ts:128:26

      125 
      126 it('should allow upgrading combatPower to level 15 with academy level 1', async () => {
      127   // Update robot to level 14
    → 128   await prisma.robot.update(
    An operation failed because it depends on one or more records that were required but not found. Record to update not found.

      126 |     it('should allow upgrading combatPower to level 15 with academy level 1', async () => {
      127 |       // Update robot to level 14
    > 128 |       await prisma.robot.update({
          |       ^
      129 |         where: { id: testRobot.id },
      130 |         data: { combatPower: new Prisma.Decimal(14) },
      131 |       });

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:128:7)

  ● Training Academy Cap Enforcement › Test 2: Academy Level 1 cap (15) › should block upgrading combatPower from level 15 to level 16

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.update()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/trainingAcademyCaps.test.ts:150:26

      147 
      148 it('should block upgrading combatPower from level 15 to level 16', async () => {
      149   // Update robot to level 15
    → 150   await prisma.robot.update(
    An operation failed because it depends on one or more records that were required but not found. Record to update not found.

      148 |     it('should block upgrading combatPower from level 15 to level 16', async () => {
      149 |       // Update robot to level 15
    > 150 |       await prisma.robot.update({
          |       ^
      151 |         where: { id: testRobot.id },
      152 |         data: { combatPower: new Prisma.Decimal(15) },
      153 |       });

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:150:7)

  ● Training Academy Cap Enforcement › Test 3: All 4 academies control their respective attributes › should enforce Combat Training Academy for Combat Systems attributes

    expect(received).toBe(expected) // Object.is equality

    Expected: 400
    Received: 404

      189 |           .send({ attribute });
      190 |
    > 191 |         expect(response.status).toBe(400);
          |                                 ^
      192 |         expect(response.body.error).toContain('Attribute cap of 10 reached');
      193 |         expect(response.body.error).toContain('Combat Training Academy');
      194 |       }

      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:191:33)

  ● Training Academy Cap Enforcement › Test 3: All 4 academies control their respective attributes › should enforce Defense Training Academy for Defensive Systems attributes

    expect(received).toBe(expected) // Object.is equality

    Expected: 400
    Received: 404

      217 |           .send({ attribute });
      218 |
    > 219 |         expect(response.status).toBe(400);
          |                                 ^
      220 |         expect(response.body.error).toContain('Attribute cap of 10 reached');
      221 |         expect(response.body.error).toContain('Defense Training Academy');
      222 |       }

      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:219:33)

  ● Training Academy Cap Enforcement › Test 3: All 4 academies control their respective attributes › should enforce Mobility Training Academy for Chassis & Mobility attributes

    expect(received).toBe(expected) // Object.is equality

    Expected: 400
    Received: 404

      245 |           .send({ attribute });
      246 |
    > 247 |         expect(response.status).toBe(400);
          |                                 ^
      248 |         expect(response.body.error).toContain('Attribute cap of 10 reached');
      249 |         expect(response.body.error).toContain('Mobility Training Academy');
      250 |       }

      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:247:33)

  ● Training Academy Cap Enforcement › Test 3: All 4 academies control their respective attributes › should enforce AI Training Academy for AI Processing + Team attributes

    expect(received).toBe(expected) // Object.is equality

    Expected: 400
    Received: 404

      275 |           .send({ attribute });
      276 |
    > 277 |         expect(response.status).toBe(400);
          |                                 ^
      278 |         expect(response.body.error).toContain('Attribute cap of 10 reached');
      279 |         expect(response.body.error).toContain('AI Training Academy');
      280 |       }

      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:277:33)

  ● Training Academy Cap Enforcement › Test 4: Maximum cap of 50 at academy level 10 › should allow upgrading combatPower to level 50 with academy level 10

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 404

      307 |         .send({ attribute: 'combatPower' });
      308 |
    > 309 |       expect(response.status).toBe(200);
          |                               ^
      310 |
      311 |       // Verify the robot is at level 50
      312 |       const robot = await prisma.robot.findUnique({

      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:309:31)

  ● Training Academy Cap Enforcement › Test 4: Maximum cap of 50 at academy level 10 › should block upgrading combatPower from level 50 to level 51

    expect(received).toBe(expected) // Object.is equality

    Expected: 400
    Received: 404

      329 |         .send({ attribute: 'combatPower' });
      330 |
    > 331 |       expect(response.status).toBe(400);
          |                               ^
      332 |       expect(response.body.error).toContain('maximum level');
      333 |     });
      334 |   });

      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:331:31)

  ● Training Academy Cap Enforcement › Test 5: Verify cap progression mapping › should enforce cap of 35 for academy level 5

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.update()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/trainingAcademyCaps.test.ts:374:28

      371 }
      372 
      373 // Set robot attribute to the cap level
    → 374 await prisma.robot.update(
    An operation failed because it depends on one or more records that were required but not found. Record to update not found.

      372 |
      373 |         // Set robot attribute to the cap level
    > 374 |         await prisma.robot.update({
          |         ^
      375 |           where: { id: testRobot.id },
      376 |           data: { combatPower: cap },
      377 |         });

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:374:9)

  ● Training Academy Cap Enforcement › Test 5: Verify cap progression mapping › should enforce cap of 40 for academy level 6

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.update()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/trainingAcademyCaps.test.ts:374:28

      371 }
      372 
      373 // Set robot attribute to the cap level
    → 374 await prisma.robot.update(
    An operation failed because it depends on one or more records that were required but not found. Record to update not found.

      372 |
      373 |         // Set robot attribute to the cap level
    > 374 |         await prisma.robot.update({
          |         ^
      375 |           where: { id: testRobot.id },
      376 |           data: { combatPower: cap },
      377 |         });

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/trainingAcademyCaps.test.ts:374:9)

FAIL tests/tagTeamLeagueRebalancing.property.test.ts
  ● Tag Team League Rebalancing - Property Tests › Property 20: Tier Change Resets › promotion resets league points and cycles to 0

    Property failed after 1 tests
    { seed: -1591895252, path: "0:0:0", endOnFailure: true }
    Counterexample: ["bronze",1,1]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    TypeError: Cannot read properties of null (reading 'id')

      74 |     const weapon = await prisma.weapon.findFirst();
      75 |     const weaponInv = await prisma.weaponInventory.create({
    > 76 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      77 |     });
      78 |
      79 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.property.test.ts:76:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.property.test.ts:106:20)
      at tests/tagTeamLeagueRebalancing.property.test.ts:142:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.property.test.ts:132:7)

  ● Tag Team League Rebalancing - Property Tests › Property 20: Tier Change Resets › demotion resets league points and cycles to 0

    Property failed after 1 tests
    { seed: 1277371852, path: "0:0:0:0", endOnFailure: true }
    Counterexample: ["silver",1,1]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    TypeError: Cannot read properties of null (reading 'id')

      74 |     const weapon = await prisma.weapon.findFirst();
      75 |     const weaponInv = await prisma.weaponInventory.create({
    > 76 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      77 |     });
      78 |
      79 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.property.test.ts:76:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.property.test.ts:106:20)
      at tests/tagTeamLeagueRebalancing.property.test.ts:183:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.property.test.ts:173:7)

  ● Tag Team League Rebalancing - Property Tests › Property 20: Tier Change Resets › tier change resets work across all valid tier transitions

    Property failed after 1 tests
    { seed: 1404879569, path: "0:0:0:0:0", endOnFailure: true }
    Counterexample: [{"action":"demote","tier":"silver"},0,0]
    Shrunk 4 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    TypeError: Cannot read properties of null (reading 'id')

      74 |     const weapon = await prisma.weapon.findFirst();
      75 |     const weaponInv = await prisma.weaponInventory.create({
    > 76 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      77 |     });
      78 |
      79 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.property.test.ts:76:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.property.test.ts:106:20)
      at tests/tagTeamLeagueRebalancing.property.test.ts:234:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.property.test.ts:214:7)

  ● Tag Team League Rebalancing - Property Tests › Property 20: Tier Change Resets › reset applies regardless of initial values magnitude

    Property failed after 1 tests
    { seed: 11423722, path: "0:0:0:0", endOnFailure: true }
    Counterexample: ["bronze",0,0]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    TypeError: Cannot read properties of null (reading 'id')

      74 |     const weapon = await prisma.weapon.findFirst();
      75 |     const weaponInv = await prisma.weaponInventory.create({
    > 76 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      77 |     });
      78 |
      79 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.property.test.ts:76:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.property.test.ts:106:20)
      at tests/tagTeamLeagueRebalancing.property.test.ts:269:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.property.test.ts:261:7)

  ● Tag Team League Rebalancing - Property Tests › Property 20: Tier Change Resets › reset applies even when initial values are already 0

    Property failed after 1 tests
    { seed: -72446833, path: "0:0", endOnFailure: true }
    Counterexample: ["bronze"]
    Shrunk 1 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    TypeError: Cannot read properties of null (reading 'id')

      74 |     const weapon = await prisma.weapon.findFirst();
      75 |     const weaponInv = await prisma.weaponInventory.create({
    > 76 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      77 |     });
      78 |
      79 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueRebalancing.property.test.ts:76:55)
      at createTestTeam (tests/tagTeamLeagueRebalancing.property.test.ts:106:20)
      at tests/tagTeamLeagueRebalancing.property.test.ts:294:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.property.test.ts:289:7)


  ● Test suite failed to run

    PrismaClientKnownRequestError: 
    Invalid `prisma.user.delete()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeamLeagueRebalancing.property.test.ts:45:31

      42   });
      43 }
      44 if (testStableId) {
    → 45   await prisma.user.delete(
    An operation failed because it depends on one or more records that were required but not found. Record to delete does not exist.

      43 |     }
      44 |     if (testStableId) {
    > 45 |       await prisma.user.delete({
         |       ^
      46 |         where: { id: testStableId },
      47 |       });
      48 |     }

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/tagTeamLeagueRebalancing.property.test.ts:45:7)

FAIL tests/facilityAdvisorStreamingStudio.test.ts
  ● Facility Advisor - Streaming Studio › should recommend Streaming Studio with positive ROI when user has battle history

    PrismaClientKnownRequestError: 
    Invalid `prisma.facility.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/facilityAdvisorStreamingStudio.test.ts:97:27

      94 });
      95 
      96 // Create Streaming Studio facility at level 0
    → 97 await prisma.facility.create(
    Foreign key constraint violated: `facilities_user_id_fkey (index)`

       95 |
       96 |     // Create Streaming Studio facility at level 0
    >  97 |     await prisma.facility.create({
          |     ^
       98 |       data: {
       99 |         userId: user.id,
      100 |         facilityType: 'streaming_studio',

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/facilityAdvisorStreamingStudio.test.ts:97:5)

  ● Facility Advisor - Streaming Studio › should calculate correct ROI for Streaming Studio upgrade from level 1 to 2

    PrismaClientKnownRequestError: 
    Invalid `prisma.facility.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/facilityAdvisorStreamingStudio.test.ts:231:27

      228 });
      229 
      230 // Create Streaming Studio facility at level 1
    → 231 await prisma.facility.create(
    Foreign key constraint violated: `facilities_user_id_fkey (index)`

      229 |
      230 |     // Create Streaming Studio facility at level 1
    > 231 |     await prisma.facility.create({
          |     ^
      232 |       data: {
      233 |         userId: user.id,
      234 |         facilityType: 'streaming_studio',

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/facilityAdvisorStreamingStudio.test.ts:231:5)

  ● Facility Advisor - Streaming Studio › should not recommend Streaming Studio when battle frequency is too low

    PrismaClientKnownRequestError: 
    Invalid `prisma.facility.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/facilityAdvisorStreamingStudio.test.ts:316:27

      313 });
      314 
      315 // Create Streaming Studio facility at level 0
    → 316 await prisma.facility.create(
    Foreign key constraint violated: `facilities_user_id_fkey (index)`

      314 |
      315 |     // Create Streaming Studio facility at level 0
    > 316 |     await prisma.facility.create({
          |     ^
      317 |       data: {
      318 |         userId: user.id,
      319 |         facilityType: 'streaming_studio',

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/facilityAdvisorStreamingStudio.test.ts:316:5)

FAIL tests/leagueInstanceService.test.ts
  ● League Instance Service › getLeagueInstanceStats › should calculate correct statistics

    expect(received).toBe(expected) // Object.is equality

    Expected: 150
    Received: 151

      136 |       const stats = await getLeagueInstanceStats('bronze');
      137 |       
    > 138 |       expect(stats.totalRobots).toBe(150);
          |                                 ^
      139 |       expect(stats.instances).toHaveLength(3);
      140 |       expect(stats.averagePerInstance).toBe(50);
      141 |       expect(stats.needsRebalancing).toBe(false); // All instances have exactly 50 robots

      at Object.<anonymous> (tests/leagueInstanceService.test.ts:138:33)

  ● League Instance Service › getLeagueInstanceStats › should detect when rebalancing is needed

    expect(received).toBe(expected) // Object.is equality

    Expected: 100
    Received: 101

      173 |       const stats = await getLeagueInstanceStats('bronze');
      174 |       
    > 175 |       expect(stats.totalRobots).toBe(100);
          |                                 ^
      176 |       expect(stats.averagePerInstance).toBe(50);
      177 |       expect(stats.needsRebalancing).toBe(true); // Deviation of 30 > threshold of 20
      178 |

      at Object.<anonymous> (tests/leagueInstanceService.test.ts:175:33)

  ● League Instance Service › getLeagueInstanceStats › should detect rebalancing needed when single instance exceeds MAX_ROBOTS_PER_INSTANCE

    expect(received).toBe(expected) // Object.is equality

    Expected: 331
    Received: 332

      208 |       const stats = await getLeagueInstanceStats('bronze');
      209 |       
    > 210 |       expect(stats.totalRobots).toBe(331);
          |                                 ^
      211 |       expect(stats.instances).toHaveLength(1);
      212 |       expect(stats.instances[0].currentRobots).toBe(331);
      213 |       expect(stats.averagePerInstance).toBe(331);

      at Object.<anonymous> (tests/leagueInstanceService.test.ts:210:33)

  ● League Instance Service › rebalanceInstances › should rebalance when imbalance exceeds threshold

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 2
    Received array:  [{"currentRobots": 80, "instanceNumber": 1, "isFull": false, "leagueId": "champion_1", "maxRobots": 100, "tier": "champion"}, {"currentRobots": 20, "instanceNumber": 2, "isFull": false, "leagueId": "champion_2", "maxRobots": 100, "tier": "champion"}]

      370 |       
      371 |       // With 100 robots and MAX_ROBOTS_PER_INSTANCE=100, should have exactly 1 instance
    > 372 |       expect(instances).toHaveLength(1);
          |                         ^
      373 |       expect(instances[0].currentRobots).toBe(100);
      374 |       
      375 |       // Verify no instance exceeds the limit

      at Object.<anonymous> (tests/leagueInstanceService.test.ts:372:25)

  ● League Instance Service › getRobotsInInstance › should return robots in correct order

    expect(received).toHaveLength(expected)

    Expected length: 3
    Received length: 4
    Received array:  [{"adaptiveAI": "1", "armorPlating": "1", "attackSpeed": "1", "battleReadiness": 100, "combatAlgorithms": "1", "combatPower": "1", "counterProtocols": "1", "createdAt": 2026-02-23T15:01:32.012Z, "criticalSystems": "1", "currentHP": 10, "currentLeague": "bronze", "currentShield": 2, "cyclesInCurrentLeague": 0, "damageDampeners": "1", "damageDealtLifetime": 0, "damageTaken": 0, "damageTakenLifetime": 0, "draws": 0, "elo": 1300, "evasionThrusters": "1", "fame": 0, "formationTactics": "1", "frameId": 1, "gyroStabilizers": "1", "hullIntegrity": "1", "hydraulicSystems": "1", "id": 553332, "imageUrl": null, "kills": 0, "leagueId": "bronze_1", "leaguePoints": 20, "loadoutType": "single", "logicCores": "1", "losses": 0, "mainWeaponId": null, "maxHP": 10, "maxShield": 2, "name": "Robot C", "offhandWeaponId": null, "paintJob": null, "penetration": "1", "powerCore": "1", "repairCost": 0, "servoMotors": "1", "shieldCapacity": "1", "stance": "balanced", "supportSystems": "1", "syncProtocols": "1", "targetingSystems": "1", "threatAnalysis": "1", "timesTaggedIn": 0, "timesTaggedOut": 0, "titles": null, "totalBattles": 0, "totalRepairsPaid": 0, "totalTagTeamBattles": 0, "totalTagTeamDraws": 0, "totalTagTeamLosses": 0, "totalTagTeamWins": 0, "updatedAt": 2026-02-23T15:01:32.012Z, "user": {"id": 38678, "username": "test_order_user"}, "userId": 38678, "weaponControl": "1", "wins": 0, "yieldThreshold": 10}, {"adaptiveAI": "1", "armorPlating": "1", "attackSpeed": "1", "battleReadiness": 100, "combatAlgorithms": "1", "combatPower": "1", "counterProtocols": "1", "createdAt": 2026-02-23T15:01:32.012Z, "criticalSystems": "1", "currentHP": 10, "currentLeague": "bronze", "currentShield": 2, "cyclesInCurrentLeague": 0, "damageDampeners": "1", "damageDealtLifetime": 0, "damageTaken": 0, "damageTakenLifetime": 0, "draws": 0, "elo": 1100, "evasionThrusters": "1", "fame": 0, "formationTactics": "1", "frameId": 1, "gyroStabilizers": "1", "hullIntegrity": "1", "hydraulicSystems": "1", "id": 553331, "imageUrl": null, "kills": 0, "leagueId": "bronze_1", "leaguePoints": 20, "loadoutType": "single", "logicCores": "1", "losses": 0, "mainWeaponId": null, "maxHP": 10, "maxShield": 2, "name": "Robot B", "offhandWeaponId": null, "paintJob": null, "penetration": "1", "powerCore": "1", "repairCost": 0, "servoMotors": "1", "shieldCapacity": "1", "stance": "balanced", "supportSystems": "1", "syncProtocols": "1", "targetingSystems": "1", "threatAnalysis": "1", "timesTaggedIn": 0, "timesTaggedOut": 0, "titles": null, "totalBattles": 0, "totalRepairsPaid": 0, "totalTagTeamBattles": 0, "totalTagTeamDraws": 0, "totalTagTeamLosses": 0, "totalTagTeamWins": 0, "updatedAt": 2026-02-23T15:01:32.012Z, "user": {"id": 38678, "username": "test_order_user"}, "userId": 38678, "weaponControl": "1", "wins": 0, "yieldThreshold": 10}, {"adaptiveAI": "1", "armorPlating": "1", "attackSpeed": "1", "battleReadiness": 100, "combatAlgorithms": "1", "combatPower": "1", "counterProtocols": "1", "createdAt": 2026-02-23T15:01:32.012Z, "criticalSystems": "1", "currentHP": 10, "currentLeague": "bronze", "currentShield": 2, "cyclesInCurrentLeague": 0, "damageDampeners": "1", "damageDealtLifetime": 0, "damageTaken": 0, "damageTakenLifetime": 0, "draws": 0, "elo": 1200, "evasionThrusters": "1", "fame": 0, "formationTactics": "1", "frameId": 1, "gyroStabilizers": "1", "hullIntegrity": "1", "hydraulicSystems": "1", "id": 553330, "imageUrl": null, "kills": 0, "leagueId": "bronze_1", "leaguePoints": 10, "loadoutType": "single", "logicCores": "1", "losses": 0, "mainWeaponId": null, "maxHP": 10, "maxShield": 2, "name": "Robot A", "offhandWeaponId": null, "paintJob": null, "penetration": "1", "powerCore": "1", "repairCost": 0, "servoMotors": "1", "shieldCapacity": "1", "stance": "balanced", "supportSystems": "1", "syncProtocols": "1", "targetingSystems": "1", "threatAnalysis": "1", "timesTaggedIn": 0, "timesTaggedOut": 0, "titles": null, "totalBattles": 0, "totalRepairsPaid": 0, "totalTagTeamBattles": 0, "totalTagTeamDraws": 0, "totalTagTeamLosses": 0, "totalTagTeamWins": 0, "updatedAt": 2026-02-23T15:01:32.012Z, "user": {"id": 38678, "username": "test_order_user"}, "userId": 38678, "weaponControl": "1", "wins": 0, "yieldThreshold": 10}, {"adaptiveAI": "1", "armorPlating": "1", "attackSpeed": "1", "battleReadiness": 100, "combatAlgorithms": "1", "combatPower": "1", "counterProtocols": "1", "createdAt": 2026-02-23T15:01:32.012Z, "criticalSystems": "1", "currentHP": 100, "currentLeague": "bronze", "currentShield": 20, "cyclesInCurrentLeague": 0, "damageDampeners": "1", "damageDealtLifetime": 0, "damageTaken": 0, "damageTakenLifetime": 0, "draws": 0, "elo": 1200, "evasionThrusters": "1", "fame": 0, "formationTactics": "1", "frameId": 1, "gyroStabilizers": "1", "hullIntegrity": "1", "hydraulicSystems": "1", "id": 553328, "imageUrl": null, "kills": 0, "leagueId": "bronze_1", "leaguePoints": 0, "loadoutType": "single", "logicCores": "1", "losses": 0, "mainWeaponId": null, "maxHP": 100, "maxShield": 20, "name": "Test Robot 1771858892011", "offhandWeaponId": null, "paintJob": null, "penetration": "1", "powerCore": "1", "repairCost": 0, "servoMotors": "1", "shieldCapacity": "1", "stance": "balanced", "supportSystems": "1", "syncProtocols": "1", "targetingSystems": "1", "threatAnalysis": "1", "timesTaggedIn": 0, "timesTaggedOut": 0, "titles": null, "totalBattles": 0, "totalRepairsPaid": 0, "totalTagTeamBattles": 0, "totalTagTeamDraws": 0, "totalTagTeamLosses": 0, "totalTagTeamWins": 0, "updatedAt": 2026-02-23T15:01:32.012Z, "user": {"id": 38677, "username": "testuser_1771858892009_uke42d"}, "userId": 38677, "weaponControl": "1", "wins": 0, "yieldThreshold": 10}]

      404 |       const robots = await getRobotsInInstance('bronze_1');
      405 |       
    > 406 |       expect(robots).toHaveLength(3);
          |                      ^
      407 |       // Should be ordered by league points DESC, then ELO DESC
      408 |       expect(robots[0].name).toBe('Robot C'); // 20 points, 1300 ELO
      409 |       expect(robots[1].name).toBe('Robot B'); // 20 points, 1100 ELO

      at Object.<anonymous> (tests/leagueInstanceService.test.ts:406:22)

FAIL tests/facilityRecommendationService.test.ts
  ● FacilityRecommendationService › generateRecommendations › should recommend repair bay for user with high repair costs

    User 38621 not found

      43 |
      44 |     if (!user) {
    > 45 |       throw new Error(`User ${userId} not found`);
         |             ^
      46 |     }
      47 |
      48 |     // Get current cycle number

      at FacilityRecommendationService.generateRecommendations (src/services/facilityRecommendationService.ts:45:13)
      at Object.<anonymous> (tests/facilityRecommendationService.test.ts:139:22)

  ● FacilityRecommendationService › generateRecommendations › should rank recommendations by projected ROI

    User 38633 not found

      43 |
      44 |     if (!user) {
    > 45 |       throw new Error(`User ${userId} not found`);
         |             ^
      46 |     }
      47 |
      48 |     // Get current cycle number

      at FacilityRecommendationService.generateRecommendations (src/services/facilityRecommendationService.ts:45:13)
      at Object.<anonymous> (tests/facilityRecommendationService.test.ts:212:22)

  ● FacilityRecommendationService › generateRecommendations › should recommend roster expansion when user is at capacity

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/testHelpers.ts:24:29

      21  * Creates a test robot for a given user
      22  */
      23 export async function createTestRobot(userId: number, name?: string) {
    → 24   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      22 |  */
      23 | export async function createTestRobot(userId: number, name?: string) {
    > 24 |   return await prisma.robot.create({
         |          ^
      25 |     data: {
      26 |       name: name || `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      27 |       userId,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/testHelpers.ts:24:10)
      at Object.<anonymous> (tests/facilityRecommendationService.test.ts:344:7)

FAIL tests/stanceAndYieldAPI.test.ts
  ● Stance and Yield Threshold API Endpoints › PATCH /api/robots/:id/stance › should update robot stance to offensive

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 404

       99 |         .send({ stance: 'offensive' });
      100 |
    > 101 |       expect(response.status).toBe(200);
          |                               ^
      102 |       expect(response.body.stance).toBe('offensive');
      103 |       expect(response.body.message).toContain('offensive');
      104 |     });

      at Object.<anonymous> (tests/stanceAndYieldAPI.test.ts:101:31)

  ● Stance and Yield Threshold API Endpoints › PATCH /api/robots/:id/stance › should reject invalid stance value

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/stanceAndYieldAPI.test.ts:73:36

      70 );
      71 
      72 // Create a test robot
    → 73 testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      71 |
      72 |     // Create a test robot
    > 73 |     testRobot = await prisma.robot.create({
         |                 ^
      74 |       data: {
      75 |         userId: testUser.id,
      76 |         name: `Test Robot ${Date.now()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/stanceAndYieldAPI.test.ts:73:17)

  ● Stance and Yield Threshold API Endpoints › PATCH /api/robots/:id/yield-threshold › should update yield threshold to 25

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      206 |         .send({ yieldThreshold: 25 });
      207 |
    > 208 |       expect(response.status).toBe(200);
          |                               ^
      209 |       expect(response.body.yieldThreshold).toBe(25);
      210 |       expect(response.body.message).toContain('25');
      211 |     });

      at Object.<anonymous> (tests/stanceAndYieldAPI.test.ts:208:31)

  ● Stance and Yield Threshold API Endpoints › PATCH /api/robots/:id/yield-threshold › should accept 0% yield threshold

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      217 |         .send({ yieldThreshold: 0 });
      218 |
    > 219 |       expect(response.status).toBe(200);
          |                               ^
      220 |       expect(response.body.yieldThreshold).toBe(0);
      221 |     });
      222 |

      at Object.<anonymous> (tests/stanceAndYieldAPI.test.ts:219:31)

  ● Stance and Yield Threshold API Endpoints › PATCH /api/robots/:id/yield-threshold › should handle decimal yield threshold by rounding

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 404

      238 |         .send({ yieldThreshold: 12.5 });
      239 |
    > 240 |       expect(response.status).toBe(200);
          |                               ^
      241 |       // Expect integer value (database will round/truncate)
      242 |       expect(response.body.yieldThreshold).toBe(12);
      243 |     });

      at Object.<anonymous> (tests/stanceAndYieldAPI.test.ts:240:31)

  ● Stance and Yield Threshold API Endpoints › PATCH /api/robots/:id/yield-threshold › should return 404 for non-existent robot

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/stanceAndYieldAPI.test.ts:73:36

      70 );
      71 
      72 // Create a test robot
    → 73 testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      71 |
      72 |     // Create a test robot
    > 73 |     testRobot = await prisma.robot.create({
         |                 ^
      74 |       data: {
      75 |         userId: testUser.id,
      76 |         name: `Test Robot ${Date.now()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/stanceAndYieldAPI.test.ts:73:17)

FAIL tests/tagTeamLeagueInstance.property.test.ts
  ● Tag Team League Instance - Property Tests › Property 21: League Instance Capacity › no instance ever exceeds maximum capacity of 50 teams

    Property failed after 1 tests
    { seed: -1253227198, path: "0:0", endOnFailure: true }
    Counterexample: [1,"bronze"]
    Shrunk 1 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    TypeError: Cannot read properties of null (reading 'id')

      82 |     const weapon = await prisma.weapon.findFirst();
      83 |     const weaponInv = await prisma.weaponInventory.create({
    > 84 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      85 |     });
      86 |
      87 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueInstance.property.test.ts:84:55)
      at createTestTeam (tests/tagTeamLeagueInstance.property.test.ts:113:20)
      at tests/tagTeamLeagueInstance.property.test.ts:171:28
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueInstance.property.test.ts:156:7)

  ● Tag Team League Instance - Property Tests › Property 21: League Instance Capacity › new instance is created when 51st team would be added

    Property failed after 1 tests
    { seed: 154800718, path: "0:0", endOnFailure: true }
    Counterexample: ["bronze"]
    Shrunk 1 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    TypeError: Cannot read properties of null (reading 'id')

      82 |     const weapon = await prisma.weapon.findFirst();
      83 |     const weaponInv = await prisma.weaponInventory.create({
    > 84 |       data: { userId: testStableId, weaponId: weapon!.id },
         |                                                       ^
      85 |     });
      86 |
      87 |     const robot = await prisma.robot.create({

      at createTestRobot (tests/tagTeamLeagueInstance.property.test.ts:84:55)
      at createTestTeam (tests/tagTeamLeagueInstance.property.test.ts:113:20)
      at tests/tagTeamLeagueInstance.property.test.ts:205:15
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueInstance.property.test.ts:193:7)

  ● Tag Team League Instance - Property Tests › Property 21: League Instance Capacity › instance assignment distributes teams correctly

    Property failed after 1 tests
    { seed: -1892823521, path: "0:0:0", endOnFailure: true }
    Counterexample: [51,"bronze"]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeamLeagueInstance.property.test.ts:83:52

      80 async function createTestRobot(elo: number = 1000) {
      81   // Get a weapon for the robot
      82   const weapon = await prisma.weapon.findFirst();
    → 83   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      81 |     // Get a weapon for the robot
      82 |     const weapon = await prisma.weapon.findFirst();
    > 83 |     const weaponInv = await prisma.weaponInventory.create({
         |                       ^
      84 |       data: { userId: testStableId, weaponId: weapon!.id },
      85 |     });
      86 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/tagTeamLeagueInstance.property.test.ts:83:23)
      at createTestTeam (tests/tagTeamLeagueInstance.property.test.ts:113:20)
      at tests/tagTeamLeagueInstance.property.test.ts:251:15
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueInstance.property.test.ts:238:7)

  ● Tag Team League Instance - Property Tests › Property 21: League Instance Capacity › instance capacity is enforced across all league tiers

    Property failed after 1 tests
    { seed: -1857637709, path: "0:0", endOnFailure: true }
    Counterexample: [[{"tier":"bronze","numTeams":1}]]
    Shrunk 1 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeamLeagueInstance.property.test.ts:83:52

      80 async function createTestRobot(elo: number = 1000) {
      81   // Get a weapon for the robot
      82   const weapon = await prisma.weapon.findFirst();
    → 83   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      81 |     // Get a weapon for the robot
      82 |     const weapon = await prisma.weapon.findFirst();
    > 83 |     const weaponInv = await prisma.weaponInventory.create({
         |                       ^
      84 |       data: { userId: testStableId, weaponId: weapon!.id },
      85 |     });
      86 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/tagTeamLeagueInstance.property.test.ts:83:23)
      at createTestTeam (tests/tagTeamLeagueInstance.property.test.ts:113:20)
      at tests/tagTeamLeagueInstance.property.test.ts:299:17
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueInstance.property.test.ts:282:7)

  ● Tag Team League Instance - Property Tests › Property 21: League Instance Capacity › assignTagTeamLeagueInstance never returns a full instance

    Property failed after 1 tests
    { seed: -168130077, path: "0:0:1:0:0:0:0:0:0", endOnFailure: true }
    Counterexample: ["bronze",1]
    Shrunk 8 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeamLeagueInstance.property.test.ts:83:52

      80 async function createTestRobot(elo: number = 1000) {
      81   // Get a weapon for the robot
      82   const weapon = await prisma.weapon.findFirst();
    → 83   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      81 |     // Get a weapon for the robot
      82 |     const weapon = await prisma.weapon.findFirst();
    > 83 |     const weaponInv = await prisma.weaponInventory.create({
         |                       ^
      84 |       data: { userId: testStableId, weaponId: weapon!.id },
      85 |     });
      86 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/tagTeamLeagueInstance.property.test.ts:83:23)
      at createTestTeam (tests/tagTeamLeagueInstance.property.test.ts:113:20)
      at tests/tagTeamLeagueInstance.property.test.ts:330:15
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueInstance.property.test.ts:323:7)

  ● Tag Team League Instance - Property Tests › Property 21: League Instance Capacity › instance numbers are sequential and start at 1

    Property failed after 1 tests
    { seed: 124590087, path: "0:0:0", endOnFailure: true }
    Counterexample: ["bronze",1]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeamLeagueInstance.property.test.ts:83:52

      80 async function createTestRobot(elo: number = 1000) {
      81   // Get a weapon for the robot
      82   const weapon = await prisma.weapon.findFirst();
    → 83   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      81 |     // Get a weapon for the robot
      82 |     const weapon = await prisma.weapon.findFirst();
    > 83 |     const weaponInv = await prisma.weaponInventory.create({
         |                       ^
      84 |       data: { userId: testStableId, weaponId: weapon!.id },
      85 |     });
      86 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/tagTeamLeagueInstance.property.test.ts:83:23)
      at createTestTeam (tests/tagTeamLeagueInstance.property.test.ts:113:20)
      at tests/tagTeamLeagueInstance.property.test.ts:360:15
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueInstance.property.test.ts:353:7)

  ● Tag Team League Instance - Property Tests › Property 21: League Instance Capacity › capacity enforcement works with concurrent team creation

    Property failed after 1 tests
    { seed: -1638561238, path: "0:0:0", endOnFailure: true }
    Counterexample: ["bronze",45]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeamLeagueInstance.property.test.ts:83:52

      80 async function createTestRobot(elo: number = 1000) {
      81   // Get a weapon for the robot
      82   const weapon = await prisma.weapon.findFirst();
    → 83   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      81 |     // Get a weapon for the robot
      82 |     const weapon = await prisma.weapon.findFirst();
    > 83 |     const weaponInv = await prisma.weaponInventory.create({
         |                       ^
      84 |       data: { userId: testStableId, weaponId: weapon!.id },
      85 |     });
      86 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/tagTeamLeagueInstance.property.test.ts:83:23)
      at createTestTeam (tests/tagTeamLeagueInstance.property.test.ts:113:20)
          at async Promise.all (index 13)
      at tests/tagTeamLeagueInstance.property.test.ts:400:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/tagTeamLeagueInstance.property.test.ts:385:7)


  ● Test suite failed to run

    PrismaClientKnownRequestError: 
    Invalid `prisma.user.delete()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeamLeagueInstance.property.test.ts:47:31

      44   });
      45 }
      46 if (testStableId) {
    → 47   await prisma.user.delete(
    An operation failed because it depends on one or more records that were required but not found. Record to delete does not exist.

      45 |     }
      46 |     if (testStableId) {
    > 47 |       await prisma.user.delete({
         |       ^
      48 |         where: { id: testStableId },
      49 |       });
      50 |     }

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/tagTeamLeagueInstance.property.test.ts:47:7)

FAIL tests/eventLogger.test.ts
  ● EventLogger Service › Single Event Logging › should log a single event with correct sequence number

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 0
    Received array:  []

      42 |       });
      43 |
    > 44 |       expect(events).toHaveLength(1);
         |                      ^
      45 |       expect(events[0].eventType).toBe(EventType.CYCLE_START);
      46 |       expect(events[0].sequenceNumber).toBe(1);
      47 |       expect(events[0].payload).toEqual(payload);

      at Object.<anonymous> (tests/eventLogger.test.ts:44:22)

  ● EventLogger Service › Sequence Number Management › should maintain separate sequence numbers per cycle

    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at Object.<anonymous> (tests/eventLogger.test.ts:468:7)

FAIL tests/adminRobotStats.test.ts
  ● Admin Robot Statistics Endpoint › GET /api/admin/stats/robots › should require authentication

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/adminRobotStats.test.ts:102:40

       99 ];
      100 
      101 for (const data of robotData) {
    → 102   const robot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      100 |
      101 |     for (const data of robotData) {
    > 102 |       const robot = await prisma.robot.create({
          |                     ^
      103 |         data: {
      104 |           userId: adminUser.id,
      105 |           name: data.name,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/adminRobotStats.test.ts:102:21)

  ● Admin Robot Statistics Endpoint › GET /api/admin/stats/robots › should require admin role

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/adminRobotStats.test.ts:102:40

       99 ];
      100 
      101 for (const data of robotData) {
    → 102   const robot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      100 |
      101 |     for (const data of robotData) {
    > 102 |       const robot = await prisma.robot.create({
          |                     ^
      103 |         data: {
      104 |           userId: adminUser.id,
      105 |           name: data.name,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/adminRobotStats.test.ts:102:21)

  ● Admin Robot Statistics Endpoint › GET /api/admin/stats/robots › should return comprehensive robot statistics

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/adminRobotStats.test.ts:102:40

       99 ];
      100 
      101 for (const data of robotData) {
    → 102   const robot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      100 |
      101 |     for (const data of robotData) {
    > 102 |       const robot = await prisma.robot.create({
          |                     ^
      103 |         data: {
      104 |           userId: adminUser.id,
      105 |           name: data.name,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/adminRobotStats.test.ts:102:21)

  ● Admin Robot Statistics Endpoint › GET /api/admin/stats/robots › should include summary statistics

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/adminRobotStats.test.ts:102:40

       99 ];
      100 
      101 for (const data of robotData) {
    → 102   const robot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      100 |
      101 |     for (const data of robotData) {
    > 102 |       const robot = await prisma.robot.create({
          |                     ^
      103 |         data: {
      104 |           userId: adminUser.id,
      105 |           name: data.name,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/adminRobotStats.test.ts:102:21)

  ● Admin Robot Statistics Endpoint › GET /api/admin/stats/robots › should calculate attribute statistics correctly

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/adminRobotStats.test.ts:102:40

       99 ];
      100 
      101 for (const data of robotData) {
    → 102   const robot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      100 |
      101 |     for (const data of robotData) {
    > 102 |       const robot = await prisma.robot.create({
          |                     ^
      103 |         data: {
      104 |           userId: adminUser.id,
      105 |           name: data.name,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/adminRobotStats.test.ts:102:21)

  ● Admin Robot Statistics Endpoint › GET /api/admin/stats/robots › should detect outliers correctly

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/adminRobotStats.test.ts:102:40

       99 ];
      100 
      101 for (const data of robotData) {
    → 102   const robot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      100 |
      101 |     for (const data of robotData) {
    > 102 |       const robot = await prisma.robot.create({
          |                     ^
      103 |         data: {
      104 |           userId: adminUser.id,
      105 |           name: data.name,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/adminRobotStats.test.ts:102:21)

  ● Admin Robot Statistics Endpoint › GET /api/admin/stats/robots › should provide statistics by league tier

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/adminRobotStats.test.ts:102:40

       99 ];
      100 
      101 for (const data of robotData) {
    → 102   const robot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      100 |
      101 |     for (const data of robotData) {
    > 102 |       const robot = await prisma.robot.create({
          |                     ^
      103 |         data: {
      104 |           userId: adminUser.id,
      105 |           name: data.name,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/adminRobotStats.test.ts:102:21)

  ● Admin Robot Statistics Endpoint › GET /api/admin/stats/robots › should include top and bottom performers

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/adminRobotStats.test.ts:102:40

       99 ];
      100 
      101 for (const data of robotData) {
    → 102   const robot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      100 |
      101 |     for (const data of robotData) {
    > 102 |       const robot = await prisma.robot.create({
          |                     ^
      103 |         data: {
      104 |           userId: adminUser.id,
      105 |           name: data.name,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/adminRobotStats.test.ts:102:21)

  ● Admin Robot Statistics Endpoint › GET /api/admin/stats/robots › should include win rate analysis

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/adminRobotStats.test.ts:102:40

       99 ];
      100 
      101 for (const data of robotData) {
    → 102   const robot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      100 |
      101 |     for (const data of robotData) {
    > 102 |       const robot = await prisma.robot.create({
          |                     ^
      103 |         data: {
      104 |           userId: adminUser.id,
      105 |           name: data.name,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/adminRobotStats.test.ts:102:21)

FAIL tests/streamingRevenueFormula.property.test.ts (14.878 s)
  ● Property 6: Studio Multiplier Applies Stable-Wide › Property 6.2: Studio upgrade affects all robots in stable

    Property failed after 44 tests
    { seed: -1052348510, path: "43:0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,1,0,0,0,0]
    Shrunk 5 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:802:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:776:5)

  ● Property 6: Studio Multiplier Applies Stable-Wide › Property 6.3: All robots in stable use same studio multiplier

    Property failed after 1 tests
    { seed: -642930646, path: "0:0:0", endOnFailure: true }
    Counterexample: [0,3]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:899:27
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:881:5)

  ● Property 2: Streaming Revenue Awarded to All Battle Participants › Property 2: Both participants receive streaming revenue in non-bye battles

    Property failed after 3 tests
    { seed: 998785496, path: "2:1:0:0:0:0:0:0:0:0:0:0:0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0,0,0,0]
    Shrunk 17 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1029:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1005:5)

  ● Property 2: Streaming Revenue Awarded to All Battle Participants › Property 2.1: Both winner and loser receive streaming revenue

    Property failed after 1 tests
    { seed: -289407348, path: "0:0:0", endOnFailure: true }
    Counterexample: [0,0,0]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1117:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1096:5)

  ● Property 2: Streaming Revenue Awarded to All Battle Participants › Property 2.2: Streaming revenue is independent of battle outcome

    Property failed after 1 tests
    { seed: -157739632, path: "0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0,0]
    Shrunk 4 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1176:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1168:5)

  ● Property 2: Streaming Revenue Awarded to All Battle Participants › Property 2.3: New robots with no stats still receive base streaming revenue

    Property failed after 1 tests
    { seed: -2144628441, path: "0", endOnFailure: true }
    Counterexample: [null]
    Shrunk 0 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1228:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1223:5)

  ● Property 2: Streaming Revenue Awarded to All Battle Participants › Property 2.4: Both participants receive revenue even with different studio levels

    Property failed after 1 tests
    { seed: 522538163, path: "0:0:1:0:1:1", endOnFailure: true }
    Counterexample: [0,1,0,0]
    Shrunk 5 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1292:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1265:5)

  ● Property 3: No Streaming Revenue for Bye Matches › Property 3: No streaming revenue for bye matches

    Property failed after 1 tests
    { seed: 2016728100, path: "0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1405:25
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1390:5)

  ● Property 3: No Streaming Revenue for Bye Matches › Property 3.1: Veteran robots get no revenue from bye matches

    Property failed after 1 tests
    { seed: -1717141400, path: "0:0:0:0", endOnFailure: true }
    Counterexample: [1000,5000,5]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1451:25
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1436:5)

  ● Property 3: No Streaming Revenue for Bye Matches › Property 3.2: Bye match flag always results in null revenue

    Property failed after 1 tests
    { seed: 834500299, path: "0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1500:25
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1485:5)

  ● Property 3: No Streaming Revenue for Bye Matches › Property 3.3: New robots get null revenue from bye matches

    Property failed after 1 tests
    { seed: 1253555510, path: "0", endOnFailure: true }
    Counterexample: [null]
    Shrunk 0 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1543:25
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1538:5)

  ● Property 3: No Streaming Revenue for Bye Matches › Property 3.4: Max studio level does not override bye match rule

    Property failed after 1 tests
    { seed: -668734267, path: "0:0", endOnFailure: true }
    Counterexample: [0,0]
    Shrunk 1 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1577:25
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1563:5)

  ● Property 12: Tag Team Single Payment Per Team › Property 12: Each stable receives exactly one payment per Tag Team battle

    Property failed after 1 tests
    { seed: 404937345, path: "0:0:0:0:0:0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0,0,0,0,0,0,0,0]
    Shrunk 10 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1695:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1659:5)

  ● Property 12: Tag Team Single Payment Per Team › Property 12.1: Single payment even with identical robot stats

    Property failed after 1 tests
    { seed: 1629920805, path: "0:0:0", endOnFailure: true }
    Counterexample: [0,0,0]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1822:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1807:5)

  ● Property 12: Tag Team Single Payment Per Team › Property 12.2: Payment uses team max values, not sum of robots

    Property failed after 1 tests
    { seed: -1113572953, path: "0:0:0:0", endOnFailure: true }
    Counterexample: [100,100,100,100,0]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:1906:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1889:5)

  ● Property 10: Tag Team Uses Maximum Values › Property 10: Tag Team uses maximum battles and fame from each team

    Property failed after 1 tests
    { seed: 1608382944, path: "0:0:0:0:0:0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0,0,0,0,0,0,0,0]
    Shrunk 10 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:2080:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2045:5)

  ● Property 10: Tag Team Uses Maximum Values › Property 10.1: Tag Team uses max battles from one robot and max fame from another

    Property failed after 1 tests
    { seed: 112835302, path: "0:0:0:0", endOnFailure: true }
    Counterexample: [100,1000,0]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:2202:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2187:5)

  ● Property 10: Tag Team Uses Maximum Values › Property 10.2: Tag Team with equal robot stats uses either robot

    Property failed after 1 tests
    { seed: 1919770136, path: "0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:2281:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2266:5)

  ● Property 10: Tag Team Uses Maximum Values › Property 10.3: Each team independently selects max values

    Property failed after 1 tests
    { seed: -1025627617, path: "0:0:0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0,0,0,0,0,0]
    Shrunk 7 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:2356:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2339:5)

  ● Property 10: Tag Team Uses Maximum Values › Property 10.4: Tag Team revenue benefits from max value selection

    Property failed after 1 tests
    { seed: -126478909, path: "0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,1,1,0]
    Shrunk 4 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:2434:29
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2414:5)

  ● Property 10: Tag Team Uses Maximum Values › Property 10.5: Tag Team with new robots uses base multipliers

    Property failed after 1 tests
    { seed: -1988319284, path: "0:0", endOnFailure: true }
    Counterexample: [0]
    Shrunk 1 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:2507:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2494:5)

  ● Property 11: Tag Team Separate Calculations › Property 11: Tag Team separate calculations use own team values

    Property failed after 2 tests
    { seed: 2006659310, path: "1:0:0:0:0:0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0,0,0,0,0,0,0,0]
    Shrunk 10 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:2653:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2620:5)

  ● Property 11: Tag Team Separate Calculations › Property 11.1: Higher stat team gets more revenue independently

    Property failed after 1 tests
    { seed: -1432056810, path: "0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,100,1000,0]
    Shrunk 5 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:2791:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2768:5)

  ● Property 11: Tag Team Separate Calculations › Property 11.2: Each team uses their own studio multiplier

    Property failed after 1 tests
    { seed: 887631697, path: "0:0:0:0:1:0:0", endOnFailure: true }
    Counterexample: [0,0,0,1]
    Shrunk 6 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:2881:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2854:5)

  ● Property 11: Tag Team Separate Calculations › Property 11.3: Team calculations are independent of opponent composition

    Property failed after 1 tests
    { seed: -206066021, path: "0:0:0:0:0:0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0,0,0,0,0,0,0,0]
    Shrunk 10 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:2982:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2949:5)

  ● Property 11: Tag Team Separate Calculations › Property 11.4: Both teams receive positive revenue independently

    Property failed after 1 tests
    { seed: 1478003478, path: "0:0:0:0:0:0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [0,0,0,0,0,0,0,0,0,0]
    Shrunk 10 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:23:29

      20 
      21 // Helper function to create a minimal test robot
      22 async function createTestRobot(userId: number, battles: number, fame: number) {
    → 23   return await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      21 | // Helper function to create a minimal test robot
      22 | async function createTestRobot(userId: number, battles: number, fame: number) {
    > 23 |   return await prisma.robot.create({
         |          ^
      24 |     data: {
      25 |       userId,
      26 |       name: `TestRobot_${Date.now()}_${Math.random()}`,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTestRobot (tests/streamingRevenueFormula.property.test.ts:23:10)
      at tests/streamingRevenueFormula.property.test.ts:3087:31
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:3054:5)


  ● Test suite failed to run

    PrismaClientKnownRequestError: 
    Invalid `prisma.user.delete()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:620:29

      617 // Clean up test data
      618 await prisma.robot.deleteMany({ where: { userId: testUserId } });
      619 await prisma.facility.deleteMany({ where: { userId: testUserId } });
    → 620 await prisma.user.delete(
    An operation failed because it depends on one or more records that were required but not found. Record to delete does not exist.

      618 |     await prisma.robot.deleteMany({ where: { userId: testUserId } });
      619 |     await prisma.facility.deleteMany({ where: { userId: testUserId } });
    > 620 |     await prisma.user.delete({ where: { id: testUserId } });
          |     ^
      621 |     await prisma.$disconnect();
      622 |   });
      623 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:620:5)

  ● Test suite failed to run

    PrismaClientKnownRequestError: 
    Invalid `prisma.user.delete()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:988:29

      985 await prisma.robot.deleteMany({ where: { userId: testUserId2 } });
      986 await prisma.facility.deleteMany({ where: { userId: testUserId1 } });
      987 await prisma.facility.deleteMany({ where: { userId: testUserId2 } });
    → 988 await prisma.user.delete(
    An operation failed because it depends on one or more records that were required but not found. Record to delete does not exist.

      986 |     await prisma.facility.deleteMany({ where: { userId: testUserId1 } });
      987 |     await prisma.facility.deleteMany({ where: { userId: testUserId2 } });
    > 988 |     await prisma.user.delete({ where: { id: testUserId1 } });
          |     ^
      989 |     await prisma.user.delete({ where: { id: testUserId2 } });
      990 |     await prisma.$disconnect();
      991 |   });

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:988:5)

  ● Test suite failed to run

    PrismaClientKnownRequestError: 
    Invalid `prisma.user.delete()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:1375:29

      1372 // Clean up test data
      1373 await prisma.robot.deleteMany({ where: { userId: testUserId } });
      1374 await prisma.facility.deleteMany({ where: { userId: testUserId } });
    → 1375 await prisma.user.delete(
    An operation failed because it depends on one or more records that were required but not found. Record to delete does not exist.

      1373 |     await prisma.robot.deleteMany({ where: { userId: testUserId } });
      1374 |     await prisma.facility.deleteMany({ where: { userId: testUserId } });
    > 1375 |     await prisma.user.delete({ where: { id: testUserId } });
           |     ^
      1376 |     await prisma.$disconnect();
      1377 |   });
      1378 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1375:5)

  ● Test suite failed to run

    PrismaClientKnownRequestError: 
    Invalid `prisma.user.delete()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:1641:29

      1638 await prisma.robot.deleteMany({ where: { userId: testUser2Id } });
      1639 await prisma.facility.deleteMany({ where: { userId: testUser1Id } });
      1640 await prisma.facility.deleteMany({ where: { userId: testUser2Id } });
    → 1641 await prisma.user.delete(
    An operation failed because it depends on one or more records that were required but not found. Record to delete does not exist.

      1639 |     await prisma.facility.deleteMany({ where: { userId: testUser1Id } });
      1640 |     await prisma.facility.deleteMany({ where: { userId: testUser2Id } });
    > 1641 |     await prisma.user.delete({ where: { id: testUser1Id } });
           |     ^
      1642 |     await prisma.user.delete({ where: { id: testUser2Id } });
      1643 |     await prisma.$disconnect();
      1644 |   });

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:1641:5)

  ● Test suite failed to run

    PrismaClientKnownRequestError: 
    Invalid `prisma.user.delete()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:2027:29

      2024 await prisma.robot.deleteMany({ where: { userId: testUserId2 } });
      2025 await prisma.facility.deleteMany({ where: { userId: testUserId1 } });
      2026 await prisma.facility.deleteMany({ where: { userId: testUserId2 } });
    → 2027 await prisma.user.delete(
    An operation failed because it depends on one or more records that were required but not found. Record to delete does not exist.

      2025 |     await prisma.facility.deleteMany({ where: { userId: testUserId1 } });
      2026 |     await prisma.facility.deleteMany({ where: { userId: testUserId2 } });
    > 2027 |     await prisma.user.delete({ where: { id: testUserId1 } });
           |     ^
      2028 |     await prisma.user.delete({ where: { id: testUserId2 } });
      2029 |     await prisma.$disconnect();
      2030 |   });

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2027:5)

  ● Test suite failed to run

    PrismaClientKnownRequestError: 
    Invalid `prisma.user.delete()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/streamingRevenueFormula.property.test.ts:2602:29

      2599 await prisma.robot.deleteMany({ where: { userId: testUserId2 } });
      2600 await prisma.facility.deleteMany({ where: { userId: testUserId1 } });
      2601 await prisma.facility.deleteMany({ where: { userId: testUserId2 } });
    → 2602 await prisma.user.delete(
    An operation failed because it depends on one or more records that were required but not found. Record to delete does not exist.

      2600 |     await prisma.facility.deleteMany({ where: { userId: testUserId1 } });
      2601 |     await prisma.facility.deleteMany({ where: { userId: testUserId2 } });
    > 2602 |     await prisma.user.delete({ where: { id: testUserId1 } });
           |     ^
      2603 |     await prisma.user.delete({ where: { id: testUserId2 } });
      2604 |     await prisma.$disconnect();
      2605 |   });

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/streamingRevenueFormula.property.test.ts:2602:5)

FAIL tests/queryService.test.ts
  ● QueryService › queryEvents › should query events by cycle number

    expect(received).toHaveLength(expected)

    Expected length: 1
    Received length: 0
    Received array:  []

      39 |       const result = await queryService.queryEvents({ cycleNumber: 2 });
      40 |
    > 41 |       expect(result.events).toHaveLength(1);
         |                             ^
      42 |       expect(result.events[0].cycleNumber).toBe(2);
      43 |       expect(result.total).toBe(1);
      44 |       expect(result.hasMore).toBe(false);

      at Object.<anonymous> (tests/queryService.test.ts:41:29)

  ● QueryService › queryEvents › should query events by cycle range

    expect(received).toHaveLength(expected)

    Expected length: 3
    Received length: 7
    Received array:  [{"cycleNumber": 2, "eventTimestamp": 2026-02-23T15:01:32.107Z, "eventType": "cycle_start", "id": 2116845n, "metadata": null, "payload": {"timestamp": "2026-02-23T15:01:32.107Z", "triggerType": "manual"}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"cycleNumber": 3, "eventTimestamp": 2026-02-23T15:01:32.110Z, "eventType": "cycle_start", "id": 2116847n, "metadata": null, "payload": {"timestamp": "2026-02-23T15:01:32.110Z", "triggerType": "manual"}, "robotId": null, "sequenceNumber": 289, "userId": null}, {"cycleNumber": 3, "eventTimestamp": 2026-02-23T15:01:32.111Z, "eventType": "credit_change", "id": 2116849n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 291, "userId": 7}, {"cycleNumber": 3, "eventTimestamp": 2026-02-23T15:01:32.115Z, "eventType": "credit_change", "id": 2116853n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 292, "userId": 1}, {"cycleNumber": 3, "eventTimestamp": 2026-02-23T15:01:32.119Z, "eventType": "credit_change", "id": 2116858n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 293, "userId": 5}, {"cycleNumber": 4, "eventTimestamp": 2026-02-23T15:01:32.113Z, "eventType": "cycle_start", "id": 2116851n, "metadata": null, "payload": {"timestamp": "2026-02-23T15:01:32.112Z", "triggerType": "manual"}, "robotId": null, "sequenceNumber": 1, "userId": null}, {"cycleNumber": 4, "eventTimestamp": 2026-02-23T15:01:32.116Z, "eventType": "credit_change", "id": 2116854n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 644, "userId": 6}]

      57 |       const result = await queryService.queryEvents({ cycleRange: [2, 4] });
      58 |
    > 59 |       expect(result.events).toHaveLength(3);
         |                             ^
      60 |       expect(result.events[0].cycleNumber).toBe(2);
      61 |       expect(result.events[2].cycleNumber).toBe(4);
      62 |       expect(result.total).toBe(3);

      at Object.<anonymous> (tests/queryService.test.ts:59:29)

  ● QueryService › queryEvents › should query events by event type

    expect(received).toHaveLength(expected)

    Expected length: 2
    Received length: 1
    Received array:  [{"cycleNumber": 173049, "eventTimestamp": 2026-02-23T15:01:32.152Z, "eventType": "cycle_start", "id": 2116897n, "metadata": null, "payload": {"test": "data", "value": 123}, "robotId": null, "sequenceNumber": 1, "userId": null}]

      116 |       });
      117 |
    > 118 |       expect(result.events).toHaveLength(2);
          |                             ^
      119 |       expect(result.events.every(e => e.eventType === 'cycle_start')).toBe(true);
      120 |     });
      121 |

      at Object.<anonymous> (tests/queryService.test.ts:118:29)

  ● QueryService › queryEvents › should query events by multiple event types

    expect(received).toHaveLength(expected)

    Expected length: 2
    Received length: 0
    Received array:  []

      134 |       });
      135 |
    > 136 |       expect(result.events).toHaveLength(2);
          |                             ^
      137 |       expect(result.events.some(e => e.eventType === 'cycle_start')).toBe(true);
      138 |       expect(result.events.some(e => e.eventType === 'cycle_complete')).toBe(true);
      139 |     });

      at Object.<anonymous> (tests/queryService.test.ts:136:29)

  ● QueryService › queryEvents › should support pagination with limit and offset

    expect(received).toBe(expected) // Object.is equality

    Expected: 10
    Received: 14

      151 |       const page1 = await queryService.queryEvents({ limit: 5, offset: 0 });
      152 |       expect(page1.events).toHaveLength(5);
    > 153 |       expect(page1.total).toBe(10);
          |                           ^
      154 |       expect(page1.hasMore).toBe(true);
      155 |
      156 |       // Get second page (5 events)

      at Object.<anonymous> (tests/queryService.test.ts:153:27)

  ● QueryService › queryEvents › should support sorting by timestamp

    expect(received).toHaveLength(expected)

    Expected length: 3
    Received length: 7
    Received array:  [{"cycleNumber": 6, "eventTimestamp": 2026-02-23T15:01:32.238Z, "eventType": "cycle_step_complete", "id": 2116992n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 211, "userId": null}, {"cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.237Z, "eventType": "credit_change", "id": 2116991n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 595, "userId": 6}, {"cycleNumber": 5, "eventTimestamp": 2026-02-23T15:01:32.236Z, "eventType": "cycle_step_complete", "id": 2116990n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"cycleNumber": 4, "eventTimestamp": 2026-02-23T15:01:32.235Z, "eventType": "cycle_step_complete", "id": 2116987n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"cycleNumber": 3, "eventTimestamp": 2026-02-23T15:01:32.235Z, "eventType": "cycle_start", "id": 2116988n, "metadata": null, "payload": {"timestamp": "2026-02-23T15:01:32.235Z", "triggerType": "manual"}, "robotId": null, "sequenceNumber": 291, "userId": null}, {"cycleNumber": 6, "eventTimestamp": 2026-02-23T15:01:32.235Z, "eventType": "credit_change", "id": 2116989n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 225, "userId": 5}, {"cycleNumber": 3, "eventTimestamp": 2026-02-23T15:01:32.233Z, "eventType": "cycle_step_complete", "id": 2116985n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}]

      179 |       });
      180 |
    > 181 |       expect(result.events).toHaveLength(3);
          |                             ^
      182 |       expect(result.events[0].cycleNumber).toBe(3);
      183 |       expect(result.events[2].cycleNumber).toBe(1);
      184 |     });

      at Object.<anonymous> (tests/queryService.test.ts:181:29)

  ● QueryService › getEventsByCycle › should get all events for a specific cycle

    expect(received).toHaveLength(expected)

    Expected length: 3
    Received length: 4
    Received array:  [{"cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.262Z, "eventType": "cycle_start", "id": 2117024n, "metadata": null, "payload": {"timestamp": "2026-02-23T15:01:32.262Z", "triggerType": "manual"}, "robotId": null, "sequenceNumber": 4, "userId": null}, {"cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.266Z, "eventType": "cycle_step_complete", "id": 2117028n, "metadata": null, "payload": {"duration": 100, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 5, "userId": null}, {"cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.271Z, "eventType": "cycle_complete", "id": 2117032n, "metadata": null, "payload": {"timestamp": "2026-02-23T15:01:32.271Z", "totalDuration": 100}, "robotId": null, "sequenceNumber": 6, "userId": null}, {"cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.263Z, "eventType": "credit_change", "id": 2117023n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 598, "userId": 6}]

      221 |       const events = await queryService.getEventsByCycle(1);
      222 |
    > 223 |       expect(events).toHaveLength(3);
          |                      ^
      224 |       expect(events.every(e => e.cycleNumber === 1)).toBe(true);
      225 |     });
      226 |   });

      at Object.<anonymous> (tests/queryService.test.ts:223:22)

  ● QueryService › getEventsByUser › should get all events for a specific user

    expect(received).toHaveLength(expected)

    Expected length: 3
    Received length: 4
    Received array:  [{"cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.301Z, "eventType": "credit_change", "id": 2117041n, "metadata": null, "payload": {"amount": 100, "newBalance": 1100, "source": "battle"}, "robotId": null, "sequenceNumber": 1, "userId": 5}, {"cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.316Z, "eventType": "prestige_change", "id": 2117047n, "metadata": null, "payload": {"amount": 10, "newTotal": 110, "source": "battle"}, "robotId": null, "sequenceNumber": 2, "userId": 5}, {"cycleNumber": 2, "eventTimestamp": 2026-02-23T15:01:32.307Z, "eventType": "credit_change", "id": 2117044n, "metadata": null, "payload": {"amount": 200, "newBalance": 1300, "source": "battle"}, "robotId": null, "sequenceNumber": 8, "userId": 5}, {"cycleNumber": 3, "eventTimestamp": 2026-02-23T15:01:32.303Z, "eventType": "credit_change", "id": 2117042n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 317, "userId": 5}]

      239 |       const events = await queryService.getEventsByUser(userId);
      240 |
    > 241 |       expect(events).toHaveLength(3);
          |                      ^
      242 |       expect(events.every(e => e.userId === userId)).toBe(true);
      243 |     });
      244 |

      at Object.<anonymous> (tests/queryService.test.ts:241:22)

  ● QueryService › getPaginatedEvents › should paginate events correctly

    expect(received).toHaveLength(expected)

    Expected length: 10
    Received length: 9
    Received array:  [{"cycleNumber": 25, "eventTimestamp": 2026-02-23T15:01:32.447Z, "eventType": "cycle_start", "id": 2117192n, "metadata": null, "payload": {"timestamp": "2026-02-23T15:01:32.445Z", "triggerType": "manual"}, "robotId": null, "sequenceNumber": 1, "userId": null}, {"cycleNumber": 78, "eventTimestamp": 2026-02-23T15:01:32.438Z, "eventType": "cycle_step_complete", "id": 2117179n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"cycleNumber": 79, "eventTimestamp": 2026-02-23T15:01:32.440Z, "eventType": "cycle_step_complete", "id": 2117182n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"cycleNumber": 80, "eventTimestamp": 2026-02-23T15:01:32.441Z, "eventType": "cycle_step_complete", "id": 2117184n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"cycleNumber": 81, "eventTimestamp": 2026-02-23T15:01:32.443Z, "eventType": "cycle_step_complete", "id": 2117187n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"cycleNumber": 82, "eventTimestamp": 2026-02-23T15:01:32.444Z, "eventType": "cycle_step_complete", "id": 2117189n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"cycleNumber": 83, "eventTimestamp": 2026-02-23T15:01:32.447Z, "eventType": "cycle_step_complete", "id": 2117193n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"cycleNumber": 84, "eventTimestamp": 2026-02-23T15:01:32.450Z, "eventType": "cycle_step_complete", "id": 2117195n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"cycleNumber": 85, "eventTimestamp": 2026-02-23T15:01:32.454Z, "eventType": "cycle_step_complete", "id": 2117197n, "metadata": null, "payload": {"duration": 1000, "stepName": "step_1", "stepNumber": 1, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}]

      310 |       // Get page 2
      311 |       const page2 = await queryService.getPaginatedEvents({}, 2, 10);
    > 312 |       expect(page2.events).toHaveLength(10);
          |                            ^
      313 |       expect(page2.hasMore).toBe(true);
      314 |
      315 |       // Get page 3

      at Object.<anonymous> (tests/queryService.test.ts:312:28)

  ● QueryService › getEventStatistics › should calculate event statistics

    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: 4

      338 |       const stats = await queryService.getEventStatistics([1, 2]);
      339 |
    > 340 |       expect(stats.totalEvents).toBe(5);
          |                                 ^
      341 |       expect(stats.eventsByType['cycle_start']).toBe(2);
      342 |       expect(stats.eventsByType['credit_change']).toBe(2);
      343 |       expect(stats.eventsByType['attribute_upgrade']).toBe(1);

      at Object.<anonymous> (tests/queryService.test.ts:340:33)

  ● QueryService › getRecentEvents › should get most recent events

    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: 101

      362 |
      363 |       expect(recent).toHaveLength(3);
    > 364 |       expect(recent[0].cycleNumber).toBe(5); // Most recent first
          |                                     ^
      365 |       expect(recent[2].cycleNumber).toBe(3);
      366 |     });
      367 |   });

      at Object.<anonymous> (tests/queryService.test.ts:364:37)

FAIL tests/cycleExecutionTiming.test.ts
  ● Cycle Execution Timing › Complete cycle timing flow › should log complete cycle with start, steps, and complete events

    expect(received).toHaveLength(expected)

    Expected length: 5
    Received length: 9
    Received array:  [{"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.612Z, "eventType": "cycle_start", "id": 2117344n, "metadata": null, "payload": {"timestamp": "2026-02-23T15:01:32.611Z", "triggerType": "manual"}, "robotId": null, "sequenceNumber": 1, "userId": null}, {"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.613Z, "eventType": "cycle_step_complete", "id": 2117347n, "metadata": null, "payload": {"duration": 1000, "stepName": "execute_battles", "stepNumber": 1, "summary": {"battles": 5}}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.615Z, "eventType": "cycle_step_complete", "id": 2117350n, "metadata": null, "payload": {"duration": 500, "stepName": "repair_robots", "stepNumber": 2, "summary": {"repaired": 10}}, "robotId": null, "sequenceNumber": 3, "userId": null}, {"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.616Z, "eventType": "cycle_step_complete", "id": 2117353n, "metadata": null, "payload": {"duration": 300, "stepName": "matchmaking", "stepNumber": 3, "summary": {"matches": 8}}, "robotId": null, "sequenceNumber": 4, "userId": null}, {"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.618Z, "eventType": "cycle_complete", "id": 2117356n, "metadata": null, "payload": {"timestamp": "2026-02-23T15:01:32.618Z", "totalDuration": 1800}, "robotId": null, "sequenceNumber": 5, "userId": null}, {"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.611Z, "eventType": "credit_change", "id": 2117342n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 640, "userId": 6}, {"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.617Z, "eventType": "credit_change", "id": 2117354n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 641, "userId": 1}, {"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.618Z, "eventType": "credit_change", "id": 2117357n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 642, "userId": 1}, {"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.620Z, "eventType": "credit_change", "id": 2117360n, "metadata": null, "payload": {"amount": 100, "newBalance": 10100, "source": "battle"}, "robotId": null, "sequenceNumber": 643, "userId": 1}]

      182 |       });
      183 |       
    > 184 |       expect(allEvents).toHaveLength(5);
          |                         ^
      185 |       expect(allEvents[0].eventType).toBe('cycle_start');
      186 |       expect(allEvents[1].eventType).toBe('cycle_step_complete');
      187 |       expect(allEvents[2].eventType).toBe('cycle_step_complete');

      at Object.<anonymous> (tests/cycleExecutionTiming.test.ts:184:25)

  ● Cycle Execution Timing › Step duration recording › should record accurate step durations

    expect(received).toHaveLength(expected)

    Expected length: 4
    Received length: 3
    Received array:  [{"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.648Z, "eventType": "cycle_step_complete", "id": 2117390n, "metadata": null, "payload": {"duration": 250, "stepName": "step2", "stepNumber": 2, "summary": {}}, "robotId": null, "sequenceNumber": 2, "userId": null}, {"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.650Z, "eventType": "cycle_step_complete", "id": 2117393n, "metadata": null, "payload": {"duration": 500, "stepName": "step3", "stepNumber": 3, "summary": {}}, "robotId": null, "sequenceNumber": 3, "userId": null}, {"battleId": null, "cycleNumber": 1, "eventTimestamp": 2026-02-23T15:01:32.651Z, "eventType": "cycle_step_complete", "id": 2117398n, "metadata": null, "payload": {"duration": 1000, "stepName": "step4", "stepNumber": 4, "summary": {}}, "robotId": null, "sequenceNumber": 4, "userId": null}]

      233 |       });
      234 |       
    > 235 |       expect(events).toHaveLength(durations.length);
          |                      ^
      236 |       events.forEach((event, index) => {
      237 |         expect((event.payload as any).duration).toBe(durations[index]);
      238 |       });

      at Object.<anonymous> (tests/cycleExecutionTiming.test.ts:235:22)

  ● Cycle Execution Timing › Step duration recording › should sum step durations approximately equal to total cycle duration

    expect(received).toBe(expected) // Object.is equality

    Expected: 2000
    Received: 0

      273 |       
      274 |       const sumOfSteps = stepEvents.reduce((sum, e) => sum + ((e.payload as any).duration as number), 0);
    > 275 |       expect(sumOfSteps).toBe((completeEvent?.payload as any).totalDuration);
          |                          ^
      276 |     });
      277 |   });
      278 |

      at Object.<anonymous> (tests/cycleExecutionTiming.test.ts:275:26)

FAIL tests/facility.test.ts
  ● Facility Routes › POST /api/facility/upgrade › should handle upgrade attempt when at max level

    expect(received).toContain(expected) // indexOf

    Expected value: 404
    Received array: [200, 400, 403]

      118 |
      119 |       // Should either succeed, indicate max level reached, or insufficient credits
    > 120 |       expect([200, 400, 403]).toContain(response.status);
          |                               ^
      121 |       
      122 |       if (response.status === 400) {
      123 |         // Accept either max level or insufficient credits as valid responses

      at Object.<anonymous> (tests/facility.test.ts:120:31)

FAIL tests/battleEventLogging.test.ts
  ● Battle Event Logging Integration › should log battle_complete event when a battle is processed

    PrismaClientKnownRequestError: 
    Invalid `prisma.scheduledMatch.update()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:803:31

      800 // No need to update Battle table
      801 
      802 // Update scheduled match
    → 803 await prisma.scheduledMatch.update(
    An operation failed because it depends on one or more records that were required but not found. Record to update not found.

      801 |   
      802 |   // Update scheduled match
    > 803 |   await prisma.scheduledMatch.update({
          |   ^
      804 |     where: { id: scheduledMatch.id },
      805 |     data: {
      806 |       status: 'completed',

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at processBattle (src/services/battleOrchestrator.ts:803:3)
      at Object.<anonymous> (tests/battleEventLogging.test.ts:120:20)

  ● Battle Event Logging Integration › should maintain Battle table records alongside event logs

    PrismaClientKnownRequestError: 
    Invalid `prisma.battle.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:397:38

      394 }
      395 
      396 // Create battle record
    → 397 const battle = await prisma.battle.create(
    Foreign key constraint violated: `battles_robot1_id_fkey (index)`

      395 |   
      396 |   // Create battle record
    > 397 |   const battle = await prisma.battle.create({
          |                  ^
      398 |     data: {
      399 |       robot1Id: robot1.id,
      400 |       robot2Id: robot2.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createBattleRecord (src/services/battleOrchestrator.ts:397:18)
      at processBattle (src/services/battleOrchestrator.ts:641:18)
      at Object.<anonymous> (tests/battleEventLogging.test.ts:163:20)

FAIL tests/tournamentStreamingRevenue.test.ts
  ● Tournament Streaming Revenue › Tournament Battle Streaming Revenue › should award streaming revenue to both participants in a tournament battle

    PrismaClientKnownRequestError: 
    Invalid `prisma.battle.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/tournamentBattleOrchestrator.ts:403:38

      400 });
      401 
      402 // Create battle record
    → 403 const battle = await prisma.battle.create(
    Foreign key constraint violated: `battles_robot1_id_fkey (index)`

      401 |
      402 |   // Create battle record
    > 403 |   const battle = await prisma.battle.create({
          |                  ^
      404 |     data: {
      405 |       robot1Id: robot1.id,
      406 |       robot2Id: robot2.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at createTournamentBattleRecord (src/services/tournamentBattleOrchestrator.ts:403:18)
      at processTournamentBattle (src/services/tournamentBattleOrchestrator.ts:109:18)
      at Object.<anonymous> (tests/tournamentStreamingRevenue.test.ts:198:22)

  ● Tournament Streaming Revenue › Tournament Battle Streaming Revenue › should not award streaming revenue for bye matches

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tournamentStreamingRevenue.test.ts:239:54

      236 const testUser1Id = testUserIds[0];
      237 
      238 // Create a robot for bye match
    → 239 const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      237 |
      238 |       // Create a robot for bye match
    > 239 |       const weaponInv = await prisma.weaponInventory.create({
          |                         ^
      240 |         data: { userId: testUser1Id, weaponId: practiceSword.id },
      241 |       });
      242 |       testWeaponInvIds.push(weaponInv.id);

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/tournamentStreamingRevenue.test.ts:239:25)

FAIL tests/battleOrchestrator.test.ts
  ● Battle Orchestrator › processBattle › should handle bye-robot battles correctly

    PrismaClientKnownRequestError: 
    Invalid `prisma.user.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/battleOrchestrator.test.ts:70:23

      67 await prisma.weaponInventory.deleteMany({
      68   where: { userId: testUser.id },
      69 });
    → 70 await prisma.user.deleteMany(
    Foreign key constraint violated: `battles_robot1_id_fkey (index)`

      68 |       where: { userId: testUser.id },
      69 |     });
    > 70 |     await prisma.user.deleteMany({
         |     ^
      71 |       where: { 
      72 |         id: { not: testUser.id },
      73 |       },

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/battleOrchestrator.test.ts:70:5)

  ● Battle Orchestrator › processBattle › should increment kills when a robot destroys its opponent

    PrismaClientKnownRequestError: 
    Invalid `prisma.battleParticipant.update()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/battleOrchestrator.ts:686:34

      683   },
      684 });
      685 
    → 686 await prisma.battleParticipant.update(
    An operation failed because it depends on one or more records that were required but not found. Record to update not found.

      684 |   });
      685 |   
    > 686 |   await prisma.battleParticipant.update({
          |   ^
      687 |     where: {
      688 |       battleId_robotId: {
      689 |         battleId: battle.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at processBattle (src/services/battleOrchestrator.ts:686:3)
      at Object.<anonymous> (tests/battleOrchestrator.test.ts:343:22)

  ● Battle Orchestrator › executeScheduledBattles › should execute multiple scheduled battles

    PrismaClientKnownRequestError: 
    Invalid `prisma.scheduledMatch.createMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/battleOrchestrator.test.ts:407:35

      404 
      405 // Create 2 scheduled matches
      406 const scheduledTime = new Date();
    → 407 await prisma.scheduledMatch.createMany(
    Foreign key constraint violated: `scheduled_matches_robot1_id_fkey (index)`

      405 |       // Create 2 scheduled matches
      406 |       const scheduledTime = new Date();
    > 407 |       await prisma.scheduledMatch.createMany({
          |       ^
      408 |         data: [
      409 |           {
      410 |             robot1Id: robots[0].id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/battleOrchestrator.test.ts:407:7)

  ● Battle Orchestrator › Streaming Revenue Integration › should calculate and award streaming revenue after battle

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/battleOrchestrator.test.ts:448:55

      445 describe('Streaming Revenue Integration', () => {
      446   it('should calculate and award streaming revenue after battle', async () => {
      447     // Create test robots with some fame and battles
    → 448     const weaponInv1 = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      446 |     it('should calculate and award streaming revenue after battle', async () => {
      447 |       // Create test robots with some fame and battles
    > 448 |       const weaponInv1 = await prisma.weaponInventory.create({
          |                          ^
      449 |         data: { userId: testUser.id, weaponId: practiceSword.id },
      450 |       });
      451 |       const weaponInv2 = await prisma.weaponInventory.create({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/battleOrchestrator.test.ts:448:26)

  ● Battle Orchestrator › Streaming Revenue Integration › should not award streaming revenue for bye matches

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/battleOrchestrator.test.ts:525:54

      522 
      523 it('should not award streaming revenue for bye matches', async () => {
      524   // Create player robot
    → 525   const weaponInv = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      523 |     it('should not award streaming revenue for bye matches', async () => {
      524 |       // Create player robot
    > 525 |       const weaponInv = await prisma.weaponInventory.create({
          |                         ^
      526 |         data: { userId: testUser.id, weaponId: practiceSword.id },
      527 |       });
      528 |

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/battleOrchestrator.test.ts:525:25)

  ● Battle Orchestrator › Streaming Revenue Integration › should add streaming revenue to audit log

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/battleOrchestrator.test.ts:618:55

      615 
      616 it('should add streaming revenue to audit log', async () => {
      617   // Create test robots
    → 618   const weaponInv1 = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      616 |     it('should add streaming revenue to audit log', async () => {
      617 |       // Create test robots
    > 618 |       const weaponInv1 = await prisma.weaponInventory.create({
          |                          ^
      619 |         data: { userId: testUser.id, weaponId: practiceSword.id },
      620 |       });
      621 |       const weaponInv2 = await prisma.weaponInventory.create({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/battleOrchestrator.test.ts:618:26)

  ● Battle Orchestrator › Streaming Revenue Integration › should log streaming revenue to terminal

    PrismaClientKnownRequestError: 
    Invalid `prisma.weaponInventory.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/battleOrchestrator.test.ts:696:55

      693 
      694 it('should log streaming revenue to terminal', async () => {
      695   // Create test robots
    → 696   const weaponInv1 = await prisma.weaponInventory.create(
    Foreign key constraint violated: `weapon_inventory_user_id_fkey (index)`

      694 |     it('should log streaming revenue to terminal', async () => {
      695 |       // Create test robots
    > 696 |       const weaponInv1 = await prisma.weaponInventory.create({
          |                          ^
      697 |         data: { userId: testUser.id, weaponId: practiceSword.id },
      698 |       });
      699 |       const weaponInv2 = await prisma.weaponInventory.create({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/battleOrchestrator.test.ts:696:26)

FAIL tests/finances.test.ts
  ● Finances Routes › GET /api/finances/daily › should get daily financial report with auth

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › GET /api/finances/daily › should return 401 without authentication

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › GET /api/finances/summary › should get financial summary with auth

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › GET /api/finances/summary › should return 401 without authentication

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › GET /api/finances/operating-costs › should get operating costs with auth

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › GET /api/finances/operating-costs › should return 401 without authentication

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › GET /api/finances/revenue-streams › should get revenue streams with auth

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › GET /api/finances/revenue-streams › should return 401 without authentication

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › GET /api/finances/projections › should get financial projections with auth

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › GET /api/finances/projections › should return 401 without authentication

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › GET /api/finances/per-robot › should get per-robot financial report with auth

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › GET /api/finances/per-robot › should return 401 without authentication

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › POST /api/finances/roi-calculator › should return 400 without required fields

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › POST /api/finances/roi-calculator › should calculate ROI with valid data

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

  ● Finances Routes › POST /api/finances/roi-calculator › should return 401 without authentication

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/finances.test.ts:39:42

      36 testUserIds.push(testUser.id);
      37 
      38 // Create a test robot
    → 39 const testRobot = await prisma.robot.create(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      37 |
      38 |     // Create a test robot
    > 39 |     const testRobot = await prisma.robot.create({
         |                       ^
      40 |       data: {
      41 |         name: `TestRobot_${Date.now()}_${Math.random().toString(36).substring(7)}`,
      42 |         userId: testUser.id,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/finances.test.ts:39:23)

FAIL tests/tagTeams.test.ts
  ● Tag Teams API Endpoints › POST /api/tag-teams › should create a tag team with valid robots

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › POST /api/tag-teams › should reject team creation without authentication

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › POST /api/tag-teams › should reject team creation with missing robot IDs

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › POST /api/tag-teams › should reject team creation with same robot in both positions

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › POST /api/tag-teams › should reject duplicate team creation

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › GET /api/tag-teams › should list all teams for the user

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › GET /api/tag-teams › should include robot details and readiness status

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › GET /api/tag-teams › should reject request without authentication

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › GET /api/tag-teams/:id › should get team details by ID

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › GET /api/tag-teams/:id › should get team details by ID

    TypeError: Cannot read properties of undefined (reading 'id')

      246 |         where: { stableId: testUserId },
      247 |       });
    > 248 |       teamId = teams[0].id;
          |                         ^
      249 |     });
      250 |
      251 |     it('should get team details by ID', async () => {

      at Object.<anonymous> (tests/tagTeams.test.ts:248:25)

  ● Tag Teams API Endpoints › GET /api/tag-teams/:id › should reject request for non-existent team

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › GET /api/tag-teams/:id › should reject request for non-existent team

    TypeError: Cannot read properties of undefined (reading 'id')

      246 |         where: { stableId: testUserId },
      247 |       });
    > 248 |       teamId = teams[0].id;
          |                         ^
      249 |     });
      250 |
      251 |     it('should get team details by ID', async () => {

      at Object.<anonymous> (tests/tagTeams.test.ts:248:25)

  ● Tag Teams API Endpoints › GET /api/tag-teams/:id › should reject request with invalid team ID

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › GET /api/tag-teams/:id › should reject request with invalid team ID

    TypeError: Cannot read properties of undefined (reading 'id')

      246 |         where: { stableId: testUserId },
      247 |       });
    > 248 |       teamId = teams[0].id;
          |                         ^
      249 |     });
      250 |
      251 |     it('should get team details by ID', async () => {

      at Object.<anonymous> (tests/tagTeams.test.ts:248:25)

  ● Tag Teams API Endpoints › DELETE /api/tag-teams/:id › should disband a team

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › DELETE /api/tag-teams/:id › should disband a team

    PrismaClientValidationError: 
    Invalid `prisma.tagTeam.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeams.test.ts:286:41

      283 
      284 beforeAll(async () => {
      285   // Create a team to delete
    → 286   const team = await prisma.tagTeam.create({
              data: {
                stableId: 38706,
                activeRobotId: undefined,
                reserveRobotId: undefined,
                tagTeamLeague: "bronze",
                tagTeamLeagueId: "bronze_1",
                tagTeamLeaguePoints: 0,
                cyclesInTagTeamLeague: 0,
                totalTagTeamWins: 0,
                totalTagTeamLosses: 0,
                totalTagTeamDraws: 0,
            +   stable: {
            +     create: UserCreateWithoutTagTeamsInput | UserUncheckedCreateWithoutTagTeamsInput,
            +     connectOrCreate: UserCreateOrConnectWithoutTagTeamsInput,
            +     connect: UserWhereUniqueInput
            +   }
              }
            })

    Argument `stable` is missing.

      284 |     beforeAll(async () => {
      285 |       // Create a team to delete
    > 286 |       const team = await prisma.tagTeam.create({
          |                    ^
      287 |         data: {
      288 |           stableId: testUserId,
      289 |           activeRobotId: robot2Id,

      at wn (node_modules/@prisma/client/runtime/library.js:29:1363)
      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:6958)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/tagTeams.test.ts:286:20)

  ● Tag Teams API Endpoints › DELETE /api/tag-teams/:id › should reject request for non-existent team

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › DELETE /api/tag-teams/:id › should reject request for non-existent team

    PrismaClientValidationError: 
    Invalid `prisma.tagTeam.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeams.test.ts:286:41

      283 
      284 beforeAll(async () => {
      285   // Create a team to delete
    → 286   const team = await prisma.tagTeam.create({
              data: {
                stableId: 38706,
                activeRobotId: undefined,
                reserveRobotId: undefined,
                tagTeamLeague: "bronze",
                tagTeamLeagueId: "bronze_1",
                tagTeamLeaguePoints: 0,
                cyclesInTagTeamLeague: 0,
                totalTagTeamWins: 0,
                totalTagTeamLosses: 0,
                totalTagTeamDraws: 0,
            +   stable: {
            +     create: UserCreateWithoutTagTeamsInput | UserUncheckedCreateWithoutTagTeamsInput,
            +     connectOrCreate: UserCreateOrConnectWithoutTagTeamsInput,
            +     connect: UserWhereUniqueInput
            +   }
              }
            })

    Argument `stable` is missing.

      284 |     beforeAll(async () => {
      285 |       // Create a team to delete
    > 286 |       const team = await prisma.tagTeam.create({
          |                    ^
      287 |         data: {
      288 |           stableId: testUserId,
      289 |           activeRobotId: robot2Id,

      at wn (node_modules/@prisma/client/runtime/library.js:29:1363)
      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:6958)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/tagTeams.test.ts:286:20)

  ● Tag Teams API Endpoints › DELETE /api/tag-teams/:id › should reject request with invalid team ID

    No weapons found in database. Run seed first.

      38 |     const weapon = await prisma.weapon.findFirst();
      39 |     if (!weapon) {
    > 40 |       throw new Error('No weapons found in database. Run seed first.');
         |             ^
      41 |     }
      42 |
      43 |     // Create test robots with battle readiness

      at Object.<anonymous> (tests/tagTeams.test.ts:40:13)

  ● Tag Teams API Endpoints › DELETE /api/tag-teams/:id › should reject request with invalid team ID

    PrismaClientValidationError: 
    Invalid `prisma.tagTeam.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeams.test.ts:286:41

      283 
      284 beforeAll(async () => {
      285   // Create a team to delete
    → 286   const team = await prisma.tagTeam.create({
              data: {
                stableId: 38706,
                activeRobotId: undefined,
                reserveRobotId: undefined,
                tagTeamLeague: "bronze",
                tagTeamLeagueId: "bronze_1",
                tagTeamLeaguePoints: 0,
                cyclesInTagTeamLeague: 0,
                totalTagTeamWins: 0,
                totalTagTeamLosses: 0,
                totalTagTeamDraws: 0,
            +   stable: {
            +     create: UserCreateWithoutTagTeamsInput | UserUncheckedCreateWithoutTagTeamsInput,
            +     connectOrCreate: UserCreateOrConnectWithoutTagTeamsInput,
            +     connect: UserWhereUniqueInput
            +   }
              }
            })

    Argument `stable` is missing.

      284 |     beforeAll(async () => {
      285 |       // Create a team to delete
    > 286 |       const team = await prisma.tagTeam.create({
          |                    ^
      287 |         data: {
      288 |           stableId: testUserId,
      289 |           activeRobotId: robot2Id,

      at wn (node_modules/@prisma/client/runtime/library.js:29:1363)
      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:6958)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/tagTeams.test.ts:286:20)

FAIL tests/tagTeamService.test.ts
  ● TagTeamService › validateTeam › should validate a team with two ready robots from same stable

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › validateTeam › should reject robots from different stables

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › validateTeam › should reject team with unready robot (low HP)

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › validateTeam › should reject duplicate teams

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › validateTeam › should reject duplicate teams in reverse order

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › validateTeam › should enforce roster limit (max teams = roster size / 2)

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › createTeam › should create a valid team

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › createTeam › should place new teams in Bronze league with initial values

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › createTeam › should return errors for invalid team

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › createTeam › should reject team creation if user does not own robots

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › getTeamById › should retrieve a team by ID

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › getTeamById › should include robot details in response

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › getTeamById › should return null for non-existent team

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › getTeamsByStable › should retrieve all teams for a stable

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › getTeamsByStable › should include robot details for all teams

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › getTeamsByStable › should return empty array for stable with no teams

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › disbandTeam › should disband a team

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › disbandTeam › should reject disbanding team from wrong stable

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › disbandTeam › should return false for non-existent team

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

  ● TagTeamService › disbandTeam › should make robots available for new teams after disbanding

    TypeError: Cannot read properties of null (reading 'id')

      115 |     // Create test weapons
      116 |     const weapon = await prisma.weapon.findFirst();
    > 117 |     const weaponId = weapon!.id;
          |                              ^
      118 |
      119 |     // Add weapons to inventory
      120 |     const [weapon1, weapon2, weapon3, weapon4, weapon5] = await Promise.all([

      at Object.<anonymous> (tests/tagTeamService.test.ts:117:30)

FAIL tests/tagTeamDatabaseSchema.test.ts
  ● Tag Team Database Schema Verification › TagTeam Model › should have check constraint for different robots

    expect(received).toContain(expected) // indexOf

    Expected value: "tag_teams_different_robots_check"
    Received array: []

      76 |
      77 |       const checkConstraints = constraints.map(c => c.conname);
    > 78 |       expect(checkConstraints).toContain('tag_teams_different_robots_check');
         |                                ^
      79 |     });
      80 |   });
      81 |

      at Object.<anonymous> (tests/tagTeamDatabaseSchema.test.ts:78:32)

FAIL tests/integration/bronzeLeagueRebalancing.test.ts
  ● Bronze League Rebalancing - Integration Test › should correctly rebalance 331 robots from single bronze instance into multiple instances

    PrismaClientKnownRequestError: 
    Invalid `prisma.robot.createMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/integration/bronzeLeagueRebalancing.test.ts:105:24

      102     maxShield: 2,
      103   });
      104 }
    → 105 await prisma.robot.createMany(
    Foreign key constraint violated: `robots_user_id_fkey (index)`

      103 |       });
      104 |     }
    > 105 |     await prisma.robot.createMany({ data: robots });
          |     ^
      106 |
      107 |     // Verify initial state - all robots in one instance
      108 |     const initialStats = await getLeagueInstanceStats('bronze');

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/integration/bronzeLeagueRebalancing.test.ts:105:5)

FAIL tests/matches.test.ts
  ● Matches Routes › GET /api/matches/upcoming › should get upcoming matches with auth

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |     
      29 |     // Create test user
      30 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/matches.test.ts:27:5)

  ● Matches Routes › GET /api/matches/upcoming › should return 401 without authentication

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |     
      29 |     // Create test user
      30 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/matches.test.ts:27:5)

  ● Matches Routes › GET /api/matches/upcoming › should return 403 with invalid token

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |     
      29 |     // Create test user
      30 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/matches.test.ts:27:5)

  ● Matches Routes › GET /api/matches/history › should get match history with auth

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |     
      29 |     // Create test user
      30 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/matches.test.ts:27:5)

  ● Matches Routes › GET /api/matches/history › should support pagination

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |     
      29 |     // Create test user
      30 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/matches.test.ts:27:5)

  ● Matches Routes › GET /api/matches/history › should filter by robot ID

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |     
      29 |     // Create test user
      30 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/matches.test.ts:27:5)

  ● Matches Routes › GET /api/matches/history › should return 401 without authentication

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |     
      29 |     // Create test user
      30 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/matches.test.ts:27:5)

  ● Matches Routes › GET /api/matches/battles/:id/log › should return 401 without authentication

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |     
      29 |     // Create test user
      30 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/matches.test.ts:27:5)

  ● Matches Routes › GET /api/matches/battles/:id/log › should return 403 with invalid token

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |     
      29 |     // Create test user
      30 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/matches.test.ts:27:5)

  ● Matches Routes › GET /api/matches/battles/:id/log › should handle non-existent battle ID with auth

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |     
      29 |     // Create test user
      30 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/matches.test.ts:27:5)

FAIL tests/tagTeamLeagueStandings.property.test.ts
  ● Tag Team League Standings Property Tests › should maintain independent 1v1 and tag team league standings

    TypeError: Cannot read properties of null (reading 'id')

      34 |     // Get a weapon for testing
      35 |     const weapon = await prisma.weapon.findFirst();
    > 36 |     weaponId = weapon!.id;
         |                        ^
      37 |   });
      38 |
      39 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamLeagueStandings.property.test.ts:36:24)

  ● Tag Team League Standings Property Tests › should not affect robot 1v1 standings when tag team league changes

    TypeError: Cannot read properties of null (reading 'id')

      34 |     // Get a weapon for testing
      35 |     const weapon = await prisma.weapon.findFirst();
    > 36 |     weaponId = weapon!.id;
         |                        ^
      37 |   });
      38 |
      39 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamLeagueStandings.property.test.ts:36:24)

  ● Tag Team League Standings Property Tests › should allow robots with different 1v1 leagues to be in the same tag team

    TypeError: Cannot read properties of null (reading 'id')

      34 |     // Get a weapon for testing
      35 |     const weapon = await prisma.weapon.findFirst();
    > 36 |     weaponId = weapon!.id;
         |                        ^
      37 |   });
      38 |
      39 |   afterAll(async () => {

      at Object.<anonymous> (tests/tagTeamLeagueStandings.property.test.ts:36:24)


  ● Test suite failed to run

    PrismaClientKnownRequestError: 
    Invalid `prisma.tagTeam.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeamLeagueStandings.property.test.ts:41:26

      38 
      39 afterAll(async () => {
      40   // Clean up test data
    → 41   await prisma.tagTeam.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already
    Prisma Accelerate has built-in connection pooling to prevent such errors: https://pris.ly/client/error-accelerate

      39 |   afterAll(async () => {
      40 |     // Clean up test data
    > 41 |     await prisma.tagTeam.deleteMany({
         |     ^
      42 |       where: { stableId: testUserId },
      43 |     });
      44 |     await prisma.robot.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/tagTeamLeagueStandings.property.test.ts:41:5)

FAIL tests/profileUpdate.test.ts
  ● Profile Update Endpoint › PUT /api/user/profile › should update stable name successfully

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should update profile visibility successfully

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should update notification preferences successfully

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should update theme preference successfully

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should update multiple fields at once

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should change password successfully with correct current password

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject password change with incorrect current password

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject password change without current password

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject stable name that is too short

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject stable name that is too long

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject stable name with invalid characters

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject stable name with profanity

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject duplicate stable name

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject weak password (too short)

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject weak password (no uppercase)

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject weak password (no lowercase)

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject weak password (no number)

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject invalid profile visibility value

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject invalid theme preference value

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject request without authentication token

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should reject request with invalid authentication token

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should preserve unchanged fields when updating partial data

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should return all profile fields in response

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should have default visibility set to public for new users

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

  ● Profile Update Endpoint › PUT /api/user/profile › should return 400 with validation errors for multiple invalid fields

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |     
      31 |     // Create a test user
      32 |     const passwordHash = await bcrypt.hash(testPassword, 10);

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/profileUpdate.test.ts:29:5)

FAIL tests/leagues.test.ts
  ● Leagues Routes › GET /api/leagues/:tier/standings › should get bronze league standings

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      24 |
      25 |   beforeAll(async () => {
    > 26 |     await prisma.$connect();
         |     ^
      27 |     
      28 |     // Create test user
      29 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leagues.test.ts:26:5)

  ● Leagues Routes › GET /api/leagues/:tier/standings › should get silver league standings

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      24 |
      25 |   beforeAll(async () => {
    > 26 |     await prisma.$connect();
         |     ^
      27 |     
      28 |     // Create test user
      29 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leagues.test.ts:26:5)

  ● Leagues Routes › GET /api/leagues/:tier/standings › should return 400 for invalid tier

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      24 |
      25 |   beforeAll(async () => {
    > 26 |     await prisma.$connect();
         |     ^
      27 |     
      28 |     // Create test user
      29 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leagues.test.ts:26:5)

  ● Leagues Routes › GET /api/leagues/:tier/standings › should support pagination

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      24 |
      25 |   beforeAll(async () => {
    > 26 |     await prisma.$connect();
         |     ^
      27 |     
      28 |     // Create test user
      29 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leagues.test.ts:26:5)

  ● Leagues Routes › GET /api/leagues/:tier/instances › should get bronze league instances

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      24 |
      25 |   beforeAll(async () => {
    > 26 |     await prisma.$connect();
         |     ^
      27 |     
      28 |     // Create test user
      29 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leagues.test.ts:26:5)

  ● Leagues Routes › GET /api/leagues/:tier/instances › should return 400 for invalid tier

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      24 |
      25 |   beforeAll(async () => {
    > 26 |     await prisma.$connect();
         |     ^
      27 |     
      28 |     // Create test user
      29 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leagues.test.ts:26:5)

FAIL tests/weapons.test.ts
  ● Weapons Routes › GET /api/weapons › should get all weapons with auth

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      24 |
      25 |   beforeAll(async () => {
    > 26 |     await prisma.$connect();
         |     ^
      27 |     
      28 |     // Create test user
      29 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/weapons.test.ts:26:5)

  ● Weapons Routes › GET /api/weapons › should return weapons sorted by cost

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      24 |
      25 |   beforeAll(async () => {
    > 26 |     await prisma.$connect();
         |     ^
      27 |     
      28 |     // Create test user
      29 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/weapons.test.ts:26:5)

  ● Weapons Routes › GET /api/weapons › should return 401 without authentication

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      24 |
      25 |   beforeAll(async () => {
    > 26 |     await prisma.$connect();
         |     ^
      27 |     
      28 |     // Create test user
      29 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/weapons.test.ts:26:5)

  ● Weapons Routes › GET /api/weapons › should return 403 with invalid token

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      24 |
      25 |   beforeAll(async () => {
    > 26 |     await prisma.$connect();
         |     ^
      27 |     
      28 |     // Create test user
      29 |     testUser = await createTestUser();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/weapons.test.ts:26:5)

FAIL tests/integration/tagTeamLeagueRebalancing.test.ts
  ● Tag Team League Rebalancing Integration Test › should promote top 10% and demote bottom 10% with varying league points

    No weapons found. Run seed first.

      28 |     const weapon = await prisma.weapon.findFirst();
      29 |     if (!weapon) {
    > 30 |       throw new Error('No weapons found. Run seed first.');
         |             ^
      31 |     }
      32 |
      33 |     // Create 20 test users (for 20 teams in bronze league)

      at Object.<anonymous> (tests/integration/tagTeamLeagueRebalancing.test.ts:30:13)

  ● Tag Team League Rebalancing Integration Test › should not promote/demote teams with < 5 cycles in tier

    No weapons found. Run seed first.

      28 |     const weapon = await prisma.weapon.findFirst();
      29 |     if (!weapon) {
    > 30 |       throw new Error('No weapons found. Run seed first.');
         |             ^
      31 |     }
      32 |
      33 |     // Create 20 test users (for 20 teams in bronze league)

      at Object.<anonymous> (tests/integration/tagTeamLeagueRebalancing.test.ts:30:13)

  ● Tag Team League Rebalancing Integration Test › should handle demotion from silver to bronze

    No weapons found. Run seed first.

      28 |     const weapon = await prisma.weapon.findFirst();
      29 |     if (!weapon) {
    > 30 |       throw new Error('No weapons found. Run seed first.');
         |             ^
      31 |     }
      32 |
      33 |     // Create 20 test users (for 20 teams in bronze league)

      at Object.<anonymous> (tests/integration/tagTeamLeagueRebalancing.test.ts:30:13)

  ● Tag Team League Rebalancing Integration Test › should handle minimum team count for rebalancing (< 10 teams)

    No weapons found. Run seed first.

      28 |     const weapon = await prisma.weapon.findFirst();
      29 |     if (!weapon) {
    > 30 |       throw new Error('No weapons found. Run seed first.');
         |             ^
      31 |     }
      32 |
      33 |     // Create 20 test users (for 20 teams in bronze league)

      at Object.<anonymous> (tests/integration/tagTeamLeagueRebalancing.test.ts:30:13)

FAIL tests/leaderboards.test.ts
  ● Leaderboards Routes › GET /api/leaderboards/fame › should get fame leaderboard

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      18 | describe('Leaderboards Routes', () => {
      19 |   beforeAll(async () => {
    > 20 |     await prisma.$connect();
         |     ^
      21 |   });
      22 |
      23 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leaderboards.test.ts:20:5)

  ● Leaderboards Routes › GET /api/leaderboards/fame › should support pagination

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      18 | describe('Leaderboards Routes', () => {
      19 |   beforeAll(async () => {
    > 20 |     await prisma.$connect();
         |     ^
      21 |   });
      22 |
      23 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leaderboards.test.ts:20:5)

  ● Leaderboards Routes › GET /api/leaderboards/fame › should filter by league

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      18 | describe('Leaderboards Routes', () => {
      19 |   beforeAll(async () => {
    > 20 |     await prisma.$connect();
         |     ^
      21 |   });
      22 |
      23 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leaderboards.test.ts:20:5)

  ● Leaderboards Routes › GET /api/leaderboards/fame › should filter by minimum battles

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      18 | describe('Leaderboards Routes', () => {
      19 |   beforeAll(async () => {
    > 20 |     await prisma.$connect();
         |     ^
      21 |   });
      22 |
      23 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leaderboards.test.ts:20:5)

  ● Leaderboards Routes › GET /api/leaderboards/losses › should get losses leaderboard

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      18 | describe('Leaderboards Routes', () => {
      19 |   beforeAll(async () => {
    > 20 |     await prisma.$connect();
         |     ^
      21 |   });
      22 |
      23 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leaderboards.test.ts:20:5)

  ● Leaderboards Routes › GET /api/leaderboards/losses › should support pagination

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      18 | describe('Leaderboards Routes', () => {
      19 |   beforeAll(async () => {
    > 20 |     await prisma.$connect();
         |     ^
      21 |   });
      22 |
      23 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leaderboards.test.ts:20:5)

  ● Leaderboards Routes › GET /api/leaderboards/prestige › should get prestige leaderboard

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      18 | describe('Leaderboards Routes', () => {
      19 |   beforeAll(async () => {
    > 20 |     await prisma.$connect();
         |     ^
      21 |   });
      22 |
      23 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leaderboards.test.ts:20:5)

  ● Leaderboards Routes › GET /api/leaderboards/prestige › should support pagination

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      18 | describe('Leaderboards Routes', () => {
      19 |   beforeAll(async () => {
    > 20 |     await prisma.$connect();
         |     ^
      21 |   });
      22 |
      23 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/leaderboards.test.ts:20:5)

FAIL tests/integration/tagTeamAutoRepair.test.ts
  ● Tag Team Auto-Repair Integration Test › should auto-repair damaged robots before battle and deduct costs

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |
      29 |     // Get a weapon for robots
      30 |     weapon = await prisma.weapon.findFirst();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/integration/tagTeamAutoRepair.test.ts:27:5)

  ● Tag Team Auto-Repair Integration Test › should allow users to go into negative currency for repairs

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |
      29 |     // Get a weapon for robots
      30 |     weapon = await prisma.weapon.findFirst();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/integration/tagTeamAutoRepair.test.ts:27:5)

FAIL tests/twoRobotTagTeamGeneration.test.ts
  ● Two-Robot Specialist Tag Team Generation › should create tag team for Two-Robot Specialist archetype (cycle 4, position 9)

    Practice Sword weapon not found. Run seed first.

      19 |
      20 |     if (!practiceSword) {
    > 21 |       throw new Error('Practice Sword weapon not found. Run seed first.');
         |             ^
      22 |     }
      23 |   });
      24 |

      at Object.<anonymous> (tests/twoRobotTagTeamGeneration.test.ts:21:13)

  ● Two-Robot Specialist Tag Team Generation › should create tag team for Two-Robot Specialist in cycle 1 (position 9 wraps to cycle 10)

    Practice Sword weapon not found. Run seed first.

      19 |
      20 |     if (!practiceSword) {
    > 21 |       throw new Error('Practice Sword weapon not found. Run seed first.');
         |             ^
      22 |     }
      23 |   });
      24 |

      at Object.<anonymous> (tests/twoRobotTagTeamGeneration.test.ts:21:13)

  ● Two-Robot Specialist Tag Team Generation › should not create tag teams for single-robot archetypes

    Practice Sword weapon not found. Run seed first.

      19 |
      20 |     if (!practiceSword) {
    > 21 |       throw new Error('Practice Sword weapon not found. Run seed first.');
         |             ^
      22 |     }
      23 |   });
      24 |

      at Object.<anonymous> (tests/twoRobotTagTeamGeneration.test.ts:21:13)

  ● Two-Robot Specialist Tag Team Generation › should create tag teams with correct robot assignments

    Practice Sword weapon not found. Run seed first.

      19 |
      20 |     if (!practiceSword) {
    > 21 |       throw new Error('Practice Sword weapon not found. Run seed first.');
         |             ^
      22 |     }
      23 |   });
      24 |

      at Object.<anonymous> (tests/twoRobotTagTeamGeneration.test.ts:21:13)

FAIL tests/tagTeamStreamingRevenue.test.ts
  ● Tag Team Streaming Revenue Integration › should calculate and award streaming revenue for Tag Team battles

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      27 |
      28 |   beforeAll(async () => {
    > 29 |     await prisma.$connect();
         |     ^
      30 |
      31 |     // Get a weapon for robots
      32 |     weapon = await prisma.weapon.findFirst();

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/tagTeamStreamingRevenue.test.ts:29:5)

  ● Tag Team Streaming Revenue Integration › should calculate and award streaming revenue for Tag Team battles

    PrismaClientInitializationError: 
    Invalid `prisma.tagTeamMatch.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/tagTeamStreamingRevenue.test.ts:119:31

      116 
      117 afterEach(async () => {
      118   // Clean up test data between tests (keep users and weapons from beforeAll)
    → 119   await prisma.tagTeamMatch.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      117 |   afterEach(async () => {
      118 |     // Clean up test data between tests (keep users and weapons from beforeAll)
    > 119 |     await prisma.tagTeamMatch.deleteMany({});
          |     ^
      120 |     await prisma.battleParticipant.deleteMany({});
      121 |     await prisma.battle.deleteMany({});
      122 |     await prisma.tagTeam.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/tagTeamStreamingRevenue.test.ts:119:5)

FAIL tests/matchmakingService.test.ts
  ● Matchmaking Service › checkBattleReadiness › should mark robot as ready when HP >= 75% and weapon equipped

    PrismaClientInitializationError: 
    Invalid `prisma.scheduledMatch.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/matchmakingService.test.ts:21:33

      18 
      19 beforeAll(async () => {
      20   // Clean up in correct order
    → 21   await prisma.scheduledMatch.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      19 |   beforeAll(async () => {
      20 |     // Clean up in correct order
    > 21 |     await prisma.scheduledMatch.deleteMany({});
         |     ^
      22 |     await prisma.battleParticipant.deleteMany({});
      23 |     await prisma.battle.deleteMany({});
      24 |     await prisma.tagTeamMatch.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/matchmakingService.test.ts:21:5)

  ● Matchmaking Service › checkBattleReadiness › should mark robot as not ready when HP < 75%

    PrismaClientInitializationError: 
    Invalid `prisma.scheduledMatch.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/matchmakingService.test.ts:21:33

      18 
      19 beforeAll(async () => {
      20   // Clean up in correct order
    → 21   await prisma.scheduledMatch.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      19 |   beforeAll(async () => {
      20 |     // Clean up in correct order
    > 21 |     await prisma.scheduledMatch.deleteMany({});
         |     ^
      22 |     await prisma.battleParticipant.deleteMany({});
      23 |     await prisma.battle.deleteMany({});
      24 |     await prisma.tagTeamMatch.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/matchmakingService.test.ts:21:5)

  ● Matchmaking Service › checkBattleReadiness › should mark robot as not ready when HP is at or below yield threshold

    PrismaClientInitializationError: 
    Invalid `prisma.scheduledMatch.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/matchmakingService.test.ts:21:33

      18 
      19 beforeAll(async () => {
      20   // Clean up in correct order
    → 21   await prisma.scheduledMatch.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      19 |   beforeAll(async () => {
      20 |     // Clean up in correct order
    > 21 |     await prisma.scheduledMatch.deleteMany({});
         |     ^
      22 |     await prisma.battleParticipant.deleteMany({});
      23 |     await prisma.battle.deleteMany({});
      24 |     await prisma.tagTeamMatch.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/matchmakingService.test.ts:21:5)

  ● Matchmaking Service › checkBattleReadiness › should mark robot as not ready when weapon not equipped

    PrismaClientInitializationError: 
    Invalid `prisma.scheduledMatch.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/matchmakingService.test.ts:21:33

      18 
      19 beforeAll(async () => {
      20   // Clean up in correct order
    → 21   await prisma.scheduledMatch.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      19 |   beforeAll(async () => {
      20 |     // Clean up in correct order
    > 21 |     await prisma.scheduledMatch.deleteMany({});
         |     ^
      22 |     await prisma.battleParticipant.deleteMany({});
      23 |     await prisma.battle.deleteMany({});
      24 |     await prisma.tagTeamMatch.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/matchmakingService.test.ts:21:5)

  ● Matchmaking Service › checkBattleReadiness › should check dual wield loadout correctly

    PrismaClientInitializationError: 
    Invalid `prisma.scheduledMatch.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/matchmakingService.test.ts:21:33

      18 
      19 beforeAll(async () => {
      20   // Clean up in correct order
    → 21   await prisma.scheduledMatch.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      19 |   beforeAll(async () => {
      20 |     // Clean up in correct order
    > 21 |     await prisma.scheduledMatch.deleteMany({});
         |     ^
      22 |     await prisma.battleParticipant.deleteMany({});
      23 |     await prisma.battle.deleteMany({});
      24 |     await prisma.tagTeamMatch.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/matchmakingService.test.ts:21:5)

  ● Matchmaking Service › runMatchmakingForTier › should create matches for available robots

    PrismaClientInitializationError: 
    Invalid `prisma.scheduledMatch.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/matchmakingService.test.ts:21:33

      18 
      19 beforeAll(async () => {
      20   // Clean up in correct order
    → 21   await prisma.scheduledMatch.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      19 |   beforeAll(async () => {
      20 |     // Clean up in correct order
    > 21 |     await prisma.scheduledMatch.deleteMany({});
         |     ^
      22 |     await prisma.battleParticipant.deleteMany({});
      23 |     await prisma.battle.deleteMany({});
      24 |     await prisma.tagTeamMatch.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/matchmakingService.test.ts:21:5)

  ● Matchmaking Service › runMatchmakingForTier › should create bye-match for odd number of robots

    PrismaClientInitializationError: 
    Invalid `prisma.scheduledMatch.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/matchmakingService.test.ts:21:33

      18 
      19 beforeAll(async () => {
      20   // Clean up in correct order
    → 21   await prisma.scheduledMatch.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      19 |   beforeAll(async () => {
      20 |     // Clean up in correct order
    > 21 |     await prisma.scheduledMatch.deleteMany({});
         |     ^
      22 |     await prisma.battleParticipant.deleteMany({});
      23 |     await prisma.battle.deleteMany({});
      24 |     await prisma.tagTeamMatch.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/matchmakingService.test.ts:21:5)

  ● Matchmaking Service › runMatchmakingForTier › should not create duplicate matches for already scheduled robots

    PrismaClientInitializationError: 
    Invalid `prisma.scheduledMatch.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/matchmakingService.test.ts:21:33

      18 
      19 beforeAll(async () => {
      20   // Clean up in correct order
    → 21   await prisma.scheduledMatch.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      19 |   beforeAll(async () => {
      20 |     // Clean up in correct order
    > 21 |     await prisma.scheduledMatch.deleteMany({});
         |     ^
      22 |     await prisma.battleParticipant.deleteMany({});
      23 |     await prisma.battle.deleteMany({});
      24 |     await prisma.tagTeamMatch.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/matchmakingService.test.ts:21:5)

  ● Matchmaking Service › runMatchmakingForTier › should skip robots that are not battle-ready

    PrismaClientInitializationError: 
    Invalid `prisma.scheduledMatch.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/matchmakingService.test.ts:21:33

      18 
      19 beforeAll(async () => {
      20   // Clean up in correct order
    → 21   await prisma.scheduledMatch.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      19 |   beforeAll(async () => {
      20 |     // Clean up in correct order
    > 21 |     await prisma.scheduledMatch.deleteMany({});
         |     ^
      22 |     await prisma.battleParticipant.deleteMany({});
      23 |     await prisma.battle.deleteMany({});
      24 |     await prisma.tagTeamMatch.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/matchmakingService.test.ts:21:5)

  ● Matchmaking Service › runMatchmaking (all tiers) › should run matchmaking across all tiers

    PrismaClientInitializationError: 
    Invalid `prisma.scheduledMatch.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/matchmakingService.test.ts:21:33

      18 
      19 beforeAll(async () => {
      20   // Clean up in correct order
    → 21   await prisma.scheduledMatch.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      19 |   beforeAll(async () => {
      20 |     // Clean up in correct order
    > 21 |     await prisma.scheduledMatch.deleteMany({});
         |     ^
      22 |     await prisma.battleParticipant.deleteMany({});
      23 |     await prisma.battle.deleteMany({});
      24 |     await prisma.tagTeamMatch.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/matchmakingService.test.ts:21:5)

FAIL tests/cycleSnapshotService.test.ts
  ● CycleSnapshotService › should create a cycle snapshot with cycle start and complete events

    PrismaClientInitializationError: 
    Invalid `prisma.cycleSnapshot.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSnapshotService.test.ts:18:32

      15 
      16 beforeAll(async () => {
      17   // Clean up any existing test data
    → 18   await prisma.cycleSnapshot.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      16 |   beforeAll(async () => {
      17 |     // Clean up any existing test data
    > 18 |     await prisma.cycleSnapshot.deleteMany({
         |     ^
      19 |       where: { cycleNumber: testCycleNumber },
      20 |     });
      21 |     await prisma.auditLog.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleSnapshotService.test.ts:18:5)

  ● CycleSnapshotService › should retrieve a snapshot by cycle number

    PrismaClientInitializationError: 
    Invalid `prisma.cycleSnapshot.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSnapshotService.test.ts:18:32

      15 
      16 beforeAll(async () => {
      17   // Clean up any existing test data
    → 18   await prisma.cycleSnapshot.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      16 |   beforeAll(async () => {
      17 |     // Clean up any existing test data
    > 18 |     await prisma.cycleSnapshot.deleteMany({
         |     ^
      19 |       where: { cycleNumber: testCycleNumber },
      20 |     });
      21 |     await prisma.auditLog.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleSnapshotService.test.ts:18:5)

  ● CycleSnapshotService › should return null for non-existent snapshot

    PrismaClientInitializationError: 
    Invalid `prisma.cycleSnapshot.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSnapshotService.test.ts:18:32

      15 
      16 beforeAll(async () => {
      17   // Clean up any existing test data
    → 18   await prisma.cycleSnapshot.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      16 |   beforeAll(async () => {
      17 |     // Clean up any existing test data
    > 18 |     await prisma.cycleSnapshot.deleteMany({
         |     ^
      19 |       where: { cycleNumber: testCycleNumber },
      20 |     });
      21 |     await prisma.auditLog.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleSnapshotService.test.ts:18:5)

  ● CycleSnapshotService › should retrieve snapshots for a range of cycles

    PrismaClientInitializationError: 
    Invalid `prisma.cycleSnapshot.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSnapshotService.test.ts:18:32

      15 
      16 beforeAll(async () => {
      17   // Clean up any existing test data
    → 18   await prisma.cycleSnapshot.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      16 |   beforeAll(async () => {
      17 |     // Clean up any existing test data
    > 18 |     await prisma.cycleSnapshot.deleteMany({
         |     ^
      19 |       where: { cycleNumber: testCycleNumber },
      20 |     });
      21 |     await prisma.auditLog.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleSnapshotService.test.ts:18:5)

  ● CycleSnapshotService › should throw error if cycle is incomplete (missing start event)

    PrismaClientInitializationError: 
    Invalid `prisma.cycleSnapshot.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSnapshotService.test.ts:18:32

      15 
      16 beforeAll(async () => {
      17   // Clean up any existing test data
    → 18   await prisma.cycleSnapshot.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      16 |   beforeAll(async () => {
      17 |     // Clean up any existing test data
    > 18 |     await prisma.cycleSnapshot.deleteMany({
         |     ^
      19 |       where: { cycleNumber: testCycleNumber },
      20 |     });
      21 |     await prisma.auditLog.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleSnapshotService.test.ts:18:5)

  ● CycleSnapshotService › should throw error if cycle is incomplete (missing complete event)

    PrismaClientInitializationError: 
    Invalid `prisma.cycleSnapshot.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSnapshotService.test.ts:18:32

      15 
      16 beforeAll(async () => {
      17   // Clean up any existing test data
    → 18   await prisma.cycleSnapshot.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      16 |   beforeAll(async () => {
      17 |     // Clean up any existing test data
    > 18 |     await prisma.cycleSnapshot.deleteMany({
         |     ^
      19 |       where: { cycleNumber: testCycleNumber },
      20 |     });
      21 |     await prisma.auditLog.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleSnapshotService.test.ts:18:5)

  ● CycleSnapshotService › should aggregate step durations from cycle step events

    PrismaClientInitializationError: 
    Invalid `prisma.cycleSnapshot.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSnapshotService.test.ts:18:32

      15 
      16 beforeAll(async () => {
      17   // Clean up any existing test data
    → 18   await prisma.cycleSnapshot.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      16 |   beforeAll(async () => {
      17 |     // Clean up any existing test data
    > 18 |     await prisma.cycleSnapshot.deleteMany({
         |     ^
      19 |       where: { cycleNumber: testCycleNumber },
      20 |     });
      21 |     await prisma.auditLog.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleSnapshotService.test.ts:18:5)


  ● Test suite failed to run

    PrismaClientInitializationError: 
    Invalid `prisma.cycleSnapshot.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleSnapshotService.test.ts:28:32

      25 
      26 afterAll(async () => {
      27   // Clean up test data
    → 28   await prisma.cycleSnapshot.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      26 |   afterAll(async () => {
      27 |     // Clean up test data
    > 28 |     await prisma.cycleSnapshot.deleteMany({
         |     ^
      29 |       where: { cycleNumber: testCycleNumber },
      30 |     });
      31 |     await prisma.auditLog.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleSnapshotService.test.ts:28:5)

FAIL tests/dataIntegrityService.test.ts
  ● DataIntegrityService › validateCycleIntegrity › should pass validation for a complete, valid cycle

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      13 |
      14 |   beforeAll(async () => {
    > 15 |     await prisma.$connect();
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/dataIntegrityService.test.ts:15:5)

  ● DataIntegrityService › validateCycleIntegrity › should detect missing cycle_start event

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      13 |
      14 |   beforeAll(async () => {
    > 15 |     await prisma.$connect();
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/dataIntegrityService.test.ts:15:5)

  ● DataIntegrityService › validateCycleIntegrity › should detect missing cycle_complete event

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      13 |
      14 |   beforeAll(async () => {
    > 15 |     await prisma.$connect();
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/dataIntegrityService.test.ts:15:5)

  ● DataIntegrityService › validateCycleIntegrity › should detect incomplete cycle steps

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      13 |
      14 |   beforeAll(async () => {
    > 15 |     await prisma.$connect();
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/dataIntegrityService.test.ts:15:5)

  ● DataIntegrityService › checkSequenceNumbers › should detect sequence number gaps

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      13 |
      14 |   beforeAll(async () => {
    > 15 |     await prisma.$connect();
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/dataIntegrityService.test.ts:15:5)

  ● DataIntegrityService › checkSequenceNumbers › should pass with continuous sequence numbers

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      13 |
      14 |   beforeAll(async () => {
    > 15 |     await prisma.$connect();
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/dataIntegrityService.test.ts:15:5)

  ● DataIntegrityService › checkCreditConsistency › should detect credit sum mismatch

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      13 |
      14 |   beforeAll(async () => {
    > 15 |     await prisma.$connect();
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/dataIntegrityService.test.ts:15:5)

  ● DataIntegrityService › checkCreditConsistency › should pass with matching credit sums

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      13 |
      14 |   beforeAll(async () => {
    > 15 |     await prisma.$connect();
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/dataIntegrityService.test.ts:15:5)

  ● DataIntegrityService › checkCreditConsistency › should allow 1 credit tolerance for rounding

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      13 |
      14 |   beforeAll(async () => {
    > 15 |     await prisma.$connect();
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/dataIntegrityService.test.ts:15:5)

  ● DataIntegrityService › validateCycleRange › should validate multiple cycles

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      13 |
      14 |   beforeAll(async () => {
    > 15 |     await prisma.$connect();
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/dataIntegrityService.test.ts:15:5)

  ● DataIntegrityService › getIntegritySummary › should provide summary of integrity issues

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      13 |
      14 |   beforeAll(async () => {
    > 15 |     await prisma.$connect();
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/dataIntegrityService.test.ts:15:5)

FAIL tests/integration/tagTeamMultiMatchCycle.test.ts
  ● Tag Team Multi-Match Cycle Integration Test › should handle robot in both 1v1 and tag team match with cumulative damage

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |
      29 |     // Initialize cycle metadata to odd cycle (so tag team matchmaking runs)
      30 |     await prisma.cycleMetadata.upsert({

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/integration/tagTeamMultiMatchCycle.test.ts:27:5)

  ● Tag Team Multi-Match Cycle Integration Test › should exclude unready robots from tag team match after 1v1 damage

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |
      29 |     // Initialize cycle metadata to odd cycle (so tag team matchmaking runs)
      30 |     await prisma.cycleMetadata.upsert({

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/integration/tagTeamMultiMatchCycle.test.ts:27:5)

  ● Tag Team Multi-Match Cycle Integration Test › should process matches in correct order: 1v1 first, then tag team

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      25 |
      26 |   beforeAll(async () => {
    > 27 |     await prisma.$connect();
         |     ^
      28 |
      29 |     // Initialize cycle metadata to odd cycle (so tag team matchmaking runs)
      30 |     await prisma.cycleMetadata.upsert({

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/integration/tagTeamMultiMatchCycle.test.ts:27:5)

FAIL tests/prestigeGates.test.ts
  ● Prestige Gates › Facility Config Prestige Requirements › Income Generator has correct prestige requirements

    expect(received).toBeDefined()

    Received: undefined

      89 |     test('Income Generator has correct prestige requirements', () => {
      90 |       const config = getFacilityConfig('income_generator');
    > 91 |       expect(config).toBeDefined();
         |                      ^
      92 |       expect(config?.prestigeRequirements).toEqual([0, 0, 0, 3000, 0, 0, 7500, 0, 15000, 0]);
      93 |     });
      94 |

      at Object.<anonymous> (tests/prestigeGates.test.ts:91:22)

FAIL tests/eventLogger.integration.test.ts
  ● EventLogger Integration › should successfully log events to the database

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/eventLogger.integration.test.ts:15:27

      12 
      13 beforeEach(async () => {
      14   // Clean up audit logs before each test
    → 15   await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      13 |   beforeEach(async () => {
      14 |     // Clean up audit logs before each test
    > 15 |     await prisma.auditLog.deleteMany({});
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/eventLogger.integration.test.ts:15:5)

  ● EventLogger Integration › should handle batch logging efficiently

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/eventLogger.integration.test.ts:15:27

      12 
      13 beforeEach(async () => {
      14   // Clean up audit logs before each test
    → 15   await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      13 |   beforeEach(async () => {
      14 |     // Clean up audit logs before each test
    > 15 |     await prisma.auditLog.deleteMany({});
         |     ^
      16 |   });
      17 |
      18 |   afterAll(async () => {

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/eventLogger.integration.test.ts:15:5)

FAIL tests/cycleCsvStreamingRevenue.property.test.ts
  ● Property 15: Cycle CSV Contains Streaming Revenue Column › should include streaming_revenue column in CSV export

    PrismaClientInitializationError: 
    Invalid `prisma.user.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleCsvStreamingRevenue.property.test.ts:95:37

      92 
      93 beforeAll(async () => {
      94   // Create test users
    → 95   const user1 = await prisma.user.create(
    Too many database connections opened: FATAL: sorry, too many clients already

      93 |   beforeAll(async () => {
      94 |     // Create test users
    > 95 |     const user1 = await prisma.user.create({
         |                   ^
      96 |       data: {
      97 |         username: `test_csv_user1_${Date.now()}`,
      98 |         passwordHash: 'test',

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleCsvStreamingRevenue.property.test.ts:95:19)

  ● Property 15: Cycle CSV Contains Streaming Revenue Column › should include streaming_revenue column in CSV export

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleCsvStreamingRevenue.property.test.ts:132:27

      129 
      130 // Cleanup - delete in correct order to avoid foreign key constraints
      131 // Clean up audit log entries for this test cycle
    → 132 await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      130 |     // Cleanup - delete in correct order to avoid foreign key constraints
      131 |     // Clean up audit log entries for this test cycle
    > 132 |     await prisma.auditLog.deleteMany({
          |     ^
      133 |       where: {
      134 |         cycleNumber: {
      135 |           gte: testCycleNumber,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleCsvStreamingRevenue.property.test.ts:132:5)

  ● Property 15: Cycle CSV Contains Streaming Revenue Column › should show ₡0 for bye matches in CSV

    PrismaClientInitializationError: 
    Invalid `prisma.user.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleCsvStreamingRevenue.property.test.ts:95:37

      92 
      93 beforeAll(async () => {
      94   // Create test users
    → 95   const user1 = await prisma.user.create(
    Too many database connections opened: FATAL: sorry, too many clients already

      93 |   beforeAll(async () => {
      94 |     // Create test users
    > 95 |     const user1 = await prisma.user.create({
         |                   ^
      96 |       data: {
      97 |         username: `test_csv_user1_${Date.now()}`,
      98 |         passwordHash: 'test',

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleCsvStreamingRevenue.property.test.ts:95:19)

  ● Property 15: Cycle CSV Contains Streaming Revenue Column › should show ₡0 for bye matches in CSV

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleCsvStreamingRevenue.property.test.ts:132:27

      129 
      130 // Cleanup - delete in correct order to avoid foreign key constraints
      131 // Clean up audit log entries for this test cycle
    → 132 await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      130 |     // Cleanup - delete in correct order to avoid foreign key constraints
      131 |     // Clean up audit log entries for this test cycle
    > 132 |     await prisma.auditLog.deleteMany({
          |     ^
      133 |       where: {
      134 |         cycleNumber: {
      135 |           gte: testCycleNumber,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleCsvStreamingRevenue.property.test.ts:132:5)

  ● Property 15: Cycle CSV Contains Streaming Revenue Column › should include streaming revenue for both winner and loser

    PrismaClientInitializationError: 
    Invalid `prisma.user.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleCsvStreamingRevenue.property.test.ts:95:37

      92 
      93 beforeAll(async () => {
      94   // Create test users
    → 95   const user1 = await prisma.user.create(
    Too many database connections opened: FATAL: sorry, too many clients already

      93 |   beforeAll(async () => {
      94 |     // Create test users
    > 95 |     const user1 = await prisma.user.create({
         |                   ^
      96 |       data: {
      97 |         username: `test_csv_user1_${Date.now()}`,
      98 |         passwordHash: 'test',

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleCsvStreamingRevenue.property.test.ts:95:19)

  ● Property 15: Cycle CSV Contains Streaming Revenue Column › should include streaming revenue for both winner and loser

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleCsvStreamingRevenue.property.test.ts:132:27

      129 
      130 // Cleanup - delete in correct order to avoid foreign key constraints
      131 // Clean up audit log entries for this test cycle
    → 132 await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      130 |     // Cleanup - delete in correct order to avoid foreign key constraints
      131 |     // Clean up audit log entries for this test cycle
    > 132 |     await prisma.auditLog.deleteMany({
          |     ^
      133 |       where: {
      134 |         cycleNumber: {
      135 |           gte: testCycleNumber,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleCsvStreamingRevenue.property.test.ts:132:5)


  ● Test suite failed to run

    PrismaClientInitializationError: 
    Invalid `prisma.user.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/cycleCsvStreamingRevenue.property.test.ts:185:23

      182 
      183 afterAll(async () => {
      184   // Final cleanup of users
    → 185   await prisma.user.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      183 |   afterAll(async () => {
      184 |     // Final cleanup of users
    > 185 |     await prisma.user.deleteMany({
          |     ^
      186 |       where: {
      187 |         OR: [{ id: testUserId1 }, { id: testUserId2 }],
      188 |       },

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/cycleCsvStreamingRevenue.property.test.ts:185:5)

FAIL tests/financialReportStreamingRevenue.test.ts
  ● Financial Report - Streaming Revenue Integration › should include streaming revenue in financial report

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      18 |
      19 |   beforeAll(async () => {
    > 20 |     await prisma.$connect();
         |     ^
      21 |   });
      22 |
      23 |   afterEach(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/financialReportStreamingRevenue.test.ts:20:5)

  ● Financial Report - Streaming Revenue Integration › should include streaming revenue in financial report

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/financialReportStreamingRevenue.test.ts:25:27

      22 
      23 afterEach(async () => {
      24   // Clean up test data between tests
    → 25   await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      23 |   afterEach(async () => {
      24 |     // Clean up test data between tests
    > 25 |     await prisma.auditLog.deleteMany({});
         |     ^
      26 |     await prisma.battleParticipant.deleteMany({});
      27 |     await prisma.battle.deleteMany({});
      28 |     await prisma.robot.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/financialReportStreamingRevenue.test.ts:25:5)

  ● Financial Report - Streaming Revenue Integration › should show zero streaming revenue when no battles occurred

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      18 |
      19 |   beforeAll(async () => {
    > 20 |     await prisma.$connect();
         |     ^
      21 |   });
      22 |
      23 |   afterEach(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/financialReportStreamingRevenue.test.ts:20:5)

  ● Financial Report - Streaming Revenue Integration › should show zero streaming revenue when no battles occurred

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/financialReportStreamingRevenue.test.ts:25:27

      22 
      23 afterEach(async () => {
      24   // Clean up test data between tests
    → 25   await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      23 |   afterEach(async () => {
      24 |     // Clean up test data between tests
    > 25 |     await prisma.auditLog.deleteMany({});
         |     ^
      26 |     await prisma.battleParticipant.deleteMany({});
      27 |     await prisma.battle.deleteMany({});
      28 |     await prisma.robot.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/financialReportStreamingRevenue.test.ts:25:5)

  ● Financial Report - Streaming Revenue Integration › should only count streaming revenue from user's own robots

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      18 |
      19 |   beforeAll(async () => {
    > 20 |     await prisma.$connect();
         |     ^
      21 |   });
      22 |
      23 |   afterEach(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/financialReportStreamingRevenue.test.ts:20:5)

  ● Financial Report - Streaming Revenue Integration › should only count streaming revenue from user's own robots

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/financialReportStreamingRevenue.test.ts:25:27

      22 
      23 afterEach(async () => {
      24   // Clean up test data between tests
    → 25   await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      23 |   afterEach(async () => {
      24 |     // Clean up test data between tests
    > 25 |     await prisma.auditLog.deleteMany({});
         |     ^
      26 |     await prisma.battleParticipant.deleteMany({});
      27 |     await prisma.battle.deleteMany({});
      28 |     await prisma.robot.deleteMany({

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/financialReportStreamingRevenue.test.ts:25:5)


  ● Test suite failed to run

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/financialReportStreamingRevenue.test.ts:42:27

      39 
      40 afterAll(async () => {
      41   // Final cleanup
    → 42   await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      40 |   afterAll(async () => {
      41 |     // Final cleanup
    > 42 |     await prisma.auditLog.deleteMany({});
         |     ^
      43 |     await prisma.battleParticipant.deleteMany({});
      44 |     await prisma.battle.deleteMany({});
      45 |     await prisma.robot.deleteMany({});

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/financialReportStreamingRevenue.test.ts:42:5)

FAIL tests/validation.test.ts
  ● Validation Service - Unit Tests › Stable Name Uniqueness Check › should return false when stable name is already taken by another user

    PrismaClientInitializationError: 
    Invalid `prisma.user.findFirst()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/validation.ts:68:42

      65  * Requirements: 1.6
      66  */
      67 export async function isStableNameUnique(name: string, userId: number): Promise<boolean> {
    → 68   const existingUser = await prisma.user.findFirst(
    Too many database connections opened: FATAL: sorry, too many clients already

      66 |  */
      67 | export async function isStableNameUnique(name: string, userId: number): Promise<boolean> {
    > 68 |   const existingUser = await prisma.user.findFirst({
         |                        ^
      69 |     where: {
      70 |       stableName: name,
      71 |       NOT: {

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at isStableNameUnique (src/utils/validation.ts:68:24)
      at Object.<anonymous> (tests/validation.test.ts:182:24)

  ● Validation Service - Unit Tests › Stable Name Uniqueness Check › should return true when stable name is not taken

    PrismaClientInitializationError: 
    Invalid `prisma.user.findFirst()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/validation.ts:68:42

      65  * Requirements: 1.6
      66  */
      67 export async function isStableNameUnique(name: string, userId: number): Promise<boolean> {
    → 68   const existingUser = await prisma.user.findFirst(
    Too many database connections opened: FATAL: sorry, too many clients already

      66 |  */
      67 | export async function isStableNameUnique(name: string, userId: number): Promise<boolean> {
    > 68 |   const existingUser = await prisma.user.findFirst({
         |                        ^
      69 |     where: {
      70 |       stableName: name,
      71 |       NOT: {

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at isStableNameUnique (src/utils/validation.ts:68:24)
      at Object.<anonymous> (tests/validation.test.ts:202:24)

  ● Validation Service - Unit Tests › Stable Name Uniqueness Check › should return true when stable name is owned by the current user

    PrismaClientInitializationError: 
    Invalid `prisma.user.findFirst()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/validation.ts:68:42

      65  * Requirements: 1.6
      66  */
      67 export async function isStableNameUnique(name: string, userId: number): Promise<boolean> {
    → 68   const existingUser = await prisma.user.findFirst(
    Too many database connections opened: FATAL: sorry, too many clients already

      66 |  */
      67 | export async function isStableNameUnique(name: string, userId: number): Promise<boolean> {
    > 68 |   const existingUser = await prisma.user.findFirst({
         |                        ^
      69 |     where: {
      70 |       stableName: name,
      71 |       NOT: {

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at isStableNameUnique (src/utils/validation.ts:68:24)
      at Object.<anonymous> (tests/validation.test.ts:223:24)

  ● Validation Service - Unit Tests › Stable Name Uniqueness Check › should be case-sensitive for uniqueness

    PrismaClientInitializationError: 
    Invalid `prisma.user.findFirst()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/utils/validation.ts:68:42

      65  * Requirements: 1.6
      66  */
      67 export async function isStableNameUnique(name: string, userId: number): Promise<boolean> {
    → 68   const existingUser = await prisma.user.findFirst(
    Too many database connections opened: FATAL: sorry, too many clients already

      66 |  */
      67 | export async function isStableNameUnique(name: string, userId: number): Promise<boolean> {
    > 68 |   const existingUser = await prisma.user.findFirst({
         |                        ^
      69 |     where: {
      70 |       stableName: name,
      71 |       NOT: {

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at isStableNameUnique (src/utils/validation.ts:68:24)
      at Object.<anonymous> (tests/validation.test.ts:256:24)

FAIL tests/repairCostMultiRobot.property.test.ts


  ● Test suite failed to run

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)

FAIL tests/auth.test.ts
  ● Authentication Endpoints › POST /api/auth/login › should successfully login with valid credentials

    expect(received).toBe(expected) // Object.is equality

    Expected: 200
    Received: 500

      106 |         });
      107 |
    > 108 |       expect(response.status).toBe(200);
          |                               ^
      109 |       expect(response.body).toHaveProperty('token');
      110 |       expect(response.body).toHaveProperty('user');
      111 |       

      at Object.<anonymous> (tests/auth.test.ts:108:31)

FAIL tests/facilityTransactionLogging.test.ts
  ● Facility Transaction Logging › should log facility_purchase event when purchasing a new facility

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      16 |
      17 |   beforeAll(async () => {
    > 18 |     await prisma.$connect();
         |     ^
      19 |   });
      20 |
      21 |   afterEach(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/facilityTransactionLogging.test.ts:18:5)

  ● Facility Transaction Logging › should log facility_purchase event when purchasing a new facility

    Property failed after 1 tests
    { seed: 443249998, path: "0:0:0", endOnFailure: true }
    Counterexample: [1,1]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.user.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/repairCostMultiRobot.property.test.ts:887:44

      884 fc.integer({ min: 1, max: 5 }), // number of damaged robots
      885 async (numHealthy, numDamaged) => {
      886   // Create test user for this iteration
    → 887   const user = await prisma.user.create(
    Too many database connections opened: FATAL: sorry, too many clients already
    Prisma Accelerate has built-in connection pooling to prevent such errors: https://pris.ly/client/error-accelerate

      885 |           async (numHealthy, numDamaged) => {
      886 |             // Create test user for this iteration
    > 887 |             const user = await prisma.user.create({
          |                          ^
      888 |               data: {
      889 |                 username: `rc_test_${Date.now()}_${Math.floor(Math.random() * 1000000)}`,
      890 |                 passwordHash: 'test_hash',

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at tests/repairCostMultiRobot.property.test.ts:887:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)

  ● Facility Transaction Logging › should log facility_purchase event when purchasing a new facility

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/facilityTransactionLogging.test.ts:23:27

      20 
      21 afterEach(async () => {
      22   // Clean up test data after each test
    → 23   await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      21 |   afterEach(async () => {
      22 |     // Clean up test data after each test
    > 23 |     await prisma.auditLog.deleteMany({
         |     ^
      24 |       where: {
      25 |         userId: testUserId,
      26 |         eventType: { in: ['facility_purchase', 'facility_upgrade'] },

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/facilityTransactionLogging.test.ts:23:5)

  ● Facility Transaction Logging › should log facility_upgrade event when upgrading an existing facility

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      16 |
      17 |   beforeAll(async () => {
    > 18 |     await prisma.$connect();
         |     ^
      19 |   });
      20 |
      21 |   afterEach(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/facilityTransactionLogging.test.ts:18:5)

  ● Facility Transaction Logging › should log facility_upgrade event when upgrading an existing facility

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/facilityTransactionLogging.test.ts:23:27

      20 
      21 afterEach(async () => {
      22   // Clean up test data after each test
    → 23   await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      21 |   afterEach(async () => {
      22 |     // Clean up test data after each test
    > 23 |     await prisma.auditLog.deleteMany({
         |     ^
      24 |       where: {
      25 |         userId: testUserId,
      26 |         eventType: { in: ['facility_purchase', 'facility_upgrade'] },

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/facilityTransactionLogging.test.ts:23:5)

  ● Facility Transaction Logging › should include all required fields in the event payload

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      16 |
      17 |   beforeAll(async () => {
    > 18 |     await prisma.$connect();
         |     ^
      19 |   });
      20 |
      21 |   afterEach(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/facilityTransactionLogging.test.ts:18:5)

  ● Facility Transaction Logging › should include all required fields in the event payload

    Property failed after 1 tests
    { seed: -1858135954, path: "0:0:0:0:0", endOnFailure: true }
    Counterexample: [1,1000,50,10]
    Shrunk 4 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.user.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/repairCostMultiRobot.property.test.ts:1025:44

      1022 fc.integer({ min: 10, max: 100 }), // hpPercent
      1023 async (repairBayLevel, sumOfAllAttributes, damagePercent, hpPercent) => {
      1024   // Create test user for this iteration
    → 1025   const user = await prisma.user.create(
    Too many database connections opened: FATAL: sorry, too many clients already
    Prisma Accelerate has built-in connection pooling to prevent such errors: https://pris.ly/client/error-accelerate

      1023 |           async (repairBayLevel, sumOfAllAttributes, damagePercent, hpPercent) => {
      1024 |             // Create test user for this iteration
    > 1025 |             const user = await prisma.user.create({
           |                          ^
      1026 |               data: {
      1027 |                 username: `rc_test_${Date.now()}_${Math.floor(Math.random() * 1000000)}`,
      1028 |                 passwordHash: 'test_hash',

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at tests/repairCostMultiRobot.property.test.ts:1025:26
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)

  ● Facility Transaction Logging › should include all required fields in the event payload

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/facilityTransactionLogging.test.ts:23:27

      20 
      21 afterEach(async () => {
      22   // Clean up test data after each test
    → 23   await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      21 |   afterEach(async () => {
      22 |     // Clean up test data after each test
    > 23 |     await prisma.auditLog.deleteMany({
         |     ^
      24 |       where: {
      25 |         userId: testUserId,
      26 |         eventType: { in: ['facility_purchase', 'facility_upgrade'] },

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/facilityTransactionLogging.test.ts:23:5)

  ● Facility Transaction Logging › should log events with correct cycle number

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      16 |
      17 |   beforeAll(async () => {
    > 18 |     await prisma.$connect();
         |     ^
      19 |   });
      20 |
      21 |   afterEach(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/facilityTransactionLogging.test.ts:18:5)

  ● Facility Transaction Logging › should log events with correct cycle number

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/facilityTransactionLogging.test.ts:23:27

      20 
      21 afterEach(async () => {
      22   // Clean up test data after each test
    → 23   await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      21 |   afterEach(async () => {
      22 |     // Clean up test data after each test
    > 23 |     await prisma.auditLog.deleteMany({
         |     ^
      24 |       where: {
      25 |         userId: testUserId,
      26 |         eventType: { in: ['facility_purchase', 'facility_upgrade'] },

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/facilityTransactionLogging.test.ts:23:5)

  ● Facility Transaction Logging › should distinguish between purchase and upgrade events

    PrismaClientInitializationError: Too many database connections opened: FATAL: sorry, too many clients already

      16 |
      17 |   beforeAll(async () => {
    > 18 |     await prisma.$connect();
         |     ^
      19 |   });
      20 |
      21 |   afterEach(async () => {

      at t (node_modules/@prisma/client/runtime/library.js:112:2488)
      at Object.<anonymous> (tests/facilityTransactionLogging.test.ts:18:5)

  ● Facility Transaction Logging › should distinguish between purchase and upgrade events

    PrismaClientInitializationError: 
    Invalid `prisma.auditLog.deleteMany()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/facilityTransactionLogging.test.ts:23:27

      20 
      21 afterEach(async () => {
      22   // Clean up test data after each test
    → 23   await prisma.auditLog.deleteMany(
    Too many database connections opened: FATAL: sorry, too many clients already

      21 |   afterEach(async () => {
      22 |     // Clean up test data after each test
    > 23 |     await prisma.auditLog.deleteMany({
         |     ^
      24 |       where: {
      25 |         userId: testUserId,
      26 |         eventType: { in: ['facility_purchase', 'facility_upgrade'] },

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7615)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at Object.<anonymous> (tests/facilityTransactionLogging.test.ts:23:5)


  ● Test suite failed to run

    Property failed after 1 tests
    { seed: 300705198, path: "0:0", endOnFailure: true }
    Counterexample: [1]
    Shrunk 1 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

  ● Test suite failed to run

    Property failed after 1 tests
    { seed: 66571471, path: "0:0", endOnFailure: true }
    Counterexample: [1,1]
    Shrunk 1 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

FAIL tests/integration/tagTeamByeHandling.test.ts
  ● Test suite failed to run

    [96mtests/integration/tagTeamByeHandling.test.ts[0m:[93m245[0m:[93m27[0m - [91merror[0m[90m TS2552: [0mCannot find name 'testRobots'. Did you mean 'testRobotIds'?

    [7m245[0m     const originalRobot = testRobots.find(r => r.id === realTeamId);
    [7m   [0m [91m                          ~~~~~~~~~~[0m

      [96mtests/integration/tagTeamByeHandling.test.ts[0m:[93m24[0m:[93m7[0m
        [7m24[0m   let testRobotIds: number[] = [];
        [7m  [0m [96m      ~~~~~~~~~~~~[0m
        'testRobotIds' is declared here.
    [96mtests/integration/tagTeamByeHandling.test.ts[0m:[93m245[0m:[93m43[0m - [91merror[0m[90m TS7006: [0mParameter 'r' implicitly has an 'any' type.

    [7m245[0m     const originalRobot = testRobots.find(r => r.id === realTeamId);
    [7m   [0m [91m                                          ~[0m
    [96mtests/integration/tagTeamByeHandling.test.ts[0m:[93m257[0m:[93m26[0m - [91merror[0m[90m TS2552: [0mCannot find name 'testUsers'. Did you mean 'testUserIds'?

    [7m257[0m     const originalUser = testUsers.find(u => u.id === user!.id);
    [7m   [0m [91m                         ~~~~~~~~~[0m

      [96mtests/integration/tagTeamByeHandling.test.ts[0m:[93m23[0m:[93m7[0m
        [7m23[0m   let testUserIds: number[] = [];
        [7m  [0m [96m      ~~~~~~~~~~~[0m
        'testUserIds' is declared here.
    [96mtests/integration/tagTeamByeHandling.test.ts[0m:[93m257[0m:[93m41[0m - [91merror[0m[90m TS7006: [0mParameter 'u' implicitly has an 'any' type.

    [7m257[0m     const originalUser = testUsers.find(u => u.id === user!.id);
    [7m   [0m [91m                                        ~[0m

FAIL tests/integration/tagTeamCompleteCycle.test.ts
  ● Test suite failed to run

    [96mtests/integration/tagTeamCompleteCycle.test.ts[0m:[93m300[0m:[93m25[0m - [91merror[0m[90m TS2552: [0mCannot find name 'testRobots'. Did you mean 'testRobotIds'?

    [7m300[0m         robot1Id: { in: testRobots.map(r => r.id) },
    [7m   [0m [91m                        ~~~~~~~~~~[0m

      [96mtests/integration/tagTeamCompleteCycle.test.ts[0m:[93m25[0m:[93m7[0m
        [7m25[0m   let testRobotIds: number[] = [];
        [7m  [0m [96m      ~~~~~~~~~~~~[0m
        'testRobotIds' is declared here.
    [96mtests/integration/tagTeamCompleteCycle.test.ts[0m:[93m300[0m:[93m40[0m - [91merror[0m[90m TS7006: [0mParameter 'r' implicitly has an 'any' type.

    [7m300[0m         robot1Id: { in: testRobots.map(r => r.id) },
    [7m   [0m [91m                                       ~[0m

FAIL tests/userGeneration.test.ts
  ● Test suite failed to run

    [96mtests/userGeneration.test.ts[0m:[93m148[0m:[93m56[0m - [91merror[0m[90m TS2554: [0mExpected 1 arguments, but got 2.

    [7m148[0m       const result = await generateBattleReadyUsers(5, cycleNumber);
    [7m   [0m [91m                                                       ~~~~~~~~~~~[0m
    [96mtests/userGeneration.test.ts[0m:[93m166[0m:[93m41[0m - [91merror[0m[90m TS2554: [0mExpected 1 arguments, but got 2.

    [7m166[0m       await generateBattleReadyUsers(3, cycleNumber);
    [7m   [0m [91m                                        ~~~~~~~~~~~[0m
    [96mtests/userGeneration.test.ts[0m:[93m181[0m:[93m41[0m - [91merror[0m[90m TS2554: [0mExpected 1 arguments, but got 2.

    [7m181[0m       await generateBattleReadyUsers(1, cycleNumber);
    [7m   [0m [91m                                        ~~~~~~~~~~~[0m
    [96mtests/userGeneration.test.ts[0m:[93m208[0m:[93m41[0m - [91merror[0m[90m TS2554: [0mExpected 1 arguments, but got 2.

    [7m208[0m       await generateBattleReadyUsers(2, cycleNumber);
    [7m   [0m [91m                                        ~~~~~~~~~~~[0m
    [96mtests/userGeneration.test.ts[0m:[93m229[0m:[93m41[0m - [91merror[0m[90m TS2554: [0mExpected 1 arguments, but got 2.

    [7m229[0m       await generateBattleReadyUsers(1, cycleNumber);
    [7m   [0m [91m                                        ~~~~~~~~~~~[0m
    [96mtests/userGeneration.test.ts[0m:[93m247[0m:[93m41[0m - [91merror[0m[90m TS2554: [0mExpected 1 arguments, but got 2.

    [7m247[0m       await generateBattleReadyUsers(3, cycleNumber);
    [7m   [0m [91m                                        ~~~~~~~~~~~[0m
    [96mtests/userGeneration.test.ts[0m:[93m263[0m:[93m41[0m - [91merror[0m[90m TS2554: [0mExpected 1 arguments, but got 2.

    [7m263[0m       await generateBattleReadyUsers(5, cycleNumber);
    [7m   [0m [91m                                        ~~~~~~~~~~~[0m
    [96mtests/userGeneration.test.ts[0m:[93m301[0m:[93m41[0m - [91merror[0m[90m TS2554: [0mExpected 1 arguments, but got 2.

    [7m301[0m       await generateBattleReadyUsers(3, cycleNumber);
    [7m   [0m [91m                                        ~~~~~~~~~~~[0m
    [96mtests/userGeneration.test.ts[0m:[93m327[0m:[93m56[0m - [91merror[0m[90m TS2554: [0mExpected 1 arguments, but got 2.

    [7m327[0m       const result = await generateBattleReadyUsers(3, cycleNumber);
    [7m   [0m [91m                                                       ~~~~~~~~~~~[0m
    [96mtests/userGeneration.test.ts[0m:[93m351[0m:[93m5[0m - [91merror[0m[90m TS1005: [0m',' expected.

    [7m351[0m     });
    [7m   [0m [91m    ~[0m
    [96mtests/userGeneration.test.ts[0m:[93m421[0m:[93m3[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

    [7m421[0m   });
    [7m   [0m [91m  ~[0m
    [96mtests/userGeneration.test.ts[0m:[93m421[0m:[93m4[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

    [7m421[0m   });
    [7m   [0m [91m   ~[0m
    [96mtests/userGeneration.test.ts[0m:[93m422[0m:[93m1[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

    [7m422[0m });
    [7m   [0m [91m~[0m
    [96mtests/userGeneration.test.ts[0m:[93m422[0m:[93m2[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

    [7m422[0m });
    [7m   [0m [91m ~[0m

FAIL tests/integration/repairCostConsistency.test.ts
  ● Test suite failed to run

    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m40[0m:[93m18[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'robot' does not exist in type 'WeaponInventoryWhereInput'.

    [7m40[0m         where: { robot: { id: { in: testRobotIds } } },
    [7m  [0m [91m                 ~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m148[0m:[93m24[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m148[0m           loadoutType: 'single',
    [7m   [0m [91m                       ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m149[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'mainWeaponId'.

    [7m149[0m           mainWeaponId: weaponInv.id,
    [7m   [0m [91m          ~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m149[0m:[93m25[0m - [91merror[0m[90m TS2304: [0mCannot find name 'weaponInv'.

    [7m149[0m           mainWeaponId: weaponInv.id,
    [7m   [0m [91m                        ~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m150[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'currentLeague'.

    [7m150[0m           currentLeague: 'bronze',
    [7m   [0m [91m          ~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m150[0m:[93m26[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m150[0m           currentLeague: 'bronze',
    [7m   [0m [91m                         ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m151[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'leagueId'.

    [7m151[0m           leagueId: 'bronze_1',
    [7m   [0m [91m          ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m151[0m:[93m21[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m151[0m           leagueId: 'bronze_1',
    [7m   [0m [91m                    ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m152[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'leaguePoints'.

    [7m152[0m           leaguePoints: 0,
    [7m   [0m [91m          ~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m152[0m:[93m25[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m152[0m           leaguePoints: 0,
    [7m   [0m [91m                        ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m153[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'cyclesInCurrentLeague'.

    [7m153[0m           cyclesInCurrentLeague: 0,
    [7m   [0m [91m          ~~~~~~~~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m153[0m:[93m34[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m153[0m           cyclesInCurrentLeague: 0,
    [7m   [0m [91m                                 ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m155[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'combatPower'.

    [7m155[0m           combatPower: 10,
    [7m   [0m [91m          ~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m155[0m:[93m24[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m155[0m           combatPower: 10,
    [7m   [0m [91m                       ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m156[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'targetingSystems'.

    [7m156[0m           targetingSystems: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m156[0m:[93m29[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m156[0m           targetingSystems: 10,
    [7m   [0m [91m                            ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m157[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'criticalSystems'.

    [7m157[0m           criticalSystems: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m157[0m:[93m28[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m157[0m           criticalSystems: 10,
    [7m   [0m [91m                           ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m158[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'penetration'.

    [7m158[0m           penetration: 10,
    [7m   [0m [91m          ~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m158[0m:[93m24[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m158[0m           penetration: 10,
    [7m   [0m [91m                       ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m159[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'weaponControl'.

    [7m159[0m           weaponControl: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m159[0m:[93m26[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m159[0m           weaponControl: 10,
    [7m   [0m [91m                         ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m160[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'attackSpeed'.

    [7m160[0m           attackSpeed: 10,
    [7m   [0m [91m          ~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m160[0m:[93m24[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m160[0m           attackSpeed: 10,
    [7m   [0m [91m                       ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m161[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'armorPlating'.

    [7m161[0m           armorPlating: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m161[0m:[93m25[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m161[0m           armorPlating: 10,
    [7m   [0m [91m                        ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m162[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'shieldCapacity'.

    [7m162[0m           shieldCapacity: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m162[0m:[93m27[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m162[0m           shieldCapacity: 10,
    [7m   [0m [91m                          ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m163[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'evasionThrusters'.

    [7m163[0m           evasionThrusters: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m163[0m:[93m29[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m163[0m           evasionThrusters: 10,
    [7m   [0m [91m                            ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m164[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'damageDampeners'.

    [7m164[0m           damageDampeners: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m164[0m:[93m28[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m164[0m           damageDampeners: 10,
    [7m   [0m [91m                           ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m165[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'counterProtocols'.

    [7m165[0m           counterProtocols: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m165[0m:[93m29[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m165[0m           counterProtocols: 10,
    [7m   [0m [91m                            ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m166[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'hullIntegrity'.

    [7m166[0m           hullIntegrity: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m166[0m:[93m26[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m166[0m           hullIntegrity: 10,
    [7m   [0m [91m                         ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m167[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'servoMotors'.

    [7m167[0m           servoMotors: 10,
    [7m   [0m [91m          ~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m167[0m:[93m24[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m167[0m           servoMotors: 10,
    [7m   [0m [91m                       ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m168[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'gyroStabilizers'.

    [7m168[0m           gyroStabilizers: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m168[0m:[93m28[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m168[0m           gyroStabilizers: 10,
    [7m   [0m [91m                           ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m169[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'hydraulicSystems'.

    [7m169[0m           hydraulicSystems: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m169[0m:[93m29[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m169[0m           hydraulicSystems: 10,
    [7m   [0m [91m                            ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m170[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'powerCore'.

    [7m170[0m           powerCore: 10,
    [7m   [0m [91m          ~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m170[0m:[93m22[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m170[0m           powerCore: 10,
    [7m   [0m [91m                     ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m171[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'combatAlgorithms'.

    [7m171[0m           combatAlgorithms: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m171[0m:[93m29[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m171[0m           combatAlgorithms: 10,
    [7m   [0m [91m                            ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m172[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'threatAnalysis'.

    [7m172[0m           threatAnalysis: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m172[0m:[93m27[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m172[0m           threatAnalysis: 10,
    [7m   [0m [91m                          ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m173[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'adaptiveAI'.

    [7m173[0m           adaptiveAI: 10,
    [7m   [0m [91m          ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m173[0m:[93m23[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m173[0m           adaptiveAI: 10,
    [7m   [0m [91m                      ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m174[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'logicCores'.

    [7m174[0m           logicCores: 10,
    [7m   [0m [91m          ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m174[0m:[93m23[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m174[0m           logicCores: 10,
    [7m   [0m [91m                      ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m175[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'syncProtocols'.

    [7m175[0m           syncProtocols: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m175[0m:[93m26[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m175[0m           syncProtocols: 10,
    [7m   [0m [91m                         ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m176[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'supportSystems'.

    [7m176[0m           supportSystems: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m176[0m:[93m27[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m176[0m           supportSystems: 10,
    [7m   [0m [91m                          ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m177[0m:[93m11[0m - [91merror[0m[90m TS2304: [0mCannot find name 'formationTactics'.

    [7m177[0m           formationTactics: 10,
    [7m   [0m [91m          ~~~~~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m177[0m:[93m29[0m - [91merror[0m[90m TS2695: [0mLeft side of comma operator is unused and has no side effects.

    [7m177[0m           formationTactics: 10,
    [7m   [0m [91m                            ~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m180[0m:[93m7[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m180[0m       testRobots.push(robot);
    [7m   [0m [91m      ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m180[0m:[93m23[0m - [91merror[0m[90m TS2448: [0mBlock-scoped variable 'robot' used before its declaration.

    [7m180[0m       testRobots.push(robot);
    [7m   [0m [91m                      ~~~~~[0m

      [96mtests/integration/repairCostConsistency.test.ts[0m:[93m212[0m:[93m11[0m
        [7m212[0m     const robot = testRobots[0];
        [7m   [0m [96m          ~~~~~[0m
        'robot' is declared here.
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m181[0m:[93m7[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobotIds'.

    [7m181[0m       testRobotIds.push(robot.id);
    [7m   [0m [91m      ~~~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m181[0m:[93m25[0m - [91merror[0m[90m TS2448: [0mBlock-scoped variable 'robot' used before its declaration.

    [7m181[0m       testRobotIds.push(robot.id);
    [7m   [0m [91m                        ~~~~~[0m

      [96mtests/integration/repairCostConsistency.test.ts[0m:[93m212[0m:[93m11[0m
        [7m212[0m     const robot = testRobots[0];
        [7m   [0m [96m          ~~~~~[0m
        'robot' is declared here.
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m187[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m187[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m194[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m194[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m202[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m202[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m212[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m212[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m254[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m254[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m261[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m261[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m269[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m269[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m275[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m275[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m321[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m321[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m328[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m328[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m336[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m336[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m342[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m342[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m384[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m384[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m389[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m389[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m441[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m441[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m480[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m480[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m496[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m496[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m529[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m529[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m535[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m535[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m542[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m542[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m549[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m549[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m608[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m608[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m614[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m614[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m621[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m621[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m628[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m628[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m685[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m685[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m691[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m691[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m698[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m698[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m706[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m706[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m772[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m772[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m778[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m778[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m785[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m785[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m792[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m792[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m836[0m:[93m19[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testRobots'.

    [7m836[0m     const robot = testRobots[0];
    [7m   [0m [91m                  ~~~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m842[0m:[93m17[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUser'.

    [7m842[0m         userId: testUser.id,
    [7m   [0m [91m                ~~~~~~~~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m149[0m:[93m23[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m149[0m           mainWeaponId: weaponInv.id,
    [7m   [0m [91m                      ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m150[0m:[93m24[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m150[0m           currentLeague: 'bronze',
    [7m   [0m [91m                       ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m151[0m:[93m19[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m151[0m           leagueId: 'bronze_1',
    [7m   [0m [91m                  ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m152[0m:[93m23[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m152[0m           leaguePoints: 0,
    [7m   [0m [91m                      ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m153[0m:[93m32[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m153[0m           cyclesInCurrentLeague: 0,
    [7m   [0m [91m                               ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m155[0m:[93m22[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m155[0m           combatPower: 10,
    [7m   [0m [91m                     ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m156[0m:[93m27[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m156[0m           targetingSystems: 10,
    [7m   [0m [91m                          ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m157[0m:[93m26[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m157[0m           criticalSystems: 10,
    [7m   [0m [91m                         ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m158[0m:[93m22[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m158[0m           penetration: 10,
    [7m   [0m [91m                     ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m159[0m:[93m24[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m159[0m           weaponControl: 10,
    [7m   [0m [91m                       ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m160[0m:[93m22[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m160[0m           attackSpeed: 10,
    [7m   [0m [91m                     ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m161[0m:[93m23[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m161[0m           armorPlating: 10,
    [7m   [0m [91m                      ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m162[0m:[93m25[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m162[0m           shieldCapacity: 10,
    [7m   [0m [91m                        ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m163[0m:[93m27[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m163[0m           evasionThrusters: 10,
    [7m   [0m [91m                          ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m164[0m:[93m26[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m164[0m           damageDampeners: 10,
    [7m   [0m [91m                         ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m165[0m:[93m27[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m165[0m           counterProtocols: 10,
    [7m   [0m [91m                          ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m166[0m:[93m24[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m166[0m           hullIntegrity: 10,
    [7m   [0m [91m                       ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m167[0m:[93m22[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m167[0m           servoMotors: 10,
    [7m   [0m [91m                     ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m168[0m:[93m26[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m168[0m           gyroStabilizers: 10,
    [7m   [0m [91m                         ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m169[0m:[93m27[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m169[0m           hydraulicSystems: 10,
    [7m   [0m [91m                          ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m170[0m:[93m20[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m170[0m           powerCore: 10,
    [7m   [0m [91m                   ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m171[0m:[93m27[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m171[0m           combatAlgorithms: 10,
    [7m   [0m [91m                          ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m172[0m:[93m25[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m172[0m           threatAnalysis: 10,
    [7m   [0m [91m                        ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m173[0m:[93m21[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m173[0m           adaptiveAI: 10,
    [7m   [0m [91m                    ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m174[0m:[93m21[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m174[0m           logicCores: 10,
    [7m   [0m [91m                    ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m175[0m:[93m24[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m175[0m           syncProtocols: 10,
    [7m   [0m [91m                       ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m176[0m:[93m25[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m176[0m           supportSystems: 10,
    [7m   [0m [91m                        ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m177[0m:[93m27[0m - [91merror[0m[90m TS1005: [0m';' expected.

    [7m177[0m           formationTactics: 10,
    [7m   [0m [91m                          ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m178[0m:[93m9[0m - [91merror[0m[90m TS1109: [0mExpression expected.

    [7m178[0m         },
    [7m   [0m [91m        ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m179[0m:[93m7[0m - [91merror[0m[90m TS1135: [0mArgument expression expected.

    [7m179[0m       });
    [7m   [0m [91m      ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m182[0m:[93m5[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

    [7m182[0m     }
    [7m   [0m [91m    ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m248[0m:[93m3[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

    [7m248[0m   });
    [7m   [0m [91m  ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m248[0m:[93m4[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

    [7m248[0m   });
    [7m   [0m [91m   ~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m894[0m:[93m1[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

    [7m894[0m });
    [7m   [0m [91m~[0m
    [96mtests/integration/repairCostConsistency.test.ts[0m:[93m894[0m:[93m2[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

    [7m894[0m });
    [7m   [0m [91m ~[0m

FAIL tests/stanceAndYield.test.ts
  ● Test suite failed to run

    [96mtests/stanceAndYield.test.ts[0m:[93m13[0m:[93m65[0m - [91merror[0m[90m TS2322: [0mType '{ name: string; id: number; userId: number; frameId: number; paintJob: string | null; combatPower: Prisma.Decimal; targetingSystems: Prisma.Decimal; criticalSystems: Prisma.Decimal; ... 55 more ...; updatedAt: Date; }' is not assignable to type '{ name: string; id: number; userId: number; frameId: number; paintJob: string | null; combatPower: Decimal; targetingSystems: Decimal; criticalSystems: Decimal; ... 55 more ...; updatedAt: Date; }'.
      Types of property 'totalTagTeamBattles' are incompatible.
        Type 'number | undefined' is not assignable to type 'number'.
          Type 'undefined' is not assignable to type 'number'.

    [7m 13[0m const createMockRobot = (overrides?: Partial<Robot>): Robot => ({
    [7m   [0m [91m                                                                ~[0m
    [7m 14[0m   id: 1,
    [7m   [0m [91m~~~~~~~~[0m
    [7m...[0m 
    [7m 71[0m   ...overrides,
    [7m   [0m [91m~~~~~~~~~~~~~~~[0m
    [7m 72[0m });
    [7m   [0m [91m~[0m

FAIL tests/tagTeamModelIntegration.test.ts
  ● Test suite failed to run

    [96mtests/tagTeamModelIntegration.test.ts[0m:[93m307[0m:[93m14[0m - [91merror[0m[90m TS18047: [0m'match.team2' is possibly 'null'.

    [7m307[0m       expect(match?.team2.activeRobot.id).toBe(testRobot3Id);
    [7m   [0m [91m             ~~~~~~~~~~~~[0m
    [96mtests/tagTeamModelIntegration.test.ts[0m:[93m308[0m:[93m14[0m - [91merror[0m[90m TS18047: [0m'match.team2' is possibly 'null'.

    [7m308[0m       expect(match?.team2.reserveRobot.id).toBe(testRobot4Id);
    [7m   [0m [91m             ~~~~~~~~~~~~[0m

FAIL tests/robotCalculations.test.ts
  ● Test suite failed to run

    [96mtests/robotCalculations.test.ts[0m:[93m12[0m:[93m65[0m - [91merror[0m[90m TS2322: [0mType '{ name: string; id: number; userId: number; frameId: number; paintJob: string | null; combatPower: Prisma.Decimal; targetingSystems: Prisma.Decimal; criticalSystems: Prisma.Decimal; ... 55 more ...; updatedAt: Date; }' is not assignable to type '{ name: string; id: number; userId: number; frameId: number; paintJob: string | null; combatPower: Decimal; targetingSystems: Decimal; criticalSystems: Decimal; ... 55 more ...; updatedAt: Date; }'.
      Types of property 'totalTagTeamBattles' are incompatible.
        Type 'number | undefined' is not assignable to type 'number'.
          Type 'undefined' is not assignable to type 'number'.

    [7m 12[0m const createMockRobot = (overrides?: Partial<Robot>): Robot => ({
    [7m   [0m [91m                                                                ~[0m
    [7m 13[0m   id: 1,
    [7m   [0m [91m~~~~~~~~[0m
    [7m...[0m 
    [7m 70[0m   ...overrides,
    [7m   [0m [91m~~~~~~~~~~~~~~~[0m
    [7m 71[0m });
    [7m   [0m [91m~[0m

FAIL tests/robotStatsView.test.ts
  ● Test suite failed to run

    [96mtests/robotStatsView.test.ts[0m:[93m79[0m:[93m11[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m79[0m           userId: testUserId,
    [7m  [0m [91m          ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/robotStatsView.test.ts[0m:[93m113[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m113[0m         userId: testUserId,
    [7m   [0m [91m        ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'

FAIL tests/trendAnalysis.property.test.ts
  ● Test suite failed to run

    [96mtests/trendAnalysis.property.test.ts[0m:[93m12[0m:[93m38[0m - [91merror[0m[90m TS2307: [0mCannot find module '../src/services/trendAnalysisService' or its corresponding type declarations.

    [7m12[0m import { trendAnalysisService } from '../src/services/trendAnalysisService';
    [7m  [0m [91m                                     ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96mtests/trendAnalysis.property.test.ts[0m:[93m192[0m:[93m59[0m - [91merror[0m[90m TS7006: [0mParameter 'd' implicitly has an 'any' type.

    [7m192[0m             const cycleNumbersInData = trendData.data.map(d => d.cycleNumber).sort((a, b) => a - b);
    [7m   [0m [91m                                                          ~[0m
    [96mtests/trendAnalysis.property.test.ts[0m:[93m192[0m:[93m85[0m - [91merror[0m[90m TS7006: [0mParameter 'a' implicitly has an 'any' type.

    [7m192[0m             const cycleNumbersInData = trendData.data.map(d => d.cycleNumber).sort((a, b) => a - b);
    [7m   [0m [91m                                                                                    ~[0m
    [96mtests/trendAnalysis.property.test.ts[0m:[93m192[0m:[93m88[0m - [91merror[0m[90m TS7006: [0mParameter 'b' implicitly has an 'any' type.

    [7m192[0m             const cycleNumbersInData = trendData.data.map(d => d.cycleNumber).sort((a, b) => a - b);
    [7m   [0m [91m                                                                                       ~[0m
    [96mtests/trendAnalysis.property.test.ts[0m:[93m203[0m:[93m53[0m - [91merror[0m[90m TS7006: [0mParameter 'd' implicitly has an 'any' type.

    [7m203[0m               const dataPoint = trendData.data.find(d => d.cycleNumber === startCycle + i);
    [7m   [0m [91m                                                    ~[0m
    [96mtests/trendAnalysis.property.test.ts[0m:[93m260[0m:[93m19[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'user' does not exist in type 'Without<BattleUncheckedCreateInput, BattleCreateInput> & BattleCreateInput'.

    [7m260[0m                   user: { connect: { id: user.id } },
    [7m   [0m [91m                  ~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/trendAnalysis.property.test.ts[0m:[93m318[0m:[93m59[0m - [91merror[0m[90m TS7006: [0mParameter 'd' implicitly has an 'any' type.

    [7m318[0m             const cycleNumbersInData = trendData.data.map(d => d.cycleNumber).sort((a, b) => a - b);
    [7m   [0m [91m                                                          ~[0m
    [96mtests/trendAnalysis.property.test.ts[0m:[93m318[0m:[93m85[0m - [91merror[0m[90m TS7006: [0mParameter 'a' implicitly has an 'any' type.

    [7m318[0m             const cycleNumbersInData = trendData.data.map(d => d.cycleNumber).sort((a, b) => a - b);
    [7m   [0m [91m                                                                                    ~[0m
    [96mtests/trendAnalysis.property.test.ts[0m:[93m318[0m:[93m88[0m - [91merror[0m[90m TS7006: [0mParameter 'b' implicitly has an 'any' type.

    [7m318[0m             const cycleNumbersInData = trendData.data.map(d => d.cycleNumber).sort((a, b) => a - b);
    [7m   [0m [91m                                                                                       ~[0m
    [96mtests/trendAnalysis.property.test.ts[0m:[93m329[0m:[93m53[0m - [91merror[0m[90m TS7006: [0mParameter 'd' implicitly has an 'any' type.

    [7m329[0m               const dataPoint = trendData.data.find(d => d.cycleNumber === startCycle + i);
    [7m   [0m [91m                                                    ~[0m
    [96mtests/trendAnalysis.property.test.ts[0m:[93m419[0m:[93m59[0m - [91merror[0m[90m TS7006: [0mParameter 'd' implicitly has an 'any' type.

    [7m419[0m             const cycleNumbersInData = trendData.data.map(d => d.cycleNumber);
    [7m   [0m [91m                                                          ~[0m

FAIL tests/tagTeamBattleLogCompleteness.property.test.ts
  ● Test suite failed to run

    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m65[0m:[93m13[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'BattleWhereInput'.

    [7m65[0m           { userId: testUserId1 },
    [7m  [0m [91m            ~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m66[0m:[93m13[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'BattleWhereInput'.

    [7m66[0m           { userId: testUserId2 },
    [7m  [0m [91m            ~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m125[0m:[93m13[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'BattleWhereInput'.

    [7m125[0m           { userId: testUserId1 },
    [7m   [0m [91m            ~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m125[0m:[93m21[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m125[0m           { userId: testUserId1 },
    [7m   [0m [91m                    ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m126[0m:[93m13[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'BattleWhereInput'.

    [7m126[0m           { userId: testUserId2 },
    [7m   [0m [91m            ~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m126[0m:[93m21[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m126[0m           { userId: testUserId2 },
    [7m   [0m [91m                    ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m133[0m:[93m32[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m133[0m           { team1: { stableId: testUserId1 } },
    [7m   [0m [91m                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m134[0m:[93m32[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m134[0m           { team1: { stableId: testUserId2 } },
    [7m   [0m [91m                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m135[0m:[93m32[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m135[0m           { team2: { stableId: testUserId1 } },
    [7m   [0m [91m                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m136[0m:[93m32[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m136[0m           { team2: { stableId: testUserId2 } },
    [7m   [0m [91m                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m143[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m143[0m           { stableId: testUserId1 },
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m144[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m144[0m           { stableId: testUserId2 },
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m151[0m:[93m21[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m151[0m           { userId: testUserId1 },
    [7m   [0m [91m                    ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m152[0m:[93m21[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m152[0m           { userId: testUserId2 },
    [7m   [0m [91m                    ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m159[0m:[93m21[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m159[0m           { userId: testUserId1 },
    [7m   [0m [91m                    ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m160[0m:[93m21[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m160[0m           { userId: testUserId2 },
    [7m   [0m [91m                    ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m186[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m186[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m186[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m186[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m189[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m189[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m189[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m189[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m192[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m192[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m192[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m192[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m195[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m195[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m195[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m195[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m201[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m201[0m               userId: testUserId1,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m216[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m216[0m               userId: testUserId1,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m232[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m232[0m               userId: testUserId2,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m247[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m247[0m               userId: testUserId2,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m261[0m:[93m48[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m261[0m           const team1Result = await createTeam(testUserId1, robot1.id, robot2.id);
    [7m   [0m [91m                                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m262[0m:[93m48[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m262[0m           const team2Result = await createTeam(testUserId2, robot3.id, robot4.id);
    [7m   [0m [91m                                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m337[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m337[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m337[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m337[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m340[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m340[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m340[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m340[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m343[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m343[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m343[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m343[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m346[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m346[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m346[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m346[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m352[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m352[0m               userId: testUserId1,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m367[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m367[0m               userId: testUserId1,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m382[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m382[0m               userId: testUserId2,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m397[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m397[0m               userId: testUserId2,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m411[0m:[93m48[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m411[0m           const team1Result = await createTeam(testUserId1, robot1.id, robot2.id);
    [7m   [0m [91m                                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m412[0m:[93m48[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m412[0m           const team2Result = await createTeam(testUserId2, robot3.id, robot4.id);
    [7m   [0m [91m                                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m492[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m492[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m492[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m492[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m495[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m495[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m495[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m495[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m498[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m498[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m498[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m498[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m501[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m501[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m501[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m501[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m507[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m507[0m               userId: testUserId1,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m522[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m522[0m               userId: testUserId1,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m537[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m537[0m               userId: testUserId2,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m552[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m552[0m               userId: testUserId2,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m566[0m:[93m48[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m566[0m           const team1Result = await createTeam(testUserId1, robot1.id, robot2.id);
    [7m   [0m [91m                                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m567[0m:[93m48[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m567[0m           const team2Result = await createTeam(testUserId2, robot3.id, robot4.id);
    [7m   [0m [91m                                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m648[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m648[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m648[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m648[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m651[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m651[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m651[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m651[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m654[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m654[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m654[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m654[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m657[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m657[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m657[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m657[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m663[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m663[0m               userId: testUserId1,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m678[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m678[0m               userId: testUserId1,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m693[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m693[0m               userId: testUserId2,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m708[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m708[0m               userId: testUserId2,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m722[0m:[93m48[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m722[0m           const team1Result = await createTeam(testUserId1, robot1.id, robot2.id);
    [7m   [0m [91m                                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m723[0m:[93m48[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m723[0m           const team2Result = await createTeam(testUserId2, robot3.id, robot4.id);
    [7m   [0m [91m                                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m803[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m803[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m803[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m803[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m806[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m806[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m806[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m806[0m             data: { userId: testUserId1, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m809[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m809[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m809[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m809[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m812[0m:[93m29[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m812[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                            ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m812[0m:[93m42[0m - [91merror[0m[90m TS18004: [0mNo value exists in scope for the shorthand property 'weaponId'. Either declare one or provide an initializer.

    [7m812[0m             data: { userId: testUserId2, weaponId },
    [7m   [0m [91m                                         ~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m818[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m818[0m               userId: testUserId1,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m833[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m833[0m               userId: testUserId1,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m848[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m848[0m               userId: testUserId2,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m863[0m:[93m23[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m863[0m               userId: testUserId2,
    [7m   [0m [91m                      ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m877[0m:[93m48[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId1'.

    [7m877[0m           const team1Result = await createTeam(testUserId1, robot1.id, robot2.id);
    [7m   [0m [91m                                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m878[0m:[93m48[0m - [91merror[0m[90m TS2304: [0mCannot find name 'testUserId2'.

    [7m878[0m           const team2Result = await createTeam(testUserId2, robot3.id, robot4.id);
    [7m   [0m [91m                                               ~~~~~~~~~~~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m944[0m:[93m1[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

    [7m944[0m });
    [7m   [0m [91m~[0m
    [96mtests/tagTeamBattleLogCompleteness.property.test.ts[0m:[93m944[0m:[93m2[0m - [91merror[0m[90m TS1128: [0mDeclaration or statement expected.

    [7m944[0m });
    [7m   [0m [91m ~[0m

FAIL tests/migrateBattlesToEvents.test.ts
  ● Test suite failed to run

    [96mtests/migrateBattlesToEvents.test.ts[0m:[93m8[0m:[93m57[0m - [91merror[0m[90m TS2307: [0mCannot find module '../src/scripts/migrateBattlesToEvents' or its corresponding type declarations.

    [7m8[0m import { migrateBattlesToEvents, verifyMigration } from '../src/scripts/migrateBattlesToEvents';
    [7m [0m [91m                                                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [96mtests/migrateBattlesToEvents.test.ts[0m:[93m111[0m:[93m33[0m - [91merror[0m[90m TS2339: [0mProperty 'robot1DamageDealt' does not exist on type '{ id: number; robot1Id: number; robot2Id: number; winnerId: number | null; battleType: string; leagueType: string; tournamentId: number | null; tournamentRound: number | null; team1ActiveRobotId: number | null; ... 22 more ...; createdAt: Date; }'.

    [7m111[0m       robot1DamageDealt: battle.robot1DamageDealt,
    [7m   [0m [91m                                ~~~~~~~~~~~~~~~~~[0m
    [96mtests/migrateBattlesToEvents.test.ts[0m:[93m112[0m:[93m33[0m - [91merror[0m[90m TS2339: [0mProperty 'robot2DamageDealt' does not exist on type '{ id: number; robot1Id: number; robot2Id: number; winnerId: number | null; battleType: string; leagueType: string; tournamentId: number | null; tournamentRound: number | null; team1ActiveRobotId: number | null; ... 22 more ...; createdAt: Date; }'.

    [7m112[0m       robot2DamageDealt: battle.robot2DamageDealt,
    [7m   [0m [91m                                ~~~~~~~~~~~~~~~~~[0m

FAIL tests/profileApiResponse.property.test.ts
  ● Test suite failed to run

    [96mtests/profileApiResponse.property.test.ts[0m:[93m66[0m:[93m17[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'totalBattles' does not exist in type '(Without<UserCreateInput, UserUncheckedCreateInput> & UserUncheckedCreateInput) | (Without<...> & UserCreateInput)'.

    [7m66[0m                 totalBattles: userProfile.totalBattles,
    [7m  [0m [91m                ~~~~~~~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m3397[0m:[93m5[0m
        [7m3397[0m     data: XOR<UserCreateInput, UserUncheckedCreateInput>
        [7m    [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: UserSelect<DefaultArgs> | null | undefined; include?: UserInclude<DefaultArgs> | null | undefined; data: (Without<UserCreateInput, UserUncheckedCreateInput> & UserUncheckedCreateInput) | (Without<...> & UserCreateInput); }'

FAIL tests/profileUpdate.property.test.ts
  ● Test suite failed to run

    [96mtests/profileUpdate.property.test.ts[0m:[93m491[0m:[93m43[0m - [91merror[0m[90m TS7053: [0mElement implicitly has an 'any' type because expression of type 'string' can't be used to index type '{ stableName?: string | undefined; profileVisibility?: "public" | "private" | undefined; notificationsBattle?: boolean | undefined; notificationsLeague?: boolean | undefined; themePreference?: "dark" | ... 2 more ... | undefined; }'.
      No index signature with a parameter of type 'string' was found on type '{ stableName?: string | undefined; profileVisibility?: "public" | "private" | undefined; notificationsBattle?: boolean | undefined; notificationsLeague?: boolean | undefined; themePreference?: "dark" | ... 2 more ... | undefined; }'.

    [7m491[0m     return Object.keys(obj).some((key) => obj[key] !== undefined);
    [7m   [0m [91m                                          ~~~~~~~~[0m
    [96mtests/profileUpdate.property.test.ts[0m:[93m518[0m:[93m43[0m - [91merror[0m[90m TS7053: [0mElement implicitly has an 'any' type because expression of type 'string' can't be used to index type '{ stableName?: string | undefined; profileVisibility?: "public" | "private" | undefined; notificationsBattle?: boolean | undefined; notificationsLeague?: boolean | undefined; themePreference?: "dark" | ... 2 more ... | undefined; }'.
      No index signature with a parameter of type 'string' was found on type '{ stableName?: string | undefined; profileVisibility?: "public" | "private" | undefined; notificationsBattle?: boolean | undefined; notificationsLeague?: boolean | undefined; themePreference?: "dark" | ... 2 more ... | undefined; }'.

    [7m518[0m     return Object.keys(obj).some((key) => obj[key] !== undefined);
    [7m   [0m [91m                                          ~~~~~~~~[0m

FAIL tests/multiMatchScheduling.property.test.ts
  ● Test suite failed to run

    [96mtests/multiMatchScheduling.property.test.ts[0m:[93m226[0m:[93m26[0m - [91merror[0m[90m TS2322: [0mType 'number | null' is not assignable to type 'number | (TagTeamActiveRobotIdReserveRobotIdCompoundUniqueInput & number) | undefined'.
      Type 'null' is not assignable to type 'number | (TagTeamActiveRobotIdReserveRobotIdCompoundUniqueInput & number) | undefined'.

    [7m226[0m                 where: { id: match.team2Id },
    [7m   [0m [91m                         ~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m22658[0m:[93m5[0m
        [7m22658[0m     id?: number
        [7m     [0m [96m    ~~[0m
        The expected type comes from property 'id' which is declared here on type 'TagTeamWhereUniqueInput'

FAIL tests/facilityROI.property.test.ts
  ● Test suite failed to run

    [96mtests/facilityROI.property.test.ts[0m:[93m53[0m:[93m63[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m53[0m           await prisma.auditLog.deleteMany({ where: { userId: testUserId } });
    [7m  [0m [91m                                                              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m54[0m:[93m63[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m54[0m           await prisma.facility.deleteMany({ where: { userId: testUserId } });
    [7m  [0m [91m                                                              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m59[0m:[93m23[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m59[0m               userId: testUserId,
    [7m  [0m [91m                      ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m73[0m:[93m15[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m73[0m               testUserId,
    [7m  [0m [91m              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m89[0m:[93m15[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m89[0m               testUserId,
    [7m  [0m [91m              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m99[0m:[93m56[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m99[0m             await eventLogger.logOperatingCosts(cycle, testUserId, [
    [7m  [0m [91m                                                       ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m113[0m:[93m13[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m113[0m             testUserId,
    [7m   [0m [91m            ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m150[0m:[93m63[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m150[0m           await prisma.auditLog.deleteMany({ where: { userId: testUserId } });
    [7m   [0m [91m                                                              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m151[0m:[93m63[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m151[0m           await prisma.facility.deleteMany({ where: { userId: testUserId } });
    [7m   [0m [91m                                                              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m156[0m:[93m23[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m156[0m               userId: testUserId,
    [7m   [0m [91m                      ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m170[0m:[93m15[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m170[0m               testUserId,
    [7m   [0m [91m              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m197[0m:[93m25[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m197[0m                 userId: testUserId,
    [7m   [0m [91m                        ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m198[0m:[93m26[0m - [91merror[0m[90m TS2454: [0mVariable 'testRobotId' is used before being assigned.

    [7m198[0m                 robotId: testRobotId,
    [7m   [0m [91m                         ~~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m208[0m:[93m52[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m208[0m             await eventLogger.logOperatingCosts(i, testUserId, [
    [7m   [0m [91m                                                   ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m222[0m:[93m13[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m222[0m             testUserId,
    [7m   [0m [91m            ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m256[0m:[93m63[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m256[0m           await prisma.auditLog.deleteMany({ where: { userId: testUserId } });
    [7m   [0m [91m                                                              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m257[0m:[93m63[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m257[0m           await prisma.facility.deleteMany({ where: { userId: testUserId } });
    [7m   [0m [91m                                                              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m262[0m:[93m23[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m262[0m               userId: testUserId,
    [7m   [0m [91m                      ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m276[0m:[93m15[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m276[0m               testUserId,
    [7m   [0m [91m              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m303[0m:[93m25[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m303[0m                 userId: testUserId,
    [7m   [0m [91m                        ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m304[0m:[93m26[0m - [91merror[0m[90m TS2454: [0mVariable 'testRobotId' is used before being assigned.

    [7m304[0m                 robotId: testRobotId,
    [7m   [0m [91m                         ~~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m316[0m:[93m52[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m316[0m             await eventLogger.logOperatingCosts(i, testUserId, [
    [7m   [0m [91m                                                   ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m330[0m:[93m13[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m330[0m             testUserId,
    [7m   [0m [91m            ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m366[0m:[93m63[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m366[0m           await prisma.auditLog.deleteMany({ where: { userId: testUserId } });
    [7m   [0m [91m                                                              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m367[0m:[93m63[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m367[0m           await prisma.facility.deleteMany({ where: { userId: testUserId } });
    [7m   [0m [91m                                                              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m372[0m:[93m25[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m372[0m               { userId: testUserId, facilityType: 'income_generator', level: 1 },
    [7m   [0m [91m                        ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m373[0m:[93m25[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m373[0m               { userId: testUserId, facilityType: 'repair_bay', level: 1 },
    [7m   [0m [91m                        ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m380[0m:[93m13[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m380[0m             testUserId,
    [7m   [0m [91m            ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m389[0m:[93m13[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m389[0m             testUserId,
    [7m   [0m [91m            ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m407[0m:[93m15[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m407[0m               testUserId,
    [7m   [0m [91m              ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m428[0m:[93m25[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m428[0m                 userId: testUserId,
    [7m   [0m [91m                        ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m429[0m:[93m26[0m - [91merror[0m[90m TS2454: [0mVariable 'testRobotId' is used before being assigned.

    [7m429[0m                 robotId: testRobotId,
    [7m   [0m [91m                         ~~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m439[0m:[93m56[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m439[0m             await eventLogger.logOperatingCosts(cycle, testUserId, [
    [7m   [0m [91m                                                       ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m455[0m:[93m13[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m455[0m             testUserId,
    [7m   [0m [91m            ~~~~~~~~~~[0m
    [96mtests/facilityROI.property.test.ts[0m:[93m459[0m:[93m13[0m - [91merror[0m[90m TS2454: [0mVariable 'testUserId' is used before being assigned.

    [7m459[0m             testUserId,
    [7m   [0m [91m            ~~~~~~~~~~[0m

FAIL tests/integration.test.ts
  ● Test suite failed to run

    [96mtests/integration.test.ts[0m:[93m159[0m:[93m22[0m - [91merror[0m[90m TS2322: [0mType 'null' is not assignable to type 'InputJsonValue | FieldRef<"Battle", "Json"> | JsonNullValueFilter | undefined'.

    [7m159[0m         battleLog: { not: null },
    [7m   [0m [91m                     ~~~[0m
    [96mtests/integration.test.ts[0m:[93m268[0m:[93m13[0m - [91merror[0m[90m TS2322: [0mType 'null' is not assignable to type 'number | IntFilter<"Battle"> | undefined'.

    [7m268[0m           { robot1Id: null },
    [7m   [0m [91m            ~~~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m21904[0m:[93m5[0m
        [7m21904[0m     robot1Id?: IntFilter<"Battle"> | number
        [7m     [0m [96m    ~~~~~~~~[0m
        The expected type comes from property 'robot1Id' which is declared here on type 'BattleWhereInput'
    [96mtests/integration.test.ts[0m:[93m269[0m:[93m13[0m - [91merror[0m[90m TS2322: [0mType 'null' is not assignable to type 'number | IntFilter<"Battle"> | undefined'.

    [7m269[0m           { robot2Id: null },
    [7m   [0m [91m            ~~~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m21905[0m:[93m5[0m
        [7m21905[0m     robot2Id?: IntFilter<"Battle"> | number
        [7m     [0m [96m    ~~~~~~~~[0m
        The expected type comes from property 'robot2Id' which is declared here on type 'BattleWhereInput'

FAIL tests/metricProgression.property.test.ts
  ● Test suite failed to run

    [96mtests/metricProgression.property.test.ts[0m:[93m131[0m:[93m42[0m - [91merror[0m[90m TS2339: [0mProperty 'robot1FameAwarded' does not exist on type '{ robot2Id: number; robot1Id: number; id: number; createdAt: Date; winnerId: number | null; battleType: string; leagueType: string; tournamentRound: number | null; team1ActiveRobotId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m131[0m               const fameAwarded = battle.robot1FameAwarded;
    [7m   [0m [91m                                         ~~~~~~~~~~~~~~~~~[0m
    [96mtests/metricProgression.property.test.ts[0m:[93m343[0m:[93m17[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m343[0m                 userId,
    [7m   [0m [91m                ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/metricProgression.property.test.ts[0m:[93m590[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m590[0m         userId,
    [7m   [0m [91m        ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/metricProgression.property.test.ts[0m:[93m644[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m644[0m         userId,
    [7m   [0m [91m        ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/metricProgression.property.test.ts[0m:[93m698[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m698[0m         userId,
    [7m   [0m [91m        ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/metricProgression.property.test.ts[0m:[93m752[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m752[0m         userId,
    [7m   [0m [91m        ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/metricProgression.property.test.ts[0m:[93m806[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m806[0m         userId,
    [7m   [0m [91m        ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'

FAIL tests/matchListInclusion.property.test.ts
  ● Test suite failed to run

    [96mtests/matchListInclusion.property.test.ts[0m:[93m298[0m:[93m17[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m298[0m                 userId: testUserId,
    [7m   [0m [91m                ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/matchListInclusion.property.test.ts[0m:[93m333[0m:[93m17[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m333[0m                 userId: testUserId,
    [7m   [0m [91m                ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'

FAIL tests/eventLogger.property.test.ts
  ● Test suite failed to run

    [96mtests/eventLogger.property.test.ts[0m:[93m92[0m:[93m15[0m - [91merror[0m[90m TS2345: [0mArgument of type '{ eventType: EventType.BATTLE_COMPLETE | EventType.ROBOT_REPAIR | EventType.ROBOT_ATTRIBUTE_UPGRADE | EventType.ROBOT_LEAGUE_CHANGE | EventType.CREDIT_CHANGE | EventType.PRESTIGE_CHANGE | EventType.PASSIVE_INCOME | ... 10 more ... | EventType.CYCLE_COMPLETE; payload: { ...; }; userId: number | null; robotId: number ...' is not assignable to parameter of type '{ eventType: EventType; payload: BaseEventPayload; userId?: number | undefined; robotId?: number | undefined; metadata?: EventMetadata | undefined; timestamp?: Date | undefined; }[]'.
      Type '{ eventType: EventType.BATTLE_COMPLETE | EventType.ROBOT_REPAIR | EventType.ROBOT_ATTRIBUTE_UPGRADE | EventType.ROBOT_LEAGUE_CHANGE | EventType.CREDIT_CHANGE | EventType.PRESTIGE_CHANGE | EventType.PASSIVE_INCOME | ... 10 more ... | EventType.CYCLE_COMPLETE; payload: { ...; }; userId: number | null; robotId: number ...' is not assignable to type '{ eventType: EventType; payload: BaseEventPayload; userId?: number | undefined; robotId?: number | undefined; metadata?: EventMetadata | undefined; timestamp?: Date | undefined; }'.
        Types of property 'userId' are incompatible.
          Type 'number | null' is not assignable to type 'number | undefined'.
            Type 'null' is not assignable to type 'number | undefined'.

    [7m 92[0m               events.map(e => ({
    [7m   [0m [91m              ~~~~~~~~~~~~~~~~~~[0m
    [7m 93[0m                 eventType: e.eventType,
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m...[0m 
    [7m 96[0m                 robotId: e.robotId,
    [7m   [0m [91m~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~[0m
    [7m 97[0m               }))
    [7m   [0m [91m~~~~~~~~~~~~~~~~~[0m

FAIL tests/byeTeamBattles.property.test.ts
  ● Test suite failed to run

    [96mtests/byeTeamBattles.property.test.ts[0m:[93m16[0m:[93m3[0m - [91merror[0m[90m TS2322: [0mType '{ name: string; id: number; userId: number; frameId: number; paintJob: string | null; combatPower: Prisma.Decimal; targetingSystems: Prisma.Decimal; criticalSystems: Prisma.Decimal; ... 55 more ...; updatedAt: Date; }' is not assignable to type '{ name: string; id: number; userId: number; frameId: number; paintJob: string | null; combatPower: Decimal; targetingSystems: Decimal; criticalSystems: Decimal; ... 55 more ...; updatedAt: Date; }'.
      Types of property 'imageUrl' are incompatible.
        Type 'string | null | undefined' is not assignable to type 'string | null'.
          Type 'undefined' is not assignable to type 'string | null'.

    [7m16[0m   return {
    [7m  [0m [91m  ~~~~~~[0m

FAIL tests/eloProgression.property.test.ts
  ● Test suite failed to run

    [96mtests/eloProgression.property.test.ts[0m:[93m161[0m:[93m19[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m161[0m                   userId,
    [7m   [0m [91m                  ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/eloProgression.property.test.ts[0m:[93m351[0m:[93m19[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m351[0m                   userId,
    [7m   [0m [91m                  ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/eloProgression.property.test.ts[0m:[93m529[0m:[93m19[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m529[0m                   userId,
    [7m   [0m [91m                  ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/eloProgression.property.test.ts[0m:[93m684[0m:[93m17[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m684[0m                 userId,
    [7m   [0m [91m                ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'

FAIL tests/cycleSnapshot.property.test.ts
  ● Test suite failed to run

    [96mtests/cycleSnapshot.property.test.ts[0m:[93m282[0m:[93m19[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'user' does not exist in type 'Without<BattleUncheckedCreateInput, BattleCreateInput> & BattleCreateInput'.

    [7m282[0m                   user: { connect: { id: user.id } },
    [7m   [0m [91m                  ~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m359[0m:[93m57[0m - [91merror[0m[90m TS2339: [0mProperty 'robot1DamageDealt' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m359[0m               robot1Metric.damageDealt += createdBattle.robot1DamageDealt;
    [7m   [0m [91m                                                        ~~~~~~~~~~~~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m360[0m:[93m60[0m - [91merror[0m[90m TS2339: [0mProperty 'robot2DamageDealt' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m360[0m               robot1Metric.damageReceived += createdBattle.robot2DamageDealt;
    [7m   [0m [91m                                                           ~~~~~~~~~~~~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m362[0m:[93m56[0m - [91merror[0m[90m TS2339: [0mProperty 'robot1FameAwarded' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m362[0m               robot1Metric.fameChange += createdBattle.robot1FameAwarded;
    [7m   [0m [91m                                                       ~~~~~~~~~~~~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m381[0m:[93m57[0m - [91merror[0m[90m TS2339: [0mProperty 'robot2DamageDealt' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m381[0m               robot2Metric.damageDealt += createdBattle.robot2DamageDealt;
    [7m   [0m [91m                                                        ~~~~~~~~~~~~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m382[0m:[93m60[0m - [91merror[0m[90m TS2339: [0mProperty 'robot1DamageDealt' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m382[0m               robot2Metric.damageReceived += createdBattle.robot1DamageDealt;
    [7m   [0m [91m                                                           ~~~~~~~~~~~~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m384[0m:[93m56[0m - [91merror[0m[90m TS2339: [0mProperty 'robot2FameAwarded' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m384[0m               robot2Metric.fameChange += createdBattle.robot2FameAwarded;
    [7m   [0m [91m                                                       ~~~~~~~~~~~~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m528[0m:[93m19[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'user' does not exist in type 'Without<BattleUncheckedCreateInput, BattleCreateInput> & BattleCreateInput'.

    [7m528[0m                   user: { connect: { id: user.id } },
    [7m   [0m [91m                  ~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m592[0m:[93m40[0m - [91merror[0m[90m TS2339: [0mProperty 'userId' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m592[0m               actualUserIds.add(battle.userId);
    [7m   [0m [91m                                       ~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m594[0m:[93m53[0m - [91merror[0m[90m TS2339: [0mProperty 'userId' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m594[0m               if (!expectedStableMetrics.has(battle.userId)) {
    [7m   [0m [91m                                                    ~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m595[0m:[93m50[0m - [91merror[0m[90m TS2339: [0mProperty 'userId' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m595[0m                 expectedStableMetrics.set(battle.userId, {
    [7m   [0m [91m                                                 ~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m602[0m:[93m64[0m - [91merror[0m[90m TS2339: [0mProperty 'userId' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m602[0m               const metrics = expectedStableMetrics.get(battle.userId)!;
    [7m   [0m [91m                                                               ~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m605[0m:[93m53[0m - [91merror[0m[90m TS2339: [0mProperty 'robot1PrestigeAwarded' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m605[0m               metrics.totalPrestigeEarned += battle.robot1PrestigeAwarded + battle.robot2PrestigeAwarded;
    [7m   [0m [91m                                                    ~~~~~~~~~~~~~~~~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m605[0m:[93m84[0m - [91merror[0m[90m TS2339: [0mProperty 'robot2PrestigeAwarded' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m605[0m               metrics.totalPrestigeEarned += battle.robot1PrestigeAwarded + battle.robot2PrestigeAwarded;
    [7m   [0m [91m                                                                                   ~~~~~~~~~~~~~~~~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m606[0m:[93m51[0m - [91merror[0m[90m TS2339: [0mProperty 'robot1RepairCost' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m606[0m               metrics.totalRepairCosts += (battle.robot1RepairCost || 0) + (battle.robot2RepairCost || 0);
    [7m   [0m [91m                                                  ~~~~~~~~~~~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m606[0m:[93m84[0m - [91merror[0m[90m TS2339: [0mProperty 'robot2RepairCost' does not exist on type '{ createdAt: Date; id: number; robot1Id: number; robot2Id: number; robot1ELOBefore: number; robot2ELOBefore: number; winnerReward: number | null; loserReward: number | null; winnerId: number | null; ... 22 more ...; tournamentId: number | null; }'.

    [7m606[0m               metrics.totalRepairCosts += (battle.robot1RepairCost || 0) + (battle.robot2RepairCost || 0);
    [7m   [0m [91m                                                                                   ~~~~~~~~~~~~~~~~[0m
    [96mtests/cycleSnapshot.property.test.ts[0m:[93m659[0m:[93m17[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'user' does not exist in type 'Without<BattleUncheckedCreateInput, BattleCreateInput> & BattleCreateInput'.

    [7m659[0m                 user: { connect: { id: user.id } },
    [7m   [0m [91m                ~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'

FAIL tests/battleLogStreamingRevenue.property.test.ts
  ● Test suite failed to run

    [96mtests/battleLogStreamingRevenue.property.test.ts[0m:[93m111[0m:[93m7[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m111[0m       userId,
    [7m   [0m [91m      ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'

FAIL tests/analyticsApi.test.ts
  ● Test suite failed to run

    [96mtests/analyticsApi.test.ts[0m:[93m228[0m:[93m11[0m - [91merror[0m[90m TS2322: [0mType 'JsonValue' is not assignable to type 'JsonNull | InputJsonValue'.
      Type 'null' is not assignable to type 'JsonNull | InputJsonValue'.

    [7m228[0m           stableMetrics: snapshot.stableMetrics,
    [7m   [0m [91m          ~~~~~~~~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m24461[0m:[93m5[0m
        [7m24461[0m     stableMetrics: JsonNullValueInput | InputJsonValue
        [7m     [0m [96m    ~~~~~~~~~~~~~[0m
        The expected type comes from property 'stableMetrics' which is declared here on type '(Without<CycleSnapshotCreateInput, CycleSnapshotUncheckedCreateInput> & CycleSnapshotUncheckedCreateInput) | (Without<...> & CycleSnapshotCreateInput)'
    [96mtests/analyticsApi.test.ts[0m:[93m229[0m:[93m11[0m - [91merror[0m[90m TS2322: [0mType 'JsonValue' is not assignable to type 'JsonNull | InputJsonValue'.
      Type 'null' is not assignable to type 'JsonNull | InputJsonValue'.

    [7m229[0m           robotMetrics: snapshot.robotMetrics,
    [7m   [0m [91m          ~~~~~~~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m24462[0m:[93m5[0m
        [7m24462[0m     robotMetrics: JsonNullValueInput | InputJsonValue
        [7m     [0m [96m    ~~~~~~~~~~~~[0m
        The expected type comes from property 'robotMetrics' which is declared here on type '(Without<CycleSnapshotCreateInput, CycleSnapshotUncheckedCreateInput> & CycleSnapshotUncheckedCreateInput) | (Without<...> & CycleSnapshotCreateInput)'
    [96mtests/analyticsApi.test.ts[0m:[93m230[0m:[93m11[0m - [91merror[0m[90m TS2322: [0mType 'JsonValue' is not assignable to type 'JsonNull | InputJsonValue'.
      Type 'null' is not assignable to type 'JsonNull | InputJsonValue'.

    [7m230[0m           stepDurations: snapshot.stepDurations,
    [7m   [0m [91m          ~~~~~~~~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m24463[0m:[93m5[0m
        [7m24463[0m     stepDurations: JsonNullValueInput | InputJsonValue
        [7m     [0m [96m    ~~~~~~~~~~~~~[0m
        The expected type comes from property 'stepDurations' which is declared here on type '(Without<CycleSnapshotCreateInput, CycleSnapshotUncheckedCreateInput> & CycleSnapshotUncheckedCreateInput) | (Without<...> & CycleSnapshotCreateInput)'
    [96mtests/analyticsApi.test.ts[0m:[93m1220[0m:[93m11[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m1220[0m           userId: testUserId,
    [7m    [0m [91m          ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/analyticsApi.test.ts[0m:[93m1724[0m:[93m13[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m1724[0m             userId: testUserId,
    [7m    [0m [91m            ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/analyticsApi.test.ts[0m:[93m2068[0m:[93m9[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m2068[0m         userId: testUserId,
    [7m    [0m [91m        ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'
    [96mtests/analyticsApi.test.ts[0m:[93m2211[0m:[93m13[0m - [91merror[0m[90m TS2353: [0mObject literal may only specify known properties, and 'userId' does not exist in type 'Without<BattleCreateInput, BattleUncheckedCreateInput> & BattleUncheckedCreateInput'.

    [7m2211[0m             userId: testUserId,
    [7m    [0m [91m            ~~~~~~[0m

      [96mnode_modules/.prisma/client/index.d.ts[0m:[93m11734[0m:[93m5[0m
        [7m11734[0m     data: XOR<BattleCreateInput, BattleUncheckedCreateInput>
        [7m     [0m [96m    ~~~~[0m
        The expected type comes from property 'data' which is declared here on type '{ select?: BattleSelect<DefaultArgs> | null | undefined; include?: BattleInclude<DefaultArgs> | null | undefined; data: (Without<...> & BattleUncheckedCreateInput) | (Without<...> & BattleCreateInput); }'

FAIL tests/streamingStudioPrestigeValidation.test.ts
  ● Streaming Studio Prestige Validation › Higher levels: Progressive prestige requirements › should enforce 50,000 prestige for Level 10

    expect(received).toBe(expected) // Object.is equality

    Expected: 403
    Received: 200

      340 |         .send({ facilityType: 'streaming_studio' });
      341 |
    > 342 |       expect(response.status).toBe(403);
          |                               ^
      343 |       expect(response.body.required).toBe(50000);
      344 |     });
      345 |

      at Object.<anonymous> (tests/streamingStudioPrestigeValidation.test.ts:342:31)

FAIL tests/incomeGeneratorNoStreaming.property.test.ts
  ● Property 18: Income Generator No Longer Provides Streaming Revenue › Property 18.2: Passive income is independent of robot stats

    Property failed after 15 tests
    { seed: -1287251150, path: "14", endOnFailure: true }
    Counterexample: [10,44060]
    Shrunk 0 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.user.update()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/tests/incomeGeneratorNoStreaming.property.test.ts:199:29

      196 });
      197 
      198 // Update user prestige
    → 199 await prisma.user.update(
    Too many database connections opened: FATAL: sorry, too many clients already
    Prisma Accelerate has built-in connection pooling to prevent such errors: https://pris.ly/client/error-accelerate

      197 |
      198 |           // Update user prestige
    > 199 |           await prisma.user.update({
          |           ^
      200 |             where: { id: testUserId },
      201 |             data: { prestige },
      202 |           });

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at tests/incomeGeneratorNoStreaming.property.test.ts:199:11
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/incomeGeneratorNoStreaming.property.test.ts:185:5)

FAIL tests/eventQueryability.property.test.ts (19.107 s)
  ● Property 5: Event Queryability › cycle range filtering returns only events within range

    Property failed after 1 tests
    { seed: 2143166356, path: "0:0:0:0:0:0:0:0:1:0:1:0:0:0:2", endOnFailure: true }
    Counterexample: [[1,1,1,1,1],1,6]
    Shrunk 14 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: 7

      67 |           // Verify count matches
      68 |           const expectedCount = cycles.filter(c => c >= start && c <= end).length;
    > 69 |           expect(result.events.length).toBe(expectedCount);
         |                                        ^
      70 |         }
      71 |       ),
      72 |       { numRuns: 30 }

      at tests/eventQueryability.property.test.ts:69:40
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/eventQueryability.property.test.ts:34:5)

  ● Property 5: Event Queryability › user filtering returns only events for that user

    Property failed after 6 tests
    { seed: -2089765227, path: "5:12:3:9:0:0:0:0:3:0:0:0:0:0:0:0:0:2:1:2:2:0:0:0", endOnFailure: true }
    Counterexample: [1,[{"userId":1,"amount":0},{"userId":1,"amount":0},{__proto__:null,"userId":1,"amount":227},{"userId":1,"amount":0},{"userId":1,"amount":0}]]
    Shrunk 23 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: 2

      117 |           // Verify count matches
      118 |           const expectedCount = events.filter(e => e.userId === targetUserId).length;
    > 119 |           expect(result.events.length).toBe(expectedCount);
          |                                        ^
      120 |         }
      121 |       ),
      122 |       { numRuns: 30 }

      at tests/eventQueryability.property.test.ts:119:40
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/eventQueryability.property.test.ts:82:5)

  ● Property 5: Event Queryability › event type filtering returns only matching types

    Property failed after 1 tests
    { seed: -1612597215, path: "0:1", endOnFailure: true }
    Counterexample: [["cycle_step_complete"],5]
    Shrunk 1 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: 1

      165 |
      166 |           // Verify count matches
    > 167 |           expect(result.events.length).toBe(expectedCount);
          |                                        ^
      168 |         }
      169 |       ),
      170 |       { numRuns: 25 }

      at tests/eventQueryability.property.test.ts:167:40
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/eventQueryability.property.test.ts:132:5)

  ● Property 5: Event Queryability › pagination returns correct subset

    Property failed after 1 tests
    { seed: -848836706, path: "0:0:0:0", endOnFailure: true }
    Counterexample: [10,1,0]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 10
    Received: 31

      208 |
      209 |           // Verify total count
    > 210 |           expect(result.total).toBe(totalEvents);
          |                                ^
      211 |         }
      212 |       ),
      213 |       { numRuns: 30 }

      at tests/eventQueryability.property.test.ts:210:32
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/eventQueryability.property.test.ts:180:5)

  ● Property 5: Event Queryability › sorting maintains order

    Property failed after 7 tests
    { seed: 1274363055, path: "6:9:59:35:1:43:32:40:41:2:9:3", endOnFailure: true }
    Counterexample: [[1,13,1,10,4,8,15,5,4],"asc"]
    Shrunk 11 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStart (src/services/eventLogger.ts:271:5)
      at tests/eventQueryability.property.test.ts:236:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/eventQueryability.property.test.ts:223:5)

  ● Property 5: Event Queryability › combined filters are applied correctly

    Property failed after 8 tests
    { seed: 1248912910, path: "7:1:0:1:26:0:2:0:0:1:12:1:2:0:0:0:0:22:9:1:1:1:0:0:1:1:1:1:0:0:0:0:0:0", endOnFailure: true }
    Counterexample: [1,1,6,[{__proto__:null,"cycle":6,"userId":5},{"cycle":1,"userId":6},{"cycle":10,"userId":8},{"cycle":3,"userId":7},{"cycle":2,"userId":1},{__proto__:null,"cycle":1,"userId":1},{"cycle":1,"userId":1},{"cycle":1,"userId":1},{"cycle":1,"userId":1},{"cycle":1,"userId":1}]]
    Shrunk 33 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).toBe(expected) // Object.is equality

    Expected: 6
    Received: 0

      315 |               e.cycle <= rangeEnd
      316 |           ).length;
    > 317 |           expect(result.events.length).toBe(expectedCount);
          |                                        ^
      318 |         }
      319 |       ),
      320 |       { numRuns: 25 }

      at tests/eventQueryability.property.test.ts:317:40
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/eventQueryability.property.test.ts:268:5)

  ● Property 5: Event Queryability › count matches filtered results

    Property failed after 3 tests
    { seed: 237222476, path: "2:1:0:4:29:7:25:1:0:37:0", endOnFailure: true }
    Counterexample: [[{__proto__:null,"cycle":15,"userId":4},{__proto__:null,"cycle":2,"userId":7},{__proto__:null,"cycle":13,"userId":1},{__proto__:null,"cycle":7,"userId":8},{"cycle":15,"userId":3},{"cycle":20,"userId":8},{"cycle":1,"userId":1},{"cycle":11,"userId":5},{"cycle":8,"userId":6},{__proto__:null,"cycle":15,"userId":9}],3]
    Shrunk 10 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCreditChange (src/services/eventLogger.ts:401:5)
      at tests/eventQueryability.property.test.ts:378:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/eventQueryability.property.test.ts:362:5)

FAIL tests/performanceDegradation.property.test.ts (31.518 s)
  ● Property 16: Performance Degradation Detection › Property 16.1: Degradation detected when recent average > 150% of baseline

    Property failed after 1 tests
    { seed: 615362161, path: "0:0:0", endOnFailure: true }
    Counterexample: [100,1.5099999904632568,"step_a"]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    expect(received).not.toBeNull()

    Received: null

      66 |           const alert = await service.detectStepDegradation(stepName, 10, 100);
      67 |
    > 68 |           expect(alert).not.toBeNull();
         |                             ^
      69 |           expect(alert!.stepName).toBe(stepName);
      70 |           expect(alert!.currentAverageDuration).toBe(recentDuration);
      71 |           expect(alert!.baselineAverageDuration).toBe(baselineDuration);

      at tests/performanceDegradation.property.test.ts:68:29
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/performanceDegradation.property.test.ts:39:5)

  ● Property 16: Performance Degradation Detection › Property 16.2: No degradation when recent average <= 150% of baseline

    Property failed after 1 tests
    { seed: -1468190363, path: "0:0:0:0", endOnFailure: true }
    Counterexample: [100,0.5,"step_x"]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStepComplete (src/services/eventLogger.ts:287:5)
      at tests/performanceDegradation.property.test.ts:98:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/performanceDegradation.property.test.ts:85:5)

  ● Property 16: Performance Degradation Detection › Property 16.3: Degradation severity correctly classified (warning vs critical)

    Property failed after 1 tests
    { seed: -1094509690, path: "0:0:0:0", endOnFailure: true }
    Counterexample: [100,1.5099999904632568,"step_1"]
    Shrunk 3 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStepComplete (src/services/eventLogger.ts:287:5)
      at tests/performanceDegradation.property.test.ts:139:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/performanceDegradation.property.test.ts:125:5)

  ● Property 16: Performance Degradation Detection › Property 16.4: Multiple steps monitored independently

    Property failed after 1 tests
    { seed: -1021460863, path: "0:0:1:1:0:1:0", endOnFailure: true }
    Counterexample: [[{"stepName":"step_a","baselineDuration":100,"isDegraded":false},{__proto__:null,"stepName":"step_a","baselineDuration":100,"isDegraded":false}]]
    Shrunk 6 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStepComplete (src/services/eventLogger.ts:287:5)
      at tests/performanceDegradation.property.test.ts:200:15
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/performanceDegradation.property.test.ts:172:5)

  ● Property 16: Performance Degradation Detection › Property 16.5: Detection consistent across different baseline sizes

    Property failed after 1 tests
    { seed: 1600627866, path: "0:0:0", endOnFailure: true }
    Counterexample: [500,20,"test_step_a"]
    Shrunk 2 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStepComplete (src/services/eventLogger.ts:287:5)
      at tests/performanceDegradation.property.test.ts:254:13
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/performanceDegradation.property.test.ts:241:5)

  ● Property 16: Performance Degradation Detection › Property 16.6: Alerts sorted by degradation percentage (highest first)

    Property failed after 2 tests
    { seed: 1975532964, path: "1:0:0:0:0:1:0:0:2:0:0:0:27:3:3", endOnFailure: true }
    Counterexample: [[{"stepName":"s1","degradationMultiplier":1.600000023841858},{"stepName":"s1","degradationMultiplier":1.6049456596374512},{"stepName":"s4","degradationMultiplier":2.433058023452759}]]
    Shrunk 14 time(s)

    Hint: Enable verbose mode in order to have the list of all failing values encountered during the run

      at buildError (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:162:19)
      at asyncThrowIfFailed (node_modules/fast-check/lib/cjs/check/runner/utils/RunDetailsFormatter.js:176:11)

    Cause:
    PrismaClientKnownRequestError: 
    Invalid `prisma.auditLog.create()` invocation in
    /Users/robertteunissen/Downloads/ArmouredSouls/prototype/backend/src/services/eventLogger.ts:197:27

      194 };
      195 
      196 // Insert into database
    → 197 await prisma.auditLog.create(
    Unique constraint failed on the fields: (`cycle_number`,`sequence_number`)

      195 |     
      196 |     // Insert into database
    > 197 |     await prisma.auditLog.create({
          |     ^
      198 |       data: {
      199 |         cycleNumber: entry.cycleNumber,
      200 |         eventType: entry.eventType,

      at $n.handleRequestError (node_modules/@prisma/client/runtime/library.js:121:7315)
      at $n.handleAndLogRequestError (node_modules/@prisma/client/runtime/library.js:121:6623)
      at $n.request (node_modules/@prisma/client/runtime/library.js:121:6307)
      at l (node_modules/@prisma/client/runtime/library.js:130:9633)
      at EventLogger.logEvent (src/services/eventLogger.ts:197:5)
      at EventLogger.logCycleStepComplete (src/services/eventLogger.ts:287:5)
      at tests/performanceDegradation.property.test.ts:308:15
      at AsyncProperty.run (node_modules/fast-check/lib/cjs/check/property/AsyncProperty.generic.js:46:28)
      at asyncRunIt (node_modules/fast-check/lib/cjs/check/runner/Runner.js:28:21)
      at Object.<anonymous> (tests/performanceDegradation.property.test.ts:282:5)

FAIL tests/integration/adminCycleGeneration.test.ts (36.929 s)
  ● Admin Cycle Generation Integration Tests › POST /api/admin/cycles/bulk with generateUsersPerCycle › should generate progressive users per cycle

    TypeError: Cannot read properties of undefined (reading 'usersCreated')

      139 |
      140 |       // Verify user generation in each cycle
    > 141 |       expect(response.body.results[0].userGeneration.usersCreated).toBe(1);
          |                                                      ^
      142 |       expect(response.body.results[1].userGeneration.usersCreated).toBe(2);
      143 |       expect(response.body.results[2].userGeneration.usersCreated).toBe(3);
      144 |

      at Object.<anonymous> (tests/integration/adminCycleGeneration.test.ts:141:54)

  ● Admin Cycle Generation Integration Tests › POST /api/admin/cycles/bulk with generateUsersPerCycle › should persist cycle count across multiple runs

    expect(received).toBe(expected) // Object.is equality

    Expected: 5
    Received: 40

      168 |       // Verify cycle metadata
      169 |       const metadata1 = await prisma.cycleMetadata.findUnique({ where: { id: 1 } });
    > 170 |       expect(metadata1!.totalCycles).toBe(5);
          |                                      ^
      171 |
      172 |       // Second run: 3 cycles (should start at cycle 6)
      173 |       const response2 = await request(app)

      at Object.<anonymous> (tests/integration/adminCycleGeneration.test.ts:170:38)

  ● Admin Cycle Generation Integration Tests › POST /api/admin/cycles/bulk with generateUsersPerCycle › should not generate users when flag is false

    expect(received).toBeNull()

    Received: undefined

      218 |       // Verify no user generation in results
      219 |       response.body.results.forEach((result: any) => {
    > 220 |         expect(result.userGeneration).toBeNull();
          |                                       ^
      221 |       });
      222 |
      223 |       // Verify no users were created

      at tests/integration/adminCycleGeneration.test.ts:220:39
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (tests/integration/adminCycleGeneration.test.ts:219:29)

  ● Admin Cycle Generation Integration Tests › POST /api/admin/cycles/bulk with generateUsersPerCycle › should return correct response structure

    expect(received).toHaveProperty(path)

    Expected path: "usersCreated"
    Received path: []

    Received value: {"error": "Missing weapons for archetype tank_fortress. Expected 2 unique weapons, found 0"}

      348 |         expect(result).toHaveProperty('cycle');
      349 |         expect(result).toHaveProperty('userGeneration');
    > 350 |         expect(result.userGeneration).toHaveProperty('usersCreated');
          |                                       ^
      351 |         expect(result.userGeneration).toHaveProperty('robotsCreated');
      352 |         expect(result.userGeneration).toHaveProperty('usernames');
      353 |       });

      at tests/integration/adminCycleGeneration.test.ts:350:39
          at Array.forEach (<anonymous>)
      at Object.<anonymous> (tests/integration/adminCycleGeneration.test.ts:347:29)

  ● Admin Cycle Generation Integration Tests › POST /api/admin/cycles/bulk with generateUsersPerCycle › should auto-create CycleMetadata if missing

    expect(received).toBe(expected) // Object.is equality

    Expected: 1
    Received: undefined

      392 |
      393 |       expect(response.status).toBe(200);
    > 394 |       expect(response.body.results[0].userGeneration.usersCreated).toBe(1);
          |                                                                    ^
      395 |
      396 |       // Verify CycleMetadata was created
      397 |       const metadata = await prisma.cycleMetadata.findUnique({ where: { id: 1 } });

      at Object.<anonymous> (tests/integration/adminCycleGeneration.test.ts:394:68)

  ● Admin Cycle Generation Integration Tests › POST /api/admin/cycles/bulk with generateUsersPerCycle › should generate correct total user count formula (N*(N+1)/2)

    expect(received).toBe(expected) // Object.is equality

    Expected: 55
    Received: 0

      419 |       });
      420 |
    > 421 |       expect(totalUsers).toBe(expectedTotal);
          |                          ^
      422 |     });
      423 |
      424 |     it('should create users eligible for matchmaking', async () => {

      at Object.<anonymous> (tests/integration/adminCycleGeneration.test.ts:421:26)


Test Suites: 85 failed, 15 passed, 100 total
Tests:       382 failed, 447 passed, 829 total
Snapshots:   0 total
Time:        38.079 s
Ran all test suites.
